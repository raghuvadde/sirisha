"use strict";define("VSSUI",["require","exports","react","OfficeFabric/DatePicker","OfficeFabric/TextField","OfficeFabric/Utilities","OfficeFabric/Persona","OfficeFabric/Pickers","OfficeFabric/Button","OfficeFabric/Spinner","OfficeFabric/Label","OfficeFabric/Callout","OfficeFabric/FocusZone"],function(n,t,i,r,u,f,e,o,s,h,c,l,a){var yt,pt,w,ft,et,b,ot,st,y,ht,k,ct,d,p,g,nt,tt,v,it,rt,lt,ut,at,vt,wt,bt;(function(n){yt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0})})("ComponentsDateTimePickerDateTimePickerProps"),function(n){pt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0})}("ComponentsDateTimeRangePickerDateTimeRangePickerProps"),function(n){w=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var e=function(n){function e(i){var r=n.call(this,i)||this;return r._value=new Date,r._getErrorMessage=function(n){var i=r.props.parseTimeFromString,u=i===void 0?r._defaultParseTimeFromString:i;return!u(n)?t.VSSResourcesVSSUI.DateTimePicker_CannotParseTime:""},i&&("value"in i&&f.warn("'value' will be ignored. Use 'defaultValue'."),"onSelectDate"in i&&f.warn("'onSelectDate' will be ignored."),r._value=i.defaultValue),r}return __extends(e,n),e.prototype.render=function(){var n=this,f=this.props,e=f.formatTime,s=e===void 0?this._defaultformatTime:e,o=f.parseTimeFromString,h=o===void 0?this._defaultParseTimeFromString:o;return i.createElement("div",{className:"vss-DateTimePicker"},i.createElement("div",{className:"vss-DateTimePicker--dateField"},i.createElement(r.DatePicker,__assign({isMonthPickerVisible:!1},this.props,{value:this._value,ariaLabel:this.props.dateAriaLabel||t.VSSResourcesVSSUI.DateTimePicker_DateFieldAriaLabel,onSelectDate:function(t){if(n._value&&n._value.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),n.props.onValueChanged)n.props.onValueChanged(n._value)}}))),i.createElement("div",{className:"vss-DateTimePicker--timeField"},i.createElement(u.TextField,{defaultValue:s(this._value),onGetErrorMessage:this._getErrorMessage,validateOnFocusOut:!0,ariaLabel:this.props.timeAriaLabel||t.VSSResourcesVSSUI.DateTimePicker_TimeFieldAriaLabel,onChanged:function(t){var i=h(t);if(!!i&&(n._value.setHours(i.getHours(),i.getMinutes(),i.getSeconds()),n.props.onValueChanged))n.props.onValueChanged(n._value)}})))},e.prototype._defaultParseTimeFromString=function(n){var t=Date.parse(n);return t?new Date(t):null},e.prototype._defaultformatTime=function(n){return n?n.toLocaleTimeString():""},e}(f.BaseComponent);t[n].DateTimePicker=e}("ComponentsDateTimePickerDateTimePicker"),function(n){ft=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var r=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t._onSelectionChanged=function(n){t.setFilterValue({value:n})},t}return __extends(t,n),t.prototype.focus=function(){return!1},t.prototype.componentWillMount=function(){this.props.filter.setFilterItemState(this.props.filterItemKey,{value:this.props.defaultValue})},t.prototype.render=function(){return i.createElement(w.DateTimePicker,{defaultValue:this.props.defaultValue,formatDate:this.props.formatDate,formatTime:this.props.formatTime,parseTimeFromString:this.props.parseTimeFromString,onValueChanged:this._onSelectionChanged})},t.prototype.onFilterChanged=function(){},t}(t.FilterBar.FilterBarItem);t[n].DateTimePickerFilterBarItem=r}("ComponentsDateTimePickerDateTimePickerFilterBarItem"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}et=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(w);i(ft)}("ComponentsDateTimePickerindex"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}b=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(et)}("DateTimePicker"),function(n){ot=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var r=function(n){function r(t){var i=n.call(this,t)||this;return t&&(i._startTime=t.defaultStartTime,i._endTime=t.defaultEndTime),i}return __extends(r,n),r.prototype.render=function(){var n=this;return i.createElement("div",{className:"vss-DateTimeRangePicker"},i.createElement("div",null,i.createElement("span",{className:"vss-DateTimeRangePicker--label"},t.VSSResourcesVSSUI.DateTimeRangePicker_Start),i.createElement(b.DateTimePicker,{defaultValue:this._startTime,formatDate:this.props.formatDate,formatTime:this.props.formatTime,parseTimeFromString:this.props.parseTimeFromString,onValueChanged:function(t){if(n._startTime=t,n.props.onValueChanged)n.props.onValueChanged(n._startTime,n._endTime)},dateAriaLabel:t.VSSResourcesVSSUI.DateTimeRangePicker_StartDate,timeAriaLabel:t.VSSResourcesVSSUI.DateTimeRangePicker_StartTime})),i.createElement("div",null,i.createElement("span",{className:"vss-DateTimeRangePicker--label"},t.VSSResourcesVSSUI.DateTimeRangePicker_End),i.createElement(b.DateTimePicker,{defaultValue:this._endTime,formatDate:this.props.formatDate,formatTime:this.props.formatTime,parseTimeFromString:this.props.parseTimeFromString,onValueChanged:function(t){if(n._endTime=t,n.props.onValueChanged)n.props.onValueChanged(n._startTime,n._endTime)},dateAriaLabel:t.VSSResourcesVSSUI.DateTimeRangePicker_EndDate,timeAriaLabel:t.VSSResourcesVSSUI.DateTimeRangePicker_EndTime})))},r}(f.BaseComponent);t[n].DateTimeRangePicker=r}("ComponentsDateTimeRangePickerDateTimeRangePicker"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}st=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(ot)}("ComponentsDateTimeRangePickerindex"),function(n){function i(n){return{imageUrl:n.image,text:n.displayName,showSecondaryText:!!n.displayName&&n.displayName!=="",secondaryText:u(n),size:e.PersonaSize.extraExtraSmall}}function r(n){var r=n,t=n;return Array.isArray(r)?r.map(function(n){return i(n)}):t&&t.then?t.then(function(n){return n.map(function(n){return i(n)})}):null}function u(n){return!n.isHosted&&n.samAccountName&&n.samAccountName.trim()?(n.scopeName&&n.scopeName.trim()?n.scopeName+"\\":"")+n.samAccountName:n.signInAddress&&n.signInAddress.trim()?n.signInAddress:n.mail&&n.mail.trim()?n.mail:n.mailNickname&&n.mailNickname.trim()?n.mailNickname:""}y=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});t[n].convertIdentityToPersona=i;t[n].convertIdentityListToPersonaList=r}("ComponentsPeoplePickerPeoplePickerUtils"),function(n){ht=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var r=function(n){function r(){var r=n!==null&&n.apply(this,arguments)||this;return r._peoplePicker=f.createRef(),r._getfilteredPersonas=function(n){return y.convertIdentityListToPersonaList(r.props.pickerProvider.onFilterIdentities(n))},r._resultsFooter=function(){return r._peoplePicker.current&&r._peoplePicker.current.items.length>0?i.createElement("div",{className:"vss-NoIdentitiesFound"},f.format(t.VSSResourcesVSSUI.PeoplePickerResultsFoundText,r._peoplePicker.current.items)):null},r._onRenderNoIdentitiesFound=function(){return i.createElement("div",{className:"vss-NoIdentitiesFound"},t.VSSResourcesVSSUI.PeoplePickerNoResultsText)},r}return __extends(r,n),r.prototype.render=function(){var n={onRenderNoResultFound:this._onRenderNoIdentitiesFound,resultsFooter:this._resultsFooter},r={placeholder:t.VSSResourcesVSSUI.PeoplePickerPlaceholderText};return i.createElement(o.NormalPeoplePicker,{componentRef:this._peoplePicker,className:"vss-PeoplePicker",pickerSuggestionsProps:n,inputProps:r,resolveDelay:200,searchingText:t.VSSResourcesVSSUI.PeoplePickerLoadingText,onResolveSuggestions:this._getfilteredPersonas})},r}(f.BaseComponent);t[n].PeoplePicker=r}("ComponentsPeoplePickerPeoplePicker"),function(n){var r,u;k=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});r=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.render=function(){var t,n=this.props,r=n.suggestionModel,e=n.renderSuggestion,o=n.onClick,h=n.className,c=n.onRemoveItem,l=n.isSelectedOverride,u=n.removeButtonAriaLabel;return i.createElement("div",{className:f.css("vss-suggestionsItem","flex flex-grow",(t={},t["is-suggested vss-suggestionsItemIsSuggested"]=r.selected||l,t),h)},i.createElement("div",{onClick:o,className:"ms-Suggestions-itemButton itemButton flex flex-grow"},e(r.item,this.props)),this.props.showRemoveButton?i.createElement(s.IconButton,{iconProps:{iconName:"Cancel",style:{fontSize:"12px"}},title:u,ariaLabel:u,onClick:c,className:f.css("ms-Suggestions-closeButton","closeButton")}):null)},t}(f.BaseComponent);t[n].SuggestionsItem=r;u=function(n){function t(t){var i=n.call(this,t)||this;return i._forceResolveButton=f.createRef(),i._searchForMoreButton=f.createRef(),i._selectedElement=f.createRef(),i.SuggestionsItemOfProperType=r,i.tryHandleKeyDown=function(n,t){var f=!1,r=null,e=i.state.selectedActionType,u=i.props.suggestions.length;if(n===40)switch(e){case 1:u>0?(i._refocusOnSuggestions(n),r=0):r=i._searchForMoreButton.current?2:1;break;case 2:i._forceResolveButton.current?r=1:u>0?(i._refocusOnSuggestions(n),r=0):r=2;break;case 0:t===-1&&i._forceResolveButton.current&&(r=1)}else if(n===38)switch(e){case 1:i._searchForMoreButton.current?r=2:u>0&&(i._refocusOnSuggestions(n),r=0);break;case 2:u>0?(i._refocusOnSuggestions(n),r=0):i._forceResolveButton.current&&(r=1);break;case 0:t===-1&&i._searchForMoreButton.current&&(r=2)}return r!==null&&(i.setState({selectedActionType:r}),f=!0),f},i._getMoreResults=function(){i.props.onGetMoreResults&&i.props.onGetMoreResults()},i._forceResolve=function(){i.props.createGenericItem&&i.props.createGenericItem()},i._shouldShowForceResolve=function(){return i.props.showForceResolve?i.props.showForceResolve():!1},i._onClickTypedSuggestionsItem=function(n,t){return function(r){i.props.onSuggestionClick(r,n,t)}},i._refocusOnSuggestions=function(n){typeof i.props.refocusSuggestions=="function"&&i.props.refocusSuggestions(n)},i._onRemoveTypedSuggestionsItem=function(n,t){return function(r){var u=i.props.onSuggestionRemove;u(r,n,t);r.stopPropagation()}},i.state={selectedActionType:0},i}return __extends(t,n),t.prototype.componentDidMount=function(){this.scrollSelected();this.activeSelectedElement=this._selectedElement?this._selectedElement.current:null},t.prototype.componentDidUpdate=function(){this._selectedElement.current&&this.activeSelectedElement!==this._selectedElement.current&&(this.scrollSelected(),this.activeSelectedElement=this._selectedElement.current)},t.prototype.render=function(){var u,e,n=this.props,a=n.forceResolveText,v=n.mostRecentlyUsedHeaderText,y=n.searchForMoreText,p=n.className,w=n.moreSuggestionsAvailable,b=n.noResultsFoundText,t=n.suggestions,o=n.isLoading,c=n.isSearching,rt=n.loadingText,k=n.onRenderNoResultFound,ut=n.searchingText,d=n.isMostRecentlyUsedVisible,ft=n.resultsMaximumNumber,et=n.resultsFooterFull,ot=n.resultsFooter,g=n.isResultsFooterVisible,st=g===void 0?!0:g,nt=n.suggestionsAvailableAlertText,ht=n.suggestionsHeaderText,tt=function(){return b?i.createElement("div",{role:"alert",className:"ms-Suggestions-none vss-suggestionsNone"},b):null},l=ht,r,it;return d&&v&&(l=v),r=undefined,st&&(r=t.length>=ft?et:ot),it=(!t||!t.length)&&!o,i.createElement("div",{className:f.css("ms-Suggestions",p?p:"","vss-suggestions")},l?i.createElement("div",{className:f.css("ms-Suggestions-title","vss-suggestionsTitle")},l):null,a&&this._shouldShowForceResolve()&&i.createElement(s.CommandButton,{componentRef:this._forceResolveButton,className:f.css("ms-forceResolve-button actionButton",(u={},u["is-selected buttonSelected"]=this.state.selectedActionType===1,u)),onClick:this._forceResolve},a),o&&i.createElement(h.Spinner,{className:"ms-Suggestions-spinner vss-suggestionsSpinner",label:rt}),it?k?k(undefined,tt):tt():this._renderSuggestions(),y&&w&&i.createElement(s.CommandButton,{componentRef:this._searchForMoreButton,className:f.css("ms-SearchMore-button","actionButton",(e={},e["is-selected buttonSelected"]=this.state.selectedActionType===2,e)),iconProps:{iconName:"Search"},onClick:this._getMoreResults},y),c?i.createElement(h.Spinner,{className:"ms-Suggestions-spinner vss-suggestionsSpinner",label:ut}):null,r&&!w&&!d&&!c?i.createElement("div",{className:"ms-Suggestions-title vss-suggestionsTitle"},r(this.props)):null,i.createElement("span",{role:"alert","aria-live":"polite",className:"ms-Suggestions-suggestionsAvailable vss-suggestionsAvailable"},!o&&!c&&t&&t.length>0&&nt?nt:null))},t.prototype.hasSuggestedAction=function(){return this._searchForMoreButton.current!==undefined||this._forceResolveButton.current!==undefined},t.prototype.hasSuggestedActionSelected=function(){return this.state.selectedActionType!==0},t.prototype.executeSelectedAction=function(){switch(this.state.selectedActionType){case 1:this._forceResolve();break;case 2:this._getMoreResults()}},t.prototype.focusAboveSuggestions=function(){this._forceResolveButton.current?this.setState({selectedActionType:1}):this._searchForMoreButton.current&&this.setState({selectedActionType:2})},t.prototype.focusBelowSuggestions=function(){this._searchForMoreButton.current?this.setState({selectedActionType:2}):this._forceResolveButton.current&&this.setState({selectedActionType:1})},t.prototype.focusSearchForMoreButton=function(){this._searchForMoreButton.current&&this._searchForMoreButton.current.focus()},t.prototype.scrollSelected=function(){this._selectedElement.current&&this._selectedElement.current.scrollIntoView!==undefined&&this._selectedElement.current.scrollIntoView(!1)},t.prototype._renderSuggestions=function(){var t=this,n=this.props,f=n.onRenderSuggestion,e=n.removeSuggestionAriaLabel,o=n.suggestionsItemClassName,u=n.resultsMaximumNumber,s=n.showRemoveButtons,h=n.suggestionsContainerAriaLabel,r=this.props.suggestions,c=this.SuggestionsItemOfProperType;return u&&(r=r.slice(0,u)),i.createElement("div",{className:"ms-Suggestions-container vss-suggestionsContainer",id:"suggestion-list",role:"list","aria-label":h},r.map(function(n,r){return i.createElement("div",{ref:n.selected?t._selectedElement:"",key:n.item.key?n.item.key:r,id:"sug-"+r,role:"listitem","aria-label":n.ariaLabel},i.createElement(c,{id:"sug-item"+r,suggestionModel:n,renderSuggestion:f,onClick:t._onClickTypedSuggestionsItem(n.item,r),className:o,showRemoveButton:s,removeButtonAriaLabel:e,onRemoveItem:t._onRemoveTypedSuggestionsItem(n.item,r)}))}))},t}(f.BaseComponent);t[n].Suggestions=u}("ComponentsPeoplePickerSuggestions"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}ct=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(ht);i(y);i(k)}("ComponentsPeoplePickerindex"),function(n){var r,u;d=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});r=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.render=function(){return i.createElement("div",null,i.createElement("div",{className:this.props.padTop?"contact-card-line-top":"contact-card-line"},i.createElement("div",{className:"contact-card-span-label"},this.props.label),i.createElement("div",{className:"contact-card-span-content"},this.props.link&&this.props.content&&i.createElement("a",{className:"profile-card-tab-element",href:this.props.link},this.props.content),!this.props.link&&this.props.content)),i.createElement("div",{style:{clear:"both"}}))},t}(f.BaseComponent);t[n].ContactCardContactLine=r;u=function(n){function u(){return n!==null&&n.apply(this,arguments)||this}return __extends(u,n),u.prototype.render=function(){var n=this.props.identity;return i.createElement("div",{className:"contact-or-organization-card-wrapper"},i.createElement("div",{className:"contact-card-header-wrapper"},i.createElement("div",{className:"body-m"},i.createElement(c.Label,null,t.VSSResourcesVSSUI.PeoplePickerContactInfo))),i.createElement("div",{className:"contact-card-info-wrapper"},i.createElement(r,{label:t.VSSResourcesVSSUI.PeoplePickerEmail,content:n.mail,link:"mailto:"+n.mail}),i.createElement(r,{label:t.VSSResourcesVSSUI.PeoplePickerPhoneNumber,content:n.telephoneNumber,link:"mailto:"+n.telephoneNumber}),i.createElement(r,{label:t.VSSResourcesVSSUI.PeoplePickerLocation,content:n.physicalDeliveryOfficeName}),i.createElement(r,{label:t.VSSResourcesVSSUI.PeoplePickerTitle,content:n.jobTitle,padTop:!0}),i.createElement(r,{label:t.VSSResourcesVSSUI.PeoplePickerDepartment,content:n.department}),i.createElement(r,{label:t.VSSResourcesVSSUI.PeoplePickerAlias,content:n.mailNickname})))},u}(i.Component);t[n].ContactCard=u}("ComponentsPersonaCardContactCard"),function(n){var r,u;p=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});r=function(n){function r(){return n!==null&&n.apply(this,arguments)||this}return __extends(r,n),r.prototype.render=function(){return i.createElement("div",{className:"default-card-contact-line-wrapper"},i.createElement(c.Label,{className:"default-card-contact-line"},i.createElement(t.VssIcon.VssIcon,{iconName:this.props.iconName,className:"default-card-contact-line-label"}),this.props.link&&i.createElement("a",{href:this.props.link,className:"default-card-contact-line-link profile-card-tab-element"},this.props.content),!this.props.link&&i.createElement("span",{className:"default-card-contact-line-no-link"},this.props.content)))},r}(f.BaseComponent);t[n].DefaultCardContactLine=r;u=function(n){function u(){return n!==null&&n.apply(this,arguments)||this}return __extends(u,n),u.prototype.componentDidMount=function(){this.props.setFocus&&this.props.setFocus()},u.prototype.render=function(){var o=this,h=this.props,n=h.identity,a=h.isPreviousHeader,f={imageUrl:this.props.identity.image,primaryText:this.props.identity.displayName,secondaryText:this.props.identity.jobTitle,tertiaryText:this.props.identity.department},v=i.createElement("div",null,i.createElement(e.Persona,__assign({},f,{key:this.props.identity.entityId+this.props.identity.signInAddress,size:e.PersonaSize.large,className:"persona-main",onRenderPrimaryText:function(){return i.createElement(t.Tooltip.TooltipHost,{key:o.props.identity.entityId+".primarytext.tooltip",content:f.primaryText,overflowMode:t.Tooltip.TooltipOverflowMode.Parent},i.createElement("span",{className:"persona-main-text-primary"},f.primaryText))},onRenderSecondaryText:function(){return i.createElement(t.Tooltip.TooltipHost,{key:o.props.identity.entityId+".secondarytext.tooltip",content:f.secondaryText,overflowMode:t.Tooltip.TooltipOverflowMode.Parent},i.createElement("span",{className:"persona-main-text-secondary"},f.secondaryText))},onRenderTertiaryText:function(){return i.createElement("div",{className:"persona-main-text-tertiary"},f.tertiaryText)},imageShouldFadeIn:!1}))),l=null,u,s;return this.props.manager&&(u=this.props.manager,s={imageUrl:u.image,primaryText:u.displayName,secondaryText:u.jobTitle,tertiaryText:u.department},l=i.createElement("div",{className:"persona-list-manager-element profile-card-tab-element","aria-label":u.displayName,key:u.entityId+u.signInAddress,onClick:function(){o.props.onClickEntity(u)},"data-is-focusable":!0,role:"button"},i.createElement(e.Persona,__assign({},s,{size:e.PersonaSize.size40,onRenderPrimaryText:function(){return i.createElement("div",{className:"persona-list-element-text-primary"},s.primaryText)},onRenderSecondaryText:function(){return i.createElement("div",{className:"persona-list-element-text-secondary"},s.secondaryText)},imageShouldFadeIn:!1})))),i.createElement("div",{className:a?"default-card-with-header":"default-card-without-header"},v,i.createElement("div",null,(n.mail||n.telephoneNumber||n.physicalDeliveryOfficeName)&&i.createElement("div",{className:"default-card-contact-info-wrapper"},i.createElement("hr",{className:"hr-main"}),i.createElement("div",{className:"default-card-header-wrapper"},i.createElement("span",{className:"default-card-header pointer profile-card-tab-element",onClick:function(){o.props.showContactCard()},"aria-label":t.VSSResourcesVSSUI.PeoplePickerContact,"data-is-focusable":!0,role:"button"},i.createElement(c.Label,{className:"pointer"},i.createElement("b",{className:"default-card-header-space"},t.VSSResourcesVSSUI.PeoplePickerContact),i.createElement(t.VssIcon.VssIcon,{iconType:0,iconName:"ChevronRight"})))),i.createElement("div",{className:"default-card-contact-info-container"},n.mail&&i.createElement(r,{iconName:"Mail",content:n.mail,link:"mailto:"+n.mail}),n.mail&&i.createElement(r,{iconName:"Chat",content:t.VSSResourcesVSSUI.PeoplePickerStartChat,link:"sip:"+n.mail}),n.telephoneNumber&&i.createElement(r,{iconName:"Phone",content:n.telephoneNumber,link:"tel:"+n.telephoneNumber}),n.physicalDeliveryOfficeName&&i.createElement(r,{iconName:"POI",content:n.physicalDeliveryOfficeName}))),this._renderDirectManagerElement(l)))},u.prototype._renderDirectManagerElement=function(n){var r=this;return n?i.createElement("div",{className:"default-card-direct-manager-wrapper"},i.createElement("hr",{className:"hr-secondary"}),i.createElement("div",{className:"default-card-header-wrapper"},i.createElement("span",{className:"default-card-header pointer profile-card-tab-element",onClick:function(){r.props.showOrganizationCard()},"aria-label":t.VSSResourcesVSSUI.PeoplePickerOrganization,"data-is-focusable":!0,role:"button"},i.createElement(c.Label,{className:"pointer"},i.createElement("b",{className:"default-card-header-space"},t.VSSResourcesVSSUI.PeoplePickerOrganization),i.createElement(t.VssIcon.VssIcon,{iconType:0,iconName:"ChevronRight"})))),i.createElement("div",{className:"default-card-direct-manager"},i.createElement("div",{className:"default-card-header-reportsto"},t.VSSResourcesVSSUI.PeoplePickerReportsTo),n)):null},u}(i.Component);t[n].DefaultCard=u}("ComponentsPersonaCardDefaultCard"),function(n){g=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var r=function(n){function r(){return n!==null&&n.apply(this,arguments)||this}return __extends(r,n),r.prototype.render=function(){var r=this,n={imageUrl:this.props.identity.image,primaryText:this.props.identity.displayName},u=i.createElement("div",null,i.createElement(e.Persona,__assign({},n,{key:this.props.identity.entityId,size:e.PersonaSize.large,className:"persona-main",onRenderPrimaryText:function(){return i.createElement(t.Tooltip.TooltipHost,{key:r.props.identity.entityId+".primarytext.tooltip",content:n.primaryText,overflowMode:t.Tooltip.TooltipOverflowMode.Parent},i.createElement("span",{className:"persona-main-text-primary"},n.primaryText))},imageShouldFadeIn:!1})));return i.createElement("div",{className:"default-card-abridged"},u,this._verifySignInAddress()&&i.createElement("div",null,i.createElement("div",{className:"default-card-contact-info-wrapper"},i.createElement("hr",{className:"hr-main"}),i.createElement("div",{className:"default-card-header-wrapper"},i.createElement("span",{className:"default-card-header"},i.createElement(c.Label,null,i.createElement("b",{className:"default-card-header-space"},t.VSSResourcesVSSUI.PeoplePickerContact)))),i.createElement("div",{className:"default-card-contact-info-container"},i.createElement(p.DefaultCardContactLine,{iconName:"Mail",content:this.props.identity.signInAddress,link:"mailto:"+this.props.identity.signInAddress}),i.createElement(p.DefaultCardContactLine,{iconName:"Chat",content:t.VSSResourcesVSSUI.PeoplePickerStartChat,link:"sip:"+this.props.identity.signInAddress})))))},r.prototype._verifySignInAddress=function(){if(!this.props.identity.signInAddress)return!1;return/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(this.props.identity.signInAddress)?!0:!1},r}(f.BaseComponent);t[n].DefaultAbridgedCard=r}("ComponentsPersonaCardDefaultAbridgedCard"),function(n){nt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var r=function(n){function r(){return n!==null&&n.apply(this,arguments)||this}return __extends(r,n),r.prototype.render=function(){var r=this,n={imageUrl:this.props.identity.image,primaryText:this.props.identity.displayName,secondaryText:this.props.identity.scopeName&&this.props.identity.signInAddress?this.props.identity.scopeName+"\\"+this.props.identity.signInAddress:this.props.identity.signInAddress?this.props.identity.signInAddress:""};return i.createElement("div",{className:"default-card-simple"},i.createElement("div",null,i.createElement(e.Persona,__assign({},n,{key:this.props.identity.entityId,size:e.PersonaSize.large,className:"persona-main",onRenderPrimaryText:function(){return i.createElement(t.Tooltip.TooltipHost,{key:r.props.identity.entityId+".primarytext.tooltip",content:n.primaryText,overflowMode:t.Tooltip.TooltipOverflowMode.Parent},i.createElement("span",{className:"persona-main-text-primary"},n.primaryText))},onRenderSecondaryText:function(){return i.createElement(t.Tooltip.TooltipHost,{key:r.props.identity.entityId+".secondarytext.tooltip",content:n.secondaryText,overflowMode:t.Tooltip.TooltipOverflowMode.Parent},i.createElement("span",{className:"persona-main-text-secondary"},n.secondaryText))},imageShouldFadeIn:!1}))))},r}(f.BaseComponent);t[n].DefaultSimpleCard=r}("ComponentsPersonaCardDefaultSimpleCard"),function(n){tt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var r=function(n){function r(){return n!==null&&n.apply(this,arguments)||this}return __extends(r,n),r.prototype.render=function(){var r=this.createManagerChainPersonaElements(),n=this.createDirectReportsPersonaElements();return i.createElement("div",{className:"contact-or-organization-card-wrapper"},i.createElement("div",{className:"organization-card-content"},i.createElement("div",{className:"organization-card-header-wrapper"},i.createElement(c.Label,null,t.VSSResourcesVSSUI.PeoplePickerOrganization)),i.createElement("div",{className:"organization-card-manager-chain-wrapper"},r),n.length>0&&i.createElement("div",{className:"organization-card-direct-reports-wrapper"},i.createElement(c.Label,{className:"organization-card-direct-reports-label"},f.format(t.VSSResourcesVSSUI.PeoplePickerReportingTo,this.props.identity.displayName,this.props.directReportList.length)),n)))},r.prototype.createManagerChainPersonaElements=function(){var u=this,t=this,r=this.props.managerList?this.props.managerList.map(function(n){var r={imageUrl:n.image,primaryText:n.displayName?n.displayName:"",secondaryText:n.jobTitle?n.jobTitle:"",tertiaryText:n.department?n.department:""};return i.createElement("div",{className:"persona-list-element profile-card-tab-element","aria-label":n.displayName,key:n.entityId+n.signInAddress,onClick:function(){t.props.onClickEntity(n)},"data-is-focusable":!0,role:"button"},i.createElement(e.Persona,__assign({},r,{size:e.PersonaSize.size40,onRenderPrimaryText:function(){return i.createElement("div",{className:"persona-list-element-text-primary"},r.primaryText)},onRenderSecondaryText:function(){return i.createElement("div",{className:"persona-list-element-text-secondary"},r.secondaryText)},imageShouldFadeIn:!1})))}):[],n={imageUrl:this.props.identity.image,primaryText:this.props.identity.displayName,secondaryText:this.props.identity.jobTitle,tertiaryText:this.props.identity.department};return r.push(i.createElement("div",{className:"persona-list-element profile-card-tab-element","aria-label":this.props.identity.displayName,key:this.props.identity.entityId+this.props.identity.signInAddress,onClick:function(){t.props.onClickEntity(u.props.identity)},"data-is-focusable":!0,role:"button"},i.createElement(e.Persona,__assign({},n,{size:e.PersonaSize.size40,onRenderPrimaryText:function(){return i.createElement("div",{className:"persona-list-element-text-primary"},n.primaryText)},onRenderSecondaryText:function(){return i.createElement("div",{className:"persona-list-element-text-secondary"},n.secondaryText)},imageShouldFadeIn:!1})))),r},r.prototype.createDirectReportsPersonaElements=function(){var n=this;return this.props.directReportList?this.props.directReportList.map(function(t){var r={imageUrl:t.image,primaryText:t.displayName?t.displayName:"",secondaryText:t.jobTitle?t.jobTitle:"",tertiaryText:t.department?t.department:""};return i.createElement("div",{className:"persona-list-element profile-card-tab-element","aria-label":t.displayName,key:t.entityId+t.signInAddress,onClick:function(){n.props.onClickEntity(t)},"data-is-focusable":!0,role:"button"},i.createElement(e.Persona,__assign({},r,{size:e.PersonaSize.size40,onRenderPrimaryText:function(){return i.createElement("div",{className:"persona-list-element-text-primary"},r.primaryText)},onRenderSecondaryText:function(){return i.createElement("div",{className:"persona-list-element-text-secondary"},r.secondaryText)},imageShouldFadeIn:!1})))}):[]},r}(f.BaseComponent);t[n].OrganizationCard=r}("ComponentsPersonaCardOrganizationCard"),function(n){function e(n,t){return n?i(n)||r(n)?!!(t&&n.mail||n.mailNickname||n.jobTitle||n.department||n.physicalDeliveryOfficeName||n.manager||n.surname||n.telephoneNumber):u(n)?!!n.signInAddress:f(n)?!!(n.scopeName||n.signInAddress):!1:!1}function i(n){return n&&n.originDirectory&&n.originDirectory.trim().toLowerCase()==="aad"}function r(n){return n&&n.originDirectory&&n.originDirectory.trim().toLowerCase()==="ad"}function u(n){return n&&n.originDirectory&&n.originDirectory.trim().toLowerCase()==="vsd"}function f(n){return n&&n.originDirectory&&n.originDirectory.trim().toLowerCase()==="wmd"}v=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});t[n].isCompleteIdentity=e;t[n].isAadUser=i;t[n].isAdUser=r;t[n].isVsdUser=u;t[n].isWmdUser=f}("ComponentsPersonaCardPersonaCardIdentityUtils"),function(n){it=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var r=function(n){function r(){return n!==null&&n.apply(this,arguments)||this}return __extends(r,n),r.prototype.componentDidMount=function(){this.props.setFocus&&this.props.setFocus()},r.prototype.componentDidUpdate=function(){this.props.setFocus&&this.props.setFocus()},r.prototype.render=function(){var u=this,n,r;return this.props.identity?(n=this.props.identity,r={imageUrl:n.image,primaryText:n.displayName,secondaryText:n.jobTitle,tertiaryText:n.department},i.createElement("div",{className:"go-back-persona-wrapper",onClick:this.props.onClickFunction,"aria-label":t.VSSResourcesVSSUI.PeoplePickerHeaderButtonLabel,ref:function(n){u._personaElement=n},"data-is-focusable":!0,role:"button"},i.createElement("div",null,i.createElement(t.VssIcon.VssIcon,{iconType:0,iconName:"ChevronLeft"})),i.createElement("div",{className:"go-back-positioning"},i.createElement(e.Persona,__assign({},r,{size:e.PersonaSize.extraExtraSmall,className:"go-back-persona",onRenderPrimaryText:function(){return i.createElement(t.Tooltip.TooltipHost,{key:n.entityId+".tooltip",content:n.displayName,overflowMode:t.Tooltip.TooltipOverflowMode.Parent},i.createElement("span",{className:"persona-header-text-primary"},n.displayName))},imageShouldFadeIn:!1}))))):null},r.prototype.setFocus=function(){this._personaElement&&this._personaElement.focus()},r}(f.BaseComponent);t[n].PersonaCardHeaderElement=r}("ComponentsPersonaCardPersonaCardHeaderElement"),function(n){rt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var r=function(n){function r(){var t=n!==null&&n.apply(this,arguments)||this;return t._onFocusZoneRef=function(n){t._focusZone=n;t._focusOnUpdate()},t._focusOnUpdate=function(){var n=t.props.dataProps.directReportList;t.props.dataProps.cardType===0&&n?t._focusZone.focus():t.props.dataProps.cardType!==0&&t._focusZone.focus()},t._onDismissCallout=function(){t.props.onDismissCallback&&t.props.onDismissCallback()},t}return __extends(r,n),r.prototype.componentDidUpdate=function(){var n=v.isVsdUser(this.props.dataProps.identity);this.props.dataProps.header||n||this._focusOnUpdate()},r.prototype.render=function(){var n=this.props.referenceHTMLComponent?this.props.referenceHTMLComponent:this.props.target;return i.createElement("div",null,i.createElement(l.Callout,{onDismiss:this._onDismissCallout,target:n,ariaLabel:t.VSSResourcesVSSUI.PeoplePickerProfileCardAriaLabel,role:"alert",isBeakVisible:!1,gapSpace:10,className:"persona-card-callout",directionalHint:11},i.createElement("div",null,this._renderCard())))},r.prototype._renderCard=function(){var r="persona-card-styles",u,n;return this.props.working&&!v.isCompleteIdentity(this.props.dataProps.identity)?i.createElement("div",{className:f.css(r,"loading")},i.createElement(f.DelayedRender,{delay:300},i.createElement(h.Spinner,{label:t.VSSResourcesVSSUI.Loading,type:h.SpinnerType.large,className:"persona-card-loading-spinner"}))):(u=v.isAdUser(this.props.dataProps.identity)||v.isAadUser(this.props.dataProps.identity),n=this.props.dataProps.header||null,i.createElement(a.FocusZone,{className:r,handleTabKey:1,isCircularNavigation:!0,componentRef:this._onFocusZoneRef,direction:a.FocusZoneDirection.vertical},u&&n&&i.createElement(it.PersonaCardHeaderElement,{identity:n,onClickFunction:this.props.onHeaderClick,setFocus:this._focusOnUpdate}),this._renderInnerCard()))},r.prototype._renderInnerCard=function(){var r=this.props.dataProps,n=r.identity,t=r.managerList,f=r.directReportList,u;if(!n)return null;var e=v.isVsdUser(n),o=v.isWmdUser(n),s=v.isAadUser(n),h=v.isAdUser(n);if(e)return i.createElement(g.DefaultAbridgedCard,{identity:n});if(o)return i.createElement(nt.DefaultSimpleCard,{identity:n});if(s||h)switch(this.props.dataProps.cardType){case 1:return i.createElement(d.ContactCard,{identity:n});case 2:return i.createElement(tt.OrganizationCard,{identity:n,managerList:t,directReportList:f,onClickEntity:this.props.onClickEntity});case 0:default:return u=t&&t.length>0?t[t.length-1]:null,i.createElement(p.DefaultCard,{identity:n,manager:u,isPreviousHeader:!!this.props.dataProps.previousDataState||!!this.props.initialHeader,showContactCard:this.props.onShowContactCard,showOrganizationCard:this.props.onShowOrganizationCard,onClickEntity:this.props.onClickEntity,setFocus:this._focusOnUpdate})}return null},r}(f.BaseComponent);t[n].PersonaCardContent=r}("ComponentsPersonaCardPersonaCardContent"),function(n){lt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var r=function(n){function t(t){var i=n.call(this,t)||this,r,u;return i._onDismissCallback=function(){i.props.onDismissCallback()},i._headerOnClickHandler=function(){i.state.dataState.previousDataState?i.setState({dataState:i.state.dataState.previousDataState,working:!1}):i.props.initialHeader&&i.props.initialHeader.onClickFunction&&i.props.initialHeader.onClickFunction()},i._onShowContactCard=function(){var n=__assign({},i.state.dataState,{previousDataState:i.state.dataState,cardType:1,header:i.state.dataState.identity});i.setState({dataState:n})},i._onShowOrganizationCard=function(){var u,n,r,t;i.state.working||i._dismissed||(u=i.state.dataState,u.managerList&&u.managerList.length<=1?(n=i.state.dataState,t=__assign({},n,{cardType:2,header:n.identity,previousDataState:n}),i.setState({dataState:t,working:!0}),i._resolveIdentity(t,i.props.onRequestConnectionInformation(n.identity,!0))):(r=i.state.dataState,t=__assign({},r,{cardType:2,header:r.identity,previousDataState:r}),i.setState({dataState:t,working:!1})))},i._onClickEntity=function(n){if(!i.state.working){var t=i.state.dataState,r={identity:n,cardType:0,header:t.identity,directReportList:[],managerList:[],previousDataState:t,displayName:n.displayName,imageUrl:n.image,email:n.mail};i.setState({dataState:r,working:!0});i._getIdentityByUniqueAttribute(n)}},i._updateConnections=function(n,t){i._dismissed||i.state.dataState&&n.identity===i.state.dataState.identity&&i.setState({dataState:__assign({},i.state.dataState,{managerList:t.managers&&t.managers.reverse(),directReportList:t.directReports}),working:!1})},i._updateEntity=function(n){var r=v.isCompleteIdentity(n,!0),u=v.isAadUser(n)||v.isAdUser(n),f=i.props.imageUrl?i.props.imageUrl:n.image,t=__assign({},i.state.dataState,{identity:n,displayName:n.displayName,imageUrl:f});r?u?(i.setState({dataState:t,working:!1}),i._resolveIdentity(t,i.props.onRequestConnectionInformation(t.identity))):i.setState({dataState:t,working:!1}):i.setState({working:!0})},r={identity:t.identity,managerList:null,directReportList:null,previousDataState:null,cardType:0,header:t.initialHeader?t.initialHeader.identity:null,displayName:t.displayName,imageUrl:t.imageUrl,email:i._getEmail()},u=!0,t.identity||t.uniqueAttribute||!t.displayName||(r.identity={entityId:"",entityType:"user",originDirectory:"vsd",originId:"",displayName:t.displayName,image:t.imageUrl,signInAddress:r.email},u=!1),i.state={dataState:r,working:u},i}return __extends(t,n),t.prototype.componentDidMount=function(){this.state.working&&this._setupInitialData(this.props.uniqueAttribute)},t.prototype.componentWillUnmount=function(){this._dismissed=!0},t.prototype.render=function(){return this.props.uniqueAttribute||this.props.identity||this.props.displayName?i.createElement(rt.PersonaCardContent,__assign({},this.props,{dataProps:this.state.dataState,onClickEntity:this._onClickEntity,onDismissCallback:this._onDismissCallback,onShowContactCard:this._onShowContactCard,onShowOrganizationCard:this._onShowOrganizationCard,working:this.state.working,onHeaderClick:this._headerOnClickHandler})):null},t.prototype._setupInitialData=function(n){var t=this.state.dataState;t.identity?v.isCompleteIdentity(t.identity)?this._resolveIdentity(t,this.props.onRequestConnectionInformation(t.identity)):this._getIdentityByUniqueAttribute(t.identity):this._getIdentityByUniqueAttribute(n)},t.prototype._resolveIdentity=function(n,t){var u=this,r=t,i=t;i&&i.then?i.then(function(t){u._updateConnections(n,t)}):r&&this._updateConnections(n,r)},t.prototype._resolveIEntity=function(n){var r=this,i=n,t=n;t&&t.then?t.then(function(n){r._updateEntity(n)}):i&&this._updateEntity(i)},t.prototype._getIdentityByUniqueAttribute=function(n){var t;t=typeof n=="string"?n:v.isAadUser(n)||v.isAdUser(n)?n.entityId:n.signInAddress;this._resolveIEntity(this.props.getEntityFromUniqueAttribute(t))},t.prototype._getEmail=function(){var n,t;return v.isAadUser(this.props.identity)||v.isAdUser(this.props.identity)?this.props.identity.mail:this.props.identity&&this.props.identity.signInAddress?this.props.identity.signInAddress:this.props.identity&&this.props.identity.mail?this.props.identity.mail:this.props.uniqueAttribute&&(n=this.props.uniqueAttribute.split("@"),n.length===2&&n[0].length>=1&&n[1].length>=3&&(t=n[1].split("."),t.length>1))?this.props.uniqueAttribute:null},t}(f.BaseComponent);t[n].PersonaCard=r}("ComponentsPersonaCardPersonaCard"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}ut=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(d);i(g);i(p);i(nt);i(tt);i(lt);i(rt);i(it);i(v)}("ComponentsPersonaCardindex"),function(n){at=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var r=function(n){function r(r){var u=n.call(this,r)||this;return u._suggestionsControl=f.createRef(),u._outerElement=f.createRef(),u._inputElement=f.createRef(),u.hidePicker=function(){u.setState({suggestionsVisible:!1})},u.showPicker=function(){u.setState({suggestionsVisible:!0})},u.currentSuggestion=function(){return u.state.selectedIdentity},u._onFocus=function(n){var t=u.props.onFocus;u._inputElement.current&&u._inputElement.current.value===""&&u.props.pickerProvider.onEmptyInputFocus&&(u.updateSuggestionsList(u.props.pickerProvider.onEmptyInputFocus()),u.setState({isMostRecentlyUsedVisible:!0}));u.setState({hasFocus:!0});t&&t(n)},u._onClick=function(){u.state.openedIdentityCard?u.setState({openedIdentityCard:undefined}):u._inputElement.current&&u._inputElement.current.value===""&&u.props.pickerProvider.onEmptyInputFocus?(u.updateSuggestionsList(u.props.pickerProvider.onEmptyInputFocus()),u.setState({isMostRecentlyUsedVisible:!0,suggestionsVisible:!u.state.suggestionsVisible})):u.setState({suggestionsVisible:!u.state.suggestionsVisible,isMostRecentlyUsedVisible:u._inputElement.current.value===""});u._inputElement.current.select()},u._onBlur=function(){u.setState({hasFocus:!1})},u._onSearchChange=function(){var n=u._inputElement.current.value;n!==u.state.searchValue&&(u._updateValue(n),u.setState({searchValue:n,suggestionsVisible:!0,isMostRecentlyUsedVisible:!1}))},u._onKeyDown=function(n){var t=n.which;switch(t){case 27:u.state.openedIdentityCard&&u.props.onChange&&!u._suggestionStore.currentSuggestion&&u.props.onChange();u.state.suggestionsVisible&&u.setState({suggestionsVisible:!1,openedIdentityCard:undefined});break;case 9:case 13:u._suggestionsControl.current&&u._suggestionsControl.current.hasSuggestedActionSelected()?(u._suggestionsControl.current.executeSelectedAction(),u._completeSuggestion()):!n.shiftKey&&u._suggestionStore.hasSelectedSuggestion()&&u.state.suggestionsVisible?(u._completeSuggestion(),n.preventDefault(),n.stopPropagation()):u.state.suggestionsVisible&&u._completeSuggestion();break;case 39:u._suggestionStore.currentSuggestion&&u.setState({openedIdentityCard:u._suggestionStore.currentSuggestion.item});break;case 38:u._suggestionsControl.current&&u._suggestionsControl.current.tryHandleKeyDown(t,u._suggestionStore.currentIndex)?(n.preventDefault(),n.stopPropagation()):u._suggestionsControl.current&&u.state.suggestionsVisible&&(u._suggestionStore.previousSuggestion(),u.forceUpdate(),n.preventDefault(),n.stopPropagation());break;case 40:u._suggestionsControl.current&&u._suggestionsControl.current.tryHandleKeyDown(t,u._suggestionStore.currentIndex)?(n.preventDefault(),n.stopPropagation()):u._suggestionsControl.current&&u.state.suggestionsVisible?(u._suggestionStore.nextSuggestion(),u.forceUpdate(),n.preventDefault(),n.stopPropagation()):u.setState({suggestionsVisible:!0})}},u._setInputToSelectedPerson=function(){var n=u._inputElement.current?u._inputElement.current.value:"",t=u._suggestionStore.currentSuggestion?u._suggestionStore.currentSuggestion.item.displayName:n;u.setState({searchValue:t})},u._onSuggestionClick=function(n,t,i){if(u._suggestionStore.setSelectedSuggestion(i),u.props.onChange)u.props.onChange(t);u.setState({searchValue:t.displayName,suggestionsVisible:!1,selectedIdentity:u._suggestionStore.currentSuggestion.item})},u._completeSuggestion=function(){u._suggestionStore.suggestions.length>0&&u._inputElement.value?(u._suggestionStore.currentIndex<0&&u._suggestionStore.nextSuggestion(),u._setInputToSelectedPerson(),u.props.onChange&&u._suggestionStore.currentSuggestion&&u.props.onChange(u._suggestionStore.currentSuggestion.item),u.setState({suggestionsVisible:!1,selectedIdentity:u._suggestionStore.currentSuggestion.item})):(u._suggestionStore.deselectAllSuggestions(),u._suggestionStore.currentSuggestion=undefined,u.setState({selectedIdentity:undefined}),u.props.onChange&&u.props.onChange())},u._onRenderSuggestions=function(n){return i.createElement("div",{className:"flex-row flex-grow vss-picker-suggesteditem"},i.createElement(e.Persona,__assign({className:"flex-grow vss-picker-suggesteditem",size:e.PersonaSize.size28,imageShouldFadeIn:!1,showSecondaryText:!0},y.convertIdentityToPersona(n))),i.createElement(t.VssIcon.VssIcon,{className:"flex-shrink vss-contact-card",iconType:0,iconName:"ContactCard",onClick:function(t){u.setState({openedIdentityCard:n});t.stopPropagation()}}))},u._onRenderNoIdentitiesFound=function(){return i.createElement("div",{className:"vss-NoIdentitiesFound"},t.VSSResourcesVSSUI.PeoplePickerNoResultsText)},u._resultsFooter=function(n){return n.suggestions.length>0?i.createElement("div",null,f.format(t.VSSResourcesVSSUI.PeoplePickerResultsFoundText,n.suggestions.length)):undefined},u._suggestionStore=new o.SuggestionsController,u._cachedResults={},u.state={searchValue:"",hasFocus:r.autoFocus,suggestionsVisible:!1,isMostRecentlyUsedVisible:!1,openedIdentityCard:undefined,selectedIdentity:undefined},u}return __extends(r,n),r.prototype.render=function(){var h=this,n=this.state,c=n.searchValue,r=n.hasFocus,u=n.suggestionsVisible,l=this.props.autoFocus,o=this.state.selectedIdentity,s={"vss-PeoplePickerDropdown-open":u||r};return i.createElement("div",null,i.createElement("div",{ref:this._outerElement,role:"comboBox","aria-autocomplete":"list","aria-label":t.VSSResourcesVSSUI.PeoplePickerPlaceholderText,"aria-expanded":this.state.suggestionsVisible,className:f.css("vss-PeoplePickerDropdown flex-row flex-center",s,this.props.className),onClick:this._onClick,onKeyDown:this._onKeyDown},o&&!r&&!u&&i.createElement(e.PersonaCoin,__assign({},y.convertIdentityToPersona(o),{size:e.PersonaSize.size16,className:"vss-PeoplePickerDropdown-icon"})),i.createElement("input",{className:"vss-PeoplePickerDropdown-input flex-grow",onFocus:this._onFocus,ref:this._inputElement,placeholder:t.VSSResourcesVSSUI.PeoplePickerPlaceholderText,onChange:this._onSearchChange,onBlur:this._onBlur,value:c,autoFocus:l}),i.createElement(t.VssIcon.VssIcon,{className:f.css("vss-PeoplePickerDropdown-chevron",s),iconType:0,iconName:"ChevronDown"}),this._renderSuggestions()),this.state.openedIdentityCard&&i.createElement(ut.PersonaCard,{key:this.state.openedIdentityCard.entityId,identity:this.state.openedIdentityCard,target:this._outerElement.current,onDismissCallback:function(){return h.setState({openedIdentityCard:undefined})},onRequestConnectionInformation:this.props.pickerProvider.onRequestConnectionInformation,getEntityFromUniqueAttribute:this.props.pickerProvider.getEntityFromUniqueAttribute}))},r.prototype.componentDidUpdate=function(n,t){if(t.suggestionsVisible&&!this.state.suggestionsVisible&&!this.state.openedIdentityCard&&!this.state.hasFocus||t.openedIdentityCard&&!this.state.openedIdentityCard&&!this.state.suggestionsVisible&&!this.state.hasFocus){var i=this.props,r=i.onChange,u=i.onBlur;r&&r(this.state.selectedIdentity);u&&u()}},r.prototype.componentDidMount=function(){this._onResolveSuggestions=this._async.debounce(this._onResolveSuggestions,250);this.props.defaultIdentity?(this._updateSuggestions([this.props.defaultIdentity]),this.setState({searchValue:this.props.defaultIdentity.displayName,selectedIdentity:this.props.defaultIdentity})):this.props.autoFocus&&this.updateSuggestionsList(this.props.pickerProvider.onEmptyInputFocus())},r.prototype.updateSuggestionsList=function(n,t){var i=this,f=n,r=n,u;Array.isArray(f)?this._updateSuggestions(f):r&&r.then&&(this._loadingTimer||(this._loadingTimer=this._async.setTimeout(function(){i.setState({suggestionsLoading:!0})},500)),u=this._currentPromise=r,u.then(function(n){u===i._currentPromise&&(i.setState({suggestionsLoading:!1}),i._updateSuggestions(n,t),i.state.searchValue!==""&&i._suggestionStore.suggestions&&i._suggestionStore.suggestions.length>0&&(i._cachedResults[i.state.searchValue]=n),i._loadingTimer&&(i._async.clearTimeout(i._loadingTimer),i._loadingTimer=undefined))}))},r.prototype._updateSuggestions=function(n,t){(!t||this._inputElement.current&&this._inputElement.current.value===t)&&(this._suggestionStore.updateSuggestions(n,0),this.setState({selectedIdentity:undefined}),this.forceUpdate())},r.prototype._onResolveSuggestions=function(n){var t=this.props.pickerProvider.onFilterIdentities(n,[this._suggestionStore.currentSuggestion&&this._suggestionStore.currentSuggestion.item]);t!==null&&this.updateSuggestionsList(t,n)},r.prototype._updateValue=function(n){this.props.pickerProvider.onEmptyInputFocus&&!n?this.updateSuggestionsList(this.props.pickerProvider.onEmptyInputFocus()):this._cachedResults[n]?this.updateSuggestionsList(this._cachedResults[n],n):this._onResolveSuggestions(n)},r.prototype._renderSuggestions=function(){var n=this.state,r=n.isMostRecentlyUsedVisible,u=n.suggestionsVisible,e=n.suggestionsLoading,o=n.openedIdentityCard;return u||o?i.createElement(l.Callout,{isBeakVisible:!1,target:this._outerElement.current,onDismiss:this.hidePicker,calloutWidth:this.props.calloutWidth},i.createElement(k.Suggestions,{isLoading:e,loadingText:t.VSSResourcesVSSUI.PeoplePickerLoadingText,className:"vss-PeoplePickerDropdown-list",suggestionsItemClassName:f.css("vss-PeoplePickerDropdown-item",this.props.suggestionsItemClassName),ref:this._suggestionsControl,resultsFooter:this._resultsFooter,isMostRecentlyUsedVisible:r,onRenderNoResultFound:this._onRenderNoIdentitiesFound,onRenderSuggestion:this._onRenderSuggestions,onSuggestionClick:this._onSuggestionClick,suggestions:this._suggestionStore.getSuggestions(),isResultsFooterVisible:this.props.isResultsFooterVisible,resultsMaximumNumber:this.props.resultsMaximumNumber,suggestionsContainerAriaLabel:this.props.suggestionsContainerAriaLabel})):null},r.defaultProps={calloutWidth:300},r}(f.BaseComponent);t[n].PeoplePickerDropdown=r}("ComponentsPeoplePickerDropdownPeoplePickerDropdown"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}vt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(at)}("ComponentsPeoplePickerDropdownindex"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}wt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(st)}("DateTimeRangePicker"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}bt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(ct);i(vt);i(ut)}("PeoplePicker")},["Components/DateTimePicker/DateTimePicker.Props","Components/DateTimeRangePicker/DateTimeRangePicker.Props","Components/DateTimePicker/DateTimePicker","Components/DateTimePicker/DateTimePickerFilterBarItem","Components/DateTimePicker/index","DateTimePicker","Components/DateTimeRangePicker/DateTimeRangePicker","Components/DateTimeRangePicker/index","Components/PeoplePicker/PeoplePickerUtils","Components/PeoplePicker/PeoplePicker","Components/PeoplePicker/Suggestions","Components/PeoplePicker/index","Components/PersonaCard/ContactCard","Components/PersonaCard/DefaultCard","Components/PersonaCard/DefaultAbridgedCard","Components/PersonaCard/DefaultSimpleCard","Components/PersonaCard/OrganizationCard","Components/PersonaCard/PersonaCardIdentityUtils","Components/PersonaCard/PersonaCardHeaderElement","Components/PersonaCard/PersonaCardContent","Components/PersonaCard/PersonaCard","Components/PersonaCard/index","Components/PeoplePickerDropdown/PeoplePickerDropdown","Components/PeoplePickerDropdown/index","DateTimeRangePicker","PeoplePicker"]);document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-pickers-content"}}));