"use strict";define("VSSUI",["require","exports","react","OfficeFabric/Utilities","OfficeFabric/Callout","OfficeFabric/Button","OfficeFabric/FocusZone","OfficeFabric/Link","OfficeFabric/Icon","OfficeFabric/ResizeGroup","VSS/Core/Observable","OfficeFabric/ContextualMenu","OfficeFabric/Slider","OfficeFabric/CommandBar","OfficeFabric/Dropdown","OfficeFabric/Fabric","VSS/Platform/Layout"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){var pt,wt,bt,it,rt,ut,kt,dt,k,g,ft,et,ot,st,ht,d,b,nt,ct,lt,tt,at,vt,yt,gt,ni,ti;(function(n){pt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0})})("ComponentsHubHeaderHubHeaderProps"),function(n){wt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0})}("ComponentsHubHeaderHubTextTileProps"),function(n){bt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0})}("ComponentsHubHeaderHubTitleProps"),function(n){it=t[n]={};Object.defineProperty(t,"__esModule",{value:!0})}("ComponentsHubHubProps"),function(n){rt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0})}("ComponentsPivotBarPivotBarProps"),function(n){ut=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var i;(function(n){n[n.Remove=0]="Remove";n[n.Hide=1]="Hide"})(i=t[n].PivotBarItemDeselectionBehavior||(t[n].PivotBarItemDeselectionBehavior={}))}("ComponentsPivotBarPivotBarItemProps"),function(n){kt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0})}("ComponentsPivotBarPivotCommandBarProps"),function(n){dt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0})}("ComponentsHubHeaderHubBreadcrumbProps"),function(n){k=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var u=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.render=function(){return i.createElement("div",__assign({},r.getNativeProps(this.props,r.divProperties),{className:r.css("vss-PivotBarItem",this.props.className)}),this.props.children)},t}(r.BaseComponent);t[n].PivotBarItem=u}("ComponentsPivotBarPivotBarItem"),function(n){g=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var c=4,l=100,a=function(n){function f(t){var i=n.call(this,t)||this;return i._onPositioned=function(){i._pickList.focus()},i._onDismiss=function(){i.closeDropdown()},i._updateDelegate=function(){return i.forceUpdate()},i.state={calloutIsVisible:!1},i}return __extends(f,n),f.prototype.render=function(){var o=this,f=this.props,s=f.getPinElement,e=f.item,h=f.width,c=f.minWidth,l=f.maxWidth,a=f.maxHeight,v=f.pickListClassName,n;return this.state.calloutIsVisible?(n=e.itemPicker,i.createElement(u.Callout,{isBeakVisible:!1,target:s(),onPositioned:this._onPositioned,onDismiss:this._onDismiss},i.createElement(t.PickList.PickList,{className:r.css("picker-dropdown",v),componentRef:function(n){return o._pickList=n},getActions:function(){return n.actions},getListItem:n.getListItem,groups:n.groups,pivots:n.pivots,indicators:n.dropdownIndicators,initiallySelectedItems:n.selectedItem?[n.selectedItem]:undefined,isSearchable:n.isSearchable,items:n.getItems(),searchResultsLoadingText:n.searchResultsLoadingText,noItemsText:n.noItemsText,itemAriaDescription:n.itemAriaDescription,searchNoResultsText:n.searchNoResultsText,searchResultsGroupName:n.searchResultsGroupName,searchTextPlaceholder:n.searchTextPlaceholder,shouldVirtualize:function(n){return(n||[]).length>50},width:h,minWidth:c,maxWidth:l,maxHeight:a,onFocusLost:this._onDismiss,onSearch:n.onSearch,onSelectionChanged:e.onSelectionChanged,onRenderItemText:n.onRenderItemText,onSelectedPivotChanged:n.onSelectedPivotChanged}))):null},f.prototype.componentDidMount=function(){if(this.props.item.isHeaderPickerItem&&this.props.item.itemPicker)this._events.on(this.props.item.itemPicker,t.PickList.PICKER_CHANGE_EVENT,this._updateDelegate)},f.prototype.componentWillUnmount=function(){this.props.item.isHeaderPickerItem&&this.props.item.itemPicker&&this._events.off(this.props.item.itemPicker,t.PickList.PICKER_CHANGE_EVENT,this._updateDelegate)},f.prototype.componentWillReceiveProps=function(n){if(this.props.item.isHeaderPickerItem&&this.props.item.itemPicker&&this.props.item.itemPicker!==n.item.itemPicker){this._events.off(this.props.item.itemPicker,t.PickList.PICKER_CHANGE_EVENT,this._updateDelegate);this._events.on(n.item.itemPicker,t.PickList.PICKER_CHANGE_EVENT,this._updateDelegate)}},f.prototype.openDropdown=function(){this.props.onPickListOpened&&this.props.onPickListOpened();this.setState({calloutIsVisible:!0})},f.prototype.closeDropdown=function(){this.setState({calloutIsVisible:!1});this.props.onPickListClosed&&this.props.onPickListClosed()},f.prototype.toggleDropdown=function(){this.state.calloutIsVisible?this.closeDropdown():this.openDropdown()},f}(r.BaseComponent),v=function(n){function u(t){var u=n.call(this,t)||this;return u._pinElements={},u._linkElements={},u._breadcrumbElements={},u._linkItems=[],u._focusedLinkIndex=-1,u._contributedItems=[],u._onItemClick=function(n){u.setState({pickerItemKey:n.key},function(){u.pickList&&u.pickList.toggleDropdown()})},u.onRenderItem=function(n,t){var c=u.props,b=c.items,f=c.presentationStyles,l=c.shouldUseFocusZone,k=u.state.pickerItemKey,tt=b[b.length-1],a=__assign({},n),p,g,h;delete a.onClick;delete a.href;var v=u._getIcon(n.leftIconProps),e=t(a),nt=e.props&&e.props.className,y=f&1?"vss-Breadcrumb--itemText-small":"vss-Breadcrumb--itemText vss-HubBreadcrumb--itemText";y=r.css(y,"ellipsis-text",{"vss-Breadcrumb--light":!!(f&2)});p=__assign({},e.props,{className:r.css(nt,y),style:e.props.style?__assign({},e.props.style):{}});u.props.maxItemWidth&&(p.style.maxWidth=u.props.maxItemWidth);var w=i.cloneElement(e,p),d=l?0:-2,s=r.getId("vss-breadcrumb-item-described-by");return n.isHeaderPickerItem&&n.itemPicker?(g=!n.nonInteractive&&!!(f&8),h=void 0,n.nonInteractive||(h=u._onItemClick.bind(u,n)),i.createElement("div",{ref:function(t){t&&(u._pinElements[n.key]=t,u._breadcrumbElements[n.key]=t)},className:r.css("vss-Breadcrumb--item vss-HubBreadcrumb--item",{"no-click":!h,"vss-Breadcrumb--item-min-height":!!(f&16)})},i.createElement(o.Link,{key:"BreadcrumbItem$"+n.key,componentRef:function(t){t&&(u._linkElements[n.key]=t)},onClick:h,href:n.href,"aria-haspopup":!0,"aria-expanded":u.state.pickerIsOpen,"aria-label":n.ariaLabel,"aria-describedby":s,tabIndex:d,onFocus:l?undefined:u._onLinkFocus.bind(u,n.key)},i.createElement("div",{className:"vss-Breadcrumb--itemContainer vss-HubBreadcrumb--itemContainer"},v,w,g&&u._getBreadcrumbIcon(n)),i.createElement("div",{id:s,className:"vss-Breadcrumb--hiddenElement"},n.ariaDescription)),k&&k===n.key&&u._renderPickerDropdown(n),u._getIndicators(n))):n.onClick||n.href?i.createElement("div",{ref:function(t){t&&(u._breadcrumbElements[n.key]=t)},className:r.css("vss-Breadcrumb--item vss-HubBreadcrumb--item",{"vss-Breadcrumb--item-min-height":!!(f&16)})},i.createElement(o.Link,{componentRef:function(t){t&&(u._linkElements[n.key]=t)},key:"BreadcrumbItem$"+n.key,onClick:n.onClick,href:n.href,"aria-label":n.ariaLabel,"aria-describedby":s,tabIndex:d,onFocus:l?undefined:u._onLinkFocus.bind(u,n.key)},i.createElement("div",{className:"vss-Breadcrumb--itemContainer"},v,w),i.createElement("div",{id:s,className:"vss-Breadcrumb--hiddenElement"},n.ariaDescription))):i.createElement("div",{ref:function(t){t&&(u._breadcrumbElements[n.key]=t)},className:r.css("vss-Breadcrumb--item vss-HubBreadcrumb--item",{"vss-Breadcrumb--item-min-height":!!(f&16)}),"aria-label":n.ariaLabel},v,w)},u._onLinkFocus=function(n){u._focusedLinkIndex<0&&(u._focusedLinkIndex=r.findIndex(u._linkItems,function(t){return t.key===n}))},u._getCustomDivider=function(n){var t=n.item,f=u.props.presentationStyles;return f!==undefined&&!(f&8)?i.createElement("div",{ref:function(n){n&&(u._breadcrumbElements["BreadcrumbItemDivider$"+t.key]=n)},key:"BreadcrumbItemDivider$"+t.key,className:r.css("vss-Breadcrumb--divider vss-HubBreadcrumb--divider",{"vss-Breadcrumb--divider-extra-padding":!!(f&4),"vss-Breadcrumb--divider-light":!!(f&2)})},u._getBreadcrumbIcon(t)):i.createElement("div",{key:"BreadcrumbItemDivider$"+t.key,className:"vss-Breadcrumb--divider-container",ref:function(n){n&&(u._pinElements[t.key]=n,u._breadcrumbElements["BreadcrumbItemDivider$"+t.key]=n)}},u._getDividerButtonOrIcon(t))},u._onKeyDown=function(n){n.which===37&&u._focusedLinkIndex>0&&(u._linkElements[u._linkItems[--u._focusedLinkIndex].key].focus(),n.preventDefault());n.which===39&&u._focusedLinkIndex>=0&&u._focusedLinkIndex<u._linkItems.length-1&&(u._linkElements[u._linkItems[++u._focusedLinkIndex].key].focus(),n.preventDefault());n.which===40&&u._onItemClick(u._linkItems[u._focusedLinkIndex])},u._onBlur=function(){u.state.pickerIsOpen||(u._focusedLinkIndex=-1)},u._itemsChanged=function(n,t){var i,r;u._isMounted&&(i={},u._contributedItems.forEach(function(n){t&&t.indexOf(n.key)!==-1||(i[n.key]=n)}),n.forEach(function(n){(!i[n.key]||(i[n.key].priority||0)<=(n.priority||0))&&(i[n.key]=n)}),r=[],Object.keys(i).forEach(function(n){r.push(i[n])}),u._contributedItems=r)},u._dataDidRender=function(n){var i=u.props.dataDidRender,t;i&&(t=0,Object.keys(u._breadcrumbElements).map(function(n){t+=u._breadcrumbElements[n].clientWidth}),i(n,t))},u.state={pickerIsOpen:!1,pickerItemKey:null,loadingTimeoutId:u._setLoadingTimeout(),displayItems:t.items.slice()},u._updateLinkItems(),u}return __extends(u,n),u.prototype.componentWillReceiveProps=function(n){n.items!==this.props.items&&(this._updateLinkItems(),this.setState({displayItems:this._arrangeItems(n.items.concat(this._contributedItems))}));n.providers!==this.props.providers&&(this._contributedItems=[],this.setState({loadingTimeoutId:this._setLoadingTimeout(),displayItems:n.items.slice()}),this._loadItemsFromProviders())},u.prototype.componentDidMount=function(){this._isMounted=!0;this._loadItemsFromProviders()},u.prototype._updateLinkItems=function(){this._linkItems=this.state.displayItems.filter(function(n){return n.isHeaderPickerItem&&n.itemPicker||n.href||n.onClick})},u.prototype._setLoadingTimeout=function(){var n=this;return this._async.setTimeout(function(){n.setState({loadingTimeoutId:undefined})},l)},u.prototype._loadItemsFromProviders=function(){var n=this,t;if(this.props.providers&&this.props.providers.length>0){var i=this.props.providers.map(function(n,t){return t}),r=function(t){var r=u.props.providers[t];r.loadItems(function(t,i){n._itemsChanged(t,i)},function(){if(n.state.loadingTimeoutId){var r=i.indexOf(t);r>-1&&(i.splice(r,1),n._isMounted&&i.length===0&&(n.props.onItemsLoaded(),n.setState({loadingTimeoutId:undefined,displayItems:n._arrangeItems(n.props.items.concat(n._contributedItems))}),n._updateLinkItems()))}else n._isMounted&&(n.props.onItemsLoaded(),n.setState({displayItems:n._arrangeItems(n.props.items.concat(n._contributedItems))}),n._updateLinkItems())})},u=this;for(t=0;t<this.props.providers.length;t++)r(t)}else this.setState({loadingTimeoutId:undefined})},u.prototype.componentWillUnmount=function(){this._isMounted=!1},u.prototype._getIcon=function(n){return n?i.createElement(t.VssIcon.VssIcon,__assign({},n,{className:r.css("vss-Breadcrumb--item-leftIcon vss-HubBreadcrumb--item-leftIcon",n.className)})):null},u.prototype._renderPickerDropdown=function(n){var r=this,t=this.props,o=t.pickListClassName,s=t.pickListWidth,h=t.pickListMinWidth,u=t.pickListMaxWidth,c=t.pickListMaxHeight,f=n.pickerWidth||s||h||this._pinElements[n.key]&&this._pinElements[n.key].clientWidth,e=!u,l=n.pickListClassName||o;return i.createElement(a,{ref:function(n){r.pickList=n},item:n,getPinElement:function(){return r._pinElements[n.key]},width:e&&f,minWidth:!e&&f,maxWidth:u,maxHeight:c,pickListClassName:l,onPickListClosed:function(){return r.setState({pickerIsOpen:!1})},onPickListOpened:function(){return r.setState({pickerIsOpen:!0})}})},u.prototype._getBreadcrumbIcon=function(n){var u=this.state.pickerItemKey,f=this.props.dividerType;return f===1?i.createElement("div",{className:"vss-Breadcrumb--forward-slash"},"/"):i.createElement(t.VssIcon.VssIcon,{iconName:n.isHeaderPickerItem||n.key===u&&this.state.pickerIsOpen?"ChevronDown":"ChevronRight",iconType:0,key:"RightIcon$"+n.key,className:r.css("vss-Breadcrumb--item-dropdown vss-HubBreadcrumb--item-dropdown",{"vss-Breadcrumb--item-dropdown-with-picker vss-HubBreadcrumb--item-dropdown-with-picker":n.isHeaderPickerItem})})},u.prototype._getDividerButtonOrIcon=function(n){var t=this.state.pickerItemKey,u=this._getBreadcrumbIcon(n);return!n.itemPicker?u:i.createElement(o.Link,{onClick:this._onItemClick.bind(this,n),"aria-expanded":this.state.pickerIsOpen,className:r.css("vss-Breadcrumb--divider vss-Breadcrumb--divider-link")},u,t&&t===n.key&&n.itemPicker&&this._renderPickerDropdown(n))},u.prototype._getIndicators=function(n){var r=n.isHeaderPickerItem&&n.itemPicker;return r&&r.selectedItem&&r.selectedItemIndicators&&r.selectedItemIndicators.length?i.createElement(t.ItemIndicator.ItemIndicatorSet,{indicators:r.selectedItemIndicators.map(function(n){return n.getItemIndicator(r.selectedItem)})}):null},u.prototype._arrangeItems=function(n){var i=n.some(function(n){return n.rank>=0}),t=n.slice();return i&&t.sort(function(n,t){var i=n.rank||Number.MAX_VALUE,r=t.rank||Number.MAX_VALUE;return i-r}),t},u.prototype.render=function(){var o=this,n=this.props,s=n.ariaLabel,h=n.className,f=n.maxDisplayedItems,l=f===void 0?c:f,e=n.onReduceData,a=n.overflowIndex,u=n.shouldUseFocusZone,v=n.dataDidRender;return i.createElement("div",{className:r.css("vss-Breadcrumb--container vss-HubBreadcrumb--container",h),onKeyDown:u?undefined:this._onKeyDown,onBlur:u?undefined:this._onBlur,ref:function(n){n&&(o._breadcrumbContainer=n)}},i.createElement(w,{onReduceData:e?e:function(){return undefined},dataDidRender:this._dataDidRender,items:this.state.displayItems,className:r.css("vss-Breadcrumb vss-HubBreadcrumb"),onRenderItem:this.onRenderItem,ariaLabel:s||t.VSSResourcesVSSUI.BreadcrumbAriaLabel,maxDisplayedItems:l,overflowIndex:a,dividerAs:this._getCustomDivider,shouldUseFocusZone:u}))},u.defaultProps={items:[],onItemsLoaded:function(){}},u}(r.BaseComponent);t[n].VssBreadcrumb=v;var y="overflow",p=function(){return null},w=function(n){function u(u){var o=n.call(this,u)||this;return o._focusZone=r.createRef(),o._onReduceData=function(n){var t=n.renderedItems,i=n.renderedOverflowItems,r=n.props.overflowIndex,u=t[r];return t=t.slice(),t.splice(r,1),i=i.concat([u]),u!==undefined?__assign({},n,{renderedItems:t,renderedOverflowItems:i}):void 0},o._onRenderBreadcrumb=function(n){var t=n.props,g=t.ariaLabel,l=t.dividerAs,a=l===void 0?s.Icon:l,v=t.onRenderItem,nt=v===void 0?o._onRenderItem:v,tt=t.overflowAriaLabel,c=t.overflowIndex,it=t.className,rt=t.shouldUseFocusZone,u=n.renderedOverflowItems,w=n.renderedItems,ut=u.map(function(n){return{name:n.text,key:n.key,onClick:n.onClick?o._onBreadcrumbClicked.bind(o,n):null,href:n.href}}),b=w.length-1,k=u&&u.length!==0,d=w.map(function(n,t){return i.createElement("li",{className:"internal-breadcrumb--listItem",key:n.key||String(t)},nt(n,o._onRenderItem),(t!==b||k&&t===c-1)&&i.createElement(a,{className:"internal-breadcrumb--chevron",iconName:r.getRTL()?"ChevronLeft":"ChevronRight",item:n}))}),h;return k&&d.splice(c,0,i.createElement("li",{className:"internal-breadcrumb--overflow",key:y},i.createElement(f.IconButton,{className:"internal-breadcrumb--overflowButton",iconProps:{iconName:"More"},role:"button","aria-haspopup":"true",ariaLabel:tt,onRenderMenuIcon:p,menuProps:{items:ut,directionalHint:4}}),c!==b+1&&i.createElement(a,{className:"internal-breadcrumb--chevron",iconName:r.getRTL()?"ChevronLeft":"ChevronRight",item:u[u.length-1]}))),h=i.createElement("ol",{className:"internal-breadcrumb--list"},d),rt&&(h=i.createElement(e.FocusZone,{componentRef:o._focusZone,direction:e.FocusZoneDirection.horizontal},h)),i.createElement("div",{className:it,role:"navigation","aria-label":g},h)},o._onRenderItem=function(n){return i.createElement("span",{className:"internal-breadcrumb--item"},i.createElement(t.Tooltip.TooltipHost,{content:n.text,overflowMode:t.Tooltip.TooltipOverflowMode.Parent},n.text))},o._onBreadcrumbClicked=function(n,t){if(n.onClick)n.onClick(t,n)},o._validateProps(u),o}return __extends(u,n),u.prototype.render=function(){var n=this.props,r=n.onReduceData,u=r===void 0?this._onReduceData:r,f=n.dataDidRender,e=n.overflowIndex,o=n.maxDisplayedItems,s=n.items,t=s.slice(),c=t.splice(e,t.length-o),l={props:this.props,renderedItems:t,renderedOverflowItems:c};return i.createElement(h.ResizeGroup,{onRenderData:this._onRenderBreadcrumb,onReduceData:u,dataDidRender:f,data:l,className:"vss-Breadcrumb--resizeGroup"})},u.prototype.componentWillReceiveProps=function(n){this._validateProps(n)},u.prototype._validateProps=function(n){var i=n.maxDisplayedItems,t=n.overflowIndex,r=n.items;if(t<0||i>1&&t>i-1||r.length>0&&t>r.length-1)throw new Error("Breadcrumb: overflowIndex out of range");},u.defaultProps={items:[],maxDisplayedItems:999,overflowIndex:0},u}(r.BaseComponent)}("ComponentsVssBreadcrumbVssBreadcrumb"),function(n){ft=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var u=function(n){function u(t){return n.call(this,t)||this}return __extends(u,n),u.prototype.getIcon=function(){if(this.props.iconProps){var n=__assign({},this.props.iconProps,{className:r.css(this.props.iconProps.className,"vss-HubTitle-titleIcon")});return i.createElement(t.VssIcon.VssIcon,__assign({},n))}return null},u.prototype.getTitleText=function(){return i.createElement("div",{className:"vss-HubTitle--titleText"},this.props.titleText)},u.prototype.render=function(){var n=r.css("vss-HubTitle");return i.createElement("h1",{className:n,onClick:this.props.onClick},this.getIcon(),this.getTitleText())},u}(r.BaseComponent);t[n].HubTitle=u}("ComponentsHubHeaderHubTitle"),function(n){et=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var u="340px",f=function(n){function t(t){var i=n.call(this,t)||this;return i.dataDidRender=function(n,t){var f=i.props,r=f.breadcrumbProps,e=f.breadcrumbDataDidRender,o=i.state.canBreadcrumbShrink,u;r&&r.onReduceData&&(u=r.onReduceData(n),u===undefined&&o?i.setState({canBreadcrumbShrink:!1}):u===undefined||o||i.setState({canBreadcrumbShrink:!0}));e&&e(n,t)},i.onSelectionChanged=function(n){var t=i.state.headerItemPicker,r=!1;return t&&t.onSelectedItemChanged&&(r=t.onSelectedItemChanged(n.selectedItems&&n.selectedItems.length>0?n.selectedItems[0]:null)===!0,i._hubBreadcrumb&&i._hubBreadcrumb.pickList&&i._hubBreadcrumb.pickList.closeDropdown()),r},i.onHeaderPickerChanged=function(n){i.setState({headerItemPicker:n})},i.state={headerItemPicker:c.ObservableLike.getValue(i.props.headerItemPicker),canBreadcrumbShrink:!0},i}return __extends(t,n),t.prototype.componentWillMount=function(){c.ObservableLike.subscribe(this.props.headerItemPicker,this.onHeaderPickerChanged)},t.prototype.componentWillUnmount=function(){c.ObservableLike.unsubscribe(this.props.headerItemPicker,this.onHeaderPickerChanged)},t.prototype.componentWillReceiveProps=function(n){this.props.headerItemPicker!==n.headerItemPicker&&(this.setState({headerItemPicker:c.ObservableLike.getValue(n.headerItemPicker)}),c.ObservableLike.unsubscribe(this.props.headerItemPicker,this.onHeaderPickerChanged),c.ObservableLike.subscribe(n.headerItemPicker,this.onHeaderPickerChanged))},t.prototype.getTitle=function(){return this.props.breadcrumbItems&&this.props.breadcrumbItems.length>0||this.props.headerItemPicker?this.getBreadcrumb():this.props.title?i.createElement(ft.HubTitle,{titleText:this.props.title,iconProps:this.props.iconProps}):(console.log("Must use title or breadcrumb items + headerItemPicker"),null)},t.prototype.getBreadcrumb=function(){var l=this,r=this.props.breadcrumbItems?this.props.breadcrumbItems.slice():[],t=this.props,s=t.maxBreadcrumbItemWidth,a=t.collapseBreadcrumb,h=t.iconProps,v=t.pickListClassName,y=t.pickListMinWidth,p=t.pickListMaxWidth,w=t.pickListMaxHeight,f=t.title,b=t.hubBreadcrumbAriaLabel,e=t.breadcrumbProps,n=this.state.headerItemPicker,o;if(n&&n.getListItem){var c=n.selectedItem&&n.getListItem(n.selectedItem),k=n.selectedItem&&n.getTitleTextForItem?n.getTitleTextForItem(n.selectedItem):c&&c.name,o={key:"title-item",text:f?f:k,leftIconProps:h,onSelectionChanged:this.onSelectionChanged,itemPicker:n,ariaLabel:n.ariaLabel,isHeaderPickerItem:!0};r.push(o)}else f&&(o={key:"title-item",text:f,leftIconProps:h},r.push(o));return a&&(r=r.slice(r.length-1),e&&(e.overflowIndex=0)),i.createElement(g.VssBreadcrumb,__assign({},e,{dataDidRender:this.dataDidRender,ref:function(n){l._hubBreadcrumb=n},items:r,maxItemWidth:typeof s=="string"?s:u,pickListClassName:v,pickListMinWidth:y,pickListMaxWidth:p,pickListMaxHeight:w,ariaLabel:b,shouldUseFocusZone:!0,presentationStyles:24}))},t.prototype.render=function(){return i.createElement("div",{className:r.css("vss-HubHeader",{"vss-HubHeader-no-shrink":!this.state.canBreadcrumbShrink})},this.getTitle(),this.props.children)},t}(r.BaseComponent);t[n].HubHeader=f}("ComponentsHubHeaderHubHeader"),function(n){ot=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var u=function(n){function u(){return n!==null&&n.apply(this,arguments)||this}return __extends(u,n),u.prototype.render=function(){var n=this.props,u=n.text,f=n.secondaryText,e=r.css("vss-HubTextTile vss-HubTile");return i.createElement("div",{className:e},i.createElement(t.Dynamic.DynamicText,{text:u,className:r.css("vss-HubTextTile--primaryText",{"vss-HubTextTile--primaryTextOnly":!this.props.secondaryText})}),i.createElement(t.Dynamic.DynamicText,{text:f,className:"vss-HubTextTile--secondaryText"}))},u}(r.BaseComponent);t[n].HubTextTile=u}("ComponentsHubHeaderHubTextTile"),function(n){st=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var u=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.render=function(){var n=r.css("vss-HubTileRegion"),t=i.Children.toArray(this.props.children),u=i.Children.map(t||[],function(n){var u=n,t=u.props,r=t&&t.className,f=__assign({},t,{className:r?r+" vss-HubTile":"vss-HubTile"});return i.cloneElement(n,f)});return i.createElement("div",{className:n},u)},t}(r.BaseComponent);t[n].HubTileRegion=u}("ComponentsHubHeaderHubTileRegion"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}ht=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(et);i(ot);i(st)}("ComponentsHubHeaderindex"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}d=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(ht)}("HubHeader"),function(n){function rt(n,t,i){return w(n,u.Bar,t,i)}function p(n){var t=n.iconProps.iconType,r=t===s.IconType.default||t===s.IconType.Default?0:3,i={key:n.key,name:n.name,href:n.href,title:n.title,iconProps:__assign({},n.iconProps,{iconType:r}),onClick:n.onClick,disabled:n.disabled,important:n.important,target:n.target,separator:n.itemType===l.ContextualMenuItemType.Divider};return n.items&&(i.children=n.items.map(p)),i}function w(n,t,i,u){for(var s,c,e=[],o=0,h=n||[];o<h.length;o++)s=h[o],c=f.getInstance(t,s.actionType||0),e=e.concat(c.getVisualization(s,i,u));return e.forEach(function(n){n.className=r.css(n.className,y)}),e}function o(n,t,i,r,u){if(n)n.setViewOption(t,i);else if(typeof u.onClick=="function")u.onClick(r,u)}var y,u,f,h,c,k,d,nt,v,it;b=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});y="vss-PivotBar--commandBar-item",function(n){n[n.Bar=0]="Bar";n[n.Overflow=1]="Overflow"}(u||(u={}));t[n].mapActionsToItems=rt;t[n].mapItemToActions=p,function(n){function i(n,t){return n+":"+t}function r(n,r,u){var f=i(n,r);t[f]=u}function u(n,r){var f=i(n,r),u=t[f];if(!u)throw new Error("No visualization found for area "+n+" and action type "+r);return new u}var t={};n.register=r;n.getInstance=u}(f||(f={}));h=function(){function n(){}return n.prototype.getVisualization=function(n,i){var f={key:n.key,name:n.name||"",ariaLabel:n.ariaLabel,className:n.actionProps&&n.actionProps.className,title:n.title,onClick:n.onClick,href:n.href,disabled:n.disabled,target:n.target,itemType:n.separator?l.ContextualMenuItemType.Divider:l.ContextualMenuItemType.Normal},e,o;return n.iconProps&&(e=__assign({},n.iconProps),e.className=r.css(e.className,"vss-PivotBar--commandBar-icon"),f.iconProps=t.VssIcon.VssIcon.getIconProps(e)),o=n.actionProps,o&&o.showChevron&&(f.subMenuProps={items:[]}),Array.isArray(n.children)&&(f.subMenuProps={className:"vss-PivotBar--commandBar-overflow",items:w(n.children,u.Overflow,i)}),[f]},n}();f.register(u.Bar,0,h);f.register(u.Overflow,0,h);c=function(){function n(){}return n.prototype.getVisualization=function(){return[]},n.prototype.getActionProps=function(n){return n.actionProps||(n.actionProps={on:!1}),n.actionProps},n.prototype.isOn=function(n,t){return t?t.getViewOption(n)===!0:!1},n}();k=function(n){function u(){return n!==null&&n.apply(this,arguments)||this}return __extends(u,n),u.prototype.getVisualization=function(n,u,f){var p=this,s=this.getActionProps(n),c=this.isOn(n.key,u),a=c?t.VSSResourcesVSSUI.PivotBarViewActionOnText:t.VSSResourcesVSSUI.PivotBarViewActionOffText,v,h,e,l,y;return s.showText!==!1&&(v=a),h=c?s.onAriaLabel:s.offAriaLabel,e=n.title,h===undefined&&(h=e!==undefined?e:a),e===undefined&&(e=h!==undefined?h:a),l=c?s.onIconProps:s.offIconProps,l||(l=n.iconProps),y={key:n.key,onRender:function(a,y,w,b){var k=i.createElement(t.Button.Button,{subtle:!0,className:r.css("vss-PivotBar--commandBar-toggle","pivotBar-toggle-button",s.className),text:v,ariaSetSize:b,ariaPosInSet:w,ariaChecked:c,disabled:n.disabled,iconProps:t.VssIcon.VssIcon.getIconProps(l),onClick:function(t){o(u,a.key,!p.isOn(a.key,u),t,n);f&&f()},ariaLabel:h});return e?i.createElement(t.Tooltip.TooltipHost,{content:e,hostClassName:"vss-PivotBar--commandBar-toggle-host"},k):k}},[y]},u}(c);f.register(u.Bar,1,k);d=function(n){function u(){return n!==null&&n.apply(this,arguments)||this}return __extends(u,n),u.prototype.getVisualization=function(n,u){var a=this,f=this.getActionProps(n),e=[],s=f.onText||t.VSSResourcesVSSUI.PivotBarViewActionOnText,h=f.offText||t.VSSResourcesVSSUI.PivotBarViewActionOffText,v=f.onAriaLabel||(n.ariaLabel?n.ariaLabel+" "+s:null),y=f.offAriaLabel||(n.ariaLabel?n.ariaLabel+" "+h:null),c={key:n.key,onRender:function(e){var c=i.createElement(t.Toggle.Toggle,{key:n.key+"-toggle",className:r.css("vss-PivotBar--commandBar-toggle",f.className),checked:a.isOn(n.key,u),disabled:n.disabled,onText:s,offText:h,onAriaLabel:v,offAriaLabel:y,onChange:function(t,i){o(u,e.key,i,null,n)}});return n.title?i.createElement(t.Tooltip.TooltipHost,{content:n.title,key:n.key+"-toggle-tooltip"},c):c}};return n.name?e.push({key:n.key,sectionProps:{items:[c],title:n.name,key:n.key+"-section"},itemType:l.ContextualMenuItemType.Section}):e.push(c),e},u}(c);f.register(u.Overflow,1,d);var g=function(){function n(){}return n.prototype.getVisualization=function(){return[]},n.prototype.getActionProps=function(n){if(!n.actionProps)throw new Error("Options must be specified for the choice group "+n.key);return n.actionProps},n.prototype.getSelectedOption=function(n,t,i){var r=(i?i.getViewOption(n):null)||t.defaultSelectedKey;return t.options.filter(function(n){return n.key===r})[0]||t.options[0]},n}(),ut=function(n){function u(t){var i=n.call(this,t)||this;return i._onCycleClick=function(n){i._changeOption(n,i._getNextOptionIndex(i.props.options))},i._onOptionClick=function(n,t){n.stopPropagation();i._changeOption(n,r.findIndex(i.props.options,function(n){return n.key===t.key}))},i._onDropClick=function(n){i.setState({showDropdown:!0,dropTarget:n.currentTarget})},i._onDismiss=function(){i.setState({showDropdown:!1})},i.state={showDropdown:!1,selectedOptionIndex:i._getSelectedOptionIndex(i.props.options,i.props.defaultSelectedKey)},i}return __extends(u,n),u.prototype.componentWillReceiveProps=function(n){this.setState({showDropdown:!1,selectedOptionIndex:this._getSelectedOptionIndex(n.options,n.defaultSelectedKey)})},u.prototype.render=function(){var s=this,n=this.props,h=n.dropButtonClassName,c=n.ariaLabel,a=n.dropButtonAriaLabel,f=n.options,u=this.state,v=u.selectedOptionIndex,e=u.showDropdown,y=u.dropTarget,o=f[v];return i.createElement("div",{className:"vss-ChoiceGroupButton"},i.createElement(t.Button.Button,{subtle:!0,ariaLabel:c||a||t.VSSResourcesVSSUI.PivotBarMoreOptionsAriaLabel,role:"listbox","aria-expanded":e,"aria-haspopup":!0,className:r.css("vss-ChoiceGroupButton--drop",h),text:o.text,onClick:this._onDropClick},t.Icon.FabricIcon({iconName:"ChevronDown",className:"pivotBar-choice-group-icon"})),e?i.createElement(l.ContextualMenu,{shouldFocusOnMount:!0,isBeakVisible:!1,target:y,onDismiss:this._onDismiss,directionalHint:r.getRTL()?4:6,items:f.map(function(n){return{key:n.key,name:n.text,ariaLabel:n.ariaLabel,isChecked:n===o,canCheck:!0,onClick:s._onOptionClick}})}):null)},u.prototype._getSelectedOptionIndex=function(n,t){t===void 0&&(t=null);var i=t?r.findIndex(n,function(n){return n.key===t}):-1;return Math.max(i,0)},u.prototype._getNextOptionIndex=function(n){var t=this.state.selectedOptionIndex+1;return t===n.length&&(t=0),t},u.prototype._changeOption=function(n,t){var i=this.props,r=i.onChange,u=i.options;this.setState({selectedOptionIndex:t});r&&r(n,u[t])},u}(r.BaseComponent),ft=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.getVisualization=function(n,t){var u=this.getActionProps(n),f=this.getSelectedOption(n.key,u,t);return[{key:n.key,className:r.css("vss-PivotBar--commandBar-barChoiceGroup",u.className),onRender:function(r,e,s,h){return i.createElement(ut,{ariaLabel:r.ariaLabel,"aria-setsize":h,"aria-posinset":s,dropButtonAriaLabel:u.dropButtonAriaLabel,defaultSelectedKey:f.key,options:u.options,dropButtonClassName:"vss-PivotBar--commandBar-barChoiceDrop",onChange:function(i,r){o(t,n.key,r.key,i,n)}})}}]},t}(g);f.register(u.Bar,2,ft);nt=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.getVisualization=function(n,t){var e=this.getActionProps(n),s=this.getSelectedOption(n.key,e,t),u=[],r,f,i;for(n.name&&u.push({key:n.key+"-header",name:n.name,itemType:l.ContextualMenuItemType.Header}),r=0,f=e.options;r<f.length;r++)i=f[r],u.push({key:i.key,name:i.text,ariaLabel:i.ariaLabel,isChecked:i===s,canCheck:!0,title:i.title,onClick:function(i,r){o(t,n.key,r.key,i,n);t&&i&&i.preventDefault()}});return u},t}(g);f.register(u.Overflow,2,nt);v=function(){function n(){}return n.prototype.getActionProps=function(n){var t=n.actionProps;if(!t||!t.text)throw new Error("Text must be specified through actionProps for "+n.key);return t},n.prototype.getVisualization=function(n){var r=this.getActionProps(n);return[{key:n.key,className:"vss-PivotBar--commandBar-text",onRender:function(){var u=i.createElement(t.Dynamic.DynamicText,{className:r.className,key:n.key+"-text",text:r.text});return n.title?i.createElement(t.Tooltip.TooltipHost,{content:n.title,key:n.key+"-tooltip"},u):u}}]},n}();f.register(u.Bar,3,v);f.register(u.Overflow,3,v);var et=function(n){function r(){var t=n!==null&&n.apply(this,arguments)||this;return t._onOuterKeyDown=function(n){n.which===13&&t._innerFocus&&(t._innerFocus.focus(),n.preventDefault(),n.stopPropagation())},t._onInnerKeyDown=function(n){n.which===27&&t._outerFocus&&(t._outerFocus.focus(),n.preventDefault(),n.stopPropagation())},t}return __extends(r,n),r.prototype.render=function(){var n=this;return i.createElement(t.Tooltip.TooltipHost,{content:this.props.title},i.createElement("div",{ref:function(t){return n._outerFocus=t},onKeyDown:this._onOuterKeyDown,"data-is-focusable":!0,className:"vss-PivotBarSlider"},i.createElement(e.FocusZone,{componentRef:function(t){return n._innerFocus=t},onKeyDown:this._onInnerKeyDown,direction:e.FocusZoneDirection.horizontal},i.createElement(a.Slider,__assign({},this.props)))))},r}(r.BaseComponent),tt=function(){function n(){}return n.prototype.getActionProps=function(n){return n.actionProps||(n.actionProps={}),n.actionProps},n.prototype.getValue=function(n,t){return t?t.getViewOption(n)||0:0},Object.defineProperty(n.prototype,"useLabel",{get:function(){return!0},enumerable:!0,configurable:!0}),n.prototype.getVisualization=function(n,t){var f=this,u=this.getActionProps(n),e=this.getValue(n.key,t);return[{key:n.key,className:"vss-PivotBar--commandBar-barSlider",onRender:function(s,h,c,l){return i.createElement(et,{key:n.key+"-slider",className:r.css("vss-PivotBar--commandBar-slider",u.className),label:f.useLabel?n.name:undefined,value:e,min:u.minValue,max:u.maxValue,step:u.step,ariaLabel:n.ariaLabel,"aria-setsize":l,"aria-posinset":c,title:n.title,showValue:!1,disabled:n.disabled,onChange:function(i){o(t,n.key,i,null,n)}})}}]},n}(),ot=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t}(tt);f.register(u.Bar,4,ot);it=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"useLabel",{get:function(){return!1},enumerable:!0,configurable:!0}),t.prototype.getVisualization=function(t,i){var r=n.prototype.getVisualization.call(this,t,i);return t.name&&r.unshift({key:t.key+"-header",name:t.name,itemType:l.ContextualMenuItemType.Header}),r},t}(tt);f.register(u.Overflow,4,it)}("ComponentsPivotBarPivotBarAction"),function(n){nt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var u=function(n){function u(t){var i=n.call(this,t)||this;return i._onCommandsChanged=function(){i.setState({commands:i._getCommands(i.props)})},i._onViewActionsChanged=function(){i.setState({viewActions:i._getViewActions(i.props)})},i._forceUpdate=function(){i.forceUpdate()},i.state={commands:i._getCommands(i.props),viewActions:i._getViewActions(i.props)},i}return __extends(u,n),u.prototype.componentWillReceiveProps=function(n){var i=!1;t.UtilitiesInternal.arrayEquals(this.props.commands,n.commands)||(this._unsubscribeItems(this.props.commands,this._onCommandsChanged),this._subscribeItems(n.commands,this._onCommandsChanged),i=!0);t.UtilitiesInternal.arrayEquals(this.props.viewActions,n.viewActions)||(this._unsubscribeItems(this.props.viewActions,this._onViewActionsChanged),this._subscribeItems(n.viewActions,this._onViewActionsChanged),i=!0);(this.props.showFilterAction!==n.showFilterAction||this.props.filterBar!==n.filterBar)&&(i=!0);i&&this.setState({commands:this._getCommands(n),viewActions:this._getViewActions(n)})},u.prototype.componentDidMount=function(){this._subscribeItems(this.props.commands,this._onCommandsChanged);this._subscribeItems(this.props.viewActions,this._onViewActionsChanged)},u.prototype.componentWillUnmount=function(){this._unsubscribeItems(this.props.commands,this._onCommandsChanged);this._unsubscribeItems(this.props.viewActions,this._onViewActionsChanged)},u.prototype._subscribeItems=function(n,t){(n||[]).forEach(function(n){return n.subscribe(t)})},u.prototype._unsubscribeItems=function(n,t){(n||[]).forEach(function(n){return n.unsubscribe(t)})},u.prototype.render=function(){var d=this,n=this.props,g=n.className,c=n.viewOptions,l=n.filterBar,y=n.hasAppliedFilter,nt=n.showFilterAction,tt=n.onShowFilterBarClicked,it=n.showFilterBarViewOptionKey,rt=n.prependSeparator,ut=n.role,ft=n.ariaLabel,p=this.state,e=p.commands,f=p.viewActions,o=[],s=[],w,k,u,a,h;return(e&&e.length&&(w=e.filter(function(n){return n.important}),k=e.filter(function(n){return!n.important}),o=b.mapActionsToItems(w,c,this._forceUpdate),s=b.mapActionsToItems(k,c,this._forceUpdate)),u=[],f&&f.length&&(u.push.apply(u,f.filter(function(n){return n.important&&n.viewActionRenderArea===1})),a=f.filter(function(n){return!n.important}),a.length&&u.push({key:"viewOptions",title:t.VSSResourcesVSSUI.PivotBarViewOptionsText,ariaLabel:t.VSSResourcesVSSUI.PivotBarViewOptionsText,actionProps:{className:"vss-PivotBar--viewOptionsMenu"},important:!0,actionType:0,iconProps:{iconName:"Equalizer"},children:a}),u.push.apply(u,f.filter(function(n){return n.important&&n.viewActionRenderArea!==1&&n.viewActionRenderArea!==2}))),nt&&!l&&u.push({key:it,important:!0,actionType:1,actionProps:{showText:!1,onAriaLabel:t.VSSResourcesVSSUI.PivotBarFilterActionTextHide,offAriaLabel:t.VSSResourcesVSSUI.PivotBarFilterActionTextShow,onIconProps:{iconName:y?"FilterSolid":"Filter"},offIconProps:{iconName:y?"FilterSolid":"Filter"}},onClick:tt}),f&&f.length&&u.push.apply(u,f.filter(function(n){return n.important&&n.viewActionRenderArea===2})),h=b.mapActionsToItems(u,c,this._forceUpdate),l&&h.unshift({className:"vss-PivotBar--inlineFilterBar",key:"filterBar",onRender:function(){return l}}),o.length||s.length||h.length)?i.createElement("div",{className:"vss-PivotBar--right",role:ut,"aria-label":ft},!!(rt&&(o.length||s.length))&&i.createElement("div",{className:"vss-PivotBar--separator"}),i.createElement(v.CommandBar,{componentRef:function(n){d._commandBar=n},className:r.css(g),items:o,overflowItems:s,farItems:h,elipisisAriaLabel:t.VSSResourcesVSSUI.PivotBarMoreCommandsAriaLabel})):null},u.prototype.focus=function(){this._commandBar&&this._commandBar.focus()},u.prototype._getCommands=function(n){for(var u,t=[],f=n.commands||[],i=0,r=f;i<r.length;i++)u=r[i],t.push.apply(t,u.value);return t},u.prototype._getViewActions=function(n){for(var u,t=[],f=n.viewActions||[],i=0,r=f;i<r.length;i++)u=r[i],t.push.apply(t,u.value);return t},u}(r.BaseComponent);t[n].PivotCommandBar=u}("ComponentsPivotBarPivotCommandBar"),function(n){var u,f,o;ct=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});u=340;t[n].MAX_PIVOT_WAIT=1e3;f=function(f){function s(n){var u=f.call(this,n)||this;return u._subscribedToPivotObservables=!1,u._pivotSelected=!1,u._pivotItemsRendered={},u._pivotHeader=r.createRef(),u._onFilterBarDismissClicked=function(){var n=u.props,t=n.showFilterBarViewOptionKey,i=n.viewOptions;i&&t&&u.props.viewOptions.setViewOption(t,!1);u._commandBar&&u._commandBar.focus();u.setState({showFilterBar:!1})},u._onDropDownSelected=function(n){var t=n.key;u._updateSelectedItem(t,null)},u._renderPivotItem=function(n,f){var e=n.itemKey,o=u.state.selectedPivot===e;return i.createElement(t.Dynamic.DynamicLink,{url:n.url,className:r.css("vss-PivotBar--itemLink",n.child&&n.child.props.headerClassName),tabIndex:-1,role:"presentation","data-is-focusable":!1,key:e},i.createElement(t.Button.Button,{id:n.id,className:r.css("vss-PivotBar--button",o?"selected":""),onClick:u._onPivotClick.bind(u,e),ariaLabel:n.ariaLabel,role:"tab",ariaSelected:o,ariaPosInSet:f+1,ariaSetSize:u.state.items.length},u._renderPivotItemContent(n)))},u._onShowFilterBarClicked=function(){u.setState({showFilterBar:!u.state.showFilterBar})},u._onFilterApplied=function(){var n=u.props.filter.hasChangesToReset();n!==u.state.hasAppliedFilter&&u.setState({hasAppliedFilter:n})},u._onContributedPivotsChanged=function(){if(u.setState({items:u._getPivotBarItems(u.props)}),u._pivotSelected){if(u.state.selectedPivot&&!u.getSelectedPivot()){var n=void 0;u.props.initialSelectedPivot&&u._getPivotBarItemByItemKey(u.props.initialSelectedPivot)?n=u.props.initialSelectedPivot:u.state.items&&u.state.items.length>0&&(n=u.state.items[0].itemKey);n&&u.selectPivot(n)}}else u.setState(u._buildInitialPivotState())},u._onViewOptionChanged=function(n){var h=u.props.showFilterBarViewOptionKey,f=u.state.viewActions,t=!1,i,e,o,s;if(h in n&&(u._focusFilterBar=!0,t=!0),!t){i=[];f&&f.forEach(function(n){return i.push.apply(i,n.value)});e=function(n){if(r.findIndex(i,function(t){return t.key===n})>=0)return t=!0,"break"};for(o in n)if(s=e(o),s==="break")break}t&&u.forceUpdate()},u._makeIPivotBarItemFromContribution=function(n,t){return{contributedItem:n,id:u._makeContributedPivotBarItemId(n,t),itemKey:n.itemKey||n.id,groupKey:n.groupKey,name:n.text,order:n.order,ariaLabel:n.ariaLabel,onRenderFilterBar:n.renderFilterBar,commandProviders:n.commandProviders,viewActionProviders:n.viewActionProviders,badgeCount:n.badgeCount,url:n.url,hidden:n.hidden,onBeforePivotChange:n.onBeforePivotChange}},u._getPivotBarItemId=function(n){return n.contributedItem?n.contributedItem.id:n.itemKey||n.id},u._id=r.getId("PivotBar"),u._setupPivotObservables(u.props),u._actionsManager=new o,u._disposables.push(u._actionsManager),u.state={items:u._getPivotBarItems(u.props)},u.state=__assign({hasAppliedFilter:u.props.filter?u.props.filter.hasChangesToReset():!1,items:u.state.items},u._buildInitialPivotState()),u}return __extends(s,f),s.prototype.focus=function(n){if(this._commandBar)switch(n){case 0:this._commandBar.focus()}},s.prototype.selectPivot=function(n){return this._getPivotBarItemByItemKey(n)?(this._updateSelectedItem(n,null),!0):!1},s.prototype.getSelectedPivot=function(){return this._getPivotBarItemByItemKey(this.state.selectedPivot)},s.prototype.componentWillReceiveProps=function(n){var r=this,i;t.UtilitiesInternal.arrayEquals(this.props.pivotProviders,n.pivotProviders)||this._setupPivotObservables(n);i=this._getPivotBarItems(n);this.setState(function(n,t){return __assign({items:i},r._buildInitialPivotState(t,i,!0))})},s.prototype.componentDidMount=function(){if(this.props.viewOptions&&this.props.showFilterBarViewOptionKey)this._events.on(this.props.viewOptions,t.UtilitiesViewOptions.VIEW_OPTIONS_CHANGE_EVENT,this._onViewOptionChanged);if(this.props.filter)this._events.on(this.props.filter,t.UtilitiesFilter.FILTER_APPLIED_EVENT,this._onFilterApplied);this._updateHeaderTopIfNeeded();this._subscribeToPivotObservables()},s.prototype.componentDidUpdate=function(){this._updateHeaderTopIfNeeded();this.props.onRenderComplete&&this.props.onRenderComplete()},s.prototype.componentWillUnmount=function(){this.props.viewOptions&&this.props.showFilterBarViewOptionKey&&this._events.off(this.props.viewOptions,t.UtilitiesViewOptions.VIEW_OPTIONS_CHANGE_EVENT,this._onViewOptionChanged);this.props.filter&&this._events.off(this.props.filter,t.UtilitiesFilter.FILTER_APPLIED_EVENT,this._onFilterApplied);this._contributedPivotWait&&(clearTimeout(this._contributedPivotWait),this._contributedPivotWait=null);this._unsubscribeFromPivotObservables()},s.prototype.render=function(){var ot=this,n=this.props,p=n.className,st=n.filter,o=n.showPivots,w=n.showFilterBarViewOptionKey,ht=n.filterBarClassName,l=n.pivotRenderingModeOptions,ct=n.isCommandBarSticky,pt=n.isPivotBarContentScrollable,b=n.pivotBarSize,g=b===void 0?"compact":b,lt=n.canBreadcrumbShrink,nt=n.maxBreadcrumbWidth,tt=n.pivotBarHeaderClassName,it=this.state,a=it.showFilterBar,at=it.headerTop,c=i.Children.toArray(this.props.children)||[],rt=c.filter(function(n){return typeof n!="object"||n.type!==k.PivotBarItem&&n.type!==t.FilterBar.FilterBar&&n.type!==d.HubTileRegion}),v=null,y=this._getHubTileRegionIndex(c),s,e,ut;y>-1&&(v=c[y]);s=null;e=y>-1;o===undefined?o=this.state.items&&this.state.items.length>1:e=e&&o;o&&(s=this._renderPivotItems(l));this._singleLineMode=!o&&!e;ut=this._singleLineMode?"vss-PivotBar--bar-one-line":"vss-PivotBar--bar-two-line";this.props.viewOptions&&w&&(a=this.props.viewOptions.getViewOption(w));var u,f=this._getFilterBarSettings(c),h=f&&f.showInline,ft=this.props.isPivotBarContentScrollable===!1&&!!ct;f&&(a||f.showInline)&&(u=f.filterBarElement,u=i.cloneElement(u,{className:r.css(u.props.className,ht,ft?"vss-PivotBar--filter-sticky":""),filter:u.props.filter||st,onDismissClicked:this._onFilterBarDismissClicked,onMounted:function(n){!h&&ot._focusFilterBar&&n.focus()}}));var vt=!!(s||this._singleLineMode),yt=ft?"sticky":"",et={};return this._singleLineMode&&nt&&(et={maxWidth:nt+"px"}),l&&l.mode===2?i.createElement("div",{className:r.css("vss-PivotBar",p)},i.createElement("div",{className:r.css(tt,"vss-PivotBar--header vertical")},rt,e&&v),i.createElement("div",{className:"vss-PivotBar--pivotsContainer vertical"},s,i.createElement("div",{className:"vss-PivotBar--barAndContentContainer"},i.createElement("div",{className:r.css("vss-PivotBar--bar",g)},this._renderCommandBar(h?u:null,!!f,!1),h?null:u),this._renderContent()))):i.createElement("div",{className:r.css("vss-PivotBar",p)},i.createElement("div",{className:r.css(ut,yt,{"bottom-border":!a}),style:{top:this._singleLineMode?0:at}},i.createElement("div",{className:r.css(tt,"vss-PivotBar--header",{"can-shrink":lt&&this._singleLineMode}),ref:this._pivotHeader,style:et},rt,e&&v),i.createElement("div",{className:r.css("vss-PivotBar--bar",g)},s,this._renderCommandBar(h?u:null,!!f,vt))),h?null:u,this._renderContent())},s.prototype._updateHeaderTopIfNeeded=function(){this.props.isPivotBarContentScrollable!==!1||!this.props.isCommandBarSticky||this.state.headerTop!==undefined||this._singleLineMode||this.setState({headerTop:"-"+this._pivotHeader.current.clientHeight+"px"})},s.prototype._renderPivotItems=function(n){return n&&n.mode===1?this._renderDropdown(n.props):n&&n.mode===2?this._renderVerticalTabs():this._renderHorizontalTabs()},s.prototype._renderDropdown=function(n){var u=[],f,r,e;if(this.state.items.length>0)for(f=this.state.items[0].groupKey,r=0,e=this.state.items;r<e.length;r++){var o=e[r],h=o.name,c=o.itemKey,s=o.groupKey;f!==s&&(u.push({key:s+"-separator",text:"-",itemType:y.DropdownMenuItemType.Divider}),f=s);u.push({key:c,text:h})}return i.createElement(y.Dropdown,{ariaLabel:t.VSSResourcesVSSUI.PivotItemAriaLabel,className:"vss-PivotBar--dropdown",selectedKey:this.state.selectedPivot,options:u,onChanged:this._onDropDownSelected,dropdownWidth:n.dropdownWidth})},s.prototype._pivotCompare=function(n,t){return(n===undefined?100:n)-(t===undefined?100:t)},s.prototype._renderHorizontalTabs=function(){var f=this,n=this.state.items?this.state.items.sort(function(n,t){return f._pivotCompare(n.order,t.order)}):null,t=this.props,u=t.pivotBarSize,o=u===void 0?"compact":u,s=t.headerAriaLabel;return i.createElement("div",{role:"navigation","aria-label":s},i.createElement(e.FocusZone,{className:r.css("vss-PivotBar--pivots",o),role:"tablist",direction:e.FocusZoneDirection.horizontal},n&&n.map(this._renderPivotItem)))},s.prototype._renderVerticalTabs=function(){var n=this,h=[],c={},l,r,o,v;if(this.props.pivotRenderingModeOptions&&this.props.pivotRenderingModeOptions.props){var a=this.props.pivotRenderingModeOptions.props,f=a.groups,p=a.navAriaLabel;if(f){for(r=0,o=f;r<o.length;r++)v=o[r],c[v.key]=!0;h=f.sort(function(t,i){return n._pivotCompare(t.rank,i.rank)})}l=p}var s=[],u=this.state.items.reduce(function(n,t){return t.groupKey&&c[t.groupKey]?(n[t.groupKey]=n[t.groupKey]||[]).push(t):s.push(t),n},{}),y=[i.createElement(t.Accordion.Accordion,{key:"PivotBarVerticalAccordion",className:"pivot-bar--accordion",initiallyExpandAll:!0,items:h.map(function(t){var r;return u[t.key]&&(u[t.key].sort(function(t,i){return n._pivotCompare(t.order,i.order)}),r={key:t.key,title:t.name,onRenderContent:function(){return i.createElement("div",{key:r.key,role:"tablist"},u[t.key].map(function(i,r){return n._renderVerticalPivotItem(i,r,u[t.key].length)}))}}),r}).filter(function(n){return n!==undefined})})];return y.push(i.createElement("div",{className:"pivot-bar--ungrouped",key:"PivotBarVerticalUngrouped",role:"tablist"},s.map(function(t,i){return n._renderVerticalPivotItem(t,i,s.length)}))),i.createElement(e.FocusZone,{direction:e.FocusZoneDirection.vertical,className:"vss-PivotBar--pivots vertical flex flex-column","aria-label":l},y)},s.prototype._renderVerticalPivotItem=function(n,u,f){var e=n.itemKey,o=this.state.selectedPivot===e;return i.createElement(t.Dynamic.DynamicLink,{url:n.url,className:r.css("vss-PivotBar--itemLink-v",n.child&&n.child.props.headerClassName),tabIndex:-1,role:"presentation","data-is-focusable":!1,key:e},i.createElement(t.Button.Button,{subtle:!0,id:n.id,className:r.css("vss-PivotBar--button-v",o?"selected":""),onClick:this._onPivotClick.bind(this,e),ariaLabel:n.ariaLabel,role:"tab",ariaSelected:o,ariaPosInSet:u+1,ariaSetSize:f},i.createElement(t.VssIcon.VssIcon,{className:"pivotbar-pivot--icon-v",iconName:n.iconProps&&n.iconProps.iconName}),i.createElement(t.Tooltip.TooltipHost,{content:n.name,overflowMode:t.Tooltip.TooltipOverflowMode.Parent},n.name)))},s.prototype._renderPivotItemContent=function(n){var o=n.name,h=n.iconProps,r=n.badgeCount,c=n.maxItemWidth,f=undefined,s=undefined,e;return typeof r=="string"?f=r:typeof r=="number"&&(f=t.UtilitiesFriendlyNumber.getFriendlyDisplayValue(r),f!==r.toString()&&(s=r.toString())),e=undefined,f&&(e=i.createElement("span",{className:"badge"},f),s&&(e=i.createElement(t.Tooltip.TooltipHost,{content:s},e))),i.createElement("span",{className:"innerContainer"},h!==undefined&&i.createElement(t.VssIcon.VssIcon,__assign({className:"icon"},h)),o!==undefined&&i.createElement("span",{className:"text",style:{maxWidth:c||u}},i.createElement(t.Tooltip.TooltipHost,{content:o,overflowMode:t.Tooltip.TooltipOverflowMode.Parent},o)),e)},s.prototype._renderCommandBar=function(n,t,r){var u=this;return i.createElement(nt.PivotCommandBar,{componentRef:function(n){u._commandBar=n},className:"vss-PivotBar--commandBar",commands:this.state.commands,viewActions:this.state.viewActions,filterBar:n,showFilterAction:t,showFilterBarViewOptionKey:this.props.showFilterBarViewOptionKey,hasAppliedFilter:this.state.hasAppliedFilter,prependSeparator:r,viewOptions:this.props.viewOptions,onShowFilterBarClicked:this._onShowFilterBarClicked,role:"region",ariaLabel:this.props.headerAriaLabel})},s.prototype._renderContent=function(){for(var f=[],c=(this.state.selectedPivot||"").toUpperCase(),e=this.props.isPivotBarContentScrollable!==undefined?this.props.isPivotBarContentScrollable:!0,u=0,o=this.state.items;u<o.length;u++){var n=o[u],t=n.itemKey.toUpperCase(),s=c===t,h=!s&&n.deselectionBehavior===1&&this._pivotItemsRendered[t]===!0;(s||h)&&(f.push(i.createElement("div",{key:t,className:r.css("vss-PivotBar--content",{"vss-PivotBar--content-unscrollable":!e,"hide-content":h},this.props.pivotBarContentClassName),role:"tabpanel",tabIndex:-1,"data-is-scrollable":e},n&&(n.child||n.contributedItem.render(r.css("vss-PivotBarItem","content-host"))))),this._pivotItemsRendered[t]=!0)}return f},s.prototype._makePivotBarItemId=function(n){return this._id+"-Tab"+n.index},s.prototype._makeContributedPivotBarItemId=function(n,t){return this._id+"-ContributedTab"+t},s.prototype._getPivotBarItemByItemKey=function(n,t){t===void 0&&(t=this.state.items);var u=(n||"").toUpperCase(),i=r.findIndex(t,function(n){return n.itemKey.toUpperCase()===u});return i>=0?t[i]:undefined},s.prototype._getPivotBarItems=function(n){for(var u,i,r={},s=t.UtilitiesChildrenUtils.childrenOfType(n.children,k.PivotBarItem),e=function(n){var i=n.groupKey||"",t=r[i];t||(t=[],r[i]=t);t.push(n)},h=100,f=0,o=s;f<o.length;f++)u=o[f],i=u.item.props,i.hidden||e({child:u.item,id:this._makePivotBarItemId(u),itemKey:i.itemKey,name:i.name,groupKey:i.groupKey,order:i.order!=undefined?i.order:h++,ariaLabel:i.ariaLabel,iconProps:i.iconProps,badgeCount:i.badgeCount,maxItemWidth:i.maxItemWidth,commands:i.commands,viewActions:i.viewActions,commandProviders:i.commandProviders,viewActionProviders:i.viewActionProviders,deselectionBehavior:i.deselectionBehavior,url:i.url,onBeforePivotChange:i.onBeforePivotChange,onRenderFilterBar:i.onRenderFilterBar});return this._contributedPivots.forEach(function(n){return n.value.forEach(function(n){n.hidden||e(n)})}),Object.keys(r).reduce(function(n,t){return r[t].forEach(function(t){return n.push(t)}),n},[])},s.prototype._setupPivotObservables=function(n){var i=this,u=0,r=this._subscribedToPivotObservables;r&&this._unsubscribeFromPivotObservables();this._contributedPivots=[];n.pivotProviders&&(n.pivotProviders.forEach(function(n){var r=new t.UtilitiesItemContribution.ContributedItemWithIdArray(n,function(n){return i._makeIPivotBarItemFromContribution(n,u++)},i._getPivotBarItemId);i._contributedPivots.push(r)}),r&&this._subscribeToPivotObservables())},s.prototype._unsubscribeFromPivotObservables=function(){var n=this;this._contributedPivots.forEach(function(t){return t.unsubscribe(n._onContributedPivotsChanged)});this._subscribedToPivotObservables=!1},s.prototype._subscribeToPivotObservables=function(){var n=this;this._contributedPivots.forEach(function(t){return t.subscribe(n._onContributedPivotsChanged)});this._subscribedToPivotObservables=!0},s.prototype._getFilterBarSettings=function(n){var l=this.props,a=l.onRenderFilterBar,e=l.showFilterBarInline,u,o=this._getPivotBarItemByItemKey(this.state.selectedPivot),s,h,f,c;return o&&o.onRenderFilterBar&&(u=o.onRenderFilterBar()),!u&&a&&(u=a()),u||(s=r.findIndex(n,function(n){return typeof n=="object"&&n.type===t.FilterBar.FilterBar}),s>=0&&(h=n[s],f=i.Children.toArray(h.props.children),f&&f.length>=1&&(u=h,f.length!==1||e||(c=f[0],typeof c=="object"&&c.props.isTextItem===!0&&(e=!0))))),u?{filterBarElement:u,showInline:e}:void 0},s.prototype._getHubTileRegionIndex=function(n){return r.findIndex(n,function(n){return typeof n=="object"&&n.type===d.HubTileRegion})},s.prototype._isKeyValid=function(n,t){return t===void 0&&(t=this.state.items),n!==undefined&&this._getPivotBarItemByItemKey(n,t)!==undefined},s.prototype._buildInitialPivotState=function(i,r,u){var e=this,o,f;return i===void 0&&(i=this.props),u===void 0&&(u=!1),o=function(){var n=r||e._getPivotBarItems(i);return n.length>0?n[0].itemKey:null},f=null,i.initialSelectedPivot||i.selectedPivot||(f=o()),!f&&i.initialSelectedPivot&&this._isKeyValid(i.initialSelectedPivot)&&(f=i.initialSelectedPivot),!f&&i.selectedPivot&&this._isKeyValid(i.selectedPivot)&&(f=i.selectedPivot),this._isKeyValid(f,r)||(f=null,this._contributedPivotWait||(this._contributedPivotWait=setTimeout(function(){e._pivotSelected||(f=o(),f&&e._updateSelectedItem(f,null));e._contributedPivotWait=null},t[n].MAX_PIVOT_WAIT))),this._pivotSelected=f!==null,this._buildNewPivotState(i,f,r,u)},s.prototype._buildNewPivotState=function(n,t,i,r){r===void 0&&(r=!1);var u=this._getPivotBarItemByItemKey(t,i),f=t&&u;return{selectedPivot:f?u.itemKey:"",commands:f?this._actionsManager.getCommandObservables(n.commands,u,r):[],viewActions:f?this._actionsManager.getViewActionObservables(n.viewActions,u,r):[]}},s.prototype._onPivotClick=function(n,t){var r=!0,i;t.ctrlKey&&(i=this._getPivotBarItemByItemKey(n),i&&i.url&&(typeof i.url=="string"||i.url.value)&&(r=!1));r&&(t.preventDefault(),this._updateSelectedItem(n,t))},s.prototype._updateSelectedItem=function(n,t){var i=this._getPivotBarItemByItemKey(n),u,r;if(i&&(this.props.onBeforePivotChange||i.onBeforePivotChange)){if(u=i&&i.url&&(typeof i.url=="string"?i.url:i.url.value),i.onBeforePivotChange&&!i.onBeforePivotChange(t,n,u))return;if(this.props.onBeforePivotChange&&!this.props.onBeforePivotChange(t,n,u))return}if(r=this.props,this._pivotSelected=!0,this.setState(this._buildNewPivotState(r,n)),r.onPivotClicked)r.onPivotClicked(t,n)},s}(r.BaseComponent);t[n].PivotBar=f;o=function(){function n(){this._commands={};this._viewActions={};this._getPivotActionItemId=function(n){return n.key}}return n.prototype.getCommandObservables=function(n,i,r){var e=this,u,f;return r===void 0&&(r=!1),u=i.id,r===!0&&delete this._commands[u],this._commands[u]||(f=[],this._commands[u]=f,f.push(c.ObservableLike.isObservable(n)?n:new c.ObservableArray(n)),f.push(c.ObservableLike.isObservable(i.commands)?i.commands:new c.ObservableArray(i.commands)),i.commandProviders&&i.commandProviders.forEach(function(n){var i=new t.UtilitiesItemContribution.ContributedItemWithIdArray(n,function(n){return n},e._getPivotActionItemId);f.push(i)})),this._commands[u]},n.prototype.getViewActionObservables=function(n,i,r){var u,f;return r===void 0&&(r=!1),u=i.id,r===!0&&delete this._viewActions[u],this._viewActions[u]||(f=[],this._viewActions[u]=f,f.push(c.ObservableLike.isObservable(i.viewActions)?i.viewActions:new c.ObservableArray(i.viewActions)),f.push(c.ObservableLike.isObservable(n)?n:new c.ObservableArray(n)),i.viewActionProviders&&i.viewActionProviders.forEach(function(n){var i=new t.UtilitiesItemContribution.ContributedItemArray(n,function(n){return n});f.push(i)})),this._viewActions[u]},n.prototype.dispose=function(){this._commands=null;this._viewActions=null},n}()}("ComponentsPivotBarPivotBar"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}lt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(ct);i(rt);i(b);i(k);i(ut);i(nt)}("ComponentsPivotBarindex"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}tt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(lt)}("PivotBar"),function(n){at=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var u=function(n){function u(i){var r=n.call(this,i)||this;return r._dataDidRender=function(n,t){var u=r.state,s=u.maxBreadcrumbWidth,f=u.canBreadcrumbShrink,e=r.props.minDisplayedBreadcrumbItems,o=e===void 0?0:e,i;f&&n.renderedItems.length<=o?r.setState({canBreadcrumbShrink:!1}):!f&&n.renderedItems.length>o&&r.setState({canBreadcrumbShrink:!0});i=n.renderedItems.length+n.renderedOverflowItems.length;r._breadcrumbItemCount&&i!==r._breadcrumbItemCount?r.setState({maxBreadcrumbWidth:undefined}):!s&&n.renderedOverflowItems.length===0&&t&&r.setState({maxBreadcrumbWidth:t+12});r._breadcrumbItemCount=i},r._onViewActionObservableChanged=function(){r._viewActionsObservable.value=r._underlyingViewActionsObservable.value.concat([r._getFullScreenViewAction()])},r._onSelectedPivotChanged=function(n){r.setState({selectedPivot:n})},r._onPivotClicked=function(n,t){if(t!==r.props.hubViewState.selectedPivot.value)if(r.props.hubViewState.canSwitchPivots(t))r.props.hubViewState.selectedPivot.value=t;else{var i=r.props.hubViewState.selectedPivot.value;r.pivotBar.selectPivot(i)}},r._chromeless=document.body.classList.contains("chromeless"),r.state={viewActions:r._getViewActions(i),selectedPivot:r.props.hubViewState.selectedPivot.value,inFullScreenMode:r.props.hubViewState.viewOptions.getViewOption(t.UtilitiesHubViewState.HubViewOptionKeys.fullScreen),canBreadcrumbShrink:!0},r}return __extends(u,n),u.prototype.focus=function(n){switch(n){case 0:this.pivotBar&&this.pivotBar.focus(n)}},u.prototype.componentWillReceiveProps=function(n){this.props.viewActions!==n.viewActions&&this.setState({viewActions:this._getViewActions(n)})},u.prototype.componentDidMount=function(){this.props.hubViewState.selectedPivot.subscribe(this._onSelectedPivotChanged);this._events.on(this.props.hubViewState.viewOptions,t.UtilitiesViewOptions.VIEW_OPTIONS_CHANGE_EVENT,this._onViewOptionChanged)},u.prototype.componentWillUnmount=function(){this.props.hubViewState.selectedPivot.unsubscribe(this._onSelectedPivotChanged);this._events.off(this.props.hubViewState.viewOptions,t.UtilitiesViewOptions.VIEW_OPTIONS_CHANGE_EVENT,this._onViewOptionChanged);this._underlyingViewActionsObservable&&this._underlyingViewActionsObservable.unsubscribe(this._onViewActionObservableChanged)},u.prototype.render=function(){var a=this,f=i.Children.toArray(this.props.children);this.validateChildren(f);var n=this.props,v=n.className,y=n.commands,w=n.hideHeader,o=n.hubViewState,b=n.onRenderFilterBar,k=n.pivotProviders,d=n.onBeforePivotChange,g=n.onPivotBarRenderComplete,nt=n.showFilterBarInline,it=n.showPivots,rt=n.useShadowStyle,ut=n.pivotRenderingModeOptions,s=n.onRenderSecondaryContent,ft=n.splitterProps,e=n.scrollableRegion,et=n.pivotHeaderAriaLabel,h=n.breadcrumbIsExpandable,u=this.state,ot=u.selectedPivot,st=u.viewActions,ht=u.inFullScreenMode,ct=u.maxBreadcrumbWidth,lt=u.canBreadcrumbShrink;h&&(f[0]=i.cloneElement(f[0],{breadcrumbDataDidRender:this._dataDidRender}));var at={onPivotClicked:this._onPivotClicked,onBeforePivotChange:d,commands:y,selectedPivot:ot,viewOptions:o.viewOptions,filter:o.filter,pivotProviders:k,showPivots:ht?!1:it,onRenderComplete:g,viewActions:st,onRenderFilterBar:b,showFilterBarInline:nt,showFilterBarViewOptionKey:t.UtilitiesHubViewState.HubViewOptionKeys.showFilterBar,filterBarClassName:"vss-Hub--filterBar",pivotRenderingModeOptions:ut,pivotBarContentClassName:this.props.pivotBarContentClassName,isPivotBarContentScrollable:e===1,isCommandBarSticky:e===0,pivotBarSize:"tall",headerAriaLabel:et,canBreadcrumbShrink:lt,maxBreadcrumbWidth:ct,pivotBarHeaderClassName:h&&"vss-PivotBar--header-with-expandable-breadcrumb"},c=i.createElement(tt.PivotBar,__assign({},at,{className:r.css("vss-HubPivotBar",{"vss-HubPivotBar--scrollable":e===0,shadowStyle:rt,hideHeader:w},this.props.pivotBarClassName),componentRef:function(n){a.pivotBar=n}}),f),l=c;return s&&(l=i.createElement(t.Splitter.Splitter,__assign({},ft,{onRenderFarElement:function(){return c},onRenderNearElement:s}))),i.createElement(p.Fabric,{className:r.css("vss-Hub",v)},l)},u.prototype.validateChildren=function(n){var r=t.UtilitiesChildrenUtils.childrenOfType(n,d.HubHeader)[0];if(!r||r.index!==0)throw new Error("Expected first child of Hub to be HubHeader.");this.state.inFullScreenMode&&(n[r.index]=i.cloneElement(n[r.index],{collapseBreadcrumb:!0}))},u.prototype._getFullScreenViewAction=function(){return{key:t.UtilitiesHubViewState.HubViewOptionKeys.fullScreen,important:!0,viewActionRenderArea:2,actionType:1,actionProps:{showText:!1,onAriaLabel:t.VSSResourcesVSSUI.ExitFullScreenAriaLabel,offAriaLabel:t.VSSResourcesVSSUI.EnterFullScreenAriaLabel,onIconProps:{iconName:"BackToWindow"},offIconProps:{iconName:"FullScreen"}}}},u.prototype._getViewActions=function(n){var t,i,r;return c.ObservableLike.isObservable(n.viewActions)?!n.hideFullScreenToggle&&!this._chromeless?(this._underlyingViewActionsObservable&&this._underlyingViewActionsObservable.unsubscribe(this._onViewActionObservableChanged),t=n.viewActions,i=new c.ObservableArray(t.value.concat([this._getFullScreenViewAction()])),this._underlyingViewActionsObservable=t,this._viewActionsObservable=i,t.subscribe(this._onViewActionObservableChanged),i):n.viewActions:(r=n.viewActions||[],n.hideFullScreenToggle||this._chromeless||r.push(this._getFullScreenViewAction()),r)},u.prototype._onViewOptionChanged=function(n){if(t.UtilitiesHubViewState.HubViewOptionKeys.fullScreen in n){var i=n[t.UtilitiesHubViewState.HubViewOptionKeys.fullScreen]===!0;this.setState({inFullScreenMode:i})}},u.defaultProps={scrollableRegion:1},u}(r.BaseComponent);t[n].Hub=u}("ComponentsHubHub"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}vt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(at);i(it)}("ComponentsHubindex"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}yt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(g)}("ComponentsVssBreadcrumbindex"),function(n){gt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});w.VssComponent.register("pivotBar",tt.PivotBar)}("RegistrationPivotBarRegistration"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}ni=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(vt)}("Hub"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}ti=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(yt)}("VssBreadcrumb")},["Components/HubHeader/HubHeader.Props","Components/HubHeader/HubTextTile.Props","Components/HubHeader/HubTitle.Props","Components/Hub/Hub.Props","Components/PivotBar/PivotBar.Props","Components/PivotBar/PivotBarItem.Props","Components/PivotBar/PivotCommandBar.Props","Components/HubHeader/HubBreadcrumb.Props","Components/PivotBar/PivotBarItem","Components/VssBreadcrumb/VssBreadcrumb","Components/HubHeader/HubTitle","Components/HubHeader/HubHeader","Components/HubHeader/HubTextTile","Components/HubHeader/HubTileRegion","Components/HubHeader/index","HubHeader","Components/PivotBar/PivotBarAction","Components/PivotBar/PivotCommandBar","Components/PivotBar/PivotBar","Components/PivotBar/index","PivotBar","Components/Hub/Hub","Components/Hub/index","Components/VssBreadcrumb/index","Registration/PivotBarRegistration","Hub","VssBreadcrumb"]);document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-hub-content"}}));