if (window.performance && window.performance.mark) { window.performance.mark('startLoadBundleInner-async'); }
// Copyright (C) Microsoft Corporation. All rights reserved.
define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Contracts",["require","exports","Presentation/Scripts/TFS/Resources/TFS.Resources.Presentation"],function(n,t,i){var r,u,f,e,o,s,h;Object.defineProperty(t,"__esModule",{value:!0});t.DefaultGridHeight=300;t.LINKED_ARTIFACTS_CUSTOMER_INTELLIGENCE_AREA="linkedArtifacts",function(n){n[n.String=0]="String";n[n.Integer=1]="Integer";n[n.DateTime=2]="DateTime";n[n.PlainText=3]="PlainText";n[n.Html=4]="Html";n[n.TreePath=5]="TreePath";n[n.Double=6]="Double";n[n.Guid=7]="Guid";n[n.Boolean=8]="Boolean";n[n.Identity=9]="Identity"}(r=t.LinkColumnType||(t.LinkColumnType={})),function(n){n[n.List=0]="List";n[n.Grid=1]="Grid";n[n.FullGrid=2]="FullGrid"}(u=t.ViewMode||(t.ViewMode={})),function(n){n[n.Hidden=0]="Hidden";n[n.Default=1]="Default";n[n.Custom=2]="Custom"}(f=t.ZeroDataExperienceViewMode||(t.ZeroDataExperienceViewMode={})),function(n){n[n.Done=0]="Done";n[n.InProgress=1]="InProgress"}(e=t.FetchingLinks||(t.FetchingLinks={})),function(n){n[n.Ascending=1]="Ascending";n[n.Descending=-1]="Descending"}(o=t.SortDirection||(t.SortDirection={}));t.InternalKnownColumns={Link:{name:i.LinkedArtifacts_ColumnHeader_Link,refName:"Link"},Id:{name:i.LinkedArtifacts_ColumnHeader_Id,refName:"System.Id"},State:{name:i.LinkedArtifacts_ColumnHeader_State,refName:"System.State"},LastUpdate:{name:i.LinkedArtifacts_ColumnHeader_LastUpdate,refName:"System.ChangedDate"},Comment:{name:i.LinkedArtifacts_ColumnHeader_Comment,refName:"System.Links.Comment"}},function(n){n.ProjectName="PROJECT_NAME";n.ProjectId="PROJECT_ID"}(s=t.HostArtifactAdditionalData||(t.HostArtifactAdditionalData={})),function(n){n.ForceRerender="LA_FORCE_RERENDER"}(h=t.Events||(t.Events={}))});

define("VersionControl/Scenarios/Shared/Committing/TextFieldParentAddon",["require","exports","VSSUI/Tooltip","react","VersionControl/Scripts/VersionControlPath","VSS/LoaderPlugins/Css!VersionControl/Shared/Committing/TextFieldParentAddon"],function(n,t,i,r,u){Object.defineProperty(t,"__esModule",{value:!0});t.TextFieldParentAddon=function(n){return r.createElement(i.TooltipHost,{hostClassName:"vc-text-field-parent-addon",content:n.prefix,overflowMode:i.TooltipOverflowMode.Self},u.addTrailingSlash(n.prefix))}});

var __extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();define("VersionControl/Scenarios/Shared/FileInput",["require","exports","react","VSS/Controls","VSS/Controls/FileInput","VSS/Utils/String","VersionControl/Scripts/Controls/SourceEditing","VersionControl/Scripts/Resources/TFS.Resources.VersionControl","VersionControl/Scripts/CustomerIntelligenceConstants","VSS/Telemetry/Services"],function(n,t,i,r,u,f,e,o,s,h){Object.defineProperty(t,"__esModule",{value:!0});var c=function(n){function t(t){var i=n.call(this,t)||this;return i._decorateInputFiles(),i}return __extends(t,n),t.prototype.componentDidMount=function(){this.innerControl=this.createControl()},t.prototype.componentWillReceiveProps=function(n){this.props.onUploadedFileStateChaged(n.filesToBeUploaded);this._decorateInputFiles()},t.prototype.componentWillUnmount=function(){this.innerControl&&(this.innerControl.dispose(),this.innerControl=null)},t.prototype.render=function(){return i.createElement("div",{ref:"holder"})},t.prototype.createControl=function(){var t=this,n=this.props.isGit,i=!n,f={initialDrop:this.props.initialDrop,maximumTotalFileSize:e.Constants.MAX_EDIT_FROM_WEB_CONTENT_SIZE,detectEncoding:i,fileNamesCaseSensitive:n,updateHandler:function(n){t.props.onUploadedFileStateChaged(n.files);t._decorateInputFiles()},limitMessageFormatter:function(t,r){return h.publishEvent(new h.TelemetryEventData(s.VERSION_CONTROL_AREA,s.SOURCEEDITING_UPLOAD_LIMIT,$.extend({},r,{isGit:n,isTfvc:i}))),t+(n?o.WebEditLimitWorkaroundGit:o.WebEditLimitWorkaroundTfvc)}};return r.BaseControl.enhance(u.FileInputControl,this.refs.holder,f)},t.prototype._decorateInputFiles=function(){var t,i,r,n;if(this.innerControl&&(t=this.innerControl.getRows(),t.length>0))for(i=0,r=t.length;i<r;i++)n=t[i],this.props.fileAlreadyExists(n.result.name)?n.$fileNameElement.text(f.format(o.AddFileDialogReplaceFileFormat,n.result.name)):n.$fileNameElement.text(f.format(o.AddFileDialogNewFileFormat,n.result.name))},t}(i.Component);t.FileInput=c});

define("VSS/Flux/PlatformComponent",["require","exports","VSS/Flux/Component","react"],function(n,t,i,r){Object.defineProperty(t,"__esModule",{value:!0});var u=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.render=function(){var t=this,n={ref:function(n){t.onRef(n)}};return this.props.cssClass&&(n.className=this.props.cssClass),r.createElement(this.getTagName(),n,this.props.children)},t.prototype.onRef=function(n){n&&(this._control=this.createControl($(n)))},t.prototype.getTagName=function(){return"div"},t.prototype.shouldComponentUpdate=function(n){return n.shouldUpdate===!0},t.prototype.componentWillUnmount=function(){n.prototype.componentWillUnmount.call(this);this._control&&(this._control.dispose(),this._control=null)},t.prototype.createControl=function(){return null},t}(i.Component);t.Component=u});

define("Mention/Scripts/TFS.Mention.Autocomplete",["require","exports"],function(n,t){Object.defineProperty(t,"__esModule",{value:!0});var i;(function(n){n[n.WorkItem=0]="WorkItem"})(i=t.MentionType||(t.MentionType={}))});

/*!
 * jQuery UI Menu 1.11.4
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/menu/
 */
(function (n) { typeof define == "function" && define.amd ? define("jQueryUI/menu",["jquery", "./core", "./widget", "./position"], n) : n(jQuery) })(function (n) { return n.widget("ui.menu", { version: "1.11.4", defaultElement: "<ul>", delay: 300, options: { icons: { submenu: "ui-icon-carat-1-e" }, items: "> *", menus: "ul", position: { my: "left-1 top", at: "right top" }, role: "menu", blur: null, focus: null, select: null }, _create: function () { this.activeMenu = this.element; this.mouseHandled = !1; this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content").toggleClass("ui-menu-icons", !!this.element.find(".ui-icon").length).attr({ role: this.options.role, tabIndex: 0 }); this.options.disabled && this.element.addClass("ui-state-disabled").attr("aria-disabled", "true"); this._on({ "mousedown .ui-menu-item": function (n) { n.preventDefault() }, "click .ui-menu-item": function (t) { var i = n(t.target); !this.mouseHandled && i.not(".ui-state-disabled").length && (this.select(t), t.isPropagationStopped() || (this.mouseHandled = !0), i.has(".ui-menu").length ? this.expand(t) : !this.element.is(":focus") && n(this.document[0].activeElement).closest(".ui-menu").length && (this.element.trigger("focus", [!0]), this.active && this.active.parents(".ui-menu").length === 1 && clearTimeout(this.timer))) }, "mouseenter .ui-menu-item": function (t) { if (!this.previousFilter) { var i = n(t.currentTarget); i.siblings(".ui-state-active").removeClass("ui-state-active"); this.focus(t, i) } }, mouseleave: "collapseAll", "mouseleave .ui-menu": "collapseAll", focus: function (n, t) { var i = this.active || this.element.find(this.options.items).eq(0); t || this.focus(n, i) }, blur: function (t) { this._delay(function () { n.contains(this.element[0], this.document[0].activeElement) || this.collapseAll(t) }) }, keydown: "_keydown" }); this.refresh(); this._on(this.document, { click: function (n) { this._closeOnDocumentClick(n) && this.collapseAll(n); this.mouseHandled = !1 } }) }, _destroy: function () { this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-menu-icons ui-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(); this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function () { var t = n(this); t.data("ui-menu-submenu-carat") && t.remove() }); this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content") }, _keydown: function (t) { var i, u, r, f, e = !0; switch (t.keyCode) { case n.ui.keyCode.PAGE_UP: this.previousPage(t); break; case n.ui.keyCode.PAGE_DOWN: this.nextPage(t); break; case n.ui.keyCode.HOME: this._move("first", "first", t); break; case n.ui.keyCode.END: this._move("last", "last", t); break; case n.ui.keyCode.UP: this.previous(t); break; case n.ui.keyCode.DOWN: this.next(t); break; case n.ui.keyCode.LEFT: this.collapse(t); break; case n.ui.keyCode.RIGHT: this.active && !this.active.is(".ui-state-disabled") && this.expand(t); break; case n.ui.keyCode.ENTER: case n.ui.keyCode.SPACE: this._activate(t); break; case n.ui.keyCode.ESCAPE: this.collapse(t); break; default: e = !1; u = this.previousFilter || ""; r = String.fromCharCode(t.keyCode); f = !1; clearTimeout(this.filterTimer); r === u ? f = !0 : r = u + r; i = this._filterMenuItems(r); i = f && i.index(this.active.next()) !== -1 ? this.active.nextAll(".ui-menu-item") : i; i.length || (r = String.fromCharCode(t.keyCode), i = this._filterMenuItems(r)); i.length ? (this.focus(t, i), this.previousFilter = r, this.filterTimer = this._delay(function () { delete this.previousFilter }, 1e3)) : delete this.previousFilter } e && t.preventDefault() }, _activate: function (n) { this.active.is(".ui-state-disabled") || (this.active.is("[aria-haspopup='true']") ? this.expand(n) : this.select(n)) }, refresh: function () { var i, t, u = this, f = this.options.icons.submenu, r = this.element.find(this.options.menus); this.element.toggleClass("ui-menu-icons", !!this.element.find(".ui-icon").length); r.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-front").hide().attr({ role: this.options.role, "aria-hidden": "true", "aria-expanded": "false" }).each(function () { var t = n(this), i = t.parent(), r = n("<span>").addClass("ui-menu-icon ui-icon " + f).data("ui-menu-submenu-carat", !0); i.attr("aria-haspopup", "true").prepend(r); t.attr("aria-labelledby", i.attr("id")) }); i = r.add(this.element); t = i.find(this.options.items); t.not(".ui-menu-item").each(function () { var t = n(this); u._isDivider(t) && t.addClass("ui-widget-content ui-menu-divider") }); t.not(".ui-menu-item, .ui-menu-divider").addClass("ui-menu-item").uniqueId().attr({ tabIndex: -1, role: this._itemRole() }); t.filter(".ui-state-disabled").attr("aria-disabled", "true"); this.active && !n.contains(this.element[0], this.active[0]) && this.blur() }, _itemRole: function () { return { menu: "menuitem", listbox: "option" }[this.options.role] }, _setOption: function (n, t) { n === "icons" && this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu); n === "disabled" && this.element.toggleClass("ui-state-disabled", !!t).attr("aria-disabled", t); this._super(n, t) }, focus: function (n, t) { var i, r; this.blur(n, n && n.type === "focus"); this._scrollIntoView(t); this.active = t.first(); r = this.active.addClass("ui-state-focus").removeClass("ui-state-active"); this.options.role && this.element.attr("aria-activedescendant", r.attr("id")); this.active.parent().closest(".ui-menu-item").addClass("ui-state-active"); n && n.type === "keydown" ? this._close() : this.timer = this._delay(function () { this._close() }, this.delay); i = t.children(".ui-menu"); i.length && n && /^mouse/.test(n.type) && this._startOpening(i); this.activeMenu = t.parent(); this._trigger("focus", n, { item: t }) }, _scrollIntoView: function (t) { var e, o, i, r, u, f; this._hasScroll() && (e = parseFloat(n.css(this.activeMenu[0], "borderTopWidth")) || 0, o = parseFloat(n.css(this.activeMenu[0], "paddingTop")) || 0, i = t.offset().top - this.activeMenu.offset().top - e - o, r = this.activeMenu.scrollTop(), u = this.activeMenu.height(), f = t.outerHeight(), i < 0 ? this.activeMenu.scrollTop(r + i) : i + f > u && this.activeMenu.scrollTop(r + i - u + f)) }, blur: function (n, t) { (t || clearTimeout(this.timer), this.active) && (this.active.removeClass("ui-state-focus"), this.active = null, this._trigger("blur", n, { item: this.active })) }, _startOpening: function (n) { (clearTimeout(this.timer), n.attr("aria-hidden") === "true") && (this.timer = this._delay(function () { this._close(); this._open(n) }, this.delay)) }, _open: function (t) { var i = n.extend({ of: this.active }, this.options.position); clearTimeout(this.timer); this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden", "true"); t.show().removeAttr("aria-hidden").attr("aria-expanded", "true").position(i) }, collapseAll: function (t, i) { clearTimeout(this.timer); this.timer = this._delay(function () { var r = i ? this.element : n(t && t.target).closest(this.element.find(".ui-menu")); r.length || (r = this.element); this._close(r); this.blur(t); this.activeMenu = r }, this.delay) }, _close: function (n) { n || (n = this.active ? this.active.parent() : this.element); n.find(".ui-menu").hide().attr("aria-hidden", "true").attr("aria-expanded", "false").end().find(".ui-state-active").not(".ui-state-focus").removeClass("ui-state-active") }, _closeOnDocumentClick: function (t) { return !n(t.target).closest(".ui-menu").length }, _isDivider: function (n) { return !/[^\-\u2014\u2013\s]/.test(n.text()) }, collapse: function (n) { var t = this.active && this.active.parent().closest(".ui-menu-item", this.element); t && t.length && (this._close(), this.focus(n, t)) }, expand: function (n) { var t = this.active && this.active.children(".ui-menu ").find(this.options.items).first(); t && t.length && (this._open(t.parent()), this._delay(function () { this.focus(n, t) })) }, next: function (n) { this._move("next", "first", n) }, previous: function (n) { this._move("prev", "last", n) }, isFirstItem: function () { return this.active && !this.active.prevAll(".ui-menu-item").length }, isLastItem: function () { return this.active && !this.active.nextAll(".ui-menu-item").length }, _move: function (n, t, i) { var r; this.active && (r = n === "first" || n === "last" ? this.active[n === "first" ? "prevAll" : "nextAll"](".ui-menu-item").eq(-1) : this.active[n + "All"](".ui-menu-item").eq(0)); r && r.length && this.active || (r = this.activeMenu.find(this.options.items)[t]()); this.focus(i, r) }, nextPage: function (t) { var i, r, u; if (!this.active) { this.next(t); return } this.isLastItem() || (this._hasScroll() ? (r = this.active.offset().top, u = this.element.height(), this.active.nextAll(".ui-menu-item").each(function () { return i = n(this), i.offset().top - r - u < 0 }), this.focus(t, i)) : this.focus(t, this.activeMenu.find(this.options.items)[this.active ? "last" : "first"]())) }, previousPage: function (t) { var i, r, u; if (!this.active) { this.next(t); return } this.isFirstItem() || (this._hasScroll() ? (r = this.active.offset().top, u = this.element.height(), this.active.prevAll(".ui-menu-item").each(function () { return i = n(this), i.offset().top - r + u > 0 }), this.focus(t, i)) : this.focus(t, this.activeMenu.find(this.options.items).first())) }, _hasScroll: function () { return this.element.outerHeight() < this.element.prop("scrollHeight") }, select: function (t) { this.active = this.active || n(t.target).closest(".ui-menu-item"); var i = { item: this.active }; this.active.has(".ui-menu").length || this.collapseAll(t, !0); this._trigger("select", t, i) }, _filterMenuItems: function (t) { var i = t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&"), r = new RegExp("^" + i, "i"); return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function () { return r.test(n.trim(n(this).text())) }) } }) });

/*!
 * jQuery UI Autocomplete 1.11.4
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/autocomplete/
 */
(function (n) { typeof define == "function" && define.amd ? define("jQueryUI/autocomplete",["jquery", "./core", "./widget", "./position", "./menu"], n) : n(jQuery) })(function (n) { return n.widget("ui.autocomplete", { version: "1.11.4", defaultElement: "<input>", options: { appendTo: null, autoFocus: !1, delay: 300, minLength: 1, position: { my: "left top", at: "left bottom", collision: "none" }, source: null, change: null, close: null, focus: null, open: null, response: null, search: null, select: null }, requestIndex: 0, pending: 0, _create: function () { var t, i, r, u = this.element[0].nodeName.toLowerCase(), f = u === "textarea", e = u === "input"; this.isMultiLine = f ? !0 : e ? !1 : this.element.prop("isContentEditable"); this.valueMethod = this.element[f || e ? "val" : "text"]; this.isNewMenu = !0; this.element.addClass("ui-autocomplete-input").attr("autocomplete", "off"); this._on(this.element, { keydown: function (u) { if (this.element.prop("readOnly")) { t = !0; r = !0; i = !0; return } t = !1; r = !1; i = !1; var f = n.ui.keyCode; switch (u.keyCode) { case f.PAGE_UP: t = !0; this._move("previousPage", u); break; case f.PAGE_DOWN: t = !0; this._move("nextPage", u); break; case f.UP: t = !0; this._keyEvent("previous", u); break; case f.DOWN: t = !0; this._keyEvent("next", u); break; case f.ENTER: this.menu.active && (t = !0, u.preventDefault(), this.menu.select(u)); break; case f.TAB: this.menu.active && this.menu.select(u); break; case f.ESCAPE: this.menu.element.is(":visible") && (this.isMultiLine || this._value(this.term), this.close(u), u.preventDefault()); break; default: i = !0; this._searchTimeout(u) } }, keypress: function (r) { if (t) { t = !1; (!this.isMultiLine || this.menu.element.is(":visible")) && r.preventDefault(); return } if (!i) { var u = n.ui.keyCode; switch (r.keyCode) { case u.PAGE_UP: this._move("previousPage", r); break; case u.PAGE_DOWN: this._move("nextPage", r); break; case u.UP: this._keyEvent("previous", r); break; case u.DOWN: this._keyEvent("next", r) } } }, input: function (n) { if (r) { r = !1; n.preventDefault(); return } this._searchTimeout(n) }, focus: function () { this.selectedItem = null; this.previous = this._value() }, blur: function (n) { if (this.cancelBlur) { delete this.cancelBlur; return } clearTimeout(this.searching); this.close(n); this._change(n) } }); this._initSource(); this.menu = n("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({ role: null }).hide().menu("instance"); this._on(this.menu.element, { mousedown: function (t) { t.preventDefault(); this.cancelBlur = !0; this._delay(function () { delete this.cancelBlur }); var i = this.menu.element[0]; n(t.target).closest(".ui-menu-item").length || this._delay(function () { var t = this; this.document.one("mousedown", function (r) { r.target === t.element[0] || r.target === i || n.contains(i, r.target) || t.close() }) }) }, menufocus: function (t, i) { var r, u; if (this.isNewMenu && (this.isNewMenu = !1, t.originalEvent && /^mouse/.test(t.originalEvent.type))) { this.menu.blur(); this.document.one("mousemove", function () { n(t.target).trigger(t.originalEvent) }); return } u = i.item.data("ui-autocomplete-item"); !1 !== this._trigger("focus", t, { item: u }) && t.originalEvent && /^key/.test(t.originalEvent.type) && this._value(u.value); r = i.item.attr("aria-label") || u.value; r && n.trim(r).length && (this.liveRegion.children().hide(), n("<div>").text(r).appendTo(this.liveRegion)) }, menuselect: function (n, t) { var i = t.item.data("ui-autocomplete-item"), r = this.previous; this.element[0] !== this.document[0].activeElement && (this.element.focus(), this.previous = r, this._delay(function () { this.previous = r; this.selectedItem = i })); !1 !== this._trigger("select", n, { item: i }) && this._value(i.value); this.term = this._value(); this.close(n); this.selectedItem = i } }); this.liveRegion = n("<span>", { role: "status", "aria-live": "assertive", "aria-relevant": "additions" }).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body); this._on(this.window, { beforeunload: function () { this.element.removeAttr("autocomplete") } }) }, _destroy: function () { clearTimeout(this.searching); this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"); this.menu.element.remove(); this.liveRegion.remove() }, _setOption: function (n, t) { this._super(n, t); n === "source" && this._initSource(); n === "appendTo" && this.menu.element.appendTo(this._appendTo()); n === "disabled" && t && this.xhr && this.xhr.abort() }, _appendTo: function () { var t = this.options.appendTo; return t && (t = t.jquery || t.nodeType ? n(t) : this.document.find(t).eq(0)), t && t[0] || (t = this.element.closest(".ui-front")), t.length || (t = this.document[0].body), t }, _initSource: function () { var i, r, t = this; n.isArray(this.options.source) ? (i = this.options.source, this.source = function (t, r) { r(n.ui.autocomplete.filter(i, t.term)) }) : typeof this.options.source == "string" ? (r = this.options.source, this.source = function (i, u) { t.xhr && t.xhr.abort(); t.xhr = n.ajax({ url: r, data: i, dataType: "json", success: function (n) { u(n) }, error: function () { u([]) } }) }) : this.source = this.options.source }, _searchTimeout: function (n) { clearTimeout(this.searching); this.searching = this._delay(function () { var t = this.term === this._value(), i = this.menu.element.is(":visible"), r = n.altKey || n.ctrlKey || n.metaKey || n.shiftKey; t && (!t || i || r) || (this.selectedItem = null, this.search(null, n)) }, this.options.delay) }, search: function (n, t) { return (n = n != null ? n : this._value(), this.term = this._value(), n.length < this.options.minLength) ? this.close(t) : this._trigger("search", t) === !1 ? void 0 : this._search(n) }, _search: function (n) { this.pending++; this.element.addClass("ui-autocomplete-loading"); this.cancelSearch = !1; this.source({ term: n }, this._response()) }, _response: function () { var t = ++this.requestIndex; return n.proxy(function (n) { t === this.requestIndex && this.__response(n); this.pending--; this.pending || this.element.removeClass("ui-autocomplete-loading") }, this) }, __response: function (n) { n && (n = this._normalize(n)); this._trigger("response", null, { content: n }); !this.options.disabled && n && n.length && !this.cancelSearch ? (this._suggest(n), this._trigger("open")) : this._close() }, close: function (n) { this.cancelSearch = !0; this._close(n) }, _close: function (n) { this.menu.element.is(":visible") && (this.menu.element.hide(), this.menu.blur(), this.isNewMenu = !0, this._trigger("close", n)) }, _change: function (n) { this.previous !== this._value() && this._trigger("change", n, { item: this.selectedItem }) }, _normalize: function (t) { return t.length && t[0].label && t[0].value ? t : n.map(t, function (t) { return typeof t == "string" ? { label: t, value: t } : n.extend({}, t, { label: t.label || t.value, value: t.value || t.label }) }) }, _suggest: function (t) { var i = this.menu.element.empty(); this._renderMenu(i, t); this.isNewMenu = !0; this.menu.refresh(); i.show(); this._resizeMenu(); i.position(n.extend({ of: this.element }, this.options.position)); this.options.autoFocus && this.menu.next() }, _resizeMenu: function () { var n = this.menu.element; n.outerWidth(Math.max(n.width("").outerWidth() + 1, this.element.outerWidth())) }, _renderMenu: function (t, i) { var r = this; n.each(i, function (n, i) { r._renderItemData(t, i) }) }, _renderItemData: function (n, t) { return this._renderItem(n, t).data("ui-autocomplete-item", t) }, _renderItem: function (t, i) { return n("<li>").text(i.label).appendTo(t) }, _move: function (n, t) { if (!this.menu.element.is(":visible")) { this.search(null, t); return } if (this.menu.isFirstItem() && /^previous/.test(n) || this.menu.isLastItem() && /^next/.test(n)) { this.isMultiLine || this._value(this.term); this.menu.blur(); return } this.menu[n](t) }, widget: function () { return this.menu.element }, _value: function () { return this.valueMethod.apply(this.element, arguments) }, _keyEvent: function (n, t) { (!this.isMultiLine || this.menu.element.is(":visible")) && (this._move(n, t), t.preventDefault()) } }), n.extend(n.ui.autocomplete, { escapeRegex: function (n) { return n.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&") }, filter: function (t, i) { var r = new RegExp(n.ui.autocomplete.escapeRegex(i), "i"); return n.grep(t, function (n) { return r.test(n.label || n.value || n) }) } }), n.widget("ui.autocomplete", n.ui.autocomplete, { options: { messages: { noResults: "No search results.", results: function (n) { return n + (n > 1 ? " results are" : " result is") + " available, use up and down arrow keys to navigate." } } }, __response: function (t) { var i; (this._superApply(arguments), this.options.disabled || this.cancelSearch) || (i = t && t.length ? this.options.messages.results(t.length) : this.options.messages.noResults, this.liveRegion.children().hide(), n("<div>").text(i).appendTo(this.liveRegion)) } }), n.ui.autocomplete });

// Copyright (C) Microsoft Corporation. All rights reserved.
define("Mention/Scripts/TFS.Mention.Helpers",["require","exports","VSS/Utils/Core","Presentation/Scripts/TFS/TFS.Host.TfsContext","jQueryUI/autocomplete"],function(n,t,i,r){function h(n,t,i,r){var h;if(typeof n=="undefined"||n===null||t===null||!t.length)return{found:{},highlightedSource:n};t=t.slice(0,e);var c=n.toUpperCase(),l=t.map(function(n){return $.ui.autocomplete.escapeRegex(n)}),o,f={},s=!1;return i===u.Prefix?(t.forEach(function(n){c.indexOf(n.toUpperCase())===0?(s=!0,f[n]=!0):f[n]=!1}),o=new RegExp("^("+l.join("|")+")","ig")):i===u.Contains&&(t.forEach(function(n){c.indexOf(n.toUpperCase())>=0?(s=!0,f[n]=!0):f[n]=!1}),o=new RegExp(l.join("|"),"ig")),h="",h=s&&r?n.replace(o,r):n,{found:f,highlightedSource:h}}function o(){return window.parent!==window}function s(){try{if(o()&&window.parent.TfsMentionHelpers)return window.parent.TfsMentionHelpers.getDefaultTfsContext()}catch(n){}return f.getDefaultTfsContext()}function c(){var n;try{n=s()}catch(t){n=null}return!!n}function l(n,t){return i.delegate(n,t)}function a(n,t,r){var u,f=i.throttledDelegate(n,t,function(){var t=u;u=null;r.apply(n,t)});return function(){return u=arguments,f()}}function v(){return window.location}function y(n){return $("<div>").html(n).text()}function p(n){if(!n)return null;var t=n.ownerDocument;return t?t.defaultView||t.parentWindow:null}function w(n){return n.charCode?!0:!1}var e,u,f;Object.defineProperty(t,"__esModule",{value:!0});e=10,function(n){n[n.Contains=0]="Contains";n[n.Prefix=1]="Prefix"}(u=t.SearchBehavior||(t.SearchBehavior={}));t.searchString=h;t.hasParentWindow=o;t.getMainTfsContext=s;t.environmentIsSupported=c;t.delegate=l;t.throttledDelegate=a;t.getWindowLocation=v;t.convertHtmlToText=y;t.getWindow=p,function(n){function t(){return r.TfsContext.getDefault()}n.getDefaultTfsContext=t}(f=t.TfsMentionHelpers||(t.TfsMentionHelpers={}));t.eventHasPrintableCharacter=w;window.TfsMentionHelpers=f});

var __assign=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n};define("Mention/Scripts/TFS.Social.Telemetry",["require","exports","Mention/Scripts/TFS.Mention.Helpers","VSS/Telemetry/Services","VSS/VSS"],function(n,t,i,r,u){var f,e;Object.defineProperty(t,"__esModule",{value:!0});f=function(){function n(){}return n.MENTION_AREA="Mention",n.WORKITEMS_INITIALIZE_EVENT="WorkitemsInitialize",n.WORKITEMS_CLICK_EVENT="WorkitemsClick",n.PEOPLE_CLICK_EVENT="PeopleClick",n.AUTOCOMPLETE_OPEN_EVENT="AutocompleteOpen",n.AUTOCOMPLETE_SUGGEST_EVENT="AutocompleteSuggest",n.AUTOCOMPLETE_SELECT_EVENT="AutocompleteSelect",n.AUTOCOMPLETE_CANCEL_EVENT="AutocompleteCancel",n.MENTIONABLE_PREVIEW_EVENT="MentionablePreview",n.MENTIONABLE_EDIT_EVENT="MentionableEdit",n.WORKITEMPROVIDER_SEARCHONSERVER_EVENT="WorkItemProvider.SearchOnServer",n.SOCIAL_AREA="Social",n.DISCUSSION_RENDER_EVENT="DiscussionRender",n.DISCUSSION_SHOWMORE_EVENT="DiscussionShowMore",n.MATERIALIZE_IDENTITY="MaterializeIdentity",n.MATERIALIZE_IDENTITY_ERROR="MaterializeIdentityError",n}();t.CustomerIntelligenceConstants=f;e=function(){function n(){}return n.publishAutocompleteOpenEvent=function(t){n.delayedPublish(f.AUTOCOMPLETE_OPEN_EVENT,t)},n.publishAutocompleteSuggestEvent=function(t){n.delayedPublish(f.AUTOCOMPLETE_SUGGEST_EVENT,t)},n.publishAutocompleteSelectEvent=function(t){var i=t.identity?n._sanitizeIdentityEvent({identity:t.identity}):{identity:undefined};n.delayedPublish(f.AUTOCOMPLETE_SELECT_EVENT,__assign({},t,{identity:i.identity}))},n.publishAutocompleteCancelEvent=function(t){n.delayedPublish(f.AUTOCOMPLETE_CANCEL_EVENT,t)},n.publishWorkItemsInitializeEvent=function(t){n.delayedPublish(f.WORKITEMS_INITIALIZE_EVENT,t)},n.publishWorkItemsClickEvent=function(t){n.delayedPublish(f.WORKITEMS_CLICK_EVENT,t)},n.publishPeopleClickEvent=function(t,i){var r=n._sanitizeIdentityEvent(t);n.delayedPublish(f.PEOPLE_CLICK_EVENT,$.extend({},r,i))},n.publishMentionableEditEvent=function(t){n.delayedPublish(f.MENTIONABLE_EDIT_EVENT,t)},n.publishMentionablePreviewEvent=function(t){n.delayedPublish(f.MENTIONABLE_PREVIEW_EVENT,t)},n.publishDiscussionRenderEvent=function(t){n.delayedPublish(f.DISCUSSION_RENDER_EVENT,t,f.SOCIAL_AREA)},n.publishDiscussionShowMoreClickEvent=function(t){n.delayedPublish(f.DISCUSSION_SHOWMORE_EVENT,t,f.SOCIAL_AREA)},n.publishMaterializeIdentityEvent=function(t){var i=n._sanitizeIdentityEvent(t);n.delayedPublish(f.MATERIALIZE_IDENTITY,i)},n.publishMaterializeIdentityError=function(t){var i=n._sanitizeIdentityEvent(t);n.delayedPublish(f.MATERIALIZE_IDENTITY_ERROR,i)},n._sanitizeIdentityEvent=function(n){var t=n.identity,i=n.error;return{identity:{localId:t.localId,entityType:t.entityType,originId:t.originId,originDirectory:t.originDirectory,active:t.active},error:i}},n._getTfsContext=function(){return n.tfsContext||(n.tfsContext=i.getMainTfsContext()),n.tfsContext},n._extendProperties=function(t){var i=n._getTfsContext().navigation.projectId;t=t||{};t.projectId=""+i},n.delayedPublish=function(t,i,u){u===void 0&&(u=f.MENTION_AREA);n._extendProperties(i);r.publishEvent(new r.TelemetryEventData(u,t,i))},n.publish=function(t,i){n._extendProperties(i);r.publishEvent(new r.TelemetryEventData(f.MENTION_AREA,t,i))},n}();t.EventLogging=e;u.tfsModuleLoaded("TFS.Social.Telemetry",t)});

var __extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__assign=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n};define("Mention/Scripts/TFS.Mention.Autocomplete.Controls",["require","exports","q","VSS/Controls","VSS/Utils/Core","Presentation/Scripts/TFS/TFS.Core.Utils","VSS/Utils/UI","Mention/Scripts/TFS.Mention.Helpers","Mention/Scripts/TFS.Social.Telemetry","VSS/Diag","VSS/LoaderPlugins/Css!Mention"],function(n,t,i,r,u,f,e,o,s,h){var c,l,a,v;Object.defineProperty(t,"__esModule",{value:!0}),function(n){function t(n){var t=0,r=n[0],i;return r.selectionStart?t=r.selectionStart:u.documentSelection&&(this.$inputElement.focus(),i=u.documentSelection.createRange(),i.moveStart("character",-this.$inputElement.val().length),t=i.text.length),t}function i(n,t,i){e.SelectionUtils.selectInputText(n,t,i,!1)}function r(n,t,i){var s=$._data(n[0],"events"),c,e,o,u,h,f,r;if(s)for(e=$.grep(t.split(" "),function(n){return!!n}),c={},r=0;r<e.length;r++)o=e[r],u=s[o],c[o]=u?u.length:0;if(i(),s)for(h=0;h<e.length;h++){var o=e[h],u=s[o],l=c[o];if(u&&u.length>l){for(f=[],r=l;r<u.length;r++)f.push(u[r]);for(r=u.length-f.length-1;r>=0;r--)u[r+f.length]=u[r];for(r=0;r<f.length;r++)u[r]=f[r]}}}n.getInputCaretPosition=t;n.setInputSelectionRange=i;n.moveAllAddedEventHandlersToFront=r}(c||(c={}));l=function(){function n(n,t){var r=this;this._instanceId=f.GUIDUtils.newGuid();this._plugins=[];this._sessionActive=!1;this._sessionPluginActive=!1;this._sessionStartTime=null;this._options=n;this._artifactUri=n.artifactUri;var u=this._options.pluginConfigs.filter(function(n){return Boolean(n.factory)}),e=this._options.pluginConfigs.filter(function(n){return Boolean(n.factoryPromise)}),o=e.map(function(n){return n.factoryPromise});this._pluginsPromise=i.allSettled(o).then(function(n){return r._plugins=u.map(function(n){return r._createPlugin(n,t)}),n.forEach(function(n){n.state==="fulfilled"&&n.value?r._plugins.push(r._createPlugin({factory:n.value},t)):h.logError("Failed loading mention plugin: "+n.reason)}),r._plugins})}return n.prototype._createPlugin=function(n,t){var i=this;return n.factory(__assign({select:function(n,t,r){i._sessionPluginActive&&i._pluginSelect(n,t,r)},focus:function(n,t){i._sessionPluginActive&&i._pluginFocus(n,t)},close:function(n,t){i._sessionPluginActive&&i.close(n,t)}},t,n.options))},n.prototype.initialize=function(){var n=this;return this._pluginsPromise.then(function(t){return t.forEach(function(n){n.initialize()}),n._plugins=t,n._options&&n._options.pluginsInitialized&&n._options.pluginsInitialized(),null})},n.prototype.dispose=function(){this._plugins&&(this._plugins.forEach(function(n){n.dispose()}),this._plugins=null)},n.prototype.isActive=function(){return this._sessionActive},n.prototype.getActivePlugin=function(){return this._sessionPluginActive?this._getPlugin():null},n.prototype.updateSession=function(n,t){var u=this._sessionPluginActive?this._sessionPluginIndex:null,o,i,r,e;for(this._sessionPluginActive&&!this._getPlugin().canOpen(t)&&this._pluginClose(n,t),o=this._sessionPluginActive?this._sessionPluginIndex:this._plugins.length,i=null,r=0;r<o;r++)if(e=this._plugins[r].canOpen(t),e){i=r;break}this._sessionPluginActive&&i!==null&&this._pluginClose(n,t);i!==null&&(this._sessionId=f.GUIDUtils.newGuid(),this._sessionStartTime=new Date,this._sessionSuggestionSelected=!1,this._sessionPluginActive=!0,this._sessionPluginIndex=i,this._getPlugin().open(n,t),this._publishTelemetry(s.EventLogging.publishAutocompleteOpenEvent,n,this._getPlugin().getPluginName(),t,{}));u===null||this._sessionPluginActive||this._sessionClose(n,t,u);u===null&&this._sessionPluginActive&&(this._sessionActive=!0,this._options.open&&this._options.open(e))},n.prototype.suggest=function(n,t){var i=this,r,u;this._sessionPluginActive&&(r=this._getPlugin().getPluginName(),u=new Date,this._getPlugin().suggest(n,t).then(function(f){var e=__assign({durationInMSec:""+((new Date).getTime()-u.getTime()),mentionAfrifactContext:i._options.getMentionArtifactContext?i._options.getMentionArtifactContext():undefined},f.telemetry);i._publishTelemetry(s.EventLogging.publishAutocompleteSuggestEvent,n,r,t,e)}))},n.prototype.setLastKeyEvent=function(n){this._lastKeyEvent=n},n.prototype.prefetch=function(){this._pluginsPromise.then(function(n){n.forEach(function(n){n.prefetch()})})},n.prototype.setArtifactUri=function(n){this._artifactUri=n},n.prototype.close=function(n,t){this._sessionPluginActive&&(this._pluginClose(n,t),this._sessionClose(n,t,this._sessionPluginIndex))},n.prototype._getPlugin=function(){return this._plugins[this._sessionPluginIndex]},n.prototype._pluginSelect=function(n,t,i){this._sessionPluginActive&&(this._sessionSuggestionSelected=!0,this._options.select&&this._options.select(t),this._publishTelemetry(s.EventLogging.publishAutocompleteSelectEvent,n,this._getPlugin().getPluginName(),t.getPlainText(),i))},n.prototype._pluginFocus=function(n,t){this._sessionPluginActive&&this._options.focus&&this._options.focus(t)},n.prototype._pluginClose=function(n,t){if(this._sessionPluginActive&&(this._sessionPluginActive=!1,this._getPlugin().close(n,t),!this._sessionSuggestionSelected)){var i=this._plugins[this._sessionPluginIndex].getPluginName();this._publishTelemetry(s.EventLogging.publishAutocompleteCancelEvent,n,i,t,{})}},n.prototype._sessionClose=function(){this._sessionActive&&(this._sessionActive=!1,this._options.close&&this._options.close())},n.prototype._publishTelemetry=function(t,i,r,u,f){for(var o="",e,s;i&&i.type&&!n.REGEX_TELEMETRY_UI_EVENT_TYPES.exec(i.type);)i=i.originalEvent;i&&i.type&&(o+=""+i.type,e=i,e.type==="input"&&!e.keyCode&&this._lastKeyEvent&&(e=this._lastKeyEvent),e.keyCode&&(o+=":"+e.keyCode),e.altKey&&(o+=":alt"),e.ctrlKey&&(o+=":ctrl"));s=$.extend({telemetryVersion:"0.3",artifactUri:this._artifactUri,autocompleteSessionId:this._sessionId,autocompleteSessionStartTime:this._sessionStartTime.toISOString(),time:(new Date).toISOString(),uiEvent:o,pluginName:r},f,this._options.defaultTelemetryProperties);t(s)},n.REGEX_TELEMETRY_UI_EVENT_TYPES=/^(key[a-z]+|input|blur|click)$/i,n}();t.AutocompleteSessionManager=l;a=function(){function n(t,i){this._throttledSuggest=o.throttledDelegate(this,n.AUTOCOMPLETE_DELAY_MSEC,this._suggest);this._sessionManager=new l(t,i)}return n.prototype.initialize=function(){this._sessionManager.initialize()},n.prototype.dispose=function(){this._sessionManager&&(this._sessionManager.dispose(),this._sessionManager=null)},n.prototype.prefetch=function(){this._sessionManager.prefetch()},n.prototype.handleEvent=function(n,t){return n.keyCode&&this._sessionManager.setLastKeyEvent(n),t!=undefined&&(this._sessionManager.updateSession(n,t),this._throttledSuggest(n,t)),this._sessionManager.isActive()?this._sessionManager.getActivePlugin().handle(n):void 0},n.prototype.close=function(n,t){this._sessionManager.close(n,t)},n.prototype.setArtifactUri=function(n){this._sessionManager.setArtifactUri(n)},n.prototype.isActive=function(){return this._sessionManager.isActive()},n.prototype._suggest=function(n,t){this._sessionManager&&this._sessionManager.suggest(n,t)},n.AUTOCOMPLETE_DELAY_MSEC=100,n}();t.AutocompleteManager=a;v=function(n){function t(i,r){var u=n.call(this,i,r)||this;return u._autocompleteManager=t._createAutocompleteManager({artifactUri:u._options.artifactUri,pluginConfigs:u._options.pluginConfigs,open:o.delegate(u,u._sessionOpen),close:o.delegate(u,u._sessionClose),select:o.delegate(u,u._sessionSelect),focus:o.delegate(u,u._sessionFocus),pluginsInitialized:o.delegate(u,u._pluginsInitialized),defaultTelemetryProperties:u._options.defaultTelemetryProperties},{menuContainer:o.delegate(u,u._getMenuContainer),positioningElement:o.delegate(u,u._getPositioningElement),textElement:o.delegate(u,u.getElement)}),u}return __extends(t,n),t._createAutocompleteManager=function(n,t){return new a(n,t)},t.prototype.dispose=function(){n.prototype.dispose.call(this);this._options=null;this._autocompleteManager&&(this._autocompleteManager.dispose(),this._autocompleteManager=null);this.getElement()&&this.getElement().off(t.PASSTHROUGH_EVENT_TYPES)},t.prototype.initialize=function(){var n=this;this._lastValue=this.getElement().val();this._autocompleteManager.initialize();c.moveAllAddedEventHandlersToFront(this.getElement(),t.PASSTHROUGH_EVENT_TYPES,function(){n.getElement().on(t.PASSTHROUGH_EVENT_TYPES,o.delegate(n,n._handleEvent))})},t.prototype.prefetch=function(){this._autocompleteManager.prefetch()},t.prototype.isActive=function(){return this._autocompleteManager.isActive()},t.prototype.runAutocomplete=function(n){var t=jQuery.Event("manual");this._autocompleteManager.handleEvent(t,n)},t.prototype._getMenuContainer=function(){return this.getElement()&&this.getElement().parent()?this.getElement().parent():$(document.body)},t.prototype._getPositioningElement=function(){return this.getElement()},t.prototype._createInputText=function(n,t){var i=c.getInputCaretPosition(this.getElement());return{textBeforeSelection:t.substring(0,i),textInSelection:"",textAfterSelection:t.substring(i)}},t.prototype._handleEvent=function(n){var r,i,u,f;if(!this._suppressInputEvents||n.type!=="input")return(r=undefined,(n.type==="keyup"&&n.keyCode!==e.KeyCode.ENTER&&n.keyCode!==e.KeyCode.TAB||n.type==="input")&&(i=this.getElement().val(),i!=this._lastValue&&(this._lastValue=i,r=this._createInputText(n,i))),u=this._autocompleteManager.isActive(),f=this._autocompleteManager.handleEvent(n,r),u&&t.INTERCEPTED_EVENT_KEYCODES.some(function(t){return t===n.keyCode}))?(n.preventDefault(),n.stopImmediatePropagation(),!1):f},t.prototype._sessionOpen=function(n){this._options.open&&this._options.open(n)},t.prototype._sessionClose=function(){this._options.close&&this._options.close()},t.prototype._sessionSelect=function(n){var t=this;this._setValue(n.getPlainText(),function(){return t._triggerInputEvent()});this._options.select&&this._options.select(n)},t.prototype._sessionFocus=function(n){this._setValue(n.getPlainText())},t.prototype._pluginsInitialized=function(){this._options&&this._options.pluginsInitialized&&this._options.pluginsInitialized()},t.prototype._setValue=function(n,t){this.getElement().val(n.textBeforeSelection+n.textInSelection+n.textAfterSelection);c.setInputSelectionRange(this.getElement(),n.textBeforeSelection.length,n.textBeforeSelection.length+n.textInSelection.length);var i=this.getElement().val();i!==this._lastValue&&(t&&t(),this._lastValue=i)},t.prototype._triggerInputEvent=function(){this._suppressInputEvents=!0;try{this.getElement().trigger("input")}finally{this._suppressInputEvents=!1}},t.PASSTHROUGH_EVENT_TYPES="keyup keydown keypress input focus blur",t.INTERCEPTED_EVENT_KEYCODES=[e.KeyCode.ENTER,e.KeyCode.ESCAPE,e.KeyCode.TAB],t}(r.Enhancement);t.AutocompleteEnhancement=v});

define("Mention/Scripts/TFS.Mention",["require","exports","q","VSS/VSS","VSS/Diag","VSS/Utils/Array","VSS/FeatureAvailability/Services","Presentation/Scripts/TFS/Generated/TFS.Server.WebAccess.Constants"],function(n,t,i,r,u,f,e,o){function p(n,t,i,r){var u,f;return r===void 0&&(r="1.0"),u=h.HTML_MENTION_VERSION_ATTR+h.METADATA_ATTR_SEPARATOR+r,i&&(u+=","+i),f=$("<a>").attr("href",n).attr(h.HTML_MENTION_ATTR_NAME,u).text(t),f[0].outerHTML+"&nbsp;"}var h,y,s,l,a,c,v;Object.defineProperty(t,"__esModule",{value:!0}),function(n){n.PATTERN_WORD_START_SEPARATOR="\\s|^|-|\\.|,|:|;|'|\"|\\(";n.PATTERN_WORD_END_SEPARATOR="\\s|$|\\.|,|:|;|-|' | \"|\\)";n.PATTERN_WORD_SEPARATOR="\\s#";n.METADATA_ATTR_SEPARATOR=":";n.HTML_MENTION_ATTR_NAME="data-vss-mention";n.HTML_MENTION_ID_ATTR="id";n.HTML_MENTION_VERSION_ATTR="version";n.HTML_MENTION_LEGACY_HREF_ATTR="mailto";n.HTML_MENTION_VERSION_10=n.HTML_MENTION_VERSION_ATTR+n.METADATA_ATTR_SEPARATOR+"1.0";n.HTML_MENTION_VERSION_20=n.HTML_MENTION_VERSION_ATTR+n.METADATA_ATTR_SEPARATOR+"2.0";n.HTML_MENTION_ID_ATTR_PREFIX=n.HTML_MENTION_ID_ATTR+n.METADATA_ATTR_SEPARATOR;n.HTML_MENTION_LEGACY_FORMAT_HREF=n.HTML_MENTION_LEGACY_HREF_ATTR+n.METADATA_ATTR_SEPARATOR;n.CODE_BLOCK_REGEX="(```[a-z]*[\\s\\S]*?```)|(<pre>[a-z]*[\\s\\S]*?<\/pre>)|(`[a-z]*[\\s\\S]*?`)";n.IDENTITY_PICKER_CONSUMER_ID="0ca36598-9c44-4a19-a3b1-74960b631990";n.DISCUSSION_MESSAGE_CLASS="discussion-messages-messagecontent"}(h=t.Constants||(t.Constants={})),function(n){n.AUTOCOMPLETE_ID="mention-autocomp-id";n.AUTOCOMPLETE_TITLE="mention-autocomp-title"}(y=t.CssClasses||(t.CssClasses={}));t.createHtmlMention=p,function(n){n[n.Text=0]="Text";n[n.Mention=1]="Mention"}(s=t.TextPartType||(t.TextPartType={}));l=function(){function n(n){n===void 0&&(n=c.getDefault());this._parserFactories=[];this._mentionsRenderer=n;e.FeatureAvailabilityService.isFeatureEnabled(o.FeatureAvailabilityFlags.WebAccessVersionControlPullRequestsMentions,!1)&&this._parserFactories.push(i.Promise(function(n){r.using(["VersionControl/Scripts/Mentions/PullRequestMentionParser"],function(t){n(function(){return t.createParser()})})}));this._MentionTranslatorFactory=i.Promise(function(n){r.using(["Mention/Scripts/TFS.Mention.People","Mention/Scripts/TFS.Mention.People.Registration"],function(t){n(function(){return t.getDisplayNameStorageKeyTranslatorInstance()})})})}return n.getDefault=function(){return n._defaultInstance||(n._defaultInstance=new n),n._defaultInstance},n.prototype.registerParser=function(n){this._parsers?this._parsers.then(function(t){for(var f,r=n(),e=r.getArtifactType(),i=0,u=t;i<u.length;i++)if(f=u[i],f.getArtifactType()===e)throw new Error("Cannot register additional parser of same artifact type after initialization.");return t.push(r),t}):this._parserFactories.push(i.resolve(n))},n.prototype.setMentionTranslationProvider=function(n){this._mentionTranslationProvider||(this._mentionTranslationProvider=n)},n.prototype.getMentionsRenderer=function(){return this._mentionsRenderer},n.prototype.parseCodeBlocksFromText=function(n){for(var t=[],i=new RegExp(h.CODE_BLOCK_REGEX,"ig"),r;r=i.exec(n);)t.push({start:r.index,end:i.lastIndex});return t},n.prototype.parseInput=function(n){this._parsers||(this._parsers=i.allSettled(this._parserFactories).then(function(n){return n.map(function(n){return n.state=="fulfilled"?n.value():null}).filter(function(n){return n!=null})}));var t=this.parseCodeBlocksFromText(n);return this._parsers.then(function(i){var r=[{Text:n,Type:s.Text,StartIndex:0}],u,f;for(u in i)f=i[u],r=$.map(r,function(n){var i=n;return i.Type===s.Mention?n:f.parseMentions(i.Text,i.StartIndex,t)});return r})},n.prototype.renderParts=function(n,t,i){for(var u,e=this,o=$.Deferred(),r=$(),h=0,f=[],c=0;c<t.length;c++)r=r.add("<span>");return u=function(){h++;h===t.length&&(i.parts=f.join(","),o.resolve(r))},t.forEach(function(n,t){if(n.Type===s.Mention){var i=n;f.push(e._mentionsRenderer.getTelemetryMentionSummary(i));e._mentionsRenderer.renderMention($(r[t]),i).then(function(){u(t)},function(){u(t)})}else f.push("text"),$(r[t]).text(n.Text),u(t)}),r.appendTo(n),o.promise()},n.prototype.translateDisplayNamesToStorageKeysOfPersonMentions=function(n){return n&&this._mentionTranslationProvider?this._mentionTranslationProvider.translateDisplayNamesToStorageKeys(n):n},n.prototype.translateStorageKeysToDisplayNamesOfPersonMentions=function(n){var t=this,r=function(){return t._mentionTranslationProvider&&n?t._mentionTranslationProvider.translateStorageKeysToDisplayNames(n):i.resolve(n)};return this._mentionTranslationProvider?r():this._MentionTranslatorFactory.then(function(n){return t._mentionTranslationProvider||(t._mentionTranslationProvider=n()),r()})},n}();t.MentionProcessor=l;a=function(){function n(){}return n.prototype.parseFromText=function(){throw new Error("Not implemented");},n.prototype.getArtifactType=function(){throw new Error("Not implemented");},n.prototype.parseFromUrl=function(){throw new Error("Not implemented");},n.prototype.isInsideIgnoreBlock=function(n,t,i){var r=!1;return n&&n.forEach(function(n){n.start<t&&n.start<i&&n.end>t&&n.end>i&&(r=!0)}),r},n.prototype.parseMentions=function(n,t,i){var f=[],o,u,e,r;if(n){for(o=this.parseFromText(n),u=0,e=0;e<o.length;e++)r=o[e],r.index.start>u&&f.push({Type:s.Text,Text:n.substring(u,r.index.start),StartIndex:t+u}),this.isInsideIgnoreBlock(i,t+r.index.start,t+r.index.end)?f.push({Type:s.Text,Text:n.substring(r.index.start,r.index.end),StartIndex:t+r.index.start}):f.push({Type:s.Mention,Text:n.substring(r.index.start,r.index.end),ArtifactType:this.getArtifactType(),ArtifactId:r.id,StartIndex:t+r.index.start}),u=r.index.end;n.length>u&&f.push({Type:s.Text,Text:n.substring(u,n.length),StartIndex:t+u})}return f},n}();t.ArtifactMentionParser=a;c=function(){function n(){this._rendererFactories=[];this._vcRendererPromise=e.FeatureAvailabilityService.isFeatureEnabled(o.FeatureAvailabilityFlags.WebAccessVersionControlPullRequestsMentions,!1)?i.Promise(function(n){r.using(["VersionControl/Scripts/Mentions/PullRequestMentionRenderer"],function(t){n(t.createRenderer())},function(t){u.logError(t);n(null)})}):i.resolve(null)}return n.getDefault=function(){return n._defaultInstance||(n._defaultInstance=new n),n._defaultInstance},n.prototype.registerProvider=function(n){var i,u,t,r,f;if(this._renderers){for(i=n(),u=i.getArtifactType(),t=0,r=this._renderers;t<r.length;t++)if(f=r[t],f.getArtifactType()===u)throw new Error("Cannot register additional providers of same artifact type after initialization.");this._renderers.push(i)}else this._rendererFactories.push(n)},n.prototype.getRenderer=function(n){var t=this;return this._vcRendererPromise.then(function(i){return t._renderers||(t._renderers=$.map(t._rendererFactories,function(n){return n()}),i&&t._renderers.push(i)),f.first(t._renderers,function(t){return n.ArtifactType===t.getArtifactType()})})},n.prototype.renderMention=function(n,t){return this.getRenderer(t).then(function(i){if(i)return i.renderMention(t,function(t){var i=$(t);return i.appendTo(n),i});throw new Error("No rendering provider found for artifact type");})},n.prototype.getTelemetryMentionSummary=function(n){return this.getRenderer(n).then(function(t){return t?t.getTelemetryMentionSummary(n):null})},n}();t.MentionsRenderer=c;v=function(){function n(n,t,i){this._artifactsLoader=n;this._queueWaitMSec=t;this._maxBatchSize=i;this._cache={};this._queue=[];this._keyPoppedFromQueue={}}return n.prototype.getArtifactPromise=function(n){var t,r;return typeof this._cache[n]!="undefined"?t=this._cache[n]:(r=i.defer(),t=r.promise,this._cache[n]=t,this._queue.push({key:n,deferred:r}),this._keyPoppedFromQueue[n]=!1,this._delayProcessQueue(n)),t},n.prototype._delayProcessQueue=function(n){var t=this;setTimeout(function(){return t._processQueue(n)},this._queueWaitMSec)},n.prototype._processQueue=function(n){var t,i,r;if(!this._keyPoppedFromQueue[n])while(this._queue.length>0){for(i=this._maxBatchSize,this._queue.length<=i?(t=this._queue,this._queue=[]):(t=this._queue.slice(0,i),this._queue=this._queue.slice(i)),r=0;r<t.length;r++)this._keyPoppedFromQueue[t[r].key]=!0;this._processBatch(t)}},n.prototype._processBatch=function(n){var i=n.map(function(n){return n.key}),t=this._artifactsLoader(i);n.forEach(function(n){if(t.hasOwnProperty(n.key)){var i=t[n.key];i.then(function(t){n.deferred.resolve(t)},function(){n.deferred.reject.apply(n.deferred,arguments)})}else n.deferred.reject(new Error("Artifact was missing from results of batch load."))})},n}();t.ArtifactsCache=v});

define("Mention/Scripts/Resources/TFS.Resources.Mention",["require","exports"],function(require,exports){var e=exports;e.PullRequestText="Pull Request {0}";e.MentionPR="Mention a pull request";e.AutocompleteSearchButtonText="Search";e.WorkItemMentionOptionSelected="{0}. Selected";e.AutocompleteServerError="Error loading suggestions";e.DiscussionMentionWorkItemTip="workitems (#)";e.AutocompleteSuggestionsPlural="Showing {0} suggestions";e.AutocompleteSuggestionsSingular="Showing 1 suggestion";e.AutocompleteTermsOverLimit="Search only supports up to {0} keywords. Refine your criteria.";e.MentionMaterializeErrorDialogTitle="Error";e.AutocompleteNoSuggestions="No suggestions found";e.MentionWorkItem="Mention a work item";e.DiscussionShowMoreRetrievalError="Unable to show more comments";e.GitPullRequestMentionWorkItemDiscussionMessageFormat="Mentioned in {0}";e.AutocompleteLoading="Loading suggestions";e.DiscussionStateTextFormat="({0} of {1})";e.DiscussionMentionPersonTip="people (@)";e.DiscussionUserCommentedTextFormat="commented {0}";e.MentionSomeone="Mention someone";e.DiscussionShowMoreLinkText="Show more";e.MentionMaterializeIdentityFailError="The identity \u003cspan class=\u0027{0}\u0027\u003e@{1}\u003c/span\u003e could not be added to VSTS and will not receive the e-mail notification.\u003cbr\u003ePlease remove the user and retry the mention.";});

// Copyright (C) Microsoft Corporation. All rights reserved.
define("Mention/Scripts/TFS.Mention.Autocomplete.JQueryAutocomplete",["require","exports","VSS/Utils/Accessibility","VSS/Diag","VSS/Utils/UI","VSS/Utils/String","Mention/Scripts/TFS.Mention.Helpers","Mention/Scripts/Resources/TFS.Resources.Mention","VSS/Utils/Core","jQueryUI/autocomplete"],function(n,t,i,r,u,f,e,o,s){var l,c,h,a;Object.defineProperty(t,"__esModule",{value:!0}),function(n){function t(n,i){var r=null,u;return n&&(u=/^key(down|up|press)$/i.test(n.type),u?r=n:n.originalEvent&&i&&i>0&&(r=t(n.originalEvent,i-1))),r}function i(n){return n.textBeforeSelection+n.textInSelection+n.textAfterSelection}n.tryGetKeyboardEvent=t;n.getStringFromInputText=i}(l||(l={})),function(n){n.AUTOCOMPLETE_CONTAINER="mention-autocomplete-container";n.AUTOCOMPLETE_FOOTER="mention-autocomplete-footer";n.AUTOCOMPLETE_FOOTER_CONTENTS="mention-autocomplete-footer-contents";n.HIGHLIGHT="mention-autocomplete-highlight";n.AUTOCOMPLETE_NO_ITEMS_FOUND="mention-autocomplete-no-items";n.AUTOCOMPLETE_FOOTER_LOADING="mention-autocomplete-loading"}(c=t.CssClasses||(t.CssClasses={})),function(n){n[n.Suggestion=0]="Suggestion";n[n.Error=1]="Error";n[n.Empty=2]="Empty";n[n.Loading=3]="Loading"}(h||(h={}));a=function(){function n(n){this._isOpen=!1;this._options=n}return n.prototype.initialize=function(){var t=this,n;this._$inputElement=$("<input>").autocomplete({appendTo:this._getMenuContainer(),autoFocus:!0,source:e.delegate(this,this._autocompleteOnSource),select:e.delegate(this,this._autocompleteOnSelect),focus:e.delegate(this,this._autocompleteOnFocus),open:e.delegate(this,this._autocompleteOnOpen),close:e.delegate(this,this._autocompleteOnClose),messages:{noResults:"",results:function(){return""}}});this._$inputElement.on("keydown keypress",function(n){e.eventHasPrintableCharacter(n)||(n.keyCode===u.KeyCode.UP||n.keyCode===u.KeyCode.DOWN||n.keyCode===u.KeyCode.PAGE_UP||n.keyCode===u.KeyCode.PAGE_DOWN)&&t._handleAutocompleteReset(n)});this._$menuContainer.on("mousewheel",function(n){n.stopPropagation()});n=this._getAutocompleteInstance();n._resizeMenu=e.delegate(this,this._autocompleteResizeMenu);n._renderMenu=e.delegate(this,this._autocompleteRenderMenu);n._renderItem=e.delegate(this,this._autocompleteRenderItem)},n.prototype.__test=function(){return{_$footer:this._$footer}},n.prototype.prefetch=function(){},n.prototype.getPluginName=function(){throw new Error("Not implemented");},n.prototype.canOpen=function(){throw new Error("Not implemented");},n.prototype.getSuggestions=function(){throw new Error("Not Implemented");},n.prototype.renderSuggestion=function(){throw new Error("Not Implemented");},n.prototype.getReplacementText=function(){throw new Error("Not Implemented");},n.prototype.getReplacementHtml=function(){throw new Error("Not Implemented");},n.prototype.afterRender=function(){},n.prototype.onClose=function(){},n.prototype.dispose=function(){this._$inputElement&&(this._$inputElement.autocomplete("destroy"),this._$inputElement.remove(),this._$inputElement=null);this._$menuContainer&&(this._$menuContainer.remove(),this._$menuContainer=null);this._options=null},n.prototype.getOptions=function(){return this._options},n.prototype.open=function(n,t){this._inputText=t;this._isOpen=!0},n.prototype.suggest=function(n,t){var i=$.Deferred();return this._inputText=t,this._$inputElement.val(l.getStringFromInputText(t)),this._$inputElement.autocomplete("search",i,n),i},n.prototype.close=function(n,t){this._inputText=t;this._$inputElement.autocomplete("close",n);this._isOpen=!1},n.prototype.handle=function(n){this._$inputElement.trigger(n)},n.prototype.isOpen=function(){return this._isOpen},n.prototype._getMenuContainer=function(){if(!this._$menuContainer){var n=this._options.menuContainer().length?this._options.menuContainer():$(document.body);this._$menuContainer=$("<div>").addClass(c.AUTOCOMPLETE_CONTAINER).appendTo(n)}return this._$menuContainer},n.prototype._getMenuMaxHeight=function(){return this._options.menuMaxHeight||n.DEFAULT_MENU_MAX_HEIGHT},n.prototype._getAutocompleteInstance=function(){return this._$inputElement.data("ui-autocomplete")},n.prototype._applySuggestionToTextBox=function(n,t,i){var f=this,e={selectionIndex:""+t.index},r=this.getReplacementText(this._inputText,t.suggestion,i),u;this._$inputElement.val(l.getStringFromInputText(r));u={getPlainText:function(){return r},getHtml:function(){return f.getReplacementHtml(t.suggestion)}};i?this._options.focus&&this._options.focus(n,u):(this._inputText=r,this._options.select&&this._options.select(n,u,e))},n.prototype._handleAutocompleteReset=function(n){var r=l.getStringFromInputText(this._inputText),u=this._$inputElement.val(),t,i;u===r&&this._options.focus&&(t=this._inputText,i={getPlainText:function(){return t},getHtml:function(){return""}},this._options.focus(n,i))},n.prototype._getMentionTextArea=function(){return this._options.textElement?this._options.textElement():null},n.prototype._autocompleteResizeMenu=function(){var r=this,t=$(this._getAutocompleteInstance().menu.element),i=this._options.positioningElement?typeof this._options.positioningElement=="function"?this._options.positioningElement():this._options.positioningElement:this._getMenuContainer(),p=this._options.isMenuWidthOverridable&&this._options.menuWidth?this._options.menuWidth:i.innerWidth(),u,f,s;t.width(p);u=$(">:first:visible",t);f=Math.max(i.zIndex()*1+1,n.MIN_MENU_ZINDEX);t.css("z-index",f);var h=i.offset(),c=h.top-$(window).scrollTop(),w=$(window).height()-c-i.outerHeight(!1)-n.MENU_FOOTER_HEIGHT,e=c>this._getMenuMaxHeight()&&this._getMenuMaxHeight()>w,o=0;if(this._options.allowHorizontalShift){var b=h.left-$(window).scrollLeft(),l=$(window).width()-b,a=t.outerWidth();o=a<l?0:a-l}if(s=function(o){$(this).css(o);r._$footer.css("z-index",f);r._$footer.width(t.width());r._$footer.height(n.MENU_FOOTER_HEIGHT);r._$footer.show();u.length>0?r._$footer.position({my:"left top-1",at:"left bottom",collision:"none",of:t}):r._$footer.position({my:"left "+(e?"bottom":"top"),at:"left "+(e?"top":"bottom"),collision:"none",of:i})},e?this._$inputElement.autocomplete({position:{my:"left bottom",at:"left-"+o+" top-"+n.MENU_FOOTER_HEIGHT,collision:"none",of:i,using:s}}):this._$inputElement.autocomplete({position:{my:"left top",at:"left-"+o+" bottom",collision:"none",of:i,using:s}}),u.length>0){var k=u.position().top,v=$(">:last:visible",t),d=v.position().top+v.outerHeight(),y=d-k,g=y<=this._getMenuMaxHeight()?y:this._getMenuMaxHeight();t.height(g);this.afterRender(t);t.css("max-height","").css("overflow","")}else t.css("max-height",0).css("overflow","hidden")},n.prototype._renderFooter=function(n,t){return this._$footer||(this._$footer=$("<div>").addClass(c.AUTOCOMPLETE_FOOTER),t&&this._$footer.addClass(t),this._$footer.appendTo(this._$menuContainer).hide()),this._$footer.attr("class",c.AUTOCOMPLETE_FOOTER),t&&this._$footer.addClass(t),i.announce(n,!0),this._$footer.text(n)},n.prototype._autocompleteRenderMenu=function(n,t){var i=this._getAutocompleteInstance();n.addClass("mention-autocomplete-menu").attr("role","listbox");t[0].type===h.Suggestion?(t.forEach(function(t){i._renderItemData(n,t)}),this._renderFooter(this._getFooterItemsCountString(t.length),c.AUTOCOMPLETE_FOOTER_CONTENTS)):(this._addFakeAnchor(n,t[0]),t[0].type===h.Loading?this._renderFooter(o.AutocompleteLoading,c.AUTOCOMPLETE_FOOTER_LOADING):t[0].type===h.Empty?this._renderFooter(o.AutocompleteNoSuggestions,c.AUTOCOMPLETE_NO_ITEMS_FOUND):t[0].type===h.Error&&this._renderFooter(o.AutocompleteServerError))},n.prototype._getFooterItemsCountString=function(n){if(n===0)return o.AutocompleteNoSuggestions;var t=n===1?o.AutocompleteSuggestionsSingular:o.AutocompleteSuggestionsPlural;return f.format(t,n)},n.prototype._addFakeAnchor=function(n,t){var i=$("<li>").hide().appendTo(n).data("ui-autocomplete-item",t);$("<a>").appendTo(i)},n.prototype._autocompleteRenderItem=function(n,t){return this.renderSuggestion(n,t.suggestion).addClass("mention-autocomplete-item").attr("role","option").attr("aria-selected","false")},n.prototype._autocompleteOnSource=function(t,i){var r=t.term,u;if(r&&r.resolve||(r=null),!this._isOpen){this._getAutocompleteInstance().close();i(null);return}u=!1;this.getSuggestions(this._inputText).done(function(n){var f,t;u=!0;n?(f=n.result&&n.result.length?n.result.map(function(n,t){return{type:h.Suggestion,index:t,suggestion:n,error:null}}):[{type:h.Empty,index:null,suggestion:null,error:null}],r&&r.resolve(n),i(f)):(t=new Error("Suggestions is Null"),r&&r.reject(t),i([{type:h.Error,index:null,suggestion:null,error:t}]))}).fail(function(n){u=!0;r&&r.reject(n);i([{type:h.Error,index:null,suggestion:null,error:n}])});setTimeout(function(){u||i([{type:h.Loading,index:null,suggestion:null,error:null}])},n.LOADING_DELAY_TIME)},n.prototype._autocompleteOnFocus=function(n,t){var f=this,i,r,u;return t.item.type===h.Suggestion&&(this._applySuggestionToTextBox(n,t.item,!0),t.item.value=this._$inputElement.val(),$(".ui-helper-hidden-accessible").hide().attr("aria-live","off")),i=this._$menuContainer.find("ul"),i&&i.length&&(r=this._getMentionTextArea(),u=i.find(".mention-autocomplete-item"),u.each(function(n,t){var i=$(t);i.hasClass("ui-state-focus")?(i.attr("aria-selected","true"),r&&s.delay(f,0,function(){r.attr("aria-activedescendant",i.attr("id"))})):i.attr("aria-selected","false")})),!1},n.prototype._autocompleteOnSelect=function(n,t){return t.item.type===h.Suggestion&&this._applySuggestionToTextBox(n,t.item,!1),!1},n.prototype._autocompleteOnOpen=function(){var n=this._getMentionTextArea(),t=$(this._getAutocompleteInstance().menu.element),i;n&&t&&t.length&&(i=n.length&&n[0].tagName==="DIV",n.attr({"aria-owns":t[0].id,"aria-expanded":i?null:"true","aria-autocomplete":"list"}))},n.prototype._autocompleteOnClose=function(n){var r=$(this._getAutocompleteInstance().menu.element),i,t,f;if(r)this.onClose(r);this._$footer.hide();i=l.tryGetKeyboardEvent(n,5);i&&i.keyCode===u.KeyCode.ESCAPE&&this._handleAutocompleteReset(n);this._options.close&&this._options.close(n,this._inputText);t=this._getMentionTextArea();t&&(f=t.length&&t[0].tagName==="DIV",t.attr({"aria-owns":null,"aria-autocomplete":null,"aria-activedescendant":null,"aria-expanded":f?null:"false"}))},n.MENU_FOOTER_HEIGHT=20,n.DEFAULT_MENU_MAX_HEIGHT=200,n.LOADING_DELAY_TIME=100,n.MIN_MENU_ZINDEX=100,n}();t.JQueryAutocompletePlugin=a});

define("Presentation/Scripts/TFS/FeatureRef/WorkItemTypeColorAndIconsProvider",["require","exports","VSS/Diag","VSS/Service","VSS/Contributions/Services","VSS/Error","Presentation/Scripts/TFS/TFS.Host.TfsContext","TFS/WorkItemTracking/RestClient","Presentation/Scripts/TFS/Generated/TFS.WorkItemTracking.Constants"],function(n,t,i,r,u,f,e,o,s){function h(n){return n=n||"",n.trim().toLowerCase()}var c,l;Object.defineProperty(t,"__esModule",{value:!0});t.getNormalizedValue=h;c=function(){function n(){this._items={}}return n.getDefault=function(){return{color:n.DEFAULT_WORKITEMTYPE_COLOR,icon:n.DEFAULT_WORKITEMTYPE_BOWTIE_ICON}},n.prototype.setColorAndIcon=function(t,i,r){var u=h(t);return this._items[u]={color:n.transformColor(i),icon:n.transformIcon(r)},this._items[u]},n.prototype.getColorAndIcon=function(t){var i=h(t);return this._items[i]||n.getDefault()},n.transformColor=function(t){return t?"#"+t.substr(t.length-6):n.DEFAULT_WORKITEMTYPE_COLOR},n.transformIcon=function(t){return(t=h(t),!t||!n.ICON_NAME_MAPPINGS[t])?n.DEFAULT_WORKITEMTYPE_BOWTIE_ICON:n.ICON_NAME_MAPPINGS[t]},n.ICON_NAME_MAPPINGS={icon_crown:"bowtie-symbol-crown",icon_trophy:"bowtie-symbol-trophy",icon_list:"bowtie-symbol-list",icon_book:"bowtie-symbol-book",icon_sticky_note:"bowtie-symbol-stickynote",icon_clipboard:"bowtie-symbol-task",icon_insect:"bowtie-symbol-bug",icon_traffic_cone:"bowtie-symbol-impediment",icon_chat_bubble:"bowtie-symbol-review",icon_flame:"bowtie-symbol-flame",icon_megaphone:"bowtie-symbol-ask",icon_test_plan:"bowtie-test-plan",icon_test_suite:"bowtie-test-suite",icon_test_case:"bowtie-test-case",icon_test_step:"bowtie-test-step",icon_test_parameter:"bowtie-test-parameter",icon_code_review:"bowtie-symbol-review-request",icon_code_response:"bowtie-symbol-review-response",icon_review:"bowtie-symbol-feedback-request",icon_response:"bowtie-symbol-feedback-response",icon_ribbon:"bowtie-symbol-ribbon",icon_chart:"bowtie-symbol-finance",icon_headphone:"bowtie-symbol-headphone",icon_key:"bowtie-symbol-key",icon_airplane:"bowtie-symbol-airplane",icon_car:"bowtie-symbol-car",icon_diamond:"bowtie-symbol-diamond",icon_asterisk:"bowtie-symbol-asterisk",icon_database_storage:"bowtie-symbol-storage-database",icon_government:"bowtie-symbol-government",icon_gavel:"bowtie-symbol-decision",icon_parachute:"bowtie-symbol-parachute",icon_paint_brush:"bowtie-symbol-paint-brush",icon_palette:"bowtie-symbol-color-palette",icon_gear:"bowtie-settings-gear",icon_check_box:"bowtie-status-success-box",icon_gift:"bowtie-package-fill",icon_test_beaker:"bowtie-test-fill",icon_broken_lightbulb:"bowtie-symbol-defect",icon_clipboard_issue:"bowtie-symbol-issue"},n.DEFAULT_UNPARENTED_WORKITEM_COLOR="#A6A6A6",n.DEFAULT_UNPARENTED_WORKITEM_BOWTIE_ICON="bowtie-square",n.DEFAULT_WORKITEMTYPE_COLOR_HEX="009CCC",n.DEFAULT_WORKITEMTYPE_COLOR="#"+n.DEFAULT_WORKITEMTYPE_COLOR_HEX,n.DEFAULT_WORKITEMTYPE_ICON=s.WorkItemTypeIcons.DefaultWorkItemTypeIconName,n.DEFAULT_WORKITEMTYPE_BOWTIE_ICON=n.ICON_NAME_MAPPINGS[n.DEFAULT_WORKITEMTYPE_ICON],n}();t.WorkItemTypeColorAndIcons=c;l=function(){function n(){this._cachedPromises={};this._projectToColorAndIconsMap={};this._restClient=o.getClient()}return n.getInstance=function(){return n._instance||(n._instance=this._getDataProvider()),n._instance},n.prototype.isPopulated=function(n){return n?(n=h(n),this._projectToColorAndIconsMap.hasOwnProperty(n)):!1},n.prototype.getColorAndIcon=function(n,t){return n&&t&&(n=h(n),this._projectToColorAndIconsMap[n])?this._projectToColorAndIconsMap[n].getColorAndIcon(t):c.getDefault()},n.prototype.getColor=function(n,t){return this.getColorAndIcon(n,t).color},n.prototype.ensureColorAndIconsArePopulated=function(n){var s=this,u,e,o,t,r;for(n||i.Debug.fail("EnsureWorkItemTypeColors - parameter 'projects' cannot be null or undefined"),u={},e=0,o=n;e<o.length;e++)t=o[e],t=h(t),u.hasOwnProperty(t)||this.isPopulated(t)||(u[t]=null);return(r=Object.keys(u),r.length===0)?Promise.resolve():r.length===1?this._fetchWorkItemTypeColorAndIcons(r[0]):this._restClient.getWorkItemTypeColorAndIcons(r).then(function(n){for(var r,t=0,i=n;t<i.length;t++)r=i[t],s._setColors(r.key,r.value)},function(n){return f.publishErrorToTelemetry(n)})},n.prototype.getColorAndIconAsync=function(n,t){var r=this;return(i.Debug.assertIsNotNull(n,"WorkItemTypeColorAndIconsProvider - 'getColorAndIconAsync' projectName cannot be null/undefined"),this.isPopulated(n))?Promise.resolve(this.getColorAndIcon(n,t)):this.queueEnsureColorAndIconsArePopulated(n).then(function(){return r.getColorAndIcon(n,t)})},n.prototype.getColorAsync=function(n,t){return i.Debug.assertIsNotNull(n,"WorkItemTypeColorAndIconsProvider - 'getColorAsync' projectName cannot be null/undefined"),this.getColorAndIconAsync(n,t).then(function(n){return n.color})},n.prototype.queueEnsureColorAndIconsArePopulated=function(n){var t=this;return i.Debug.assertIsNotNull(n,"WorkItemTypeColorAndIconsProvider - 'queueEnsureColorAndIconsArePopulated' projectName cannot be null/undefined"),n=h(n),this._cachedPromises[n]?this._cachedPromises[n]:(this._cachedPromises[n]=this.ensureColorAndIconsArePopulated([n]),this._cachedPromises[n].then(function(){delete t._cachedPromises[n]},function(i){delete t._cachedPromises[n];f.publishErrorToTelemetry(i)}))},n.prototype._setColors=function(n,t){for(var i,u=new c,r=0,f=t;r<f.length;r++)i=f[r],u.setColorAndIcon(i.workItemTypeName,i.color,i.icon);n=h(n);this._projectToColorAndIconsMap[n]=u},n._getDataProvider=function(){var t=e.TfsContext.getDefault().contextData.project,o=r.getService(u.WebPageDataService),i=new n,f=o.getPageData("ms.vss-work-web.work-item-type-color-icon-data-provider");return t&&f&&i._setColors(t.name,f),i},n.prototype._fetchWorkItemTypeColorAndIcons=function(t){var i=this;return this._restClient.getWorkItemTypes(t).then(function(r){if(!r)throw new Error("WorkItemTypeColorAndIconsProvider - '_restClient.getWorkItemTypes' returned undefined workItemTypes for project '"+t+"'");i._setColors(t,r.map(function(i){if(!i)throw new Error("WorkItemTypeColorAndIconsProvider - '_restClient.getWorkItemTypes' returned a null type for project '"+t+"'");return n._toWorkItemTypeColorAndIcon(i)}))},function(n){return f.publishErrorToTelemetry(n)}).then(function(){},function(n){return f.publishErrorToTelemetry(n)})},n._toWorkItemTypeColorAndIcon=function(n){var i=n.color,t=n.icon,r=n.name;return{color:i,icon:t&&t.id,workItemTypeName:r}},n}();t.WorkItemTypeColorAndIconsProvider=l});

define("Presentation/Scripts/TFS/Components/WorkItemTypeIcon",["require","exports","react","react-dom","Presentation/Scripts/TFS/FeatureRef/WorkItemTypeColorAndIconsProvider","VSS/Telemetry/Services","OfficeFabric/Utilities","VSSUI/Tooltip","VSS/LoaderPlugins/Css!Presentation/Components/WorkItemTypeIcon"],function(n,t,i,r,u,f,e,o){function l(n,t,u,f){var e=typeof u!="string",o={workItemTypeName:t,projectName:e?null:u,customInput:e?u:null,iconAccessibilityOptions:f},c=h(n,!0);r.render(i.createElement(s,__assign({},o)),c)}function a(n){var t=h(n,!1);t&&(r.unmountComponentAtNode(t),n.removeChild(t))}function h(n,t){var r="work-item-type-icon-host",u=n.getElementsByClassName(r),i;return u.length>0?u[0]:t?(i=document.createElement("span"),i.classList.add(r),n.appendChild(i),i):undefined}var s,c;Object.defineProperty(t,"__esModule",{value:!0});s=function(n){function t(t){var i=n.call(this,t)||this;return i._isMounted=!1,i.state=i._getState(i.props),i}return __extends(t,n),t.prototype.render=function(){var h=!this.props.customInput&&this._isProjectAndWorkItemTypeNullOrEmpty();h&&c.publishEvent(__assign({},this.props,{insufficientInput:h}));var l=this.state?this.state.icon:null,a=this.state?this.state.color:u.WorkItemTypeColorAndIcons.DEFAULT_WORKITEMTYPE_COLOR,n=this.props.iconAccessibilityOptions,r=null,f=null,t=!n||!n.suppressTooltip;t&&(r=n&&n.tooltip||this.props.workItemTypeName,f=e.getId("work-item-type-icon-tooltip"));var v=n&&n.ariaAttributes?n.ariaAttributes.label:r||this.props.workItemTypeName,w=n&&n.ariaAttributes?n.ariaAttributes.describedby:f,y=n&&n.ariaAttributes?n.ariaAttributes.labelledby:null,p=e.css("work-item-type-icon bowtie-icon",l,{"work-item-type-icon-no-tooltip":!t},!t&&this.props.className),s=i.createElement("i",{"aria-label":v,"aria-labelledby":y,className:p,style:{color:a}});return s&&t?i.createElement(o.TooltipHost,{hostClassName:e.css("work-item-type-icon-wrapper",this.props.className),content:r,id:f},s):s},t.prototype.componentDidMount=function(){this._isMounted=!0},t.prototype.componentWillUnmount=function(){this._isMounted=!1},t.prototype.componentWillReceiveProps=function(n){var t=this._getState(n);t&&(!this.state||t.color!==this.state.color||t.icon!==this.state.icon)&&this.setState(t)},t.prototype._getState=function(n){var i=this,t;return n.customInput?{color:n.customInput.color?n.customInput.color:u.WorkItemTypeColorAndIcons.DEFAULT_WORKITEMTYPE_COLOR,icon:n.customInput.icon?n.customInput.icon:u.WorkItemTypeColorAndIcons.DEFAULT_WORKITEMTYPE_BOWTIE_ICON}:this._isProjectAndWorkItemTypeNullOrEmpty()?u.WorkItemTypeColorAndIcons.getDefault():(t=u.WorkItemTypeColorAndIconsProvider.getInstance(),t.isPopulated(n.projectName)?t.getColorAndIcon(n.projectName,n.workItemTypeName):(t.getColorAndIconAsync(n.projectName,n.workItemTypeName).then(function(n){i._isMounted&&i.setState(n)}),null))},t.prototype._isProjectAndWorkItemTypeNullOrEmpty=function(){return!(this.props.projectName&&this.props.workItemTypeName)},t}(i.Component);t.WorkItemTypeIcon=s;t.renderWorkItemTypeIcon=l;t.unmountWorkItemTypeIcon=a;c=function(){function n(){}return n.publishEvent=function(t,i){f.publishEvent(new f.TelemetryEventData("WIT",n._featureName,__assign({},t,{action:n._featureAction})),i)},n._featureAction="Render",n._featureName="WorkItemTypeIcon",n}()});

define("Mention/Scripts/WorkItemTypeIcon.JQuery",["require","exports","Presentation/Scripts/TFS/Components/WorkItemTypeIcon"],function(n,t,i){function r(n,t,r,u){i.renderWorkItemTypeIcon(n,t,r,u);var f=$(n),e=f.children().first().clone();i.unmountWorkItemTypeIcon(n);e.appendTo(f)}Object.defineProperty(t,"__esModule",{value:!0});t.renderWorkItemTypeIcon=r});

define("Mention/Scripts/WorkItem/WorkItemMentionUtilities",["require","exports","VSS/Utils/String","Mention/Scripts/TFS.Mention.Helpers","Mention/Scripts/TFS.Mention","Mention/Scripts/TFS.Mention.Autocomplete.JQueryAutocomplete"],function(n,t,i,r,u,f){function e(n,t){return n.split(/\s+/).filter(function(n){return!!n}).map(function(n){return t?i.htmlEncode(n):n})}function l(n,u,f){f===void 0&&(f=t.DEFAULT_HIGHLIGHT_SUBSTITUTION_PATTERN);var o=e(n,!0),s=r.searchString(u.id.toString(),o,r.SearchBehavior.Prefix,f),h=r.searchString(i.htmlEncode(u.title),o,r.SearchBehavior.Contains,f),c=r.searchString(u.workItemType,o,r.SearchBehavior.Contains,f),l=!0;return o.forEach(function(n){var t=s.found[n]||h.found[n]||c.found[n];t||(l=!1)}),l?{id:s.highlightedSource,title:h.highlightedSource,workItemType:c.highlightedSource}:u}function o(n,t){return n+" "+t}function s(n,t){return n+": "+t}function a(n){return"#"+n}function v(n,i){return n?i?t.InfiniteTermsMentionPattern:t.MultipleTermsMentionPattern:t.SingleTermMentionPattern}function y(n,t,i){var r=h(t),f=o(n,t),e=s(f,i);return u.createHtmlMention(r,e)}function h(n){var t=new URI(c(n)),i;return t.host()||(i=r.getWindowLocation(),t.host(i.host),t.protocol(i.protocol)),t.href()}function c(n,i){var u=r.getMainTfsContext();return u.getPublicActionUrl(t.EDIT_ACTION_NAME,t.CONTROLLER_NAME,{parameters:n,project:i||u.navigation.projectId,team:""})}Object.defineProperty(t,"__esModule",{value:!0});t.DEFAULT_HIGHLIGHT_SUBSTITUTION_PATTERN='<span class="'+f.CssClasses.HIGHLIGHT+'">$&<\/span>';t.NumberMentionPattern=new RegExp("("+u.Constants.PATTERN_WORD_START_SEPARATOR+")#([0-9]*)$","i");t.SingleTermMentionPattern=new RegExp("("+u.Constants.PATTERN_WORD_START_SEPARATOR+")#(([^"+u.Constants.PATTERN_WORD_SEPARATOR+"]*)$)","i");t.MultipleTermsLimit=3;t.MultipleTermsMentionPattern=new RegExp("("+u.Constants.PATTERN_WORD_START_SEPARATOR+")#(([^"+u.Constants.PATTERN_WORD_SEPARATOR+"]+\\s?){0,"+t.MultipleTermsLimit+"}$)","i");t.InfiniteTermsMentionPattern=new RegExp("("+u.Constants.PATTERN_WORD_START_SEPARATOR+")#(([^"+u.Constants.PATTERN_WORD_SEPARATOR+"]+\\s?){0,}$)","i");t.AfterMentionPattern=new RegExp("^("+u.Constants.PATTERN_WORD_END_SEPARATOR+")","i");t.EDIT_ACTION_NAME="edit";t.CONTROLLER_NAME="workitems";t.PatternSplitter=/\s+/;t.getMultiTerms=e;t.searchHighlightedWorkItem=l;t.getWorkItemTypeWithIdString=o;t.getWorkItemSummary=s;t.getWorkItemMentionText=a;t.mentionPattern=v;t.createWorkItemMentionHtml=y;t.getWorkItemHref=h;t.getWorkItemUrl=c});

define("Search.Client/Shared/Search.Shared.Contracts",["require","exports"],function(n,t){"use strict";var i,r,u;Object.defineProperty(t,"__esModule",{value:!0}),function(n){n[n.Ok=0]="Ok";n[n.AccountIsBeingReindexed=1]="AccountIsBeingReindexed";n[n.IndexingNotStarted=2]="IndexingNotStarted";n[n.InvalidRequest=3]="InvalidRequest";n[n.PrefixWildcardQueryNotSupported=4]="PrefixWildcardQueryNotSupported";n[n.MultiWordWithCodeFacetNotSupported=5]="MultiWordWithCodeFacetNotSupported";n[n.AccountIsBeingOnboarded=6]="AccountIsBeingOnboarded";n[n.TakeResultValueTrimmedToMaxResultAllowed=8]="TakeResultValueTrimmedToMaxResultAllowed";n[n.BranchesAreBeingIndexed=9]="BranchesAreBeingIndexed";n[n.FacetingNotEnabledAtScaleUnit=10]="FacetingNotEnabledAtScaleUnit";n[n.WorkItemsNotAccessible=11]="WorkItemsNotAccessible";n[n.EmptyQueryNotSupported=12]="EmptyQueryNotSupported";n[n.OnlyWildcardQueryNotSupported=13]="OnlyWildcardQueryNotSupported";n[n.ZeroResultsWithWildcard=14]="ZeroResultsWithWildcard";n[n.ZeroResultsWithFilter=15]="ZeroResultsWithFilter";n[n.ZeroResultsWithWildcardAndFilter=16]="ZeroResultsWithWildcardAndFilter";n[n.ZeroResultsWithNoWildcardNoFilter=17]="ZeroResultsWithNoWildcardNoFilter";n[n.PartialResultsDueToSearchRequestTimeout=18]="PartialResultsDueToSearchRequestTimeout";n[n.PhraseQueriesWithCEFacetsNotSupported=19]="PhraseQueriesWithCEFacetsNotSupported";n[n.WildcardQueriesWithCEFacetsNotSupported=20]="WildcardQueriesWithCEFacetsNotSupported";n[n.ClearedScrollSearchRequestParam=21]="ClearedScrollSearchRequestParam";n[n.InvalidScrollSearchRequestParam=22]="InvalidScrollSearchRequestParam"}(i=t.InfoCodes||(t.InfoCodes={})),function(n){n[n.Undefined=0]="Undefined";n[n.Ascending=1]="Ascending";n[n.Descending=2]="Descending"}(r=t.SortOrder||(t.SortOrder={})),function(n){n[n.Git=0]="Git";n[n.Tfvc=1]="Tfvc";n[n.Custom=2]="Custom"}(u=t.VersionControlType||(t.VersionControlType={}));t.TypeInfo={InfoCodes:{enumValues:{ok:0,accountIsBeingReindexed:1,indexingNotStarted:2,invalidRequest:3,prefixWildcardQueryNotSupported:4,multiWordWithCodeFacetNotSupported:5,accountIsBeingOnboarded:6,takeResultValueTrimmedToMaxResultAllowed:8,branchesAreBeingIndexed:9,facetingNotEnabledAtScaleUnit:10,workItemsNotAccessible:11,emptyQueryNotSupported:12,onlyWildcardQueryNotSupported:13,zeroResultsWithWildcard:14,zeroResultsWithFilter:15,zeroResultsWithWildcardAndFilter:16,zeroResultsWithNoWildcardNoFilter:17,partialResultsDueToSearchRequestTimeout:18,phraseQueriesWithCEFacetsNotSupported:19,wildcardQueriesWithCEFacetsNotSupported:20,clearedScrollSearchRequestParam:21,invalidScrollSearchRequestParam:22}},Repository:{},SortOrder:{enumValues:{undefined:0,ascending:1,descending:2}},VersionControlType:{enumValues:{git:0,tfvc:1,custom:2}}};t.TypeInfo.Repository.fields={type:{enumType:t.TypeInfo.VersionControlType}}});

define("Search.Client/Contracts",["require","exports","Search.Client/Shared/Search.Shared.Contracts"],function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TypeInfo={CodeResult:{},CodeSearchResponse:{}};t.TypeInfo.CodeResult.fields={repository:{typeInfo:i.TypeInfo.Repository}};t.TypeInfo.CodeSearchResponse.fields={results:{isArray:!0,typeInfo:t.TypeInfo.CodeResult}}});

define("Search.Client/RestClient",["require","exports","Search.Client/Contracts","VSS/Service","VSS/WebApi/RestClient"],function(n,t,i,r,u){"use strict";function k(n){return window.VSS&&window.VSS.VssSDKRestVersion&&w[window.VSS.VssSDKRestVersion]?r.getClient(w[window.VSS.VssSDKRestVersion],undefined,undefined,undefined,n):r.getClient(o,undefined,undefined,undefined,n)}var f,e,o,s,h,c,l,a,v,y,p,b,w;Object.defineProperty(t,"__esModule",{value:!0});f=function(n){function t(t,i){return n.call(this,t,i)||this}return __extends(t,n),t.prototype.fetchWorkItemSearchResults=function(n,t){return this._beginRequest({httpMethod:"POST",area:"search",locationId:"73b2c9e2-ff9e-4447-8cda-5f5b21ff7cae",resource:"workItemSearchResults",routeTemplate:"{project}/_apis/{area}/{resource}",routeValues:{project:t},apiVersion:this.workItemSearchResultsApiVersion,data:n})},t.prototype.fetchWikiSearchResults=function(n,t){return this._beginRequest({httpMethod:"POST",area:"search",locationId:"e90e7664-7049-4100-9a86-66b161d81080",resource:"wikiSearchResults",routeTemplate:"{project}/_apis/{area}/{resource}",routeValues:{project:t},apiVersion:this.wikiSearchResultsApiVersion,data:n})},t.prototype.fetchCodeSearchResults=function(n,t){return this._beginRequest({httpMethod:"POST",area:"search",locationId:"e7f29993-5b82-4fca-9386-f5cfe683d524",resource:"codeSearchResults",routeTemplate:"{project}/_apis/{area}/{resource}",responseType:i.TypeInfo.CodeSearchResponse,routeValues:{project:t},apiVersion:this.codeSearchResultsApiVersion,data:n})},t.prototype.fetchAdvancedCodeSearchResults=function(n,t){return this._beginRequest({httpMethod:"POST",area:"search",locationId:"6bc8d206-9a7e-4cfb-83e1-c9a81e7bf166",resource:"advancedCodeSearchResults",routeTemplate:"{project}/_apis/{area}/{resource}",responseType:i.TypeInfo.CodeSearchResponse,routeValues:{project:t},apiVersion:this.advancedCodeSearchResultsApiVersion,data:n})},t.serviceInstanceId="00000010-0000-8888-8000-000000000000",t}(u.VssHttpClient);t.CommonMethods2To5=f;e=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.advancedCodeSearchResultsApiVersion=r.codeSearchResultsApiVersion=r.wikiSearchResultsApiVersion=r.workItemSearchResultsApiVersion="5.0-preview.1",r}return __extends(t,n),t}(f);t.SearchHttpClient5=e;o=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.advancedCodeSearchResultsApiVersion=r.codeSearchResultsApiVersion=r.wikiSearchResultsApiVersion=r.workItemSearchResultsApiVersion="4.1-preview.1",r}return __extends(t,n),t}(f);t.SearchHttpClient4_1=o;s=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.advancedCodeSearchResultsApiVersion=r.codeSearchResultsApiVersion=r.wikiSearchResultsApiVersion=r.workItemSearchResultsApiVersion="4.0-preview.1",r}return __extends(t,n),t}(f);t.SearchHttpClient4=s;h=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.advancedCodeSearchResultsApiVersion=r.codeSearchResultsApiVersion=r.wikiSearchResultsApiVersion=r.workItemSearchResultsApiVersion="3.2-preview.1",r}return __extends(t,n),t}(f);t.SearchHttpClient3_2=h;c=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.advancedCodeSearchResultsApiVersion=r.codeSearchResultsApiVersion=r.wikiSearchResultsApiVersion=r.workItemSearchResultsApiVersion="3.1-preview.1",r}return __extends(t,n),t}(f);t.SearchHttpClient3_1=c;l=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.advancedCodeSearchResultsApiVersion=r.codeSearchResultsApiVersion=r.wikiSearchResultsApiVersion=r.workItemSearchResultsApiVersion="3.0-preview.1",r}return __extends(t,n),t}(f);t.SearchHttpClient3=l;a=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.advancedCodeSearchResultsApiVersion=r.codeSearchResultsApiVersion=r.wikiSearchResultsApiVersion=r.workItemSearchResultsApiVersion="2.3-preview.1",r}return __extends(t,n),t}(f);t.SearchHttpClient2_3=a;v=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.advancedCodeSearchResultsApiVersion=r.codeSearchResultsApiVersion=r.wikiSearchResultsApiVersion=r.workItemSearchResultsApiVersion="2.2-preview.1",r}return __extends(t,n),t}(f);t.SearchHttpClient2_2=v;y=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.advancedCodeSearchResultsApiVersion=r.codeSearchResultsApiVersion=r.wikiSearchResultsApiVersion=r.workItemSearchResultsApiVersion="2.1-preview.1",r}return __extends(t,n),t}(f);t.SearchHttpClient2_1=y;p=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.advancedCodeSearchResultsApiVersion=r.codeSearchResultsApiVersion=r.wikiSearchResultsApiVersion=r.workItemSearchResultsApiVersion="2.0-preview.1",r}return __extends(t,n),t}(f);t.SearchHttpClient2=p;b=function(n){function t(t,i){return n.call(this,t,i)||this}return __extends(t,n),t}(e);t.SearchHttpClient=b;w={"5.0":e,"4.1":o,"4.0":s,"3.2":h,"3.1":c,"3.0":l,"2.3":a,"2.2":v,"2.1":y,"2.0":p};t.getClient=k});

var __awaiter=this&&this.__awaiter||function(n,t,i,r){return new(i||(i=Promise))(function(u,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?u(n.value):new i(function(t){t(n.value)}).then(o,s)}e((r=r.apply(n,t||[])).next())})},__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(e){if(f)throw new TypeError("Generator is already executing.");while(r)try{if(f=1,u&&(i=u[e[0]&2?"return":e[0]?"throw":"next"])&&!(i=i.call(u,e[1])).done)return i;(u=0,i)&&(e=[0,i.value]);switch(e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(e[0]===6||e[0]===2)){r=0;continue}if(e[0]===3&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(e[0]===6&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(o){e=[6,o];u=0}finally{f=i=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},f,u,i,e;return e={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(e[Symbol.iterator]=function(){return this}),e};define("Mention/Scripts/WorkItem/WorkItemProvider",["require","exports","q","VSS/Diag","VSS/VSS","VSS/Error","VSS/Service","VSS/Utils/String","VSS/Telemetry/Services","VSS/Utils/Array","Mention/Scripts/TFS.Mention.Helpers","Mention/Scripts/TFS.Social.Telemetry","Mention/Scripts/TFS.Mention","TFS/WorkItemTracking/RestClient","Presentation/Scripts/TFS/Generated/TFS.WorkItemTracking.Constants","Presentation/Scripts/TFS/FeatureRef/WorkItemTypeColorAndIconsProvider","TFS/WorkItemTracking/Contracts","Mention/Scripts/WorkItem/WorkItemMentionUtilities","Mention/Scripts/Resources/TFS.Resources.Mention","Presentation/Scripts/TFS/TFS.Host.TfsContext","Search.Client/RestClient","VSS/Contributions/Services","VSS/FeatureAvailability/Services","Presentation/Scripts/TFS/Generated/TFS.Server.WebAccess.Constants"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it){var rt,ut;Object.defineProperty(t,"__esModule",{value:!0});rt=function(){function n(t){var f=this,i,r,u;if(this._isFullTextEnabled=function(){return __awaiter(f,void 0,void 0,function(){var i,n,t,r;return __generator(this,function(u){switch(u.label){case 0:return d.TfsContext.getDefault().isHosted?[2,!0]:[4,v.getClient().getField(y.CoreFieldRefNames.Title)];case 1:for(i=u.sent(),n=0,t=i.supportedOperations;n<t.length;n++)if(r=t[n].referenceName,r==="SupportedOperations.ContainsWords")return[2,!0];return[2,!1]}})})}(),this._client=e.getClient(v.WorkItemTrackingHttpClient,c.getMainTfsContext().contextData),this._wiql=t!=null&&t.wiql!=null?t.wiql:n.DEFAULT_WIQL,this._workItemIdsToIgnore={},t&&t.workItemIdsToIgnore&&t.workItemIdsToIgnore.length>0)for(i=0,r=t.workItemIdsToIgnore;i<r.length;i++)u=r[i],this._workItemIdsToIgnore[u]=!0}return n.getInstance=function(){return n._instance=n._instance||new n},n.prototype.getArtifactType=function(){return"WorkItem"},n.prototype.getById=function(n){var i=parseInt(n),t=this.getWorkItemPromises([i]);if(t.length===1)return t[0];throw new Error("Expected GetWorkItemsByIds to return 1 promise.");},n.prototype.prefetch=function(){if(!this._myWorkItems){var n=(new Date).getTime(),t=$.Deferred(),i=$.Deferred();$.when(t,i).done(function(t,i){l.EventLogging.publishWorkItemsInitializeEvent({getMyAssignedWorkItemsDurationInMsec:(t-n).toString(),getWorkItemColorsProviderDurationInMsec:(i-n).toString()})});this._myWorkItems=this.getMyWorkItems();this._myWorkItems.then(function(){t.resolve((new Date).getTime())});ut.getInstance()._witColorAndIconsProviderPromise.then(function(){i.resolve((new Date).getTime())});this._isWorkItemSearchEnabled()}},n.prototype.searchById=function(n){this.prefetch();var t=$.Deferred(),r=parseInt(n),u=[],f=[],e=function(n,t){h.contains(f,n.id)||(f.push(n.id),u.push({original:n,highlighted:t}))},s=function(t){if(t!==null){var i=void 0;isNaN(r)?(i={id:t.id,projectName:t.projectName,colorAndIcon:t.colorAndIcon,workItemType:t.workItemType,title:o.htmlEncode(t.title)},e(t,i)):(i=b.searchHighlightedWorkItem(n,t),i!==t&&e(t,i))}},c=this.getWorkItems([r]);return i.all([c,this._myWorkItems]).then(function(n){n.forEach(function(n){n.forEach(function(n){s(n)})});t.resolve(u)},function(){t.reject.apply(t,arguments)}),t.promise()},n.prototype._transformWorkItems=function(n,t,i){var u=this,r=[];return t.forEach(function(t){if(!u._workItemIdsToIgnore[t.id]){var f=i?b.searchHighlightedWorkItem(n,t):t;f===t&&i||r.push({original:t,highlighted:f})}}),r},n.prototype.search=function(n){var i=this,t;return this.prefetch(),t=$.Deferred(),this._myWorkItems.then(function(r){var u=i._transformWorkItems(n,r,!0);t.resolve(u)},function(n){t.reject(n)}),t.promise()},n.prototype.searchOnServer=function(n){return __awaiter(this,void 0,void 0,function(){var f,t,e,i,d,r,h,nt,c,rt,a,v,ut,u,ft,et,w,ot,st,ht,ct;return __generator(this,function(lt){switch(lt.label){case 0:return n?(f=50,t=b.getMultiTerms(n,!1),e=t.length>b.MultipleTermsLimit,s.publishEvent(new s.TelemetryEventData(l.CustomerIntelligenceConstants.MENTION_AREA,l.CustomerIntelligenceConstants.WORKITEMPROVIDER_SEARCHONSERVER_EVENT,{termsOverLimit:e,numberOfTerms:t.length})),i=tt.FeatureAvailabilityService.isFeatureEnabled(it.FeatureAvailabilityFlags.MentionWorkItemRestSearch),!i)?[3,2]:[4,this._isWorkItemSearchEnabled()]:[3,10];case 1:i=lt.sent();lt.label=2;case 2:return i?(d={$orderBy:null,$skip:0,$top:f,filters:null,includeFacets:!1,searchText:n},r=function(n){return n.toLowerCase()},[4,g.getClient().fetchWorkItemSearchResults(d)]):[3,5];case 3:return h=lt.sent(),nt=h.results.map(function(n){return n.project.name}),c=p.WorkItemTypeColorAndIconsProvider.getInstance(),[4,c.ensureColorAndIconsArePopulated(nt)];case 4:return lt.sent(),rt=h.results.map(function(n){var t=n.project.name,i=n.fields[r(y.CoreFieldRefNames.WorkItemType)],u=c.getColorAndIcon(t,i);return{id:+n.fields[r(y.CoreFieldRefNames.Id)],title:n.fields[r(y.CoreFieldRefNames.Title)],colorAndIcon:u,projectName:t,workItemType:i}}),[2,this._transformWorkItems(n,rt,!1)];case 5:if(!e)return[3,6];throw new Error(o.localeFormat(k.AutocompleteTermsOverLimit,b.MultipleTermsLimit));case 6:return[4,this._isFullTextEnabled];case 7:return a=lt.sent(),v=a?"CONTAINS WORDS":"CONTAINS",ut=t.map(function(n){return"["+y.CoreFieldRefNames.Title+"] "+v+" '"+n+"'"}),u=ut.join(" AND "),a&&(u="("+u+") OR ["+y.CoreFieldRefNames.Title+"] "+v+" '"+n+"'"),ft=t.filter(function(n){return!isNaN(+n)}),et=ft.map(function(n){return"OR ["+y.CoreFieldRefNames.Id+"] = '"+n+"'"}),w=et.join(" "),ot="ORDER BY ["+y.CoreFieldRefNames.AuthorizedDate+"] DESC",st=""+u+(w?" "+w:"")+" "+ot,[4,this._getWiqlResults(st,f)];case 8:return ht=lt.sent(),ct=this._transformWorkItems(n,ht,!1),[2,ct];case 9:return[3,11];case 10:return[2,[]];case 11:return[2]}})})},n.prototype._isWorkItemSearchEnabled=function(){return __awaiter(this,void 0,void 0,function(){var n=this;return __generator(this,function(t){switch(t.label){case 0:return this._searchEnabledPromise===undefined&&(this._searchEnabledPromise=new Promise(function(t){return __awaiter(n,void 0,void 0,function(){var u,o,n,i,r,s;return __generator(this,function(h){switch(h.label){case 0:u=e.getService(nt.ExtensionService);h.label=1;case 1:return h.trys.push([1,3,,4]),[4,u.getContributions(["ms.vss-search-platform.entity-type-collection"],!1,!0)];case 2:for(o=h.sent(),n=0,i=o;n<i.length;n++)if(r=i[n].id,r==="ms.vss-workitem-search.workitem-entity-type"||r==="ms.vss-workitem-searchonprem.workitem-entity-type")return t(!0),[2];return t(!1),[3,4];case 3:return s=h.sent(),t(!1),f.publishErrorToTelemetry(s),[3,4];case 4:return[2]}})})})),[4,this._searchEnabledPromise];case 1:return[2,t.sent()]}})})},n.isValidWorkItemId=function(n){return n>=1&&n<=2147483647},n.prototype.getMyWorkItems=function(){return this._getWiqlResults(this._wiql,50)},n.prototype.getWorkItems=function(n){if(n.length===0)throw new Error("ids must contain elements.");return i.all(this.getWorkItemPromises(n))},n.prototype.getWorkItemPromises=function(t){return t.map(function(t){return n.isValidWorkItemId(t)?ut.getInstance().cache.getArtifactPromise(t):i(null)})},n.prototype._getWiqlResults=function(n,t){return __awaiter(this,void 0,void 0,function(){var r,u,i,f=this;return __generator(this,function(e){switch(e.label){case 0:return r="SELECT ["+y.CoreFieldRefNames.Id+"] FROM WorkItems WHERE "+n,[4,this._client.queryByWiql({query:r},undefined,undefined,undefined,t)];case 1:return(u=e.sent(),i=u.workItems.map(function(n){return n.id}).filter(function(n){return!f._workItemIdsToIgnore[n]}),i.length===0)?[2,[]]:[2,this.getWorkItems(i)]}})})},n.QUEUE_WAIT_MSEC=10,n.MAX_BATCH_SIZE=50,n.DEFAULT_WIQL="(["+y.CoreFieldRefNames.AuthorizedAs+"] = @me\n                        AND ["+y.CoreFieldRefNames.AuthorizedDate+"] >= @today - 30)\n                    OR (["+y.CoreFieldRefNames.CreatedBy+"] = @me\n                        AND ["+y.CoreFieldRefNames.CreatedDate+"] >= @today - 30)\n                    OR (["+y.CoreFieldRefNames.AssignedTo+"] = @me\n                        AND ["+y.CoreFieldRefNames.AuthorizedDate+"] >= @today - 30)\n                    ORDER BY ["+y.CoreFieldRefNames.AuthorizedDate+"] DESC",n}();t.WorkItemProvider=rt;ut=function(){function n(){var t=this,n;this.cache=new a.ArtifactsCache(function(n){return t._loadWorkItems(n)},rt.QUEUE_WAIT_MSEC,rt.MAX_BATCH_SIZE);this._client=e.getClient(v.WorkItemTrackingHttpClient,c.getMainTfsContext().contextData);n=this._getProjectName();this._witColorAndIconsProviderPromise=n?p.WorkItemTypeColorAndIconsProvider.getInstance().queueEnsureColorAndIconsArePopulated(n):i(null)}return n.getInstance=function(){return n._instance||(n._instance=new n),n._instance},n.prototype._loadWorkItems=function(n){var s=[y.CoreFieldRefNames.Id,y.CoreFieldRefNames.WorkItemType,y.CoreFieldRefNames.Title,y.CoreFieldRefNames.TeamProject],t={},e={},o;return n.forEach(function(n){t[n]=i.defer();e[n]=t[n].promise}),o=this._getProjectName(),this._client.getWorkItems(n,s,null,null,w.WorkItemErrorPolicy.Omit,o).then(function(u){var e=[],o=u.filter(function(n){return n!==null}).map(function(n){var r=n.fields,u=r[y.CoreFieldRefNames.WorkItemType],o=r[y.CoreFieldRefNames.TeamProject],i={id:r[y.CoreFieldRefNames.Id],projectName:o,workItemType:u,title:r[y.CoreFieldRefNames.Title],colorAndIcon:p.WorkItemTypeColorAndIcons.getDefault()};return e.push(i.id),p.WorkItemTypeColorAndIconsProvider.getInstance().getColorAndIconAsync(o,u).then(function(n){i.colorAndIcon=n;t[i.id].resolve(i)},function(n){t[i.id].resolve(i);f.publishErrorToTelemetry(n)})});return i.allSettled(o).then(function(){n.forEach(function(n){if(e.indexOf(n)===-1){var i="WorkItem #"+n+" not returned from server.";r.logWarning(i);t[n].resolve(null)}})})},function(i){u.handleError(i);n.forEach(function(n){t[n].reject(i)})}),e},n.prototype._getProjectName=function(){return c.getMainTfsContext().navigation.project||o.empty},n}();t.WorkItemProviderCache=ut});

define("Mention/Scripts/TFS.Mention.WorkItems",["require","exports","q","VSS/Diag","VSS/Utils/String","Mention/Scripts/TFS.Mention","Mention/Scripts/TFS.Mention.Autocomplete.JQueryAutocomplete","Mention/Scripts/TFS.Mention.Helpers","Mention/Scripts/TFS.Social.Telemetry","Presentation/Scripts/URI","VSS/FeatureAvailability/Services","Presentation/Scripts/TFS/Generated/TFS.Server.WebAccess.Constants","Mention/Scripts/WorkItemTypeIcon.JQuery","Mention/Scripts/WorkItem/WorkItemProvider","Mention/Scripts/WorkItem/WorkItemMentionUtilities","VSS/Controls/PopupContent","VSS/Navigation/HubsService","VSS/Service"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){function st(){return c.FeatureAvailabilityService.isFeatureEnabled("WebAccess.WorkItemTracking.WorkItemsHub.NewPlatform",!1)?"ms.vss-work-web.new-work-items-hub":"ms.vss-work-web.work-items-hub"}function nt(n){var t=y.getWorkItemTypeWithIdString(n.workItemType,n.id);return y.getWorkItemSummary(t,n.title)}function et(n){var t=ot(n.id),i=y.getWorkItemMentionText(n.id);return f.createHtmlMention(t,i)}function tt(n){var t=ot(n.id),i=nt(n);return f.createHtmlMention(t,i)}function ot(n){var r=k.getWorkItemUrl(n),t=new h(r),i;return t.host()||(i=o.getWindowLocation(),t.host(i.host),t.protocol(i.protocol)),t.href()}var it,rt,d,ut,g,ft,k;Object.defineProperty(t,"__esModule",{value:!0}),function(n){n.MENTION_WIDGET_WORKITEM="mention-widget-workitem"}(it=t.CssClasses||(t.CssClasses={}));rt=function(n){function t(i){var r=this,i=i||{};return i.isMenuWidthOverridable&&$.extend(i,{menuWidth:t.MENU_WIDTH}),n.call(this,i)||this}return __extends(t,n),t.prototype.getWorkItemProvider=function(){return this._workItemProvider||(this._workItemProvider=new v.WorkItemProvider({wiql:this._options.wiql})),this._workItemProvider},t.prototype.prefetch=function(){this.getWorkItemProvider().prefetch()},t.prototype.getPluginName=function(){return"WorkItemAutocompleteProvider"},t.prototype.canOpen=function(n){var r=this.getTruncatedText(n),t=this.mentionPattern().exec(r.textBeforeSelection),i;return t?(i=t.index,t[1]&&(i+=t[1].length+r.truncatedTextLength),{start:i,end:n.textBeforeSelection.length}):null},t.prototype.getSuggestions=function(n){var t=$.Deferred(),u={},f=y.NumberMentionPattern.exec(n.textBeforeSelection),i,e,r;return f?i=this.getWorkItemProvider().searchById(f[2]):(e=this.getTruncatedText(n),r=this.mentionPattern().exec(e.textBeforeSelection),i=r?this.getWorkItemProvider().search(r[2]):this.getWorkItemProvider().search("")),i.done(function(n){u.suggestionsCount=""+n.length;t.resolve({result:n,telemetry:u})}).fail(function(n){t.reject(n)}),t},t.prototype.renderSuggestion=function(n,t){var i=$("<li>").appendTo(n),r=$("<a>").appendTo(i),u,e;p.RichContentTooltip.add(t.original.title,r);u=$("<div>");e=u[0];a.renderWorkItemTypeIcon(e,t.highlighted.workItemType,t.original.colorAndIcon,{ariaAttributes:{}});r.append(u[0].innerHTML);var s=y.getWorkItemTypeWithIdString(t.highlighted.workItemType,t.highlighted.id),h=$("<span>").addClass(f.CssClasses.AUTOCOMPLETE_ID).html(s)[0].outerHTML,c=$("<span>").addClass(f.CssClasses.AUTOCOMPLETE_TITLE).html(t.highlighted.title)[0].outerHTML,o=$(y.getWorkItemSummary(h,c));return o.appendTo(r),i.attr("aria-label",o.text()),i},t.prototype.afterRender=function(n){$("a",n).each(function(n,t){t.clientWidth>=t.scrollWidth&&$(t).removeAttr("title")})},t.prototype.getReplacementText=function(n,t,i){if(i)return{textBeforeSelection:n.textBeforeSelection,textInSelection:"",textAfterSelection:n.textAfterSelection};var r=this.getTruncatedText(n),u=this.mentionPattern().exec(r.textBeforeSelection),e=u.index+u[1].length+1+r.truncatedTextLength,o=n.textBeforeSelection.substr(0,e),f=t.original.id.toString();return y.AfterMentionPattern.exec(n.textAfterSelection)||(f+=" "),{textBeforeSelection:o+f,textInSelection:"",textAfterSelection:n.textAfterSelection}},t.prototype.getReplacementHtml=function(n){return tt(n.original)},t.prototype.getProviderName=function(){return"WorkItemAutocompleteProvider"},t.prototype.mentionPattern=function(){return y.mentionPattern(this.isOpen())},t.prototype.getTruncatedText=function(n){var t=n.textBeforeSelection,r=t.length,i=1e3,u=0;return r>i&&(t=t.substr(-i),u=r-i),{textBeforeSelection:t,textInSelection:n.textInSelection,textAfterSelection:n.textAfterSelection,truncatedTextLength:u}},t.MENU_WIDTH=450,t}(e.JQueryAutocompletePlugin);t.WorkItemAutocompleteProvider=rt;d=function(){function n(){}return n.getDefault=function(){return n._instance||(n._instance=new n),n._instance},n._createWorkItemElement=function(n,t,i){var u,r,f,e;return i===void 0&&(i=!1),u=$("<a>"),r=null,i?r=y.getWorkItemMentionText(n.id):(a.renderWorkItemTypeIcon(u[0],n.workItemType,n.colorAndIcon,{suppressTooltip:!0}),f=$("<span>").addClass("mention-widget-workitem-typeid").text(y.getWorkItemTypeWithIdString(n.workItemType,n.id))[0].outerHTML,e=$("<span>").addClass("mention-widget-workitem-title").text(n.title)[0].outerHTML,r=y.getWorkItemSummary(f,e)),u.addClass(it.MENTION_WIDGET_WORKITEM).addClass("mention-link").attr("href",t).append(r)},n.prototype.getArtifactType=function(){return"WorkItem"},n.createWorkItemIdElement=function(t,i){return n._createWorkItemElement({id:t,colorAndIcon:null,projectName:null,title:null,workItemType:null},i,!0)},n.prototype.renderMention=function(t,u,f){return v.WorkItemProvider.getInstance().getById(t.ArtifactId).then(function(r){var e;if(r===null)return e=$("<span>").text(t.Text)[0].outerHTML,u(e),i.reject(e);var o=k.getWorkItemUrl(+t.ArtifactId,r.projectName),c=n._createWorkItemElement(r,o),h=u(c),l=nt(r);return h.click(function(n){s.EventLogging.publishWorkItemsClickEvent({workItem:r.id.toString()});var t=function(){k.showWorkItem(r.id,r,o,n)};if(f&&f.onWorkItemClick)f.onWorkItemClick(r,o,t);else t()}),{htmlComponent:h,displayText:l}})},n.prototype.getTelemetryMentionSummary=function(n){return this.getArtifactType()+":"+n.ArtifactId},n}();t.WorkItemMentionsRenderingProvider=d;ut=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.renderMention=function(n,t){return v.WorkItemProvider.getInstance().getById(n.ArtifactId).then(function(r){var u,f;if(r===null)return u=$("<span>").text(n.Text)[0].outerHTML,f=t(u),i.reject(f);var e=c.FeatureAvailabilityService.isFeatureEnabled(l.FeatureAvailabilityFlags.HideTypeAndTitleInWorkItemMentions,!1),o=e?et(r):tt(r),s=e?y.getWorkItemMentionText(r.id):nt(r),h=t(o);return{htmlComponent:h,displayText:s}})},t}(d);t.WorkItemHtmlMentionsRenderingProvider=ut;g=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.getDefault=function(){return t._instance||(t._instance=new t),t._instance},t.prototype.parseFromText=function(n){for(var r=[],u=new RegExp("("+f.Constants.PATTERN_WORD_START_SEPARATOR+")#([0-9]{1,10})(?=("+f.Constants.PATTERN_WORD_END_SEPARATOR+"))","ig"),t;t=u.exec(n);){var e=t.index,o=u.lastIndex,i=t[1];i&&i.length&&(e+=i.length);r.push({index:{start:e,end:o},id:t[2]})}return r},t.prototype.parseFromUrl=function(n){for(var r=new h(n),t=r.segment(),i;t.shift()!==k.getControllerNameWithPrefix();)if(!t.length)return;return i=+t.pop(),i>0?{workItemId:i}:void 0},t.prototype.parseFromHtml=function(n,t){var i=this,r=n.find('a[href*="/'+k.getControllerNameWithPrefix()+"/"+k.EDIT_ACTION_NAME+'/"]['+f.Constants.HTML_MENTION_ATTR_NAME+'^="'+f.Constants.HTML_MENTION_VERSION_10+'"]');r.each(function(n,r){var u=$(r),f=i.parseFromUrl(u.attr("href"));f&&t(u,f)})},t.prototype.getArtifactType=function(){return"WorkItem"},t}(f.ArtifactMentionParser);t.WorkItemsMentionParser=g;ft=function(){function n(){}return n.processHtml=function(n,t){g.getDefault().parseFromHtml(n,function(n,i){var r={ArtifactId:i.workItemId.toString(),ArtifactType:"",Text:"",Type:f.TextPartType.Mention,StartIndex:0};d.getDefault().renderMention(r,function(n){return $("<span>").append(n)},t).then(function(t){n.replaceWith(t.htmlComponent)})})},n.filterHtml=function(n){g.getDefault().parseFromHtml(n,function(n,t){var r=n.attr("href"),i=d.createWorkItemIdElement(t.workItemId,r);i.attr(f.Constants.HTML_MENTION_ATTR_NAME,n.attr(f.Constants.HTML_MENTION_ATTR_NAME));n.replaceWith(i)})},n}();t.WorkItemMentionProcessor=ft,function(n){function t(n,t,i,r){var e,f;try{if(o.hasParentWindow()&&window.parent.TfsMentionWorkItemHelpers){e=window.parent.TfsMentionWorkItemHelpers;e.showWorkItem(n);return}}catch(s){}f=o.getMainTfsContext().contextData.project;!r.ctrlKey&&!r.metaKey&&!r.shiftKey&&f&&t.projectName&&u.equals(t.projectName,f.name,!0)&&(b.getLocalService(w.HubsService).getHubNavigateHandler(st(),i)(r),r.preventDefault())}function i(t,i){var r=o.getMainTfsContext();return r.getPublicActionUrl(n.EDIT_ACTION_NAME,n.CONTROLLER_NAME,{parameters:t,project:i||r.navigation.projectId,team:""})}function r(){var t=o.getMainTfsContext();return""+t.navigation.controllerPrefix+n.CONTROLLER_NAME}n.EDIT_ACTION_NAME="edit";n.CONTROLLER_NAME="workitems";n.showWorkItem=t;n.getWorkItemUrl=i;n.getControllerNameWithPrefix=r}(k=t.TfsMentionWorkItemHelpers||(t.TfsMentionWorkItemHelpers={}));t.createWorkItemMentionSummaryWithTitle=nt;t.createWorkItemHtmlMentionWithId=et;t.createWorkItemHtmlMentionWithTitle=tt;window.TfsMentionWorkItemHelpers=k});

define("Mention/Scripts/TFS.Mention.WorkItems.Registration",["require","exports","Mention/Scripts/TFS.Mention","Mention/Scripts/TFS.Mention.WorkItems"],function(n,t,i,r){Object.defineProperty(t,"__esModule",{value:!0});i.MentionsRenderer.getDefault().registerProvider(r.WorkItemMentionsRenderingProvider.getDefault);i.MentionProcessor.getDefault().registerParser(r.WorkItemsMentionParser.getDefault)});

define("Mention/Scripts/TFS.Mention.Controls.Picker",["require","exports","VSS/Utils/UI","Mention/Scripts/TFS.Mention.Autocomplete","Mention/Scripts/TFS.Mention.Autocomplete.Controls","Mention/Scripts/TFS.Mention.WorkItems","Mention/Scripts/TFS.Mention.WorkItems.Registration"],function(n,t,i,r,u,f){Object.defineProperty(t,"__esModule",{value:!0});var e=function(n){function t(t,i){var u=this;return t=t||{},t.mentionType!==r.MentionType.WorkItem||t.pluginConfigs||(t.pluginConfigs=[{factory:function(n){return new f.WorkItemAutocompleteProvider(n)}}]),n.call(this,t,i)||this}return __extends(t,n),t.prototype.initialize=function(){var t=this,r,u;if(n.prototype.initialize.call(this),r=this.getElement(),r){u=this._options.dropDown||this.getElement().parent().children(".bowtie-triangle-down");r.on("mouseenter",function(){t.prefetch()});r.bind("keydown",function(n){if(n.altKey&&!n.shiftKey&&!n.ctrlKey){var u=n.keyCode?n.keyCode:n.which,f=t._createInputText(n,r.val());u===i.KeyCode.DOWN?t._autocompleteManager.handleEvent(n,f):u===i.KeyCode.UP&&t._autocompleteManager.close(n,f)}});r.on("click keyup",function(n){if(!t._autocompleteManager.isActive()&&(n.type!=="keyup"||n.keyCode===i.KeyCode.TAB)&&t._elementFocused!==!0){var u=t._createInputText(n,r.val());t._autocompleteManager.handleEvent(n,u);t._elementFocused=!0}});r.on("blur",function(){t._elementFocused=!1});u.on("click",function(n){var i=t._createInputText(n,r.val());t._autocompleteManager.isActive()?t._autocompleteManager.close(n,i):t._autocompleteManager.handleEvent(n,i)});u.on("blur",function(n){var u=$(document.activeElement),i;u.is(".mention-autocomplete-menu")||(i=t._createInputText(n,r.val()),t._autocompleteManager.close(n,i))})}},t.prototype._sessionSelect=function(n){this._options.select&&this._options.select(n)},t.prototype._sessionFocus=function(){},t.prototype._createInputText=function(n,t){var r=this,i={textBeforeSelection:this._filterSearchString(t),textInSelection:"",textAfterSelection:""};return this.isActive()?i:(setTimeout(function(){r._autocompleteManager.handleEvent(n,i)},0),{textBeforeSelection:"#",textInSelection:"",textAfterSelection:""})},t.prototype._filterSearchString=function(n){return"#"+n.trim().replace(/\#/g," ").replace(/\s{2,}/g," ")},t}(u.AutocompleteEnhancement);t.MentionPickerEnhancement=e});

define("VersionControl/Scripts/Controls/AddRelatedWorkItemsControl",["require","exports","VSS/Controls","VersionControl/Scripts/CustomerIntelligenceConstants","VersionControl/Scripts/Resources/TFS.Resources.VersionControl","Mention/Scripts/TFS.Mention.Controls.Picker","Mention/Scripts/TFS.Mention.Autocomplete","VSS/Telemetry/Services"],function(n,t,i,r,u,f,e,o){Object.defineProperty(t,"__esModule",{value:!0});var s=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.initialize=function(){var t=this,l;n.prototype.initialize.call(this);var s=this,h=this._element,c=this._options.dropIconCss||"bowtie-triangle-down";this._$inputBox=$('<div class="vc-pullrequest-view-details-relatedartifacts-addartifactbox-container" />');this._$inputTextBox=$('<input type="text" class="vc-pullrequest-view-details-relatedartifacts-addartifactbox textbox-input" placeholder="'+u.PullRequest_RelatedArtifactsAddWatermark+'" aria-label="'+u.PullRequest_RelatedWorkItemsTitle+'" />').appendTo(this._$inputBox);this._$inputTextBox.attr("role","combobox").attr("aria-autocomplete","list").attr("aria-expanded","false");this._options.ariaLabelledBy&&this._$inputTextBox.attr("aria-labelledby",this._options.ariaLabelledBy);this._$dropIcon=$('<div role="button" aria-label="'+u.RelatedWorkItems_ChevronLabel+'" class="drop-icon bowtie-icon '+c+'"/>').appendTo(this._$inputBox);this._$inputTextBox!=null&&this._$inputTextBox.length>0&&(l=i.Enhancement.enhance(f.MentionPickerEnhancement,s._$inputTextBox,{mentionType:e.MentionType.WorkItem,dropDown:this._$dropIcon,open:function(){t._$inputTextBox.attr("aria-expanded","true")},close:function(){t._$inputTextBox.attr("aria-expanded","false")},select:function(n){var e=s._validateAndCreateWorkItemLink(n.getPlainText().textBeforeSelection),u,i,f;e&&(u=s._$inputTextBox.val(),i=u==="",i||s._$inputTextBox.select(),f=new o.TelemetryEventData(r.VERSION_CONTROL_AREA,r.RELATED_WORK_ITEMS_ADD,{contextId:t._options.contextId||"",hostArtifactId:t._options.hostArtifactId,hasTypedText:!i,typedTextIsANumber:!i&&!isNaN(u)}),o.publishEvent(f))}}));h.append($("<div><\/div>")).append(this._$inputBox)},t.prototype.showTextBox=function(n,t){n?(this._$inputBox.show(),t&&(this._$inputTextBox.click(),this._$inputTextBox.focus())):this._$inputBox.hide()},t.prototype._validateAndCreateWorkItemLink=function(n){if(n==null||n.length<=0)return!1;var t=+n;if(n[0]=="#"&&(t=+n.substr(1)),isNaN(t)||t%1!=0)return!1;if(this._options.checkWorkItemExists&&this._options.checkWorkItemExists(t))return!0;if(this._options.onWorkItemAdd)this._options.onWorkItemAdd(t);return!0},t}(i.BaseControl);t.AddRelatedWorkItemsControl=s});

define("Presentation/Scripts/TFS/TFS.React",["require","exports","react","VSS/Events/Services"],function(n,t,i,r){var u,f,e;Object.defineProperty(t,"__esModule",{value:!0});u=function(){function n(t){this._listeners=[];this._scope=t||n.DefaultScope}return n.prototype.invoke=function(t){if(n.Executing[this._scope])throw new Error("Cannot invoke an action from inside another action.");n.Executing[this._scope]=!0;try{this._listeners.forEach(function(n){n(t)})}finally{n.Executing[this._scope]=!1}},n.prototype.addListener=function(n,t){this._listeners.push(t?n.bind(t):n)},n.DefaultScope="Default",n.Executing={},n}();t.Action=u;f=function(){function n(n,t){this._changedEvent=n;this._eventManager=t&&t.eventManager?t.eventManager:r.getService()}return n.prototype.addChangedListener=function(n){this.addListener(this._changedEvent,n)},n.prototype.removeChangedListener=function(n){this.removeListener(this._changedEvent,n)},n.prototype.emitChanged=function(n){this.emit(this._changedEvent,this,n)},n.prototype.emit=function(n,t,i){this._eventManager.fire(n,t,i)},n.prototype.addListener=function(n,t){this._eventManager.attachEvent(n,t)},n.prototype.removeListener=function(n,t){this._eventManager.detachEvent(n,t)},n}();t.Store=f;e=function(n){function t(t){return n.call(this,t)||this}return __extends(t,n),t.prototype.render=function(){var t=this,n={ref:function(n){return t.onRender(n)}};return this.props.containerCssClass&&(n.className=this.props.containerCssClass),i.createElement("div",n)},t.prototype.onRender=function(){},t}(i.Component);t.TfsComponent=e});

define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Interfaces",["require","exports"],function(n,t){Object.defineProperty(t,"__esModule",{value:!0});var i;(function(n){n[n.Done=0]="Done";n[n.InProgress=1]="InProgress"})(i=t.FetchingDisplayData||(t.FetchingDisplayData={}))});

define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Logic/ArtifactSorting",["require","exports","VSS/Diag","VSS/Utils/String","VSS/Utils/Date","VSS/Utils/Number","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Contracts"],function(n,t,i,r,u,f,e){var o;Object.defineProperty(t,"__esModule",{value:!0});o=function(){function n(){}return n.prototype.sortArtifactsInGroups=function(n,t){for(var u,i=0,r=n;i<r.length;i++)u=r[i],this._sort(u.linkedArtifacts,t)},n.prototype._sort=function(n,t){var i=new l,r,f,u;if(t&&t.length){for(r=0,f=t;r<f.length;r++)u=f[r],u.column.refName===e.InternalKnownColumns.Link.refName?i.push(new s(u.direction)):i.push(new h(u));i.push(new c)}else i.push(new s(e.SortDirection.Ascending));n.sort(i.getComparer())},n}();t.ArtifactSorter=o;var s=function(){function n(n){this._sortDirection=n}return n.prototype.compare=function(n,t){var i=this._compare(n,t);return i*this._sortDirection},n.prototype._compare=function(n,t){var o=this._handleUndefined(n,t),f,e;if(o!==null)return o;var i=n.primaryData,u=t.primaryData,s=this._handleUndefined(n.primaryData,t.primaryData);return s!==null?s:(f=r.localeComparer(i.typeName,u.typeName),f!==0)?f:i.user&&u.user&&(e=r.localeComparer(i.user.displayName,u.user.displayName),e!==0)?e:r.localeComparer(i.title,u.title)},n.prototype._handleUndefined=function(n,t){if(n||t)if(n){if(!t)return-1}else return 1;else return 0;return null},n}(),h=function(){function n(n){this._sortColumn=n}return n.prototype.compare=function(n,t){var i=this._compare(n,t);return i*this._sortColumn.direction},n.prototype._compare=function(n,t){var f=n.additionalData&&n.additionalData[this._sortColumn.column.refName],e=t.additionalData&&t.additionalData[this._sortColumn.column.refName],r,u,o;if(f||e)if(f){if(!e)return-1}else return 1;else return 0;return(r=f.rawData||f.styledText.text||"",u=e.rawData||e.styledText.text||"",typeof r!=typeof u)?-1:(o=this._getComparerForType(r),!o)?-1:o(r,u)},n.prototype._getComparerForType=function(n){return typeof n=="number"?f.defaultComparer:typeof n=="string"?r.localeComparer:n instanceof Date?u.defaultComparer:null},n}(),c=function(){function n(){}return n.prototype.compare=function(n,t){var u;if(n||t)if(n){if(!t)return-1}else return 1;else return 0;var o=n.primaryData&&n.primaryData.title||"",s=t.primaryData&&t.primaryData.title||"",f=r.localeComparer(o,s);if(f!==0)return f;var h=this._getDisplayId(n),c=this._getDisplayId(t),e=r.defaultComparer(h,c);return e!==0?e:(u=r.defaultComparer(this._getId(n),this._getId(t)),u!==0)?u:-1},n.prototype._getDisplayId=function(n){if(!n||!n.primaryData||!n.primaryData.displayId)return n.id;var t=n.primaryData.displayId;return typeof t=="string"?t:t.text||n.id},n.prototype._getId=function(n){return n.id||""},n}(),l=function(){function n(){this._comparers=[]}return n.prototype.push=function(n){this._comparers.push(n)},n.prototype.getComparer=function(){var n=this;return function(t,i){for(var e,f,r=0,u=n._comparers;r<u.length;r++)if(e=u[r],f=e.compare(t,i),f!==0)return f;return 0}},n}()});

define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Logic/GroupSorting",["require","exports","VSS/Utils/String"],function(n,t,i){var r,u,f;Object.defineProperty(t,"__esModule",{value:!0});r=function(){function n(){}return n.prototype.sort=function(n,t){var i;i=n&&n.length?new f(n):new u;t.sort(i.getComparer())},n}();t.GroupSorter=r;u=function(){function n(){}return n.prototype.getComparer=function(){return function(n,t){return i.localeIgnoreCaseComparer(n.displayName,t.displayName)}},n}();f=function(){function n(n){var t=this;this._linkTypeRefNames=n;this._linkTypeRefNamesIndexMap={};n.forEach(function(n,i){return t._linkTypeRefNamesIndexMap[n]=i})}return n.prototype.getComparer=function(){var n=this;return function(t,r){var u=n._linkTypeRefNamesIndexMap[t.linkType],f=n._linkTypeRefNamesIndexMap[r.linkType],e=typeof u=="undefined",o=typeof f=="undefined";return e&&o?i.localeIgnoreCaseComparer(t.displayName,r.displayName):e?1:o?-1:u-f}},n}()});

define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Flux/Store",["require","exports","Presentation/Scripts/TFS/TFS.Core.Utils","Presentation/Scripts/TFS/TFS.React","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Interfaces","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Contracts","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Logic/ArtifactSorting","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Logic/GroupSorting"],function(n,t,i,r,u,f,e,o){Object.defineProperty(t,"__esModule",{value:!0});var s=function(n){function t(r,e,o,s,h,c,l,a,v){var y=n.call(this,i.GUIDUtils.newGuid()+"_CHANGED",a)||this;return y._linkedArtifactGroups=[],y._actionHub=r,y._actionHub.changeViewOptions.addListener(y._changeViewMode.bind(y)),y._actionHub.changeZeroDataOptions.addListener(y._changeZeroDataExperience.bind(y)),y._actionHub.changeFetchingLinks.addListener(y._changeFetchingLInks.bind(y)),y._actionHub.changeFetchingDisplayData.addListener(y._changeFetchingDisplayData.bind(y)),y._actionHub.changeReadOnly.addListener(y._setReadOnly.bind(y)),y._actionHub.setLinkedArtifacts.addListener(y._setLinkedArtifacts.bind(y)),y._actionHub.sortLinkedArtifacts.addListener(y._sortLinkedArtifacts.bind(y)),y._actionHub.showMessage.addListener(y._showMessage.bind(y)),y._linkTypeRefNames=e,y._sortColumns=o||t.DefaultSortColumns,y._fetchingDisplayData=u.FetchingDisplayData.Done,y._fetchingLinks=f.FetchingLinks.Done,y._displayOptions={readOnly:l?l:!1,showGroupHeaders:!s?!0:s.showGroupHeaders,viewMode:s&&s.viewMode||f.ViewMode.List,availableSpace:s&&s.availableSpace||{width:null,height:null},zeroDataOptions:{zeroDataExperienceViewMode:c?c.zeroDataExperienceViewMode:f.ZeroDataExperienceViewMode.Default,message:c&&c.message,action:c&&c.action,onRenderZeroData:c&&c.onRenderZeroData},gridViewOptions:h||{maxGridHeight:f.DefaultGridHeight,autoSizeGrid:!0},artifactPageSize:v||6},y}return __extends(t,n),t.prototype.getState=function(){return{displayOptions:{readOnly:this._displayOptions.readOnly,showGroupHeaders:this._displayOptions.showGroupHeaders,viewMode:this._displayOptions.viewMode,zeroDataOptions:{zeroDataExperienceViewMode:this._displayOptions.zeroDataOptions.zeroDataExperienceViewMode,action:this._displayOptions.zeroDataOptions.action,message:this._displayOptions.zeroDataOptions.message,onRenderZeroData:this._displayOptions.zeroDataOptions.onRenderZeroData},availableSpace:this._displayOptions.availableSpace,artifactPageSize:this._displayOptions.artifactPageSize,gridViewOptions:this._displayOptions.gridViewOptions},hostArtifact:this._hostArtifact,linkedArtifactGroups:this._linkedArtifactGroups,sortColumns:this._sortColumns,message:this._message,fetchingDisplayData:this._fetchingDisplayData,fetchingLinks:this._fetchingLinks}},t.prototype._changeViewMode=function(n){var t=!1;this._displayOptions.viewMode!==n.viewOptions.viewMode&&(this._displayOptions.viewMode=n.viewOptions.viewMode,t=!0);!n.viewOptions.availableSpace||this._displayOptions.availableSpace.height===n.viewOptions.availableSpace.height&&this._displayOptions.availableSpace.width===n.viewOptions.availableSpace.width||(this._displayOptions.availableSpace=n.viewOptions.availableSpace,t=!0);t&&this.emitChanged()},t.prototype._setReadOnly=function(n){this._displayOptions.readOnly=n.readOnly;this.emitChanged()},t.prototype._changeFetchingLInks=function(n){this._fetchingLinks=n.fetchingLinks;this.emitChanged()},t.prototype._changeFetchingDisplayData=function(n){this._fetchingDisplayData=n.fetchingDisplayData;this.emitChanged()},t.prototype._changeZeroDataExperience=function(n){this._compareZeroDataOptions(this._displayOptions.zeroDataOptions,n.zeroDataOptions)&&(this._displayOptions.zeroDataOptions=n.zeroDataOptions,this.emitChanged())},t.prototype._setLinkedArtifacts=function(n){this._linkedArtifactGroups=n.groupedLinkedArtifacts;this._hostArtifact=n.hostArtifact;this._sort();this.emitChanged()},t.prototype._sortLinkedArtifacts=function(n){this._sortColumns=n.sortColumns;this._sort();this.emitChanged()},t.prototype._sort=function(){this._sortArtifacts();this._sortGroups()},t.prototype._sortArtifacts=function(){var n=new e.ArtifactSorter;n.sortArtifactsInGroups(this._linkedArtifactGroups,this._sortColumns)},t.prototype._sortGroups=function(){var n=new o.GroupSorter;n.sort(this._linkTypeRefNames,this._linkedArtifactGroups)},t.prototype._showMessage=function(n){this._message=n.message;this.emitChanged()},t.prototype._compareZeroDataOptions=function(n,t){var i=!n.action?null:n.action.actionMessage,r=!t.action?null:t.action.actionMessage;return n.zeroDataExperienceViewMode!==t.zeroDataExperienceViewMode||n.message!==t.message||i!==r?!0:!1},t.DefaultSortColumns=[{column:f.InternalKnownColumns.Link,direction:f.SortDirection.Ascending}],t}(r.Store);t.LinkedArtifactsStore=s});

define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Flux/Actions",["require","exports","Presentation/Scripts/TFS/TFS.Core.Utils","Presentation/Scripts/TFS/TFS.React"],function(n,t,i,r){Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function n(){this._scope="LinkedArtifacts_"+i.GUIDUtils.newGuid();this.changeViewOptions=this._createAction();this.changeReadOnly=this._createAction();this.setLinkedArtifacts=this._createAction();this.removeLinkedArtifact=this._createAction();this.changeLinkedArtifactComment=this._createAction();this.sortLinkedArtifacts=this._createAction();this.showMessage=this._createAction();this.changeZeroDataOptions=this._createAction();this.changeFetchingLinks=this._createAction();this.changeFetchingDisplayData=this._createAction()}return n.prototype._createAction=function(){return new r.Action(this._scope)},n}();t.ActionsHub=u});

define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/DataProvider/RequestCache",["require","exports","q","VSS/Utils/Array","VSS/Utils/String"],function(n,t,i,r,u){var o;Object.defineProperty(t,"__esModule",{value:!0}),function(n){n[n.Queued=0]="Queued";n[n.Active=1]="Active"}(o=t.CacheRequestStatus||(t.CacheRequestStatus={}));var f=function(n){return n.tool+"/"+n.type+"/"+n.id},e=function(n,t){if(n||t)if(n){if(!t)return 1}else return-1;else return 0;var i=u.ignoreCaseComparer(f(n),f(t));return i!==0?i:u.ignoreCaseComparer(n.linkType,t.linkType)},s=function(n,t){return n&&t&&u.ignoreCaseComparer(n.refName,t.refName)},h=function(){function n(n){this._cache={};this._queuedRequests=[];this._delay=n}return n.prototype.getArtifacts=function(t,u,o){for(var l=t.slice(0),a=[],p=[],v=[],s=null,h,y,w,c;l.length>0;){if(h=l.shift(),y=this._cache[f(h)],y){if(c=n._findOrExtendRequest(h,u,y),c){v.push(c.result);w=r.intersect([h].concat(l),c.linkedArtifacts,e);l=r.subtract(l,w,e);continue}}else if(s||this._queuedRequests.length>0){s=s||this._queuedRequests[0];n._extendRequest(h,u,s);p.push(h);continue}a.push(h)}return s&&(v.push(s.result),this._addToCache(p,s)),a.length>0&&(c=this._createNewRequest(a,u,o),v.push(c.result),this._addToCache(a,c)),i.all(v).then(function(n){return r.unique([].concat.apply([],n).filter(function(n){return r.contains(t,n,e)}),e)})},n.prototype._addToCache=function(n,t){for(var u=0,e=n;u<e.length;u++){var s=e[u],o=f(s),i=this._cache[o];i||(i=[],this._cache[o]=i);i.length!==0&&r.contains(i,t)||i.push(t)}},n.prototype._createNewRequest=function(n,t,u){var s=this,e={linkedArtifacts:n.slice(0),columns:t,status:o.Queued,result:i.delay(this._delay).then(function(){return e.status=o.Active,r.remove(s._queuedRequests,e),u(e.linkedArtifacts,e.columns).then(function(n){for(var r,t=0,i=e.linkedArtifacts;t<i.length;t++)r=i[t],delete s._cache[f(r)];return n})})};return this._queuedRequests.push(e),e},n._extendRequest=function(n,t,i){r.contains(i.linkedArtifacts,n,e)||i.linkedArtifacts.push(n);i.columns=r.union(i.columns,t,s)},n._requestContainsRequestedColumns=function(n,t){return r.intersect(n,t.columns,s).length===n.length},n._findOrExtendRequest=function(t,i,r){for(var e,h,u,f=0,s=r;f<s.length;f++)if(u=s[f],n._requestContainsRequestedColumns(i,u))return u;for(e=0,h=r;e<h.length;e++)if(u=h[e],u.status===o.Queued)return n._extendRequest(t,i,u),u;return null},n._getArtifactIdsForRequest=function(n){return n.linkedArtifacts.map(function(n){return f(n)})},n}();t.RequestCache=h});

define("TFS/WorkItemTracking/ExtensionContracts",["require","exports"],function(n,t){var i,r;Object.defineProperty(t,"__esModule",{value:!0}),function(n){n[n.PendingAdd=0]="PendingAdd";n[n.Success=1]="Success";n[n.Failed=2]="Failed";n[n.PendingUpdate=4]="PendingUpdate";n[n.PendingDelete=8]="PendingDelete"}(i=t.RemoteLinkStatus||(t.RemoteLinkStatus={})),function(n){n[n.icon=0]="icon";n[n.colorBar=1]="colorBar";n[n.colorCircle=2]="colorCircle";n[n.identity=3]="identity"}(r=t.ArtifactIconType||(t.ArtifactIconType={}));t.KnownColumns={State:"State",LastUpdate:"LastUpdate"}});

define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/DataProvider/ContributedDataProviderAdapter",["require","exports","VSS/Service","VSS/Context","VSS/Utils/String","VSS/Contributions/Controls","VSS/Contributions/Services","VSS/Diag","VSS/Error","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Contracts","TFS/WorkItemTracking/ExtensionContracts","Presentation/Scripts/TFS/TFS.Core.Utils"],function(n,t,i,r,u,f,e,o,s,h,c,l){function y(n){return p(n).then(function(n){return f.getBackgroundHost(n)}).then(function(n){return n.getRegisteredInstance("ArtifactLinkProvider",r.getDefaultWebContext())}).then(function(t){return new a(n,t)})}function p(n){return i.getService(e.ExtensionService).getContributionsForTargets([v]).then(function(t){var i=t.filter(function(t){return u.ignoreCaseComparer(n,t.properties.toolId)==0}),r;if(i.length===0){r=new Error("No contribution found which supports tool: '"+n+"'");s.publishErrorToTelemetry(r);throw r;}return i.length>1&&s.publishErrorToTelemetry(new Error("Multiple contributions registered for tool "+n+". Taking the first one and ignoring others.")),i[0]})}var v,a;Object.defineProperty(t,"__esModule",{value:!0});v="ms.vss-work-web.workitem-artifact-links";t.getContributedLinkedArtifactDataProvider=y;a=function(){function n(n,t){this.supportedTool=n;this._artifactLinkProvider=t}return n.prototype.beginGetDisplayData=function(n){var t=this;return this._artifactLinkProvider.getDisplayData(l.makeCopy(n)).then(function(i){for(var u,f={},r=0,e=n;r<e.length;r++)u=e[r],f[u.id]=u;return i.map(function(n){try{t._verifyDataReturnedByExtension(n,f[n.id])}catch(i){n.error=i}return t._toInternalDisplayData(n)})},function(t){return s.publishErrorToTelemetry(t),n.map(function(){return t})})},n.prototype._verifyDataReturnedByExtension=function(n,t){if(u.ignoreCaseComparer(n.linkType,t.linkType)!=0||u.ignoreCaseComparer(n.tool,t.tool)!=0||u.ignoreCaseComparer(n.type,t.type)!=0||u.ignoreCaseComparer(n.id,t.id)!=0){var i=new Error("Read-only fields in LinkedArtifact id ${originalLinkedArtifact.id} changed by extension.");s.publishErrorToTelemetry(i);throw i;}},n.prototype._toInternalDisplayData=function(n){return{uri:n.uri,tool:n.tool,type:n.type,id:n.id,linkType:n.linkType,linkTypeDisplayName:n.linkTypeDisplayName,comment:n.comment,primaryData:this._toInternalLinkedArtifactPrimaryData(n.primaryData,n),additionalData:this._toInternalAdditionalDataDictionary(n.additionalData),error:n.error}},n.prototype._toInternalLinkedArtifactPrimaryData=function(n,t){return{typeIcon:n.typeIcon,displayId:n.displayId,title:n.title,href:n.href,typeName:t.linkTypeDisplayName,callback:null,miscData:null}},n.prototype._toInternalAdditionalDataDictionary=function(n){var t={};return!n[c.KnownColumns.State]||(t[h.InternalKnownColumns.State.refName]=n[c.KnownColumns.State]),!n[c.KnownColumns.LastUpdate]||(t[h.InternalKnownColumns.LastUpdate.refName]=n[c.KnownColumns.LastUpdate]),t},n}();t.ContributedDataProviderAdapter=a});

define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/DataProvider/DataProvider.Registration",["require","exports","q","VSS/VSS","VSS/Artifacts/Constants","Presentation/Scripts/TFS/Controls/LinkedArtifacts/DataProvider/ContributedDataProviderAdapter"],function(n,t,i,r,u,f){function h(n){n=n.toLowerCase();var r=o[n];return!r?f.getContributedLinkedArtifactDataProvider(n).then(function(n){return n},function(){return i.reject({message:"No linked artifacts provider registered for tool '"+n+"'.",type:t.ERROR_NODATAPROVIDERREGISTERED_TYPE})}):r.instancePromise?r.instancePromise:c(r,n)}function c(n,t){var u=i.defer();return r.using(n.requiredModules,function(n){try{u.resolve(new n.default)}catch(t){u.reject(t)}},function(n){u.reject(n)}),n.instancePromise=u.promise.timeout(s,"Could not resolve linked artifacts for tool '"+t+"' provider within "+s+"ms"),n.instancePromise.then(function(n){return n},function(){n.instancePromise=null})}function l(n){return!!o[n.toLowerCase()]}Object.defineProperty(t,"__esModule",{value:!0});var e,o=(e={},e[u.ToolNames.WorkItemTracking.toLowerCase()]={requiredModules:["WorkItemTracking/Scripts/DataProviders/LinkedWorkItemDataProvider"]},e[u.ToolNames.RemoteWorkItemTracking.toLowerCase()]={requiredModules:["WorkItemTracking/Scripts/DataProviders/RemoteLinkedWorkItemDataProvider"]},e[u.ToolNames.TeamBuild.toLowerCase()]={requiredModules:["Build.Common/Scripts/DataProvider/LinkedArtifactsDataProvider"]},e[u.ToolNames.Git.toLowerCase()]={requiredModules:["VersionControl/Scripts/DataProviders/GitDataProvider"]},e[u.ToolNames.VersionControl.toLowerCase()]={requiredModules:["VersionControl/Scripts/DataProviders/VersionControlDataProvider"]},e[u.ToolNames.Requirements.toLowerCase()]={requiredModules:["Requirements/Scripts/DataProviders/ExternalLinkDataProvider"]},e[u.ToolNames.Hyperlink.toLowerCase()]={requiredModules:["Requirements/Scripts/DataProviders/ExternalLinkDataProvider"]},e[u.ToolNames.TestManagement.toLowerCase()]={requiredModules:["TestManagement/Scripts/DataProviders/TestManagementDataProvider"]},e[u.ToolNames.Wiki.toLowerCase()]={requiredModules:["Wiki/Scripts/LinkedArtifactsDataProvider"]},e[u.ToolNames.GitHub.toLowerCase()]={requiredModules:["WorkItemTracking/Scripts/DataProviders/GitHubDataProvider"]},e),s=3e4;t.ERROR_NODATAPROVIDERREGISTERED_TYPE="NoDataProviderRegisteredError";t.getLinkedArtifactProvider=h;t.inBuiltDataProviderExistsForTool=l});

define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Logic/ArtifactResolver",["require","exports","q","VSS/Utils/Array","VSS/Utils/String","VSS/Error","VSS/Controls/Notifications","Presentation/Scripts/TFS/Controls/LinkedArtifacts/DataProvider/RequestCache","Presentation/Scripts/TFS/Controls/LinkedArtifacts/DataProvider/DataProvider.Registration","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Contracts","Presentation/Scripts/TFS/Resources/TFS.Resources.Presentation","VSS/Utils/Accessibility"],function(n,t,i,r,u,f,e,o,s,h,c,l){Object.defineProperty(t,"__esModule",{value:!0});var a=4,v=function(){function n(){this._requestCaches={}}return n.getInstance=function(){return n._instance||(n._instance=new n),n._instance},n.invalidateArtifactCacheEntry=function(t,i,r){t.invalidate(n._getWriteArtifactCacheKey(i,r))},n.prototype.resolveArtifacts=function(t,o,h,l,a,v){var y=this,k=t.slice(0),p=[],w=this._groupLinkedArtifactsByTool(k),d=Object.keys(w),g=d.map(function(t){return y._getDataProvider(t).then(function(f){var s,b,k,d,g,nt;return f?(s=w[t],f.artifactLimit&&s.length>=f.artifactLimit&&(s=n._getLimitedNumberOfArtifacts(f.artifactLimit,s),p.push({type:e.MessageAreaType.Warning,text:c.LinkedArtifacts_TooManyLinks})),b=a&&a(t),k=[],v&&(d=[],k=s.map(function(n){var t=y._getArtifactFromCache(v,n,o);return t&&b&&(!f.filter||!f.filter(t,b,h))?(d.push(n),null):t}).filter(function(n){return!!n}),g=function(n,t){return u.equals(n.uri,t.uri,!0)&&u.equals(n.linkType,t.linkType,!0)?0:1},s=r.subtract(s,k,g),s=r.subtract(s,d,g)),s.length===0)?i(k):(nt=y._getRequestCacheForTool(t),nt.getArtifacts(s,o,y._retrieveItemsFromDataProvider.bind(y,f,l,b,h)).then(function(t){for(var r,i=0,u=t;i<u.length;i++)r=u[i],y._ensureCommentDataForArtifact(r),v&&v.set(n._getWriteArtifactCacheKey(r,o),r);return b&&f.filter&&(t=t.filter(function(n){return f.filter(n,b,h)})),t.concat(k)})):(p.push({type:e.MessageAreaType.Error,text:u.format(c.LinkedArtifacts_DataProvider_Null,t)}),w[t].map(function(n){return y._defaultDisplayFromLinkedArtifact(n)}))},function(n){return n.type===s.ERROR_NODATAPROVIDERREGISTERED_TYPE?(p.push({type:e.MessageAreaType.Error,text:u.format(c.LinkedArtifacts_DataProvider_NotRegistered,t)}),w[t].map(function(n){return y._defaultDisplayFromLinkedArtifact(n)})):(p.push({type:e.MessageAreaType.Error,text:c.LinkedArtifacts_DataProvider_CouldNotBeResolved}),n.name="DataProviderNotResolvedError",f.publishErrorToTelemetry(n),[])})}),b=[];return i.allSettled(g).then(function(n){for(var i,u,t=0,r=n;t<r.length;t++)i=r[t],i.state==="fulfilled"?(u=i.value,b=b.concat(u)):p.push({type:e.MessageAreaType.Error,text:i.reason});return{resolvedArtifacts:b,messages:p}})},n.prototype._retrieveItemsFromDataProvider=function(n,t,i,r,u,f){var o=this,e=n.beginGetDisplayData(u,f,t,r).then(function(t){return i||o._reportErrorsForUnresolvedArtifacts(n.supportedTool,u,t),t});return l.ProgressAnnouncer.forPromise(e,{announceStartMessage:c.LinkedArtifacts_LoadingStart,announceEndMessage:c.LinkedArtifacts_LoadingEnd,announceErrorMessage:c.LinkedArtifacts_LoadingError}),e},n.prototype._defaultDisplayFromLinkedArtifact=function(n){return{id:n.id,linkType:n.linkType,linkTypeDisplayName:n.linkTypeDisplayName,primaryData:{displayId:n.id,href:null,title:n.uri,typeIcon:null},tool:n.tool,type:n.type}},n.prototype._ensureCommentDataForArtifact=function(n){n.comment&&(n.additionalData||(n.additionalData={}),n.additionalData[h.InternalKnownColumns.Comment.refName]||(n.additionalData[h.InternalKnownColumns.Comment.refName]={styledText:{text:n.comment},title:n.comment}))},n.prototype._getDataProvider=function(n){return s.getLinkedArtifactProvider(n)},n.prototype._groupLinkedArtifactsByTool=function(n){for(var t,i={},r=0,u=n;r<u.length;r++)t=u[r],i[t.tool]=(i[t.tool]||[]).concat([t]);return i},n.prototype._getArtifactFromCache=function(t,i,r){var u=n._getArtifactCacheKey(i),f=t.get(u);return f?f:(u=n._getArtifactCacheKey(i,r),t.get(u))},n.prototype._getRequestCacheForTool=function(n){return this._requestCaches[n]||(this._requestCaches[n]=new o.RequestCache(a)),this._requestCaches[n]},n.prototype._reportErrorsForUnresolvedArtifacts=function(n,t,i){var c=r.subtract(t,i,function(n,t){return u.ignoreCaseComparer(n.uri,t.uri)}),o,l,e,s,h;if(c.length!==t.length)for(o=this._groupLinkedArtifactsByTool(c),l=Object.keys(o),e=0,s=l;e<s.length;e++)h=s[e],f.publishErrorToTelemetry({message:u.localeFormat("'{0}' dataprovider did not resolve following artifacts '{1}'",h,JSON.stringify(o[h])),name:"ToolDidNotResolveArtifacts"})},n._getLimitedNumberOfArtifacts=function(t,i){var s=n.groupLinkedArtifactsByLinkType(i),r,u,e,o,f;for(s.sort(function(n,t){return n.linkedArtifacts.length-t.linkedArtifacts.length}),r=[],u=0,e=s;u<e.length;u++){for(o=e[u],f=0;f<o.linkedArtifacts.length&&r.length<t;++f)r.push(o.linkedArtifacts[f]);if(r.length===t)break}return r},n.groupLinkedArtifactsByLinkType=function(n){for(var f={},e=[],i=0,o=n;i<o.length;i++){var r=o[i],u=r.linkType||"",t=f[u];t||(t={displayName:r.linkTypeDisplayName,linkType:u,linkedArtifacts:[]},f[u]=t,e.push(t));t.linkedArtifacts.push(r)}return e},n._getArtifactCacheKey=function(n,t){var i=(n.uri||n.id)+"-"+n.linkType,r;return t?(r=t.map(function(n){return n.refName}).join(),i+"-"+r):i},n._getWriteArtifactCacheKey=function(n,t){return n.isColumnDependent?this._getArtifactCacheKey(n,t):this._getArtifactCacheKey(n)},n}();t.ArtifactResolver=v});

define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Flux/ActionsCreator",["require","exports","VSS/Utils/Array","VSS/Utils/Core","VSS/Diag","VSS/Controls/Notifications","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Contracts","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Interfaces","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Logic/ArtifactResolver"],function(n,t,i,r,u,f,e,o,s){Object.defineProperty(t,"__esModule",{value:!0});var h=function(){function n(n,t,i,r,u){this._tfsContext=n;this._actionsHub=t;this._filterHelper=r;this._columns=i;this._cache=u}return n.prototype.removeLinkedArtifact=function(n){this._actionsHub.removeLinkedArtifact.invoke({linkedArtifactToRemove:n})},n.prototype.changeLinkedArtifactComment=function(n,t){s.ArtifactResolver.invalidateArtifactCacheEntry(this._cache,n,this._columns);this._actionsHub.changeLinkedArtifactComment.invoke({linkedArtifactToChange:n,newComment:t})},n.prototype.changeViewOptions=function(n){this._actionsHub.changeViewOptions.invoke({viewOptions:n})},n.prototype.changeZeroDataOptions=function(n){this._actionsHub.changeZeroDataOptions.invoke({zeroDataOptions:n})},n.prototype.changeReadOnly=function(n){this._actionsHub.changeReadOnly.invoke({readOnly:n})},n.prototype.changeFetchingLinks=function(n){this._actionsHub.changeFetchingLinks.invoke({fetchingLinks:n})},n.prototype.setLinks=function(n,t){var i=this,u;if(this._retrievingLinks&&this._retrievingLinks.cancel(),this._retrievingLinks=new r.Cancelable(null),this._setStartFetchingDisplayData(),u=this._filterHelper.filter(n.slice(0)),u.length===0){this._groupAndSetArtifacts([],t);this.clearMessage();this._setEndFetchingData();return}s.ArtifactResolver.getInstance().resolveArtifacts(u,this._columns,t,this._tfsContext,function(n){return i._filterHelper.getSubtypeFilterForDataProvider(n)},this._cache).then(this._retrievingLinks.wrap(function(n){var u=n.resolvedArtifacts,r;i._groupAndSetArtifacts(u,t);n.messages&&n.messages.length>0?(r=n.messages.filter(function(n){return n.type===f.MessageAreaType.Error}),r.length>0?i.showMessage(r[0].text,r[0].type):i.showMessage(n.messages[0].text,n.messages[0].type)):i.clearMessage();i._setEndFetchingData()}))},n.prototype.sortLinkedArtifacts=function(n){var t=this,r=n.map(function(n){var r=i.first(t._columns,function(t){return t.refName===n.index});if(r)return{column:r,direction:n.order==="desc"?e.SortDirection.Descending:e.SortDirection.Ascending}}).filter(function(n){return!!n});this._actionsHub.sortLinkedArtifacts.invoke({sortColumns:r})},n.prototype.showMessage=function(n,t){t===void 0&&(t=f.MessageAreaType.Error);var i="";if(typeof n=="string")i=n;else if(typeof n=="object"&&n.message)i=n.message;else return;this._actionsHub.showMessage.invoke({message:{text:i,type:t}})},n.prototype.clearMessage=function(){this._actionsHub.showMessage.invoke({message:null})},n.prototype._groupAndSetArtifacts=function(n,t){var i=s.ArtifactResolver.groupLinkedArtifactsByLinkType(n);this._actionsHub.setLinkedArtifacts.invoke({groupedLinkedArtifacts:i,hostArtifact:t})},n.prototype._setStartFetchingDisplayData=function(){this._actionsHub.changeFetchingDisplayData.invoke({fetchingDisplayData:o.FetchingDisplayData.InProgress})},n.prototype._setEndFetchingData=function(){this._actionsHub.changeFetchingDisplayData.invoke({fetchingDisplayData:o.FetchingDisplayData.Done})},n}();t.ActionsCreator=h});

define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Logic/Filtering",["require","exports","VSS/Utils/Array","VSS/Utils/String"],function(n,t,i,r){Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function n(n,t){var i,r,u,f;if(this._linkTypeRefNames=n,t)for(this._filterConfiguration={},i=0,r=Object.keys(t);i<r.length;i++)u=r[i],f=t[u],this._filterConfiguration[u.toLowerCase()]=f}return n.prototype.filter=function(n){var t=this;return!this._linkTypeRefNames||this._linkTypeRefNames.length===0?n:n.filter(function(n){return i.contains(t._linkTypeRefNames,n.linkType,r.ignoreCaseComparer)})},n.prototype.getSubtypeFilterForDataProvider=function(n){var t=null;return n&&this._filterConfiguration&&(n=n.toLowerCase(),t=this._filterConfiguration[n]||null),t},n}();t.ArtifactFilterHelper=u});

define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Components/ComponentUtils",["require","exports","VSS/VSS","TFS/WorkItemTracking/ExtensionContracts"],function(n,t,i,r){var u,f;Object.defineProperty(t,"__esModule",{value:!0}),function(n){function t(n){var u=n.primaryData&&n.primaryData.displayId||n.id,f=n.linkTypeDisplayName||n.linkType||n.type,t;return n&&n.error&&(t=i.getErrorMessage(n.error)),{displayId:u,title:t,typeIcon:{type:r.ArtifactIconType.icon,descriptor:"bowtie-status-error la-error-icon",title:t},typeName:f,href:"#",callback:function(){return!0}}}n.getErrorPrimaryData=t}(u=t.ErrorUtils||(t.ErrorUtils={})),function(n){function t(n,t){var u,i,f,r;if(!n||!n.primaryData)return"";if(u="",n.additionalData)for(i=0,f=t;i<f.length;i++)r=f[i],n.additionalData[r.refName]&&(u+=r.name+":\t"+n.additionalData[r.refName].styledText.text+"\n");return u.trim()}n.getTooltip=t}(f=t.ComponentUtils||(t.ComponentUtils={}))});

var __extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__decorate=this&&this.__decorate||function(n,t,i,r){var f=arguments.length,u=f<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,i):r,e,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(e=n[o])&&(u=(f<3?e(u):f>3?e(t,i,u):e(t,i))||u);return f>3&&u&&Object.defineProperty(t,i,u),u};define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Components/ArtifactRenderer",["require","exports","react","OfficeFabric/Utilities","VSS/Diag","VSS/Events/Action","VSS/Utils/Array","VSS/Utils/Core","VSS/Utils/String","Presentation/Scripts/TFS/TFS.OM.Identities","Presentation/Scripts/TFS/TFS.Host.TfsContext","VSS/Controls/PopupContent","VSSUI/Tooltip","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Contracts","TFS/WorkItemTracking/ExtensionContracts","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Components/ComponentUtils","VSS/Utils/UI","Presentation/Scripts/TFS/Resources/TFS.Resources.Presentation"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){var k,d,ft,et,g,it,nt,tt,rt,ut;Object.defineProperty(t,"__esModule",{value:!0}),function(n){n.Component=function(n){var t=n.icon,r,f;if(t&&t.descriptor)switch(t.type){case y.ArtifactIconType.colorBar:return i.createElement(a.TooltipHost,{content:t.title},i.createElement("span",{className:"la-color-bar",style:{backgroundColor:t.descriptor}}));case y.ArtifactIconType.colorCircle:return i.createElement(a.TooltipHost,{content:t.title},i.createElement("span",{className:"la-color-circle",style:{backgroundColor:t.descriptor,borderColor:t.descriptor}}));case y.ArtifactIconType.icon:return r=null,typeof t.descriptor=="string"?r=i.createElement("span",{className:"bowtie-icon "+t.descriptor}):(f=t.descriptor,f&&(r=i.createElement("span",{className:"bowtie-icon "+f.icon,style:{color:f.color}}))),i.createElement(a.TooltipHost,{content:t.title},r)}return i.createElement("span",null)};n.GridComponent=function(n){var t=n.icon,i=document.createElement("span"),r;if(t&&t.descriptor)switch(t.type){case y.ArtifactIconType.colorBar:i.className="la-color-bar";i.style.backgroundColor=t.descriptor;break;case y.ArtifactIconType.colorCircle:i.className="la-color-circle";i.style.backgroundColor=t.descriptor;i.style.borderColor=t.descriptor;break;case y.ArtifactIconType.icon:typeof t.descriptor=="string"?i.className="bowtie-icon "+t.descriptor:(r=t.descriptor,r&&(i.className="bowtie-icon "+r.icon,i.style.color=r.color))}return i}}(k=t.ArtifactIcon||(t.ArtifactIcon={})),function(n){n.Component=function(n){var t=n.styledText,r,u;return t&&t.text?(r="la-text",u=t.className?r+" "+t.className:r,i.createElement("span",{className:u,style:{backgroundColor:t.className}},t.text)):i.createElement("span",null)};n.GridComponent=function(n){var t=n.styledText,i=document.createElement("span");return i.className="la-text"+(t.className?" "+t.className:""),i.innerText=t.text,i}}(d=t.ArtifactStyledText||(t.ArtifactStyledText={})),function(n){n.Component=function(n){var t=n.groupName;return n.count>1&&(t=t+"\u00a0("+n.count+")"),i.createElement("div",{className:"la-group-title"},t)};n.GridComponent=function(n){var i=document.createElement("span"),t;return i.className="la-group-title",t=n.groupName,n.count>1&&(t=t+"\u00a0("+n.count+")"),$(i).text(t),i}}(ft=t.ArtifactGroup||(t.ArtifactGroup={})),function(n){n.GridComponent=function(n){var i=document.createElement("span"),r=document.createElement("span"),t;return r.className="bowtie-icon bowtie-azure-api-management",t=document.createElement("span"),t.className="la-group-sub-title",$(t).text(n.subGroupName),i.appendChild(r),i.appendChild(t),i}}(et=t.ArtifactSubGroup||(t.ArtifactSubGroup={})),function(n){function t(n,t,i){var u=i.altKey||i.ctrlKey||i.metaKey||i.shiftKey||i.which===s||i.button===o,r;u||(r=!0,n.callback&&n.callback(n.miscData,t,i)&&(r=!1,i.preventDefault()),r&&(f.getService().performAction(f.CommonActions.ACTION_WINDOW_OPEN,{url:n.href,target:"_blank"}),i.preventDefault()))}function u(n){return!n||!n.user?null:{id:n.user.id,displayName:n.user.displayName,uniqueName:n.user.uniqueName,_links:{avatar:{href:v(n)}}}}function v(n){var t=n&&n.user;return t&&t.imageUrl?t.imageUrl:t&&t.email?c.TfsContext.getDefault().getIdentityImageUrl(null,{email:n.user.email,defaultGravatar:"mm"}):h.IdentityHelper.getIdentityImageUrl(t,h.IdentityImageMode.ShowGenericImage,h.IdentityImageSize.Small)}function e(n){var t,i;return typeof n=="string"?t=i=n:n.text&&(t=n.text,i=n.title),{text:t,title:i}}function y(n){var i=document.createElement("div"),s,c,a,p,v,w,o,b,y,f;return i.className=r.css("la-primary-data",n.className),n.primaryData&&n.primaryData.additionalPrefixIcon&&(s=document.createElement("div"),s.className="la-primary-icon",s.appendChild(k.GridComponent({icon:n.primaryData.additionalPrefixIcon})),i.appendChild(s)),c=document.createElement("div"),c.className="la-primary-icon",c.appendChild(k.GridComponent({icon:n.primaryData.typeIcon})),i.appendChild(c),a=u(n.primaryData),a&&(p=a._links.avatar.href,p&&(v=document.createElement("img"),w=h.IdentityHelper.getUniquefiedIdentityName(a),v.src=p,v.alt=w,o=document.createElement("div"),o.className="la-user-icon",o.appendChild(v),i.appendChild(o),l.RichContentTooltip.add(w,o))),n.primaryData.displayId&&n.primaryData.href!=="#"&&(b=e(n.primaryData.displayId),y=document.createElement("div"),y.className="la-primary-data-id",$(y).text(b.text),i.appendChild(y),i.appendChild(document.createTextNode("\u00a0"))),f=null,n.primaryData.href&&n.primaryData.href!=="#"?(f=document.createElement("a"),f.href=n.primaryData.href,f.onclick=t.bind(null,n.primaryData,n.hostArtifact),f.tabIndex=-1):f=document.createElement("span"),$(f).text(n.primaryData.title),i.appendChild(f),i}var o=1,s=2;n.openArtifact=t;n.Component=function(n){var s=function(){var t=u(n.primaryData);if(!t)return null;var r=t._links.avatar.href,f=null,e=h.IdentityHelper.getUniquefiedIdentityName(t);return r&&(f=i.createElement("img",{alt:e,src:r})),i.createElement(a.TooltipHost,{content:e},i.createElement("div",{className:"la-user-icon"},f))},f=null,o,r;return n.primaryData.displayId&&n.primaryData.href&&n.primaryData.href!=="#"&&(o=e(n.primaryData.displayId),f=i.createElement("div",{className:"la-primary-data-id"},o.text,"\u00a0")),r=null,r=n.primaryData.href&&n.primaryData.href!=="#"?i.createElement("a",{href:n.primaryData.href,onClick:t.bind(null,n.primaryData,n.hostArtifact)},n.primaryData.title):i.createElement("span",null,n.primaryData.title),i.createElement("div",{className:"la-primary-data"},i.createElement("div",{className:"la-primary-icon"},i.createElement(k.Component,{icon:n.primaryData.typeIcon})),s(),f,i.createElement(a.TooltipHost,{content:n.primaryData.title,overflowMode:a.TooltipOverflowMode.Parent},r))};n.GridComponent=y}(g=t.PrimaryArtifact||(t.PrimaryArtifact={})),function(n){n.Component=function(n){var u,t,f,r;return(n.data.icon&&(u=i.createElement(k.Component,{icon:n.data.icon})),t=null,n.data.styledText&&(t=i.createElement(d.Component,{styledText:n.data.styledText})),f=s.equals(n.data.title,n.data.styledText.text)?a.TooltipOverflowMode.Parent:undefined,r=i.createElement("div",{className:"la-additional-data-item"},u,t),n.data.title)?i.createElement(a.TooltipHost,{content:n.data.title,overflowMode:f},r):r};n.GridComponent=function(n){var t=document.createElement("div"),i,r;return t.className="la-additional-data-item",i=k.GridComponent({icon:n.data.icon}),t.appendChild(i),r=d.GridComponent({styledText:n.data.styledText}),t.appendChild(r),n.data.title&&n.data.title!==n.data.styledText.text&&l.RichContentTooltip.add(n.data.title,t),t}}(it=t.AdditionalArtifact||(t.AdditionalArtifact={})),function(n){n.Component=function(n){return i.createElement("button",{className:"la-item-delete",onClick:n.onDelete,"aria-label":b.LinkedArtifacts_RemoveLink},i.createElement(a.TooltipHost,{content:b.LinkedArtifacts_RemoveLink},i.createElement("span",{className:"bowtie-icon bowtie-edit-delete"})))}}(nt=t.ArtifactDeleteButton||(t.ArtifactDeleteButton={}));tt=function(n){function t(t){var i=n.call(this,t)||this;return i.state={hasFocus:!1},i}return __extends(t,n),t.prototype.focus=function(){this._itemElement.focus()},t.prototype.render=function(){var n=this,u=[v.InternalKnownColumns.LastUpdate.refName,v.InternalKnownColumns.State.refName],t=u.map(function(t){if(n.props.linkedArtifact.additionalData&&n.props.linkedArtifact.additionalData[t]&&n.props.columns.some(function(n){return n.refName===t}))return n._renderAdditional(t,n.props.linkedArtifact.additionalData[t])}).filter(function(n){return!!n}),f,o,r,h;return t=this._intersperse(t),this.props.displayOptions.readOnly||(f=i.createElement(nt.Component,{onDelete:this._onDelete})),this.props.linkedArtifact.action&&!this.props.displayOptions.readOnly&&(o=i.createElement(ut,{linkedArtifact:this.props.linkedArtifact,hostArtifact:this.props.hostArtifact})),r="la-item",this.state.hasFocus&&(r+=" la-item-focus"),h=this.props.columns.filter(function(n){return!e.contains(u,n.refName,s.ignoreCaseComparer)}),i.createElement("div",{className:r,onFocus:this._onFocus,onBlur:this._onBlur,onKeyDown:this._onKeyDown,ref:this._resolveItemRef},i.createElement("div",{className:"la-item-wrapper"},i.createElement("div",{className:"la-artifact-data"},i.createElement(g.Component,{primaryData:this.props.linkedArtifact.primaryData,hostArtifact:this.props.hostArtifact}),i.createElement("div",{className:"la-additional-data"},t),o)),f)},t.prototype.componentWillUnmount=function(){var n=this;this.state.hasFocus&&(this._previousElement=r.getPreviousElement(document.body,this._itemElement),this._previousElement&&o.delay(this,0,function(){var t=r.getNextElement(document.body,n._previousElement);t&&t.focus()}))},t.prototype._renderAdditional=function(n,t){return i.createElement(it.Component,{key:n,data:t})},t.prototype._onDelete=function(n){this.props.actionsCreator.removeLinkedArtifact(this.props.linkedArtifact);n.preventDefault()},t.prototype._onFocus=function(){this.setState({hasFocus:!0});this._scheduledFocusChange&&(this._scheduledFocusChange.cancel(),this._scheduledFocusChange=null)},t.prototype._onBlur=function(){var n=this;this._scheduledFocusChange=o.delay(this,0,function(){n._itemElement&&n.setState({hasFocus:!1})})},t.prototype._onKeyDown=function(n){switch(n.keyCode){case w.KeyCode.DELETE:this.props.actionsCreator.removeLinkedArtifact(this.props.linkedArtifact);n.preventDefault()}},t.prototype._resolveItemRef=function(n){this._itemElement=n},t.prototype._intersperse=function(n){if(n.length===0)return[];var t=0;return n.slice(1).reduce(function(n,r){return n.concat([i.createElement("span",{key:t++},", \u00a0 "),r])},[n[0]])},__decorate([r.autobind],t.prototype,"_onDelete",null),__decorate([r.autobind],t.prototype,"_onFocus",null),__decorate([r.autobind],t.prototype,"_onBlur",null),__decorate([r.autobind],t.prototype,"_onKeyDown",null),__decorate([r.autobind],t.prototype,"_resolveItemRef",null),t}(i.Component);t.ArtifactComponent=tt;rt=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.render=function(){var n=this.props.linkedArtifact,e=n.linkTypeDisplayName||n.linkType||n.type,t=p.ErrorUtils.getErrorPrimaryData(n),f=i.createElement(g.Component,{primaryData:t,hostArtifact:this.props.hostArtifact}),r=null,u;return t.href&&t.href!=="#"&&(r=[this._renderAdditional("System.Links.ErrorColumn",{styledText:{text:s.localeFormat(b.LinkedArtifacts_ItemError)},title:s.localeFormat(b.LinkedArtifacts_ItemError)})]),this.props.displayOptions.readOnly||(u=i.createElement(nt.Component,{onDelete:this._onDelete.bind(this)})),i.createElement("div",{className:"la-item"},i.createElement("div",{className:"la-item-wrapper"},i.createElement("div",{className:"la-artifact-data"},f,i.createElement("div",{className:"la-additional-data"},r))),u)},t}(tt);t.ArtifactErrorComponent=rt;ut=function(n){var r=function(){n.linkedArtifact.action.callback&&n.linkedArtifact.action.callback(n.linkedArtifact.miscData,n.hostArtifact)},t=n.linkedArtifact.action;return i.createElement("div",{className:"la-action"},i.createElement(a.TooltipHost,{content:t.title,overflowMode:a.TooltipOverflowMode.Parent},i.createElement("a",{href:t.href,onClick:r},t.styledText.text)))}});

define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Components/LinksListComponent",["require","exports","react","OfficeFabric/Utilities","VSS/Utils/UI","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Components/ArtifactRenderer","Presentation/Scripts/TFS/Resources/TFS.Resources.Presentation","VSS/Utils/String"],function(n,t,i,r,u,f,e,o){var s,h,c;Object.defineProperty(t,"__esModule",{value:!0});s=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.state={numberOfVisibleArtifacts:r.props.displayOptions.artifactPageSize},r}return __extends(t,n),t.prototype.render=function(){for(var v,u,w,b,n,h,l=t._getGroupRenderOptions(this.state.numberOfVisibleArtifacts,this.props.linkedArtifactGroups),k=this._renderGroups(l),y=null,r=[],f=0,s=0,a=0,p=Object.keys(l);a<p.length;a++)v=p[a],u=l[v],f+=u.visibleCount,s+=u.totalArtifacts,s>f&&(w=u.totalArtifacts-u.visibleCount,r.push(v+" ("+w+")"));if(s>f){if(b=o.format(e.RelatedArtifacts_RemainingCount,f,s),n="",r&&r.length>0){for(n=r[0],h=1;h<r.length;h++)n=o.format(e.RelatedArtifacts_SummaryDelimiter,n,r[h]);n=o.format(e.RelatedArtifacts_SummaryNotShown,n)}y=i.createElement(c,{itemsNotShownDescription:n,itemsShownDescription:b,showMore:this._showMore.bind(this)})}return i.createElement("div",{className:"la-list"},k,y)},t._getGroupRenderOptions=function(n,t){var i={},r=!n;return t.forEach(function(t){var u=t.linkedArtifacts.length;r||(u>n&&(u=n),n=n-u);i[t.displayName]={totalArtifacts:t.linkedArtifacts.length,visibleCount:u,group:t}}),i},t.prototype._renderGroups=function(n){var t=this;return this.props.linkedArtifactGroups.map(function(r){var u=n[r.displayName].visibleCount;return u===0?null:i.createElement(h,{key:r.displayName,hostArtifact:t.props.hostArtifact,actionsCreator:t.props.actionsCreator,displayOptions:t.props.displayOptions,displayName:r.displayName,linkedArtifacts:r.linkedArtifacts,columns:t.props.columns,visibleCount:u})}).filter(function(n){return!!n})},t.prototype._showMore=function(){var n=this;this.setState(function(t){return{numberOfVisibleArtifacts:t.numberOfVisibleArtifacts+n.props.displayOptions.artifactPageSize}})},t}(i.Component);t.LinksListComponent=s;h=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.render=function(){var n,t,r;return this.props.displayOptions.showGroupHeaders&&this.props.visibleCount>0&&(n=i.createElement(f.ArtifactGroup.Component,{groupName:this.props.displayName,count:this.props.linkedArtifacts.length})),t=this._renderLinks(),r=this.props.displayOptions.showGroupHeaders?"la-list-group-showheader":"la-list-group-noheader",i.createElement("div",{className:r},n,t)},t.prototype._renderLinks=function(){var n=this;return this.props.linkedArtifacts.slice(0,this.props.visibleCount).map(function(t){return t.error?i.createElement(f.ArtifactErrorComponent,{key:t.id+"-"+t.linkType,hostArtifact:n.props.hostArtifact,actionsCreator:n.props.actionsCreator,displayOptions:n.props.displayOptions,columns:n.props.columns,linkedArtifact:t}):i.createElement(f.ArtifactComponent,{key:t.id+"-"+t.linkType,hostArtifact:n.props.hostArtifact,actionsCreator:n.props.actionsCreator,displayOptions:n.props.displayOptions,columns:n.props.columns,linkedArtifact:t})})},t}(i.Component);c=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.render=function(){var n=this;return i.createElement("div",null,i.createElement("div",null,i.createElement("div",{className:"la-show-more-container"},i.createElement("div",{role:"button",tabIndex:0,className:"la-show-more",onClick:function(){return n._callShowMore()},onKeyUp:this._onShowMoreKeyUp},e.RelatedArtifacts_ShowMore),i.createElement("div",{className:"la-shown-count"},this.props.itemsShownDescription))),i.createElement("div",{className:"la-not-shown-count"},this.props.itemsNotShownDescription))},t.prototype._onShowMoreKeyUp=function(n){(n.keyCode===u.KeyCode.ENTER||n.keyCode===u.KeyCode.SPACE)&&this._callShowMore()},t.prototype._callShowMore=function(){this.props.showMore()},__decorate([r.autobind],t.prototype,"_onShowMoreKeyUp",null),t}(i.Component)});

define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Components/LoadingIndicatorComponent",["require","exports","react","OfficeFabric/Spinner","OfficeFabric/Utilities","Presentation/Scripts/TFS/Resources/TFS.Resources.Presentation"],function(n,t,i,r,u,f){Object.defineProperty(t,"__esModule",{value:!0});var e=750,o=function(n){function t(t){var i=n.call(this,t)||this;return i._showSpinner=function(){i.setState({showLoadingIndicator:!0})},i._async=new u.Async,i.state={showLoadingIndicator:!1},i}return __extends(t,n),t.prototype.render=function(){return this.state.showLoadingIndicator?i.createElement(r.Spinner,{label:f.LinkedArtifacts_Loading}):null},t.prototype.componentDidMount=function(){this._timeoutId=this._async.setTimeout(this._showSpinner,e)},t.prototype.componentWillUnmount=function(){this._timeoutId&&(this._async.clearTimeout(this._timeoutId),this._timeoutId=null)},t}(i.Component);t.LoadingIndicatorComponent=o});

define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Components/ZeroDataComponent",["require","exports","react","Presentation/Scripts/TFS/Resources/TFS.Resources.Presentation"],function(n,t,i,r){Object.defineProperty(t,"__esModule",{value:!0});var u=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.render=function(){var t=this.props.message||r.LinkedArtifacts_ZeroData,n;return this.props.action&&(n=i.createElement("div",{className:"la-zero-data-action"},i.createElement("button",{className:"la-action-button",onClick:this._onClickAction.bind(this)},this.props.action.actionMessage))),i.createElement("div",{className:"la-zero-data-container"},i.createElement("div",{className:"la-zero-data"},t),n)},t.prototype._onClickAction=function(n){return this.props.action&&this.props.action.actionCallback?this.props.action.actionCallback()?!0:(n.preventDefault(),!1):!0},t}(i.Component);t.ZeroDataComponent=u});

define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Components/MessageComponent",["require","exports","react","VSS/Diag","VSS/Controls/Notifications"],function(n,t,i,r,u){Object.defineProperty(t,"__esModule",{value:!0});var f=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.render=function(){if(!this.props.message||!this.props.message.text)return null;return(typeof this.props.message.text=="string")?i.createElement("div",{className:"la-message"},i.createElement("span",{className:"la-message-icon icon bowtie-icon "+this._getIconClass()}),i.createElement("div",{className:"la-message-text"},this.props.message.text)):null},t.prototype._getIconClass=function(){switch(this.props.message.type){case u.MessageAreaType.Error:return"bowtie-status-error";case u.MessageAreaType.Warning:return"bowtie-status-warning";case u.MessageAreaType.Info:default:return"bowtie-status-info"}},t}(i.Component);t.MessageComponent=f});

define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Components/MainComponent",["require","exports","react","Presentation/Scripts/TFS/Resources/TFS.Resources.Presentation","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Contracts","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Interfaces","VSS/Flux/AsyncLoadedComponent","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Components/LinksListComponent","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Components/LoadingIndicatorComponent","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Components/ZeroDataComponent","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Components/MessageComponent"],function(n,t,i,r,u,f,e,o,s,h,c){Object.defineProperty(t,"__esModule",{value:!0});var l=function(){return i.createElement("div",null,r.Loading)},a=e.getAsyncLoadedComponent(["Presentation/Scripts/TFS/Controls/LinkedArtifacts/Components/LinksGridComponent"],function(n){return n.LinksGridComponent},function(){return i.createElement(l,null)}),v=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r._onDeleteLink=function(){r._element&&r._element.focus()},r.state=r.props.store.getState(),r}return __extends(t,n),t.prototype.componentDidMount=function(){this._storeListenerDelegate=this._onStoreChanged.bind(this);this.props.store.addChangedListener(this._storeListenerDelegate);this.props.onRender()},t.prototype.componentWillUnmount=function(){this.props.store.removeChangedListener(this._storeListenerDelegate);this._storeListenerDelegate=null},t.prototype.componentDidUpdate=function(){this.props.onRender()},t.prototype.render=function(){var p=this,n=null,r=null,e;if(this.state.linkedArtifactGroups.length===0&&this.state.fetchingDisplayData===f.FetchingDisplayData.Done&&this.state.fetchingLinks===u.FetchingLinks.Done){if(e=this.state.displayOptions.zeroDataOptions.zeroDataExperienceViewMode,e!==u.ZeroDataExperienceViewMode.Hidden){var t=this.state.displayOptions.zeroDataOptions,l=t.message,v=t.action,y=t.onRenderZeroData;n=y?y(l,v):i.createElement(h.ZeroDataComponent,{action:v,message:l})}}else n=this.state.displayOptions.viewMode===u.ViewMode.List?i.createElement(o.LinksListComponent,{actionsCreator:this.props.actionsCreator,linkedArtifactGroups:this.state.linkedArtifactGroups,columns:this.props.columns,displayOptions:this.state.displayOptions,hostArtifact:this.state.hostArtifact}):i.createElement(a,{actionsCreator:this.props.actionsCreator,linkedArtifactGroups:this.state.linkedArtifactGroups,columns:this.props.columns,sortColumns:this.state.sortColumns,displayOptions:this.state.displayOptions,onDeleteLink:this._onDeleteLink,hostArtifact:this.state.hostArtifact});return(this.state.fetchingDisplayData===f.FetchingDisplayData.InProgress||this.state.fetchingLinks===u.FetchingLinks.InProgress)&&(r=i.createElement(s.LoadingIndicatorComponent,null)),i.createElement("div",{className:"la-main-component",tabIndex:-1,ref:function(n){p._element=n}},i.createElement(c.MessageComponent,{message:this.state.message}),r,n)},t.prototype._onStoreChanged=function(){this.setState(this.props.store.getState())},t}(i.Component);t.MainComponent=v});

define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Control",["require","exports","react","VSS/Diag","VSS/Utils/Core","VSS/Utils/Array","VSS/Utils/String","VSS/Telemetry/Services","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Contracts","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Flux/Store","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Flux/Actions","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Flux/ActionsCreator","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Logic/Filtering","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Components/MainComponent","VSS/LoaderPlugins/Css!Controls/LinkedArtifacts/LinkedArtifacts"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){Object.defineProperty(t,"__esModule",{value:!0});var y=function(n){function t(t){var i=n.call(this,t)||this,u,f;return u=new c.ActionsHub,f=new a.ArtifactFilterHelper(i.props.linkTypeRefNames,i.props.artifactSubTypeFilters),i._store=new h.LinkedArtifactsStore(u,i.props.linkTypeRefNames,i.props.sortColumns,i.props.viewOptions,i.props.gridViewOptions,i.props.zeroDataOptions,i.props.readOnly,null,i.props.artifactPageSize),i._actionsCreator=new l.ActionsCreator(i.props.tfsContext,u,i._getColumns(),f,i.props.cache),u.removeLinkedArtifact.addListener(i._onRemoveArtifact.bind(i)),u.changeLinkedArtifactComment.addListener(i._onChangedLinkComment.bind(i)),i.props.linkedArtifacts&&i.setLinkedArtifacts(i.props.linkedArtifacts,i.props.hostArtifact),i}return __extends(t,n),t.prototype.componentWillReceiveProps=function(n){n&&n.linkedArtifacts&&this.setLinkedArtifacts(n.linkedArtifacts,n.hostArtifact)},t.prototype.setLinkedArtifacts=function(n,t){this._actionsCreator.setLinks(n,t)},t.prototype.setViewOptions=function(n){this._actionsCreator.changeViewOptions(n)},t.prototype.setReadOnly=function(n){this._actionsCreator.changeReadOnly(n)},t.prototype.setZeroDataOptions=function(n){this._actionsCreator.changeZeroDataOptions(n)},t.prototype.setFetchingLinks=function(n){this._actionsCreator.changeFetchingLinks(n.fetchingLinks)},t.prototype.setMessage=function(n,t){this.setMessage(n,t)},t.prototype.clearMessage=function(){this._actionsCreator.clearMessage()},t.prototype.render=function(){return i.createElement(v.MainComponent,{store:this._store,actionsCreator:this._actionsCreator,columns:this._getColumns(),onRender:this._onRender.bind(this),ref:"element"})},t.prototype._onRemoveArtifact=function(n){var t=this;this._store.getState().displayOptions.readOnly||this.props.onRemoveLinkedArtifact&&u.delay(null,0,function(){t.props.onRemoveLinkedArtifact(n.linkedArtifactToRemove)})},t.prototype._onChangedLinkComment=function(n){var t=this;this._store.getState().displayOptions.readOnly||(this.props.onChangeLinkedArtifactComment&&u.delay(null,0,function(){t.props.onChangeLinkedArtifactComment(n.linkedArtifactToChange,n.newComment)}),o.publishEvent(new o.TelemetryEventData(s.LINKED_ARTIFACTS_CUSTOMER_INTELLIGENCE_AREA,"editLinkComment",{linkType:n.linkedArtifactToChange.linkTypeDisplayName,commentLength:n.newComment.length})))},t.prototype._getColumns=function(){var n=this.props&&this.props.columns||t.DEFAULT_COLUMNS,i=f.findIndex(n,function(n){return e.equals(n.refName,s.InternalKnownColumns.Link.refName,!0)});return i>0?(n.splice(i,1),n.unshift(s.InternalKnownColumns.Link)):i===-1&&n.unshift(s.InternalKnownColumns.Link),n},t.prototype._onRender=function(){this.props.onRender&&this.props.onRender()},t.DEFAULT_COLUMNS=[s.InternalKnownColumns.State,s.InternalKnownColumns.LastUpdate,s.InternalKnownColumns.Comment],t}(i.Component);t.LinkedArtifactsControl=y});

define("VersionControl/Scenarios/Shared/WorkItemListSelector",["require","exports","react","OfficeFabric/Label","VSS/Controls","VSS/Flux/PlatformComponent","VersionControl/Scripts/Controls/AddRelatedWorkItemsControl","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Control"],function(n,t,i,r,u,f,e,o){var s,h;Object.defineProperty(t,"__esModule",{value:!0});s=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.render=function(){return i.createElement("div",null,this.props.label&&i.createElement(r.Label,null,this.props.label),i.createElement(h,{cssClass:"bowtie-style",options:this.props}),i.createElement("div",{className:"linked-artifacts-container"},i.createElement(o.LinkedArtifactsControl,__assign({},this.props))))},t}(i.PureComponent);t.WorkItemListSelector=s;h=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.createControl=function(n){return u.create(e.AddRelatedWorkItemsControl,n,this.props.options)},t}(f.Component)});

define("VersionControl/Scripts/RefNameValidator",["require","exports","VSS/Utils/Array","VSS/Utils/String","VersionControl/Scripts/Generated/TFS.VersionControl.Common","VersionControl/Scripts/GitRefUtility","VersionControl/Scripts/Resources/TFS.Resources.VersionControl","VersionControl/Scripts/VersionControlPath"],function(n,t,i,r,u,f,e,o){var s,h,c,l;Object.defineProperty(t,"__esModule",{value:!0}),function(n){n[n.None=0]="None";n[n.NameTooLong=1]="NameTooLong";n[n.InvalidCharacter=2]="InvalidCharacter";n[n.InvalidLeadCharacter=3]="InvalidLeadCharacter";n[n.InvalidTrailCharacter=4]="InvalidTrailCharacter";n[n.NameEmpty=5]="NameEmpty";n[n.AlreadyExists=6]="AlreadyExists";n[n.ExistingRefUsedAsFolder=7]="ExistingRefUsedAsFolder";n[n.NewRefIsExistingFolder=8]="NewRefIsExistingFolder"}(s=t.RefNameErrorType||(t.RefNameErrorType={}));h=function(){function n(n){this._invalidRefNameStrings=["~","^",":"," ","?","*","[","\\","/.",".lock/","//","..","@{"];this._invalidLeadNameStrings=["/","."];this._invalidTrailNameStrings=[".lock",".","/"];this._updateExistingRefs(n)}return n.prototype.validate=function(n){var t=s.None,i=null,f,r,u;return n.length>0?(f=this.getFullRefName(n),f.length>this.getNameMaxLength()?t=s.NameTooLong:(this._invalidRefNameStrings.some(function(t){return n.indexOf(t)>-1?(i=t,!0):!1}),i?t=s.InvalidCharacter:(this._invalidLeadNameStrings.some(function(t){return n.lastIndexOf(t,0)===0?(i=t,!0):!1}),i?t=s.InvalidLeadCharacter:(this._invalidTrailNameStrings.some(function(t){var r=n.length-t.length;return r>=0&&n.indexOf(t,r)===r?(i=t,!0):!1}),i?t=s.InvalidTrailCharacter:this._refExists(n)?t=s.AlreadyExists:(r=this._findRefUsedAsFolder(n),r?(t=s.ExistingRefUsedAsFolder,i=r):(u=this._findBranchInsideFolder(n),u&&(t=s.NewRefIsExistingFolder,i=u))))))):t=s.NameEmpty,{error:this.getErrorString(t,i),allValid:t===s.None}},n.prototype.getNameMaxLength=function(){return u.GitConstants.MaxGitRefNameLength},n.prototype._updateExistingRefs=function(n){var t,u,i,r,f,e;for(this._existingRefsHash={},this._existingFoldersHash={},t=0,u=n;t<u.length;t++)for(i=u[t],this._existingRefsHash[i]=!0,r=0,f=o.getParentPaths(i);r<f.length;r++)e=f[r],this._existingFoldersHash[e]=i},n.prototype._refExists=function(n){return!!this._existingRefsHash[n]},n.prototype._findRefUsedAsFolder=function(n){var t=this;return i.first(o.getParentPaths(n),function(n){return t._existingRefsHash[n]})},n.prototype._findBranchInsideFolder=function(n){return this._existingFoldersHash[n]},n}();t.RefNameValidator=h;c=function(n){function t(t){return n.call(this,t)||this}return __extends(t,n),t.prototype.getErrorString=function(n,t){switch(n){case s.None:return"";case s.NameEmpty:return e.BranchNameCannotBeEmpty;case s.NameTooLong:return e.BranchNameTooLong;case s.AlreadyExists:return e.CreateBranchDialogBranchExistsMessage;case s.ExistingRefUsedAsFolder:return r.format(e.CreateBranchDialogExistingRefUsedAsFolder,t);case s.NewRefIsExistingFolder:return r.format(e.CreateBranchDialogNewRefIsExistingFolder,t);case s.InvalidTrailCharacter:return r.format(e.CreateBranchDialogInvalidTrailCharacterMessage,t);case s.InvalidLeadCharacter:return r.format(e.CreateBranchDialogInvalidLeadCharacterMessage,t);case s.InvalidCharacter:return r.format(e.CreateBranchDialogInvalidCharacterMessage,t);default:return""}},t.prototype.getFullRefName=function(n){return f.getFullRefNameFromBranch(n)},t.prototype.getNameMaxLength=function(){return u.GitConstants.MaxGitRefNameLength-11},t}(h);t.BranchNameValidator=c;l=function(n){function t(t){return n.call(this,t)||this}return __extends(t,n),t.prototype.getErrorString=function(n,t){switch(n){case s.None:return"";case s.NameEmpty:return e.CreateTag_EmptyTagNameError;case s.NameTooLong:return e.CreateTag_TagNameTooLong;case s.AlreadyExists:return e.CreateTag_TagExistsMessage;case s.InvalidTrailCharacter:return r.format(e.CreateTag_InvalidTrailCharacterMessage,t);case s.InvalidLeadCharacter:return r.format(e.CreateTag_InvalidLeadCharacterMessage,t);case s.InvalidCharacter:return r.format(e.CreateTag_InvalidCharacterMessage,t);default:return""}},t.prototype.getFullRefName=function(n){return f.getFullRefNameFromTagName(n)},t.prototype.getNameMaxLength=function(){return u.GitConstants.MaxGitRefNameLength-10},t}(h);t.TagsNameValidator=l});

define("VersionControl/Scenarios/Shared/Committing/CommitDialog",["require","exports","OfficeFabric/Button","OfficeFabric/Checkbox","OfficeFabric/Dialog","OfficeFabric/Label","OfficeFabric/MessageBar","OfficeFabric/Spinner","OfficeFabric/TextField","react","VSS/Utils/Accessibility","VSS/Utils/String","VSS/Utils/UI","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Contracts","VersionControl/Scenarios/Shared/Committing/TextFieldParentAddon","VersionControl/Scenarios/Shared/FileInput","VersionControl/Scenarios/Shared/WorkItemListSelector","VersionControl/Scripts/FileSpecUtility","VersionControl/Scripts/RefNameValidator","VersionControl/Scripts/Resources/TFS.Resources.VersionControl","VersionControl/Scripts/Utils/WorkItemLinkUtils","VersionControl/Scripts/VersionControlPath","VSS/LoaderPlugins/Css!VersionControl/Shared/Committing/CommitDialog"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt){Object.defineProperty(t,"__esModule",{value:!0});var tt=function(n){function t(t){var i=n.call(this,t)||this,r;return i.captureCommentTextField=function(n){i.commentTextField=n;n&&i.setInitialFocus()},i.captureNewItemNameTextField=function(n){i.newItemNameTextField=n;n&&i.setInitialFocus()},i.saveOnCtrlEnter=function(n){n.ctrlKey&&i.saveOnEnter(n)},i.saveOnEnter=function(n){n.which===a.KeyCode.ENTER&&i.canSave()&&(i.save(),n.preventDefault(),n.stopPropagation())},i.setUploadedFileState=function(n){var t=i.getDefaultUploadFilesComment(n);i.setState({filesToBeUploaded:n,autoComment:t})},i.setComment=function(n){i.setState({comment:n})},i.setNewBranchName=function(n){i.setState({newBranchName:n,newBranchNameErrorMessage:i.getErrorBranchName(n)})},i.toggleCreatePullRequest=function(){i.setState(function(n){return{hasToCreatePullRequest:!n.hasToCreatePullRequest}})},i.setNewItemName=function(n){n=n?n.trim():"";var t=i.props.isRenaming?l.format(d.DefaultRenameCommentFormatFromTo,i.props.itemName,n):i.props.isCreatingFolder?l.format(d.DefaultCreateFolderCommentFormat,n):i.state.autoComment,r=i.state.autoComment===i.state.comment?t:i.state.comment;i.setState({autoComment:t,comment:r,newItemName:n,newItemNameErrorMessage:i.getErrorNewItemName(n),isNewItemNameErrorInitiallyHidden:!1})},i.save=function(){if(!i.isValid())throw new Error("Save should not be enabled if dialog is not valid.");i.props.onSave({comment:i.state.comment||i.state.autoComment,isCommentDefault:!i.state.comment||i.state.comment===i.state.autoComment,newBranchName:i.isNewBranch()&&i.state.newBranchName,hasToCreatePullRequest:i.isNewBranch()&&i.state.hasToCreatePullRequest,newItemName:i.state.newItemName,linkedWorkItemIds:i.state.linkedWorkItemIds,filesToBeUploaded:i.state.filesToBeUploaded})},i.getErrorBranchName=function(n){if(!n||n===i.props.currentBranchName)return undefined;var r=new k.BranchNameValidator(i.props.existingBranches||[]),t=r.validate(n);return t.allValid?undefined:t.error},i.getErrorNewItemName=function(n){var r,t;return n?i.props.isRenaming&&n===i.props.itemName?d.CommitRenameToSameNameError:(t=nt.validateMaxLength(i.props.editingPath,n),t)?t:i.fileAlreadyExists(n)?d.CommitNewItemNameAlreadyExists:b.hasIllegalNtfsChars(n)?l.format(d.InvalidFileName,n):void 0:(r=i.props.isRenaming?d.CommitNewItemNameLabel:d.CommitNewFolderNameLabel,l.format(d.ValidationMessageIsRequired,r))},i.fileAlreadyExists=function(n){var t=nt.combinePaths(i.props.editingPath,n);return i.props.existingFileList&&i.props.existingFileList.filter(function(n){return l.localeIgnoreCaseComparer(n.serverItem,t)===0}).length>0},i.addWorkItem=function(n){i.setState({linkedWorkItemIds:i.state.linkedWorkItemIds.concat([n])})},i.removeWorkItem=function(n){i.setState({linkedWorkItemIds:i.state.linkedWorkItemIds.filter(function(t){return t!==Number(n.id)})})},i.containsWorkItem=function(n){return i.state.linkedWorkItemIds.indexOf(n)>=0},i.setInitialFocus=function(){if(i.newItemNameTextField){if(i.newItemNameTextField.focus(),i.newItemNameTextField.setSelectionStart(0),i.state.newItemName){var n=i.state.newItemName.lastIndexOf(".");i.newItemNameTextField.setSelectionEnd(n>0?n:i.state.newItemName.length)}}else i.commentTextField&&i.commentTextField.focus()},r=t.isRenaming?t.itemName:"",i.state={comment:t.initialComment,autoComment:t.initialComment,newBranchName:t.currentBranchName,newBranchNameErrorMessage:i.getErrorBranchName(""),hasToCreatePullRequest:!1,newItemName:r,newItemNameErrorMessage:i.getErrorNewItemName(r),isNewItemNameErrorInitiallyHidden:!0,linkedWorkItemIds:[],filesToBeUploaded:[]},i}return __extends(t,n),t.prototype.componentWillReceiveProps=function(n){n.isSaving&&!this.props.isSaving&&c.announce(n.isGit?d.CommitSaving:d.CheckinSaving)},t.prototype.componentDidUpdate=function(n){this.props.errorMessage&&!n.errorMessage&&setTimeout(this.setInitialFocus)},t.prototype.render=function(){var n=this.isNewBranch()?d.EditFileCommitToNewBranch:this.getSaveButtonText();return h.createElement(u.Dialog,{modalProps:{containerClassName:"vc-commit-dialog",isBlocking:!0},hidden:!1,dialogContentProps:{type:u.DialogType.close,className:"vc-commit-dialog-content"},title:n,closeButtonAriaLabel:d.DialogClose,onDismiss:this.props.onDismiss},this.props.errorMessage&&h.createElement(e.MessageBar,{messageBarType:e.MessageBarType.error},this.props.errorMessage),(this.props.isRenaming||this.props.isCreatingFolder)&&this.renderNewItemName(),this.props.isUploading&&h.createElement(p.FileInput,{isGit:this.props.isGit,rootPath:this.props.rootPath,editingPath:this.props.editingPath,initialDrop:this.props.initialDrop,onUploadedFileStateChaged:this.setUploadedFileState,filesToBeUploaded:this.state.filesToBeUploaded,fileAlreadyExists:this.fileAlreadyExists}),h.createElement("div",{className:"comment-container"},h.createElement(f.Label,{className:"right-side-label",disabled:!0},this.state.comment&&this.state.comment!==this.state.autoComment?this.state.autoComment:""),h.createElement(s.TextField,{label:d.CommitCommentLabel,ref:this.captureCommentTextField,placeholder:this.state.autoComment,multiline:!0,resizable:!1,disabled:this.props.isSaving||this.props.gatedCheckin!==undefined,value:this.state.comment,onChanged:this.setComment,onKeyDown:this.saveOnCtrlEnter})),this.props.isGit&&h.createElement("div",{className:"new-branch-name-fixed-container"},h.createElement(f.Label,{className:"right-side-label",disabled:!0},this.isNewBranch()?l.format(d.CommitBranchBasedOnLabel,this.props.currentBranchName):""),h.createElement(s.TextField,{label:d.CommitBranchNameLabel,placeholder:this.props.currentBranchName,disabled:this.props.isSaving,value:this.state.newBranchName,onChanged:this.setNewBranchName,errorMessage:this.state.newBranchNameErrorMessage})),!this.props.gatedCheckin&&h.createElement(w.WorkItemListSelector,{tfsContext:this.props.tfsContext,linkedArtifacts:this.state.linkedWorkItemIds.map(g.mapWorkItemIdToLinkedArtifact),onWorkItemAdd:this.addWorkItem,checkWorkItemExists:this.containsWorkItem,onRemoveLinkedArtifact:this.removeWorkItem,viewOptions:{viewMode:v.ViewMode.List},zeroDataOptions:{zeroDataExperienceViewMode:v.ZeroDataExperienceViewMode.Hidden},linkTypeRefNames:null,hostArtifactId:null,dropIconCss:"bowtie-chevron-down-light",label:d.CreateBranchDialogWorkItemsLabel}),h.createElement("div",{className:"create-pull-request-container"},this.isNewBranch()&&h.createElement(r.Checkbox,{label:d.CreatePullRequestLabel,checked:this.state.hasToCreatePullRequest,disabled:!this.props.canCreatePullRequest||this.props.isSaving,onChange:this.toggleCreatePullRequest})),this.renderFooter())},t.prototype.renderNewItemName=function(){var t=this.props.isRenaming?d.CommitNewItemNameLabel:d.CommitNewFolderNameLabel,n=this.props.isCreatingFolder&&this.props.editingPath;return h.createElement(s.TextField,{className:"new-item-name-fixed-container",ref:this.captureNewItemNameTextField,label:t,prefix:n,onRenderPrefix:n&&y.TextFieldParentAddon,placeholder:d.CommitNewItemNameWatermark,disabled:this.props.isSaving,value:this.state.newItemName,onChanged:this.setNewItemName,onKeyDown:this.saveOnEnter,errorMessage:!this.state.isNewItemNameErrorInitiallyHidden&&this.state.newItemNameErrorMessage})},t.prototype.renderFooter=function(){if(this.props.isSaving)return h.createElement(o.Spinner,{label:this.props.isGit?d.CommitSaving:d.CheckinSaving});if(this.props.gatedCheckin){if(this.props.gatedCheckin.buildId)return h.createElement("div",null,h.createElement("span",null,l.format(d.CommitQueuedGatedCheckin,this.props.gatedCheckin.shelvesetName,this.props.gatedCheckin.affectedBuildDefinitionNames[0])));var n=this.props.gatedCheckin.affectedBuildDefinitionNames.map(function(n,t){return h.createElement("li",{key:t},n)});return h.createElement("div",null,h.createElement("span",null,d.CommitRequiresGatedCheckin),h.createElement("ul",null,n))}return h.createElement(u.DialogFooter,null,h.createElement(i.PrimaryButton,{disabled:!this.canSave(),onClick:this.save},this.getSaveButtonText()),h.createElement(i.DefaultButton,{disabled:this.props.isSaving,onClick:this.props.onDismiss},d.EditFileCancel))},t.prototype.canSave=function(){return this.isValid()&&!this.props.isSaving},t.prototype.getSaveButtonText=function(){return this.props.isGit?d.EditFileCommit:d.EditFileCheckin},t.prototype.isValid=function(){return!this.state.newBranchNameErrorMessage&&!((this.props.isRenaming||this.props.isCreatingFolder)&&this.state.newItemNameErrorMessage)&&!(this.props.isUploading&&this.state.filesToBeUploaded.length===0)},t.prototype.getDefaultUploadFilesComment=function(n){var t,i,u,f,r;if(n&&n.length!==0){if(t=0,this.props.existingFileList)for(i=0,u=n;i<u.length;i++)f=u[i],this.fileAlreadyExists(f.name)&&t++;return n.length===1?t>0?l.format(d.AddFileDialogDefaultCommentSingleFileWithEdit,n[0].name):l.format(d.AddFileDialogDefaultCommentSingleFile,n[0].name):(r=nt.getFileName(this.props.editingPath)||this.props.rootPath,t>0&&t<n.length?l.format(d.AddFileDialogDefaultCommentMultipleFilesWithAddsAndEdits,n.length,r):t>0?l.format(d.AddFileDialogDefaultCommentMultipleFilesWithEdits,n.length,r):l.format(d.AddFileDialogDefaultCommentMultipleFiles,n.length,r))}return""},t.prototype.isNewBranch=function(){return this.state.newBranchName&&this.state.newBranchName!==this.props.currentBranchName},t}(h.PureComponent);t.CommitDialog=tt});

if (window.performance && window.performance.mark) { window.performance.mark('endLoadBundleInner-async'); }