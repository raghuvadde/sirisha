"use strict";define("VSSUI",["require","exports","react","OfficeFabric/Utilities","OfficeFabric/OverflowSet","OfficeFabric/Button","OfficeFabric/FocusZone","VSS/Core/Observable","OfficeFabric/Tooltip","OfficeFabric/Icon"],function(n,t,i,r,u,f,e,o,s,h){var l,w,c,b,k,a,v,d,y,g,nt,tt,p,it,rt,ut;(function(n){var e,o,s;l=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});e=function(n){function e(){var r=n!==null&&n.apply(this,arguments)||this;return r._onRenderItem=function(n){var u=r._renderButton(n);return n.tooltipProps?i.createElement(t.Tooltip.TooltipHost,__assign({},n.tooltipProps),u):u},r._onRenderOverflowButton=function(n){return i.createElement(o,{data:n})},r}return __extends(e,n),e.prototype.render=function(){var f=this.props,n=f.contextualMenuItems,t=f.viewMenuItems,e=n?this.handleItemCompat(n.slice(0,3)):[],o=n?this.handleItemCompat(n.slice(3)):[];return i.createElement("div",{className:r.css("vss-Header-CommandBar flex-row",this.props.className)},t&&t.length>0&&i.createElement(u.OverflowSet,{className:"vss-Header-ViewActions",items:t,overflowItems:[],onRenderItem:this._onRenderItem,onRenderOverflowButton:undefined}),n&&n.length>0&&i.createElement(u.OverflowSet,{className:"vss-Header-Commands",items:e,overflowItems:o,onRenderItem:this._onRenderItem,onRenderOverflowButton:this._onRenderOverflowButton}))},e.prototype.handleItemCompat=function(n){for(var t,i,r=[],u=0;u<n.length;u++)t=n[u],t.id&&(i=__assign({},t),i.key=t.id,i.name=t.text,r.push(i)),r.push(t);return r},e.prototype._renderButton=function(n){var t=__assign({},n);return n.isPrimary?i.createElement(f.PrimaryButton,__assign({},t,{text:n.name,menuProps:n.subMenuProps,itemType:n.itemType&&n.itemType.toString()})):i.createElement(f.CommandBarButton,__assign({},t,{text:n.name,menuProps:n.subMenuProps,itemType:n.itemType&&n.itemType.toString()}))},e}(r.BaseComponent);t[n].HeaderCommandBar=e;o=function(n){function t(t){var i=n.call(this,t)||this;return i._onMenuOpen=function(){i.setState({isMenuOpen:!0})},i._onMenuDismiss=function(){i.setState({isMenuOpen:!1})},i.state={isMenuOpen:!1},i}return __extends(t,n),t.prototype.render=function(){return i.createElement(f.CommandBarButton,{className:this.state.isMenuOpen&&"menu-is-open",menuProps:{items:this.props.data,onMenuOpened:this._onMenuOpen,onMenuDismissed:this._onMenuDismiss},menuIconProps:{iconName:"more"}})},t}(r.BaseComponent);s=function(n){function r(t){var i=n.call(this,t)||this;return i.onFilterClicked=function(){i.props.filterToggled.value=!i.props.filterToggled.value},i.onFilterChanged=function(){var n=i.props.filter.hasChangesToReset();n!==i.state.filterHasChanges&&i.setState({filterHasChanges:n})},i.state={filterHasChanges:i.props.filter.hasChangesToReset()},i}return __extends(r,n),r.prototype.componentDidMount=function(){this.props.filter.subscribe(this.onFilterChanged,t.UtilitiesFilter.FILTER_CHANGE_EVENT)},r.prototype.componentWillUnmount=function(){this.props.filter.unsubscribe(this.onFilterChanged,t.UtilitiesFilter.FILTER_CHANGE_EVENT)},r.prototype.render=function(){var t={key:"filter",iconProps:{iconName:this.state.filterHasChanges?"FilterSolid":"Filter"},onClick:this.onFilterClicked},n=this.props.viewMenuItems?this.props.viewMenuItems.slice():[];return n.push(t),i.createElement(e,__assign({},this.props,{viewMenuItems:n}))},r}(i.Component);t[n].HeaderCommandBarWithFilter=s})("ComponentsHeaderCommandBarHeaderCommandBar"),function(n){w=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});t[n].HeaderCommandBar=l.HeaderCommandBar;t[n].HeaderCommandBarWithFilter=l.HeaderCommandBarWithFilter}("ComponentsHeaderCommandBarindex"),function(n){c=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});t[n].TabProviderContext=i.createContext({selectedId:undefined,tabs:[],commandBarItems:[],renderContent:undefined,renderFilterBar:undefined,onSelectedTabChanged:undefined});var r=function(r){function u(n){var t=r.call(this,n)||this;return t.onSelectedTabChanged=function(n){t.props.selectedTabId.value=n},t.onSelectedTabIdChanged=function(){t.forceUpdate()},t.onTabsChanged=function(n){var i;(i=t.tabs).push.apply(i,n.addedItems);t.tabs=t.tabs.sort(function(n,t){return(n.order||100)-(t.order||100)});t.forceUpdate()},t.tabs=[],t.observableArrays=[],n.providers&&n.providers.forEach(function(n){var r,i=n.getItems();i&&(t.observableArrays.push(i),(r=t.tabs).push.apply(r,i.value))}),t.tabs=t.tabs.sort(function(n,t){return(n.order||100)-(t.order||100)}),t}return __extends(u,r),u.prototype.componentWillReceiveProps=function(n){var t=this;n.providers!==this.props.providers&&(this.tabs=[],this.observableArrays=[],n.providers&&n.providers.forEach(function(n){var r,i=n.getItems();i&&(t.observableArrays.push(i),(r=t.tabs).push.apply(r,i.value))}),this.tabs=this.tabs.sort(function(n,t){return(n.order||100)-(t.order||100)}));n.selectedTabId!==this.props.selectedTabId&&(this.props.selectedTabId&&this.props.selectedTabId.unsubscribe(this.onSelectedTabIdChanged),n.selectedTabId&&n.selectedTabId.subscribe(this.onSelectedTabIdChanged))},u.prototype.render=function(){var u=this.props.selectedTabId.value,r=undefined;return this.tabs.forEach(function(n){n.id===u&&(r=n)}),r===undefined&&(r={id:u,name:undefined,render:undefined}),i.createElement(t[n].TabProviderContext.Provider,{value:{onSelectedTabChanged:this.onSelectedTabChanged,selectedId:r.id,tabs:this.tabs,commandBarItems:r.commandBarItems,renderContent:r.render,renderFilterBar:r.renderFilterBar}},this.props.children)},u.prototype.componentDidMount=function(){var n=this;this.props.selectedTabId&&this.props.selectedTabId.subscribe(this.onSelectedTabIdChanged);this.observableArrays.forEach(function(t){return t.subscribe(n.onTabsChanged)})},u.prototype.componentWillUnmount=function(){var n=this;this.observableArrays.forEach(function(t){return t.unsubscribe(n.onTabsChanged)});this.props.selectedTabId&&this.props.selectedTabId.unsubscribe(this.onSelectedTabIdChanged)},u}(i.Component);t[n].TabProvider=r}("ComponentsTabsTabProviderContext"),function(n){b=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var u=function(n){function u(){return n!==null&&n.apply(this,arguments)||this}return __extends(u,n),u.prototype.render=function(){var n=this;return i.createElement(c.TabProviderContext.Consumer,null,function(u){var f=n.props,y=f.title,o=f.kicker,s=f.titleSize,h=f.onRenderTitle,e=f.titleIconProps,p=f.viewItems,w=f.className,c=n.props.commandBarItems||u.commandBarItems,a,v;return a=h?h():i.createElement("div",{className:r.css("vss-Header-TitleText",s===1?"title-l":"title-m")},y),e&&(e.className=r.css(e.className,"vss-Header-Icon")),(c||p)&&(v=i.createElement(t.Observer.Observer,{contextualMenuItems:c,viewMenuItems:n.props.viewItems},i.createElement(l.HeaderCommandBar,{contextualMenuItems:[],viewMenuItems:[]}))),i.createElement("div",{className:r.css("vss-Header flex-row flex-noshrink",!!o&&"kicker",s===1&&"large",w)},e&&i.createElement(t.VssIcon.VssIcon,__assign({},e)),i.createElement("div",{className:"flex-column"},o&&i.createElement("div",{className:"vss-Header-KickerText"},o),i.createElement("div",{className:"vss-Header-TitleRow flex-row"},a,v)))})},u}(r.BaseComponent);t[n].Header=u}("ComponentsHeaderHeader"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}k=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(b)}("ComponentsHeaderindex"),function(n){a=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var u=function(n){function t(t){var i=n.call(this,t)||this;return i.onTabClick=function(n){var t=i.props.onSelectedTabChanged,r=i._tabPropsMap[n],u=r.onBeforeTabChange,f=r.url;u&&u(undefined,n,f);t&&t(n)},i.onSelectedTabIdChanged=function(){i.forceUpdate()},i._tabPropsMap={},o.ObservableLike.isObservable(t.selectedTabId)&&t.selectedTabId.subscribe(i.onSelectedTabIdChanged),i}return __extends(t,n),t.prototype.componentWillUnmount=function(){o.ObservableLike.isObservable(this.props.selectedTabId)&&this.props.selectedTabId.unsubscribe(this.onSelectedTabIdChanged)},t.prototype.render=function(){var n=this,t=this.props,u=t.tabSize,l=u===void 0?"tall":u,f=t.orientation,s=f===void 0?0:f,a=o.ObservableLike.getValue(this.props.selectedTabId),h=0,v=0,c={};i.Children.map(this.props.children,function(n){n&&(c[n.props.id]=v++,h++)});var y=i.Children.map(this.props.children,function(t){if(t&&typeof t.type!="string"){var r=t.props.id===a,u=n.onTabClick;return n._tabPropsMap[t.props.id]=t.props,i.cloneElement(t,__assign({},t.props,{isSelected:r,onClick:u,index:c[t.props.id],setSize:h}))}return t}),p=s===1?"flex-column":"flex-row",w=s===1?e.FocusZoneDirection.vertical:e.FocusZoneDirection.horizontal;return i.createElement(e.FocusZone,{className:r.css("vss-Tabs",p,this.props.className,l),role:"tablist",direction:w},y)},t}(i.Component);t[n].Tabs=u}("ComponentsTabsTabs"),function(n){v=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var u=function(n){function u(){var t=n!==null&&n.apply(this,arguments)||this;return t.onClick=function(n){var r=t.props.url,i=!0;n.ctrlKey&&r&&(i=!1);i&&(n.preventDefault(),t.updateSelectedItem(n))},t.onKeyUp=function(n){n.defaultPrevented||n.which===32&&t.props.url&&(n.preventDefault(),t.updateSelectedItem(n))},t}return __extends(u,n),u.prototype.render=function(){var n=this.props,f=n.ariaLabel,e=n.index,o=n.setSize,s=n.id,t=n.isSelected,u=n.url,h=this.renderPivotItemContent(),c=u?"a":"div";return i.createElement(c,{href:u,onClick:this.onClick,onKeyUp:this.onKeyUp,className:r.css("vss-Tab focus-treatment",t?"selected":""),role:"tab","data-is-focusable":!0,key:s,"aria-label":f,"aria-selected":t,"aria-posinset":e+1,"aria-setsize":o},h)},u.prototype.renderPivotItemContent=function(){var f=this.props,e=f.name,c=f.iconProps,r=f.badgeCount,u=t.UtilitiesFriendlyNumber.getFriendlyDisplayValue(r),o=undefined,n,l;return r&&u!==r.toString()&&(o=r.toString()),n=undefined,o?n=i.createElement(s.TooltipHost,{content:o},u):u&&(n=u),l=n&&i.createElement(t.Badge.Badge,{className:"tab-badge"},n),i.createElement("span",{className:"innerContainer"},c!==undefined&&i.createElement(h.Icon,__assign({className:"icon"},c)),e!==undefined&&i.createElement("span",{className:"text"},i.createElement(s.TooltipHost,{content:e,overflowMode:s.TooltipOverflowMode.Parent},e)),l)},u.prototype.updateSelectedItem=function(n){var t=this.props.onClick;if(this.props.onBeforeTabChange&&!this.props.onBeforeTabChange(n,this.props.id,this.props.url)){n.preventDefault();return}t&&t(this.props.id)},u}(i.Component);t[n].Tab=u}("ComponentsTabsTab"),function(n){d=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var r=function(n){function r(){var t=n!==null&&n.apply(this,arguments)||this;return t.onRenderAdditionalContent=function(n){return n?n(!0):t.props.onRenderAdditionalContent&&t.props.onRenderAdditionalContent()},t.createTab=function(n){return i.createElement(v.Tab,{key:n.id,id:n.id,name:n.name,url:n.url,onBeforeTabChange:n.onBeforeTabChange})},t}return __extends(r,n),r.prototype.render=function(){var n=this;return i.createElement(c.TabProviderContext.Consumer,null,function(r){var u=n.props.selectedTabId||r.selectedId;return i.createElement("div",{className:t.Util.css("vss-TabBar flex-row flex-center flex-noshrink",n.props.className,!n.props.disableSticky&&"sticky")},i.createElement(a.Tabs,__assign({onSelectedTabChanged:r.onSelectedTabChanged,selectedTabId:u},n.props,{className:"flex-grow"}),n.props.children,r.tabs.map(n.createTab)),n.onRenderAdditionalContent(r.renderFilterBar))})},r}(i.Component);t[n].TabBar=r}("ComponentsTabsTabBar"),function(n){y=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});t[n].TabGroupProviderContext=i.createContext({groups:[]});var r=function(r){function u(n){var t=r.call(this,n)||this;return t.onGroupsChanged=function(n){var i;(i=t.groups).push.apply(i,n.addedItems);t.groups=t.groups.sort(function(n,t){return(n.order||100)-(t.order||100)});t.forceUpdate()},t.groups=[],t.observableArrays=[],n.providers&&n.providers.forEach(function(n){var i,r=n.getItems();t.observableArrays.push(r);(i=t.groups).push.apply(i,r.value)}),t.groups=t.groups.sort(function(n,t){return(n.order||100)-(t.order||100)}),t}return __extends(u,r),u.prototype.render=function(){return i.createElement(t[n].TabGroupProviderContext.Provider,{value:{groups:this.groups}},this.props.children)},u.prototype.componentDidMount=function(){var n=this;this.observableArrays.forEach(function(t){return t.subscribe(n.onGroupsChanged)})},u.prototype.componentWillUnmount=function(){var n=this;this.observableArrays.forEach(function(t){return t.unsubscribe(n.onGroupsChanged)})},u}(i.Component);t[n].TabGroupProvider=r}("ComponentsTabsTabGroupProviderContext"),function(n){g=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var r=function(n){function t(t){var r=n.call(this,t)||this;return r.generateGroupMap=function(n){if(!n)return{};var t={};return n.forEach(function(n){t[n.id]=n}),t},r.processChildren=function(n){var t={};return i.Children.forEach(r.props.children,function(i){if(i){var r=i.props.groupId||"";t[r]?t[r].items.push(i):t[r]={items:[i],groupProps:n[r]||{id:"",name:"",order:-1}}}}),t},r.processContributions=function(n,t,i){return n.forEach(function(n){var f=r.createRow(n),u=n.groupId||"";i[u]?i[u].items.push(f):i[u]={items:[f],groupProps:t[u]||{id:"",name:"",order:-1}}}),i},r.processGroups=function(n){var t=[],r=[];for(var u in n)r.push(n[u]);return r.sort(function(n,t){return n.groupProps.order-t.groupProps.order}).forEach(function(n){t.push(n.groupProps.name!==""&&i.createElement("div",{key:n.groupProps.name,className:"vss-TabList-Heading title-xs flex-noshrink"},n.groupProps.name));t.push.apply(t,n.items)}),t},r.createRow=function(n){return i.createElement(v.Tab,{key:n.id,id:n.id,name:n.name,url:n.url,onBeforeTabChange:n.onBeforeTabChange})},r.renderTitle=function(n){return i.createElement("div",{className:"vss-TabList-Title title-s flex-noshrink"},n)},r.onSelectedTabIdChanged=function(){r.forceUpdate()},r}return __extends(t,n),t.prototype.render=function(){var n=this;return i.createElement(y.TabGroupProviderContext.Consumer,null,function(t){var r=n.props.tabGroups,f=r?r.concat(t.groups):t.groups,u=n.generateGroupMap(f);return i.createElement(c.TabProviderContext.Consumer,null,function(t){var r=n.props.selectedTabId||t.selectedId,f=n.processContributions(t.tabs,u,n.processChildren(u)),e=n.processGroups(f);return i.createElement("div",{className:"vss-TabList flex-column"},n.props.listTitle&&n.renderTitle(n.props.listTitle),i.createElement(a.Tabs,__assign({selectedTabId:r},n.props,{onSelectedTabChanged:t.onSelectedTabChanged,orientation:1}),e))})})},t}(i.Component);t[n].TabList=r}("ComponentsTabsTabList"),function(n){nt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var r=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.render=function(){var n=this;return i.createElement(c.TabProviderContext.Consumer,null,function(t){if(t.renderContent){var r=t.renderFilterBar&&t.renderFilterBar(!1);return i.createElement(i.Fragment,null,r,t.renderContent())}return i.createElement(i.Fragment,null,n.props.children)})},t}(i.Component);t[n].TabContent=r}("ComponentsTabsTabContent"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}tt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(d);i(g);i(a);i(v);i(nt);i(c);i(y)}("ComponentsTabsindex"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}p=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(tt)}("Tabs"),function(n){it=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var u=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.render=function(){var t=this.props,f=t.tabProviders,e=t.selectedTabId,o=t.tabGroupProviders,u=t.orientation,s=u===void 0?0:u,h=s===0?"flex-column":"flex-row",n=i.createElement("div",{className:r.css("vss-Page v-scroll-auto",h,this.props.className)},this.props.children);return this.props.selectedTabId&&(n=i.createElement(p.TabProvider,{providers:f||[],selectedTabId:e},n)),this.props.tabGroupProviders&&(n=i.createElement(p.TabGroupProvider,{providers:o},n)),n},t}(i.Component);t[n].Page=u}("ComponentsPagePage"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}rt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(it)}("ComponentsPageindex"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}ut=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(rt);i(k);i(w)}("Page")},["Components/HeaderCommandBar/HeaderCommandBar","Components/HeaderCommandBar/index","Components/Tabs/TabProviderContext","Components/Header/Header","Components/Header/index","Components/Tabs/Tabs","Components/Tabs/Tab","Components/Tabs/TabBar","Components/Tabs/TabGroupProviderContext","Components/Tabs/TabList","Components/Tabs/TabContent","Components/Tabs/index","Tabs","Components/Page/Page","Components/Page/index","Page"]);document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-page-content"}}));