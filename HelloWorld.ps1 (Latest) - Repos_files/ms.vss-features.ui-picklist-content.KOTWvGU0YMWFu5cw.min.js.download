"use strict";define("VSSUI",["require","exports","react","react-dom","OfficeFabric/Button","OfficeFabric/ChoiceGroup","OfficeFabric/FocusZone","OfficeFabric/List","OfficeFabric/Selection","OfficeFabric/Spinner","OfficeFabric/TextField","OfficeFabric/Utilities","VSS/Core/Util/Accessibility","OfficeFabric/Callout"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){var d,y,p,w,b,k,g;(function(n){d=t[n]={};Object.defineProperty(t,"__esModule",{value:!0})})("ComponentsPickListPickListProps"),function(n){y=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var v="select-all-item",k=8,p=250,d=250,g=1e3,w=200,nt=340,tt=32,it=function(n){function f(r){var u=n.call(this,r)||this;return u._groupLoadRequested={},u._searchText="",u._selectedPivot="",u._onPivotBarFocused=function(){u._pivotFocusZone&&u._pivotFocusZone.focus()},u._onSearchContainerFocused=function(){u._searchFocusZone&&u._searchFocusZone.focus(!0)},u._onKeyDown=function(n){if(n.which===9){var t=u.props.onFocusLost;t&&t()}},u._onSearchTextChanged=function(n){u._searchText=n;u._searchTextChangeDelegate(n)},u._onClearInputKeyPress=function(n){(n.which===13||n.which===32)&&(n.preventDefault(),u._onClearInputClick())},u._onClearInputClick=function(){u._searchText="";u._updateSearchText();u._textField&&u._textField.focus()},u._updateSearchText=function(n){var e=u.props,o=e.groups,c=e.onSearch,i=u.state.isSearchInProgress,r=u._searchText;r&&c&&(window.setTimeout(function(){u.state.isSearchInProgress&&a.announce(t.VSSResourcesVSSUI.Searching,!0,w)},g),i=!0,u._hideSearchingContentTimeout&&(window.clearTimeout(u._hideSearchingContentTimeout),u._hideSearchingContentTimeout=0),u._hideSearchingContent=!0,u._hideSearchingContentTimeout=window.setTimeout(function(){u._hideSearchingContent=!1;u._searchingContentHidden&&u.forceUpdate()},p),u._getOnSearchPromise(r,n).then(function(n){if(r===u._searchText)if(n){i=!1;var t=u.state,h=t.groupDictionary,f=t.itemsLoading,e=t.selectedKeys,c=u._wrapItems(n,e,"search-results"),l=u._groupItems(c,h),s=u._filterByText(r,l),a=u._buildGroupedItems(r,i,n,s,o,e,f);u._announceSearchResults(s,i,f);u.setState({isSearchInProgress:i,filteredItems:a,searchResults:n,searchError:undefined},function(){return u._rebuild(u.props)})}else u.setState({isSearchInProgress:!1})},function(n){u.setState({isSearchInProgress:!1,searchError:n},function(){return u._rebuild(u.props)})}));var f=u.state,l=f.groupDictionary,s=f.itemsLoading,v=f.selectedKeys,h=u._filterByText(r,l),y=u._buildGroupedItems(r,i,[],h,o,v,s);u.scrollToIndex(0);u._announceSearchResults(h,i,s);u.setState({filteredItems:y,isSearchInProgress:i,searchResults:n?u.state.searchResults:[]},function(){return u._rebuild(u.props)})},u._defaultFilterItemByText=function(n,t){return t.name.toLowerCase().indexOf(n.toLowerCase())!==-1},u._onSelectionChanged=function(n,t){var f=!1,i,r,e,o;return u._isMounted&&(i=u.props.onSelectionChanged,r=t||u.state.selectedOperatorKey,i&&(e=n.filter(function(n){return n!==v&&!!u._itemDictionary[n]}).map(function(n){return u._itemDictionary[n].data}),f=i({selectedItems:e,selectedOperatorKey:r})===!0),u._maintainsOwnState&&(o=u.state.filteredItems.map(function(t){return t.isSelected=n.some(function(n){return n===t.key}),t}),u.setState({filteredItems:u.state.filteredItems.slice(),selectedKeys:n,selectedOperatorKey:r}))),f},u._onOperatorChanged=function(n){u._onSelectionChanged(u.state.selectedKeys,n)},u._onRenderCell=function(n,t,r){var a=u.props.selectionMode,f;if(n.isSeparator)return n.isGroupHeader?n.onRender?n.onRender():n.name?i.createElement("div",{role:"heading",className:l.css("vss-PickList--groupHeader",{"first-group":t===0})},n.name):i.createElement("div",{className:"vss-PickList--groupSeparator"}):n.isLoadingIndicator?(f=i.createElement("div",{className:"vss-PickList--loading"},i.createElement(ot,{size:h.SpinnerSize.medium,label:n.name})),n.onRender?n.onRender(f):f):n.messageLevel?i.createElement("div",{className:l.css("vss-PickList--message",n.messageLevel===2&&"is-error")},n.name):i.createElement("div",null,n.name);var e=t===0||u.state.filteredItems[t-1].isSeparator,v=r.length===0,y=v?0:r.filter(function(n){return n<t}).length,o=t-y,c=u.state.filteredItems.length-r.length;return a===s.SelectionMode.multiple?u._onRenderCellMultipleSelection(n,e,o,c):u._onRenderCellSingleSelection(n,e,o,c)},u._onRenderCellSingleSelection=function(n,t,r,f){var o=u._getIndicators(n,u.props.indicators),e=typeof n.disabled=="function"?n.disabled():n.disabled;return i.createElement(b,{ariaLabel:n.ariaLabel||n.name,ariaDescribedBy:u.props.itemAriaDescription&&u._ariaDescribedById,ref:function(n){r===0&&(u._firstRow=n)},dataSelectionKey:n.key,isSelected:n.isSelected,setSize:f,itemIndex:r,href:n.href,disabled:e,firstInGroup:t,onKeyboardEnter:function(){return u._onSingleSelectionChanged(n.key,e)}},i.createElement(rt,{item:n,indicators:o,onSelectionChanged:function(){return u._onSingleSelectionChanged(n.key,e)},onRenderItemText:u.props.onRenderItemText}))},u._onRenderCellMultipleSelection=function(n,t,r,f){var o=u._getIndicators(n,u.props.indicators),e=typeof n.disabled=="function"?n.disabled():n.disabled;return i.createElement(b,{ariaLabel:n.ariaLabel||n.name,ariaDescribedBy:u.props.itemAriaDescription&&u._ariaDescribedById,ref:function(n){r===0&&(u._firstRow=n)},dataSelectionKey:n.key,spaceBarTriggersClick:!0,isSelected:n.isSelected,setSize:f,itemIndex:r,disabled:e,firstInGroup:t,onKeyboardEnter:function(){return u._onMultipleSelectionChanged(n.key,!n.isSelected,e)}},i.createElement(ut,{item:n,indicators:o,onSelectionChanged:function(t){return u._onMultipleSelectionChanged(n.key,t,e)}}))},u._onActiveElementChanged=function(n){if(u.props.selectionMode===s.SelectionMode.single&&u.props.selectOnFocus){var t=n.getAttribute("data-selection-key");t&&u._onSelectionChanged([t])}},u._id=u.props.id||l.getId("PickList"),u._maintainsOwnState=!1,u._itemDictionary={},r.initiallySelectedItems&&r.selectedItems&&console.warn("Please only provide ONE of initiallySelectedItems OR selectedItems as props"),r.initiallySelectedItems&&(u._maintainsOwnState=!0),r.pivots&&r.pivots.length&&(u._selectedPivot=u._getInitialPivot(r)),u.state={isSearchInProgress:!1,initiallySelectedKeys:[],selectedKeys:[],filteredItems:[],searchResults:[],items:[],selectedOperatorKey:r.selectedOperatorKey,initiallySelectedOperatorKey:r.selectedOperatorKey},u._searchTextChangeDelegate=u._async.debounce(function(){return u._updateSearchText()},d),u._ariaDescribedById=l.getId("picklist-described-by"),u}return __extends(f,n),f.prototype.clearSelection=function(){this._onSelectionChanged([],this.state.initiallySelectedOperatorKey)},f.prototype.reset=function(){this._onSelectionChanged(this.state.initiallySelectedKeys,this.state.initiallySelectedOperatorKey)},f.prototype.selectAll=function(){this.props.selectionMode===s.SelectionMode.multiple&&this._onSelectionChanged(this._getKeysFromItems(this.state.items,this.state.items))},f.prototype.focus=function(n){if(!n&&this._pickListElement&&document.activeElement&&l.doesElementContainFocus(this._pickListElement))return!1;if(this._initialItemsLoaded||(this._focusOnInitialLoad=!0),this._searchFocusZone)return this._searchFocusZone.focus(),!0;if(this._focusZone)if(this._operatorGroup)this._operatorGroup.focus();else return this._firstRow?this._focusZone.focusElement(r.findDOMNode(this._firstRow)):this._focusZone.focus();return!1},f.prototype.scrollToIndex=function(n){this._list&&this._list.scrollToIndex(n,function(){return tt})},f.prototype.scrollToSelected=function(){var t=this.state.filteredItems,n;t&&(n=t.findIndex(function(n){return n.isSelected}),n>0&&this.scrollToIndex(n))},f.prototype.forceUpdate=function(){this._isMounted&&this._rebuild(this.props)},f.prototype.componentWillMount=function(){this._rebuild(this.props)},f.prototype.componentDidMount=function(){this._isMounted=!0;var t=this.props,n=t.pivots,i=t.onSelectedPivotChanged;i&&n&&n.length>0&&this._selectedPivot&&this._selectedPivot!==n[0].id&&i(this._selectedPivot)},f.prototype.componentWillUnmount=function(){this._itemsAnnouncer&&this._itemsAnnouncer.cancel();this._isMounted=!1},f.prototype.componentWillReceiveProps=function(n){var t=this,i=this.props,r=i.selectedItems,u=i.selectedOperatorKey,f=this._haveGroupsChanged(n);this._hasNewItems(n).then(function(i){var o;if(t._isMounted)if(i||f)t._rebuild(n);else if(t._arrayEquals(r,n.selectedItems))u!==n.selectedOperatorKey&&t.setState({selectedOperatorKey:n.selectedOperatorKey});else{var e=t._getKeysFromItems(n.selectedItems,t.state.items),s=t.state.filteredItems.map(function(n){return n.isSelected=e.some(function(t){return t===n.key}),n}),h=function(n){var i=t._itemDictionary[n];i.isSelected=e.some(function(t){return t===n})};for(o in t._itemDictionary)h(o);t.setState({filteredItems:s,selectedKeys:e,selectedOperatorKey:n.selectedOperatorKey})}})},f.prototype.render=function(){var h=this,n=this.props,y=n.getActions,st=n.isSearchable,ht=n.searchBoxAriaLabel,ct=n.onSearch,lt=n.className,p=n.operators,w=n.minItemsForSearchBox,at=w===void 0?k:w,b=n.shouldVirtualize,vt=n.onMouseLeave,yt=n.onMouseEnter,d=n.itemAriaDescription,g=n.onRenderFooter,nt=this.state,tt=nt.filteredItems,pt=nt.itemsLoading,r=tt?tt.slice():[],a=this._getPivotBar(),u=this._getCurrentPivot(),s=y&&y(r)||[],it=u&&u.searchTextPlaceholder||this.props.searchTextPlaceholder,rt=u&&u.noItemsText||this.props.noItemsText,ut,f;u&&u.getActions&&(ut=u.getActions(r)||[],s=ut.concat(s));this._actionCount=s.length;var ot=s.length>0&&s.map(function(n,t){return i.createElement(ft,{action:n,itemIndex:t,key:String(t),setSize:h._actionCount})}),wt=this._searchText?{iconName:"Clear",className:"clear-filter-input",tabIndex:0,onClick:this._onClearInputClick,onKeyPress:this._onClearInputKeyPress,role:"button",ariaLabel:t.VSSResourcesVSSUI.FilterTextItemClearLabel}:undefined,bt=r&&r.length>1&&p&&i.createElement(et,{operators:p,selectedOperatorKey:this.state.selectedOperatorKey,onChange:this._onOperatorChanged,componentRef:function(n){return h._operatorGroup=n}}),v=null,kt=typeof b=="function"?function(){return b(r)}:undefined;if(r.length){var dt=!a?null:"tabpanel",gt=!a?null:!0,ni=r[0].key!=="search-no-results"&&"vss-PickList--hasItems",ti=r.filter(function(n){return n.isGroupHeader}).map(function(n){return r.indexOf(n)});v=i.createElement("div",{className:l.css("vss-PickList--items",ni),role:"listbox","data-is-scrollable":!0},i.createElement(o.List,{role:dt,"aria-expanded":gt,items:r,onRenderCell:function(n,t){return h._onRenderCell(n,t,ti)},onShouldVirtualize:kt,componentRef:function(n){return h._list=n}}))}else rt&&r.length===0&&!pt&&(v=i.createElement("div",{role:"alert","aria-live":"assertive",className:"vss-PickList--noItemsText"},rt));return f={},this.props.minWidth&&(f.minWidth=this.props.minWidth+"px"),this.props.maxWidth&&(f.maxWidth=this.props.maxWidth+"px"),this.props.width&&(r.length?f.width=this.props.width+"px":f.minWidth=this.props.width+"px"),this.props.maxHeight&&(f.maxHeight=this.props.maxHeight+"px"),i.createElement("div",{className:l.css("vss-PickList",lt),style:f,onKeyDown:this._onKeyDown,ref:this._resolveRef("_pickListElement"),id:this._id,onMouseEnter:yt,onMouseLeave:vt},d&&i.createElement("div",{className:"vss-PickList--ariaDescription",id:this._ariaDescribedById},d),i.createElement(e.FocusZone,{className:"vss-PickList--focusContainer",ref:this._resolveRef("_focusZone"),isInnerZoneKeystroke:function(n){return n.which===l.getRTLSafeKeyCode(39)},direction:e.FocusZoneDirection.vertical,onActiveElementChanged:this._onActiveElementChanged,isCircularNavigation:!0},st&&(this.state.items.length>=at||ct)&&i.createElement("div",{"data-is-focusable":!0,"data-disable-click-on-enter":!0,onFocus:this._onSearchContainerFocused},i.createElement(e.FocusZone,{ref:this._resolveRef("_searchFocusZone"),direction:e.FocusZoneDirection.horizontal},i.createElement(c.TextField,{className:"vss-PickList--searchTextField",ref:this._resolveRef("_textField"),placeholder:it,value:this._searchText,ariaLabel:ht||it,onChanged:this._onSearchTextChanged,onKeyDown:this._onKeyDown,iconProps:wt}))),bt,a,v,ot&&i.createElement("div",{className:"vss-PickList--actions",role:"listbox"},ot),g&&g()))},f.prototype._getPivotBar=function(){var n=this,r=[];return this.props.pivots&&(this.props.limitSearchToPivot||!this._searchText)&&this.props.pivots.forEach(function(f){var e=n._selectedPivot===f.id;r.push(i.createElement(u.CommandButton,{id:f.id,key:f.id,className:l.css("vss-Picklist--pivotBar-button",e?"selected":""),onClick:n._onPivotClick.bind(n,f.id),onKeyPress:n._onPivotKeyPress.bind(n,f.id),ariaLabel:f.name,role:"tab","aria-selected":e,"aria-posinset":r.length,"aria-setsize":n.props.pivots.length},i.createElement("span",{className:"innerContainer"},i.createElement("span",{className:"text",style:{maxWidth:f.maxWidth||nt}},i.createElement(t.Tooltip.TooltipHost,{content:f.name,overflowMode:t.Tooltip.TooltipOverflowMode.Parent},f.name)))))}),r.length?i.createElement("div",{className:"vss-PickList--pivotBar",role:"tablist","data-is-focusable":!0,onFocus:this._onPivotBarFocused},i.createElement(e.FocusZone,{direction:e.FocusZoneDirection.horizontal,ref:this._resolveRef("_pivotFocusZone")},r)):void 0},f.prototype._onPivotKeyPress=function(n,t){t.preventDefault();t.which===13&&this._updateSelectedPivot(n)},f.prototype._onPivotClick=function(n,t){t.preventDefault();this._updateSelectedPivot(n)},f.prototype._updateSelectedPivot=function(n){this._selectedPivot!==n&&(this._selectedPivot=n,this.props.onSelectedPivotChanged&&this.props.onSelectedPivotChanged(n),this.props.limitSearchToPivot&&this._searchText&&this._updateSearchText(),this.scrollToIndex(0),this.forceUpdate())},f.prototype._getInitialPivot=function(n){var r=n.selectedItems,u=n.initiallySelectedItems,f=n.getListItem,o=n.groups,s=n.pivots,e=r&&r[0]||u&&u[0],i,t;return e&&f&&(i=f(e).groupKey,i&&(t=o.filter(function(n){return n.key===i})[0],t&&t.pivotId))?t.pivotId:s[0].id},f.prototype._getCurrentPivot=function(){var n=this;return this.props.pivots&&this.props.pivots.filter(function(t){return t.id===n._selectedPivot})[0]},f.prototype._rebuild=function(n){var i=this,r;this.props.items!==n.items&&this._itemsAnnouncer&&(this._itemsAnnouncer.cancel(),this._itemsAnnouncer=null);this._isThenable(n.items)?(this._buildFromItems(n,this.state.items,!0),n.items.then(function(t){i.props.items===n.items&&i._buildFromItems(n,t,!1)},function(t){i.props.items===n.items&&(i._buildFromItems(n,[],!1),console.warn("Failed to get items for PickList: "+(t&&t.message?t.message:t)))}),this._itemsAnnouncer||(r=a.ProgressAnnouncer.forPromise(n.items,{announceStartMessage:t.VSSResourcesVSSUI.AnnounceLoadingItems,announceEndMessage:t.VSSResourcesVSSUI.AnnounceFinishedLoadingItems,announceErrorMessage:t.VSSResourcesVSSUI.AnnounceErrorLoadingItems}),this._itemsAnnouncer=r)):this._buildFromItems(n,n.items||[],!1)},f.prototype._buildFromItems=function(n,t,i){var u=this,o=this._initialItemsLoaded,f=this.state.initiallySelectedKeys,r=this.state.selectedKeys,s=this.state.selectedOperatorKey;i||o||!t.length||(n.initiallySelectedItems&&(f=this._getKeysFromItems(n.initiallySelectedItems,t),r=f),this._initialItemsLoaded=!0);this._maintainsOwnState||(r=this._getKeysFromItems(n.selectedItems,t),s=n.selectedOperatorKey);var e=this.state,h=e.searchResults,c=e.isSearchInProgress,v=e.itemsLoading,y=this._wrapItems(t,r),p=this._wrapItems(h,r,"search-results"),l=this._groupItems(y),w=this._groupItems(p,l),a=this._filterByText(this._searchText,w),b=this._buildGroupedItems(this._searchText,c,h,a,n.groups,r,i);v&&this._searchText&&this._announceSearchResults(a,c,i);this.setState({items:t,groupDictionary:l,initiallySelectedKeys:f,filteredItems:b,selectedKeys:r,itemsLoading:i,selectedOperatorKey:s},function(){!o&&u._initialItemsLoaded&&u._focusOnInitialLoad&&u.focus(!0)})},f.prototype._announceSearchResults=function(n,i,r){var u,f;if(!i&&!r){u=0;for(f in n)u+=n[f].length;a.announce(u>0?l.format(t.VSSResourcesVSSUI.AnnounceFilterResultCount,u):t.VSSResourcesVSSUI.NoFilterResults,!0,w)}},f.prototype._wrapItems=function(n,t,i){var f=this,r=this.props,u=r.getListItem,e=r.onSearch;return n.map(function(n){var r=u?u(n):{name:n,key:n},e;return r.groupKey||(r.groupKey="undefined-key"),e=__assign({},r,{isSelected:t.some(function(n){return n===r.key}),data:n}),i&&(e.groupKey=i),f._itemDictionary[r.key]=e,e})},f.prototype._groupItems=function(n,t){var i={},r;if(t)for(r in t)i[r]=t[r].slice();return n&&n.length&&n.forEach(function(n){var t=n.groupKey;i[t]||(i[t]=[]);i[t].push(n)}),i},f.prototype._filterByText=function(n,t){var r={},u;if(n){var f=this.props.onFilterItemByText||this._defaultFilterItemByText,e=function(u){var e,o,s;if(i._selectedPivot&&i.props.limitSearchToPivot&&u!=="search-results"&&(e=i.props.groups.filter(function(n){return n.key===u})[0],!e||e.pivotId!==i._selectedPivot))return"continue";o=t[u];s=o.filter(function(t){return t.isSeparator||f(n,t,t.data)});r[u]=s},i=this;for(u in t)e(u)}else r=t;return r},f.prototype._buildGroupedItems=function(n,i,r,u,f,e,o){var c=this,h=[],a=this.props,k=a.itemsLoadingText,p=a.onSearch,d=a.onHasMoreSearchResults,ut=a.searchResultsGroupName,g=a.searchResultsLoadingText,ft=a.selectionMode,et=a.showSelectAll,nt=this._getCurrentPivot(),tt=l.format(nt&&nt.searchNoResultsText||this.props.searchNoResultsText||t.VSSResourcesVSSUI.NoFilterResults,n||""),it=[{key:"undefined-key"}].concat(f||[]),y,w,rt,b;return p&&it.push({key:"search-results",name:ut}),y=!1,w=!1,this._searchingContentHidden=!1,it.forEach(function(f){var e=f.key,s=u[e],a=!c._selectedPivot||c._selectedPivot===f.pivotId||c._searchText&&!c.props.limitSearchToPivot||f.key==="search-results";c._selectedPivot&&!f.pivotId&&e!=="search-results"&&s&&s.length&&l.warn("Picklist pivots are being used and items were provided with no pivot id.  All items should be within a group with a valid pivot id");s&&s.length&&a?((y&&e!=="search-results"||f.name)&&h.push({isSeparator:!0,isGroupHeader:!0,name:f.name,key:"group-name-"+f.key,data:undefined,isSelected:!1,onRender:f.onRenderGroupHeader?function(){return f.onRenderGroupHeader(f)}:undefined}),h=h.concat(s),y=!0,!f.isLoading||c._searchText&&p?e==="search-results"&&d&&d(r)&&h.push({isSeparator:!0,isLoadingIndicator:!0,name:g||t.VSSResourcesVSSUI.Searching,key:"search-loading-"+f.key,data:undefined,isSelected:!1,onRender:function(n){return i||c._updateSearchText(r),n}}):h.push({isSeparator:!0,isLoadingIndicator:!0,name:f.loadingMessage||k||t.VSSResourcesVSSUI.Loading,key:"items-loading-"+f.key,data:undefined,isSelected:!1,onRender:function(n){return c._requestGroupLoad(f.key),n}})):e==="search-results"?n&&n.length&&p&&(i&&c._hideSearchingContent?c._searchingContentHidden=!0:(i||!i&&h.length===0)&&((y||f.name)&&h.push({isSeparator:!0,isGroupHeader:!0,name:f.name||"",key:"group-name-"+f.key,isSelected:!1}),i?h.push({isSeparator:!0,isLoadingIndicator:!0,name:g||t.VSSResourcesVSSUI.Searching,key:"search-loading-"+f.key,data:undefined,isSelected:!1}):c.state.searchError?h.push({isSeparator:!0,messageLevel:2,name:c.state.searchError.message,key:"search-error-"+f.key,data:undefined,isSelected:!1}):h.push({isSeparator:!0,messageLevel:1,name:tt,key:"search-no-results-"+f.key,data:undefined,isSelected:!1}),y=!0)):(!o||f.key!=="undefined-key"||c._selectedPivot)&&(!f.isLoading||!a||c._searchText&&p)||w||(w=!0,(y||f.name)&&h.push({isSeparator:!0,isGroupHeader:!0,name:f.name,key:"group-name-"+f.key,data:undefined,isSelected:!1}),h.push({isSeparator:!0,isLoadingIndicator:!0,name:f.loadingMessage||k||t.VSSResourcesVSSUI.Loading,key:"items-loading-"+f.key,data:undefined,isSelected:!1,onRender:function(n){return c._requestGroupLoad(f.key),n}}),y=!0)}),n&&n.length&&!i&&h.length===0&&h.push({isSeparator:!0,messageLevel:1,name:tt,key:"search-no-results",data:undefined,isSelected:!1}),ft===s.SelectionMode.multiple&&et&&h.length>1&&(rt=e.indexOf(v)!==-1,b={key:v,name:t.VSSResourcesVSSUI.PickListSelectAllActionText,isSelected:!!rt},h.splice(0,0,b),this._itemDictionary[v]=b),h},f.prototype._requestGroupLoad=function(n){var t=this;!this.props.onGroupLoadRequest||this._groupLoadRequested[n]||this.state.itemsLoading||(this._groupLoadRequested[n]=!0,this.props.onGroupLoadRequest(n).then(function(){delete t._groupLoadRequested[n]}))},f.prototype._getOnSearchPromise=function(n,t){var i=this.props.onSearch,r=i?i(n,this.state.items,this._selectedPivot,t):[];return Promise.resolve(r)},f.prototype._onSingleSelectionChanged=function(n,t){return t?!1:this._onSelectionChanged([n])},f.prototype._onMultipleSelectionChanged=function(n,t,i){if(i)return!1;var r=[];return n===v?r=t?this._getKeysFromItems(this.state.items,this.state.items):[]:(r=this.state.selectedKeys.filter(function(n){return n!==v}),t?r.push(n):r.splice(r.indexOf(n),1),r.length===this.state.items.length&&(r=[v].concat(r))),this._onSelectionChanged(r)},f.prototype._getIndicators=function(n,t){return t?t.map(function(t){if(n.data)return t.getItemIndicator(n.data)}):[]},f.prototype._getKeysFromItems=function(n,t){var r=this,i;return n?(i=[],i=this.props.getListItem?n.map(function(n){return r.props.getListItem(n).key}):n,t&&i.length===t.length&&(i=[v].concat(i)),i):[]},f.prototype._hasNewItems=function(n){var t=this;return this._isThenable(n.items)?n.items.then(function(n){return!t._arrayEquals(n,t.state.items)}):new Promise(function(n){n()}).then(function(){return!t._arrayEquals(t.state.items,n.items)})},f.prototype._haveGroupsChanged=function(n){var i=n.groups,t=this.props.groups;return i||t?i&&t?i.length!==t.length?!0:i.some(function(n,i){return t[i].key!==n.key||t[i].name!==n.name||t[i].isLoading!==n.isLoading}):!0:!1},f.prototype._isThenable=function(n){return n&&typeof n.then=="function"},f.prototype._arrayEquals=function(n,t){if(n&&t){if(n.length!==t.length)return!1;for(var i=0;i<n.length;i++)if(n[i]!==t[i])return!1;return!0}return n===t},f}(l.BaseComponent);t[n].PickList=it;var b=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t._onKeyDown=function(n){var i;(n.which===13||n.which===32&&t.props.spaceBarTriggersClick)&&(i=n.target,i===t._rowDiv&&(t.props.href?n.ctrlKey||n.shiftKey?window.open(t.props.href,"_blank","noopener"):t.props.onKeyboardEnter()||(window.location.href=t.props.href):t.props.onKeyboardEnter()));n.which===37&&(i=n.target,i.id===l.getFirstFocusable(t._rowDiv,i,!0).id&&t._rowDiv.focus())},t}return __extends(t,n),t.prototype.render=function(){return i.createElement("div",{role:"option","aria-selected":this.props.isSelected,"aria-label":this.props.ariaLabel,"aria-describedby":this.props.ariaDescribedBy,"aria-setsize":this.props.setSize,"aria-posinset":this.props.itemIndex+1,className:l.css("vss-PickList--row",this.props.disabled&&"disabled",this.props.firstInGroup&&"first-in-group"),ref:this._resolveRef("_rowDiv"),"data-is-focusable":!0,onKeyDown:this._onKeyDown,"data-selection-key":this.props.dataSelectionKey},i.createElement(e.FocusZone,{direction:e.FocusZoneDirection.horizontal},this.props.children))},t}(l.BaseComponent),rt=function(n){function r(){var t=n!==null&&n.apply(this,arguments)||this;return t._onClick=function(n){var i=t.props,u=i.item,r=i.onSelectionChanged;r&&(u.href&&(n.ctrlKey||n.shiftKey||n.button===1||n.button===2)||r()&&n.preventDefault())},t}return __extends(r,n),r.prototype.render=function(){var f=this.props,n=f.item,o=f.indicators,s=i.createElement("span",{className:"vss-PickList--selectableElementButton-text"},this.props.onRenderItemText?this.props.onRenderItemText(n,n.data):n.name),r=[],u,e;return n.iconProps?(u="vss-PickList--selectableElementButtonIcon",n.iconProps.className&&(u=l.css(u,n.iconProps.className)),r.push(i.createElement(t.VssIcon.VssIcon,__assign({key:"icon"},n.iconProps,{className:u})))):n.onRenderIcon&&r.push(i.createElement("span",{key:"icon",className:"vss-PickList--selectableElementButtonIcon"},n.onRenderIcon())),r.push(i.createElement("div",{key:"text-container",className:"vss-PickList--selectableElementButton-textContainer"},i.createElement(t.Tooltip.TooltipHost,{content:n.tooltipText||n.name,overflowMode:n.tooltipText&&n.tooltipText!==n.name?undefined:t.Tooltip.TooltipOverflowMode.Parent},s))),e=typeof n.disabled=="function"?n.disabled():n.disabled,i.createElement("div",{className:l.css("vss-PickList--element","vss-PickList--selectableElement",{"is-selected":n.isSelected,disabled:e})},n.href?i.createElement("a",{className:"vss-PickList--selectableElementButton",tabIndex:-1,"data-is-focusable":!1,href:n.href,onClick:this._onClick},r):i.createElement("div",{className:"vss-PickList--selectableElementButton",role:"button",onClick:this._onClick,tabIndex:-1,"data-is-focusable":!1},r),i.createElement(t.ItemIndicator.ItemIndicatorSet,{indicators:o,onClick:this._onClick}))},r}(l.BaseComponent),ut=function(n){function r(){var t=n!==null&&n.apply(this,arguments)||this;return t._onClick=function(n){if(!n.defaultPrevented){t.props.onSelectionChanged(!t.props.item.isSelected);n.preventDefault()}},t}return __extends(r,n),r.prototype.render=function(){var r=this.props,n=r.item,f=r.indicators,e=n.iconProps?i.createElement(t.VssIcon.VssIcon,__assign({className:"vss-PickList--multiSelectIcon"},n.iconProps)):n.onRenderIcon?i.createElement("span",{className:"vss-PickList--multiSelectIcon"},n.onRenderIcon()):null,u=typeof n.disabled=="function"?n.disabled():n.disabled,o=i.createElement("div",{className:"vss-PickList--multiSelectTextContainer"},i.createElement(t.Tooltip.TooltipHost,{content:n.name,overflowMode:t.Tooltip.TooltipOverflowMode.Parent},i.createElement("span",{className:l.css("vss-PickList--multiSelectText",u&&"disabled")},n.name))),s=i.createElement(t.ItemIndicator.ItemIndicatorSet,{indicators:f});return i.createElement("div",{className:l.css("vss-PickList--element","vss-PickList--multiSelectableElement"),onClick:this._onClick},i.createElement(t.Checkbox.Checkbox,{className:"vss-PickList--checkbox",checked:n.isSelected,disabled:u,ariaLabel:n.name}),e,o,s)},r}(l.BaseComponent),ft=function(n){function r(){var t=n!==null&&n.apply(this,arguments)||this;return t._onClick=function(n){var i=t.props.action;if(i.onClick)i.onClick(n)},t._onKeyDown=function(n){if(!t.props.action.disabled&&(n.which===13||n.which===32)){var i=t.props.action,r=n.ctrlKey||n.shiftKey;if(!i.onClick||i.href&&r)i.href&&(r?window.open(i.href,"_blank","noopener"):window.location.href=i.href);else t.props.action.onClick(n)}},t}return __extends(r,n),r.prototype.render=function(){var f=this.props,c=f.setSize,l=f.itemIndex,n=this.props.action,a=n.href,e=n.iconProps,o=n.name,v=n.disabled,s=n.ariaLabel,h=n.tooltipText,r=i.createElement(u.CommandButton,{className:"vss-PickList--selectableElementButton",onClick:this._onClick,disabled:v,href:a,tabIndex:-1,"data-is-focusable":!1,styles:{textContainer:{textAlign:"left"}},iconProps:e?t.VssIcon.VssIcon.getIconProps(e,"vss-PickList--selectableElementButtonIcon"):undefined},o);return h&&(r=i.createElement(t.Tooltip.TooltipHost,{content:h,hostClassName:"vss-PickList--action-tooltip"},r)),i.createElement("div",{"aria-label":s!==undefined?s:o,"aria-posinset":l+1,"aria-setsize":c,className:"vss-PickList--action","data-is-focusable":!0,role:"option",onKeyDown:this._onKeyDown},r)},r}(l.BaseComponent),et=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t._onChange=function(n,i){t.props.onChange(i.key)},t}return __extends(t,n),t.prototype.render=function(){var t=this,n=this.props,r=n.operators,o=n.onChange,u=n.selectedOperatorKey,e=r.map(function(n){return{text:n.name,key:n.key}});return i.createElement(f.ChoiceGroup,{selectedKey:u,options:e,onChange:this._onChange,componentRef:function(n){return t._choiceGroup=n}})},t.prototype.focus=function(){this._choiceGroup&&this._choiceGroup.focus()},t}(l.BaseComponent),ot=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.state={isVisible:!1},t}return __extends(t,n),t.prototype.componentDidMount=function(){var n=this;this.timeoutId=window.setTimeout(function(){n.setState({isVisible:!0});n.timeoutId=-1},p)},t.prototype.componentWillUnmount=function(){window.clearTimeout(this.timeoutId)},t.prototype.render=function(){return this.state.isVisible?i.createElement(h.Spinner,__assign({},this.props)):null},t}(i.PureComponent)}("ComponentsPickListPickList"),function(n){p=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var r=200,u=50,f=function(n){function f(t){var i=n.call(this,t)||this;return i._onClick=function(){i.props.disabled||i._togglePickList(!i._getEffectiveIsListOpen())},i._onKeyDown=function(n){i.props.disabled||(n.which===13||n.which===40?(i._togglePickList(!i._getEffectiveIsListOpen()),n.preventDefault()):n.which===27&&(i._togglePickList(!1),i._dropdownTitle.focus()))},i._onPickListFocusLost=function(){i._shouldRefocus=!0;i._togglePickList(!1)},i._onPositioned=function(){i._shouldRefocus&&(i._shouldRefocus=!1,i._pickList.focus())},i._onDismiss=function(n){i._shouldRefocus=!0;i._togglePickList(!1);n.which===27&&i._dropdownTitle.focus()},i._onSelectionChanged=function(n){var t=i._getEffectiveIsListOpen()&&i.props.selectionMode===s.SelectionMode.multiple;if(i._togglePickList(t),i._maintainsOwnState&&i.setState({selectedItems:n.selectedItems}),i.props.onSelectionChanged)return i.props.onSelectionChanged(n)},i._getNameFromItem=function(n){return i.props.getListItem?i.props.getListItem(n).name:n},i._getIconFromItem=function(n){return i.props.getListItem?i.props.getListItem(n).iconProps:undefined},i._id=l.getId("PickListDropdown"),i._maintainsOwnState=!1,t.initiallySelectedItems&&t.selectedItems&&console.warn("Please only provide ONE of initiallySelectedItems OR selectedItems as props"),t.initiallySelectedItems&&(i._maintainsOwnState=!0),i.state={isListOpen:!1,pickListWidth:t.pickListWidth||t.width||r,selectedItems:i._maintainsOwnState?t.initiallySelectedItems:undefined},i._shouldRefocus=!0,i}return __extends(f,n),f.prototype.focus=function(){this._getEffectiveIsListOpen()?this._pickList.focus():this._dropdownTitle.focus()},f.prototype.forceUpdate=function(){this._pickList&&this._pickList.forceUpdate()},f.prototype.render=function(){var d=this,n=this.props,ut=n.className,ft=n.pickListClassName,h=n.placeholder,et=n.getPickListItems,a=n.disabled,ot=n.selectionMode,g=n.preventDismissOnScroll,st=g===void 0?!0:g,ht=n.tabIndex,ct=n.hideSelectedItemIcon,nt=n.dropdownIconProps,tt=nt===void 0?{iconType:0,iconName:"ChevronDown"}:nt,it=n.directionalHint,rt=n.onRenderSelectedItemText,r=this._maintainsOwnState?this.state.selectedItems:this.props.selectedItems,e=this._getEffectiveIsListOpen(),f=r&&r.length>0,o=f?this._getTitleText(r):h,lt=l.css("vss-PickListDropdown",ut),at=l.css("vss-PickListDropdown--list",ft),p,w,c,b,k;return this.props.showPlaceholderAsLabel&&h&&f&&(p=i.createElement("span",{className:"vss-PickListDropdown--title-text vss-PickListDropdown--placeholder-label"},h+": ")),w=p?h+": "+o:o,this.props.ariaLabelFormat&&(w=l.format(this.props.ariaLabelFormat,f?o:"")),e&&(this._shouldRefocus=!0),c=undefined,f&&!ct&&(c=ot===s.SelectionMode.multiple?{iconType:0,iconName:"CheckMark",className:"vss-PickListDropdown--title-checkIcon"}:this._getIconFromItem(r[0])),b=l.getId("PickList"),k={},this.props.width&&(k.width=this.props.width+"px"),i.createElement("div",{className:lt,ref:this._resolveRef("_dropdown"),style:k},i.createElement("div",{tabIndex:a?-1:ht||0,ref:function(n){return d._dropdownTitle=n},onClick:this._onClick,onKeyDown:this._onKeyDown,className:l.css("vss-PickListDropdown--title",{"vss-PickListDropdown--placeholder":!f,disabled:a,focused:e}),"aria-expanded":e,"aria-label":w,"aria-describedby":this.props.ariaDescribedBy,"aria-disabled":!!a,role:"button",id:this._id,"aria-owns":e?b:null},c&&i.createElement(t.VssIcon.VssIcon,__assign({},c)),i.createElement("div",{className:"vss-PickListDropdown--title-textContainer"},i.createElement(t.Tooltip.TooltipHost,{content:o,overflowMode:t.Tooltip.TooltipOverflowMode.Parent},p,i.createElement("span",{className:l.css("vss-PickListDropdown--title-text",{"vss-PickListDropdown--title-text-withSelections":f}),role:"textbox","aria-readonly":!0},rt?rt(r):i.createElement(i.Fragment,null,o)))),i.createElement(t.VssIcon.VssIcon,__assign({},tt,{className:l.css(tt.className,"vss-PickListDropdown--title-caretIcon")})),this.getIndicators(r)),e&&i.createElement(v.Callout,{className:"vss-PickListDropdown--callout",onDismiss:this._onDismiss,onPositioned:this._onPositioned,target:this._dropdown,isBeakVisible:!1,preventDismissOnScroll:st,gapSpace:0,directionalHint:it!==undefined?it:4},i.createElement(y.PickList,__assign({},this.props,{initiallySelectedItems:undefined,selectedItems:r,width:this.state.pickListWidth,className:at,onSelectionChanged:this._onSelectionChanged,componentRef:function(n){return d._pickList=n},items:et(),onGroupLoadRequest:this.props.onGroupLoadRequest,onFocusLost:this._onPickListFocusLost,id:b,shouldVirtualize:function(n){return(n||[]).length>u}}))))},f.prototype.componentDidMount=function(){this.props.autoFocus&&this.focus()},f.prototype._getTitleText=function(n){var t=this._getNameFromItem(n[0]);return n.length>1&&(t=t+" (+"+(n.length-1)+")"),t},f.prototype.getIndicators=function(n){var r=this.props.selectedItemIndicators;return n&&n.length&&r&&r.length?i.createElement(t.ItemIndicator.ItemIndicatorSet,{indicators:r.map(function(t){return t.getItemIndicator(n[0])})}):null},f.prototype._togglePickList=function(n){var t=this,i=this.props.pickListWidth||this.props.width||(this._dropdownTitle?this._dropdownTitle.clientWidth:r);this.setState({isListOpen:n,pickListWidth:i},function(){return t.props.onToggleDropdown&&t.props.onToggleDropdown(t.state.isListOpen)})},f.prototype._getEffectiveIsListOpen=function(){return this.props.isOpen!==undefined?this.props.isOpen:this.state.isListOpen},f}(l.BaseComponent);t[n].PickListDropdown=f}("ComponentsPickListPickListDropdown"),function(n){var r,u,f;w=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});t[n].PICKER_CHANGE_EVENT="picker-changed";r=function(i){function r(n){var t=i.call(this,n)||this;return t.updateDelegate=function(){return t.forceUpdate()},t.state={},t}return __extends(r,i),r.prototype.componentDidMount=function(){this._events.on(this.props.provider,t[n].PICKER_CHANGE_EVENT,this.updateDelegate)},r.prototype.componentWillUnmount=function(){this._events.off(this.props.provider,t[n].PICKER_CHANGE_EVENT,this.updateDelegate)},r.prototype.componentWillReceiveProps=function(i){if(this.props.provider!==i.provider){this._events.off(this.props.provider,t[n].PICKER_CHANGE_EVENT,this.updateDelegate);this._events.on(i.provider,t[n].PICKER_CHANGE_EVENT,this.updateDelegate)}},r}(l.BaseComponent);t[n].ItemPickerComponentBase=r;u=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.render=function(){var r=this,t=this.props,u=t.className,n=t.provider,f=t.minWidth,e=t.pickListWidth,o=t.pickListClassName,s=t.tabIndex,h=t.placeholderText,c=t.hideSelectedItemIcon,a=t.dropdownIconProps,v=t.autoFocus;return i.createElement(p.PickListDropdown,{componentRef:function(n){return r.pickListDropdown=n},className:l.css("item-picker-dropdown",u),getListItem:n.getListItem,getPickListItems:function(){return n.getItems()},onSelectionChanged:function(t){return n.onSelectedItemChanged?n.onSelectedItemChanged(t&&t.selectedItems?t.selectedItems[0]:undefined):!1},selectedItems:n.selectedItem?[n.selectedItem]:undefined,indicators:n.dropdownIndicators,pickListClassName:o,selectedItemIndicators:n.selectedItemIndicators,pivots:n.pivots,groups:n.groups,limitSearchToPivot:n.limitSearchToPivot,onGroupLoadRequest:n.onGroupLoadRequest,placeholder:h,isSearchable:n.isSearchable,minItemsForSearchBox:n.minItemsForSearchBox,searchTextPlaceholder:n.searchTextPlaceholder,searchResultsGroupName:n.searchResultsGroupName,searchResultsLoadingText:n.searchResultsLoadingText,searchNoResultsText:n.searchNoResultsText,onSearch:n.onSearch,onHasMoreSearchResults:n.onHasMoreSearchResults,onFilterItemByText:n.onFilterItemByText,getActions:function(){return n.actions},noItemsText:n.noItemsText,width:f,pickListWidth:e,tabIndex:s,hideSelectedItemIcon:c,dropdownIconProps:a,autoFocus:v,shouldVirtualize:function(n){return(n||[]).length>50},onRenderItemText:this.props.onRenderItemText,isOpen:this.props.isOpen,onToggleDropdown:this.props.onToggleDropdown})},t}(r);t[n].ItemPickerDropdown=u;f=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.render=function(){var f=this,t=this.props,e=t.className,n=t.provider,r=t.useDropdownStyle,u=t.shouldVirtualize;return i.createElement(y.PickList,{componentRef:function(n){return f.pickList=n},className:l.css(r?"item-picker-dropdown":"item-picker-list",e),getListItem:n.getListItem,items:n.getItems(),onSelectionChanged:function(t){return n.onSelectedItemChanged?n.onSelectedItemChanged(t&&t.selectedItems?t.selectedItems[0]:undefined):!1},selectedItems:n.selectedItem?[n.selectedItem]:undefined,indicators:n.dropdownIndicators,groups:n.groups,pivots:n.pivots,limitSearchToPivot:n.limitSearchToPivot,onGroupLoadRequest:n.onGroupLoadRequest,isSearchable:n.isSearchable,searchTextPlaceholder:n.searchTextPlaceholder,searchResultsGroupName:n.searchResultsGroupName,searchResultsLoadingText:n.searchResultsLoadingText,searchNoResultsText:n.searchNoResultsText,onSearch:n.onSearch,onHasMoreSearchResults:n.onHasMoreSearchResults,onFilterItemByText:n.onFilterItemByText,getActions:function(){return n.actions},noItemsText:n.noItemsText,shouldVirtualize:u?u:function(n){return(n||[]).length>50},minItemsForSearchBox:r?undefined:1,onRenderItemText:this.props.onRenderItemText})},t}(r);t[n].ItemPickList=f}("ComponentsPickListItemPicker"),function(n){b=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var r=256,u=function(n){function u(r){var u=n.call(this,r)||this;return u._onClearClicked=function(){u.setFilterValue({value:[],operator:u.state.operator});u.focus()},u._onSelectionChanged=function(n){var t=!1;return u.props.onSelectionChanged&&(t=u.props.onSelectionChanged(n)),u.setFilterValue({value:n.selectedItems,operator:n.selectedOperatorKey}),t},u.onRenderFooter=function(){return i.createElement("div",{className:"vss-PickList--filterBarFooter flex-column"},i.createElement(t.Button.Button,{className:"flex-self-end vss-PickList--filterBarFooterClear",iconProps:{iconName:"Clear"},subtle:!0,disabled:!u.state.value||u.state.value.length===0,ariaLabel:t.VSSResourcesVSSUI.PickListClearActionAriaLabel,onClick:u._onClearClicked},t.VSSResourcesVSSUI.PickListClearActionText))},u._validateProps(r),u}return __extends(u,n),u.prototype.componentWillReceiveProps=function(t){n.prototype.componentWillReceiveProps.call(this,t);this._validateProps(t)},u.prototype.focus=function(){this._pickListDropdown.focus()},u.prototype.forceUpdate=function(){this._pickListDropdown&&this._pickListDropdown.forceUpdate()},u.prototype.render=function(){var o=this,n=this.props.placeholder,u=this.state.value,f=null,e=this.props.operators;return this.props.showOrAndOperators&&(e=[{name:t.VSSResourcesVSSUI.FilterOperatorOr,key:"or"},{name:t.VSSResourcesVSSUI.FilterOperatorAnd,key:"and"}]),n&&(f=u&&u.length>0?l.format(t.VSSResourcesVSSUI.FilterDropdownLabel,n)+" {0}":l.format(t.VSSResourcesVSSUI.FilterDropdownLabelNoSelection,n)),i.createElement(p.PickListDropdown,__assign({className:"vss-PickListDropdown--filterBar",pickListClassName:"vss-PickList--filterBar",componentRef:function(n){return o._pickListDropdown=n},showSelectAll:this.props.selectionMode===s.SelectionMode.multiple,ariaLabelFormat:f},this.props,{operators:e,selectedItems:u,selectedOperatorKey:this.state.operator,onSelectionChanged:this._onSelectionChanged,pickListWidth:r,directionalHint:6,width:undefined,onRenderFooter:this.onRenderFooter}))},u.prototype._validateProps=function(n){var t=n.width;t!==undefined&&l.warn("width should not be specified for picklist filter bar item, value will be ignored")},u}(t.FilterBar.FilterBarItem);t[n].PickListFilterBarItem=u}("ComponentsPickListPickListFilterBarItem"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}k=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(w);i(y);i(p);i(b)}("ComponentsPickListindex"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}g=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(k)}("PickList")},["Components/PickList/PickList.Props","Components/PickList/PickList","Components/PickList/PickListDropdown","Components/PickList/ItemPicker","Components/PickList/PickListFilterBarItem","Components/PickList/index","PickList"]);document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-picklist-content"}}));