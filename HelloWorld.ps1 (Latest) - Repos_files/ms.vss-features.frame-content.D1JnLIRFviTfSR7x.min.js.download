"use strict";define("VSS/Features/Frame",["require","exports","VSS/Platform/Layout","VSS/Platform/Location","VSS/Core/Util/String","VSS/Platform/Util/Url","react","react-dom","OfficeFabric/FocusTrapZone","VSSUI/Callout","VSS/Platform/Components/FPSLink","VSS/Platform/Util/DOM","OfficeFabric/Icon","OfficeFabric/Utilities","VSS/Platform/Feature","VSS/Platform/FPS","VSS/Core/Observable","VSSUI/VssIcon"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){var k,g,nt,ct,d,tt,it,rt,ut,ft,lt,at,et,vt,yt,pt,ot,st,ht,wt;(function(n){k=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});t[n].ExecuteSearch="Get search results";t[n].SearchChangeType="Change search type";t[n].SearchPlaceholder="Search";t[n].ShowSearch="Show Search";t[n].Close="Close"})("Resources"),function(n){g=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var u=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.render=function(){var n=this,t=this.props.assets.map(function(t){return r.getAssetLocation(n.context.pageContext,t)});return this.props.children(t)},t}(i.VssComponent);t[n].AssetResolver=u}("AssetResolverAssetResolver"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}nt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(g)}("AssetResolverindex"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}ct=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(nt)}("AssetResolver"),function(n){function i(n,t,i){var o,r,s,e;return i&&(r=void 0,i.match(/^https?:\/\//)?r=i:(s=n.getService("IVssContributionService"),e=s.getContributionProvider(t),e&&(r=f.combineUrlPaths(e.baseUri,i))),r&&(o={iconName:"None",className:"icon third-party-icon",style:{backgroundImage:u.format("url({0})",r),backgroundRepeat:"no-repeat"}})),o}d=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});t[n].contributionIconToIconProps=i}("ContributedIconUtil"),function(n){tt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function n(n,t,r){var u=this;this.ownerDrawMenuItem=function(n){return e.createElement(i.WrappedComponent,__assign({wrappedType:n.componentType},Object.assign({key:n.key},n.componentProperties)))};this.onMenuItem=function(n,t){if(t){var i=u._pageContext.getService("IVssContributionService");t.command?i.executeCommandEx(t.key,t.command,u._data):i.getService(t.key,!0).then(function(n){n&&n.execute&&n.execute(u._data)})}};this._pageContext=n;this._menuId=t;this._data=r}return n.prototype.loadItems=function(n,t){var h=this,e=[],b={},u=this._pageContext.getService("IVssContributionService"),tt=u.getSharedData("_menuItems"),c,l,k,a,o,g,r,v,i,y,s,it,p,rt,w,nt,f;if(tt&&(c=tt[this._menuId],c&&c.length>0&&(c.forEach(function(n){n.onClick=n.command?h.onMenuItem:undefined;e.push(n)}),n(this.prepareMenuItems(e)))),l=u.getContributionChildren(this._menuId,"ms.vss-web.menu-item"),l)for(i=0;i<l.length;i++)f=l[i],k=u.getContribution(f),k&&(e.push(this.createMenuItem(k,f)),b[f]=f);if(a=u.getContributionsByType("ms.vss-web.menu-item"),a)for(o in a)b[o]||(g=a[o],g.menuId===this._menuId&&(e.push(this.createMenuItem(g,o)),b[o]=o));for(e.length>0&&n(this.prepareMenuItems(e)),r=u.getContributionChildren(this._menuId,"ms.vss-web.menu-provider")||[],v={},i=0;i<r.length;i++)v[r[i]]=r[i];if(y=u.getContributionsByType("ms.vss-web.menu-provider"),y)for(s in y)v[s]||(it=y[s],it.menuId===this._menuId&&(r.push(s),v[s]=s));if(r&&r.length>0)for(p=r.slice(0),rt=function(i){u.getService(i,!0).then(function(r){var u,e,f;r&&(u=function(r,u){n(h.prepareMenuItems(r),u);var f=p.indexOf(i);f>-1&&(p.splice(f,1),p.length===0&&t())},typeof r.loadItems=="function"?r.loadItems(u):typeof r.loadMenuItems=="function"?r.loadMenuItems(u):typeof r.getMenuItems=="function"&&(e=function(n){for(var r=[],u=function(t){var u=n[t],f={key:i+t.toString(),name:u.text,groupId:u.groupId,iconProps:d.contributionIconToIconProps(h._pageContext,u.id,u.icon),onClick:function(){u.action&&u.action(h._data)}};r.push(f)},t=0;t<n.length;t++)u(t);return r},f=r.getMenuItems(h._data||{}),f instanceof Promise?f.then(function(n){u(e(n),[])}):u(e(f),[])))})},w=0,nt=r;w<nt.length;w++)f=nt[w],rt(f);else t()},n.prototype.createMenuItem=function(n,t){return{command:n.command,href:n.href,iconProps:n.iconProps||d.contributionIconToIconProps(this._pageContext,n.id,n.icon),key:t,name:n.name,rank:n.rank,onClick:n.command?this.onMenuItem:undefined,groupKey:n.groupKey}},n.prototype.prepareMenuItems=function(t){for(var i,f,r=0,u=t;r<u.length;r++)i=u[r],i.componentType&&(i.onRender=this.ownerDrawMenuItem),f=i.menuId,f&&(i.subMenuProps||(i.subMenuProps={}),i.subMenuProps.providers=[new n(this._pageContext,f)]);return t},n}();t[n].ContributedMenuItemProvider=r}("ContributedMenuItemProvider"),function(n){it=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var r=function(n){function t(t){var i=n.call(this,t)||this;return i.adjustedIndex=0,i.updateLayout=function(){var r=o.findDOMNode(i),f,s,h,c,e,n,t;if(r&&r.children.length){var p=i.adjustedIndex,a=r.getBoundingClientRect(),u=0,v=0,y=!1;for(i.adjustDetails&&r.children.length===i.adjustDetails.length||(i.appliedAdjustments=[],i.adjustDetails=[],i.adjustments=i.props.adjustments.slice(0,i.props.adjustments.length),i.adjustments.sort(function(n,t){var i=(n.priority||Number.MAX_VALUE)-(t.priority||Number.MAX_VALUE);return i===0&&(i=t.index-n.index),i}),y=!0),f=0;f<r.children.length;f++)s=r.children[f].getBoundingClientRect(),y?i.adjustDetails.push({adjustmentIndex:-1,clientRect:s}):i.adjustDetails[f].clientRect=s,i.props.ignoredChildren[f]&&(v+=i.props.orientation===1?s.height:s.width);if(u=i.props.orientation===1?i.adjustDetails[i.adjustDetails.length-1].clientRect.bottom-i.adjustDetails[0].clientRect.top:i.adjustDetails[i.adjustDetails.length-1].clientRect.right-i.adjustDetails[0].clientRect.left,u-=Math.floor(v),h=i.props.orientation===1?a.height:a.width,h<=u)for(c={},e=h-u;e<0&&i.adjustedIndex<i.adjustments.length;){var n=i.adjustments[i.adjustedIndex],t=i.adjustDetails[n.index],l=void 0;l=i.props.orientation===1?t.clientRect.height-(c[n.index]||0):t.clientRect.width-(c[n.index]||0);n.approxSize?l-=n.approxSize:t.hidden=!0;t.adjustmentIndex++;e+=l;i.appliedAdjustments[i.adjustedIndex]=l;c[n.index]=l+(c[n.index]||0);i.adjustedIndex++}else if(h>u)for(e=h-u;i.adjustedIndex>0&&i.appliedAdjustments[i.adjustedIndex-1]<e;)n=i.adjustments[--i.adjustedIndex],t=i.adjustDetails[n.index],t.adjustmentIndex--,e-=i.appliedAdjustments[i.adjustedIndex],t.hidden=!1;if(p!=i.adjustedIndex){if(i.props.onLayoutChange)i.props.onLayoutChange(i.adjustedIndex-1);window.setTimeout(function(){i.forceUpdate()},0)}}},i.addEventListener(window,"resize",function(){i.updateLayout()}),i}return __extends(t,n),t.prototype.render=function(){var n=this,t=e.Children.only(this.props.children);return e.cloneElement(t,t.props,e.Children.map(t.props.children,function(t,i){if(n.adjustDetails&&n.adjustDetails[i]){if(n.adjustDetails[i].hidden)return e.createElement("div",{key:"PH"+i,className:"responsive-placeholder"});if(n.adjustDetails[i].adjustmentIndex>=0){var r=t,u=Object.assign({},r.props,{adjustmentIndex:n.adjustDetails[i].adjustmentIndex});return e.cloneElement(r,u,r.props&&r.props.children)}}return t}))},t.prototype.componentDidMount=function(){n.prototype.componentDidMount.call(this);this.updateLayout()},t.prototype.componentDidUpdate=function(t,i){n.prototype.componentDidUpdate.call(this,t,i);this.updateLayout()},t.prototype.resetLayout=function(){delete this.adjustDetails;this.adjustedIndex=0},t}(i.VssComponent);t[n].ResponsiveLayout=r}("ResponsiveLayoutResponsiveLayout"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}rt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(it)}("ResponsiveLayout"),function(n){ut=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var r=function(n){function t(t){var i=n.call(this,t)||this;return i.onDismiss=function(){i.props.onDismiss&&i.props.onDismiss()},t.firstFocusableSelector||(i.focusElement=e.createElement("div",{className:"command-bar-flyout-focus-element","aria-label":t.ariaLabel,role:"presentation",tabIndex:-1})),i}return __extends(t,n),t.prototype.render=function(){var n=this,t=e.Children.map(this.props.children,function(t){return t&&e.cloneElement(t,Object.assign({},t.props,{onDismiss:n.onDismiss}),t.props.children)});return e.createElement(h.Callout,{ariaLabel:this.props.ariaLabel,className:i.css("command-bar-flyout",this.props.className),contentClassName:i.css("command-bar-flyout-content relative scroll-hidden",this.props.contentClassName),contentJustification:3,contentLocation:2,contentOrientation:0,id:this.props.id,isEscDismiss:this.props.isEscDismiss,isLightDismiss:this.props.isLightDismiss,isModal:this.props.isModal,onDismiss:this.onDismiss},e.createElement(s.FocusTrapZone,{className:"flex flex-column flex-grow scroll-hidden",firstFocusableSelector:this.props.firstFocusableSelector||"command-bar-flyout-focus-element",forceFocusInsideTrap:!0,isClickableOutsideFocusTrap:!0},this.focusElement,t))},t.prototype.componentWillUnmount=function(){n.prototype.componentWillUnmount.call(this);this.calloutDismissed&&this.calloutDismissed()},t}(i.VssComponent);t[n].CommandBarFlyout=r;i.VssComponent.register("commandBarFlyout",r)}("CommandBarCommandBarFlyout"),function(n){var f,u,s,w,h,v,y,p;ft=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});f=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.stateComponents={},r.components={},r.childCount=0,r.expand=function(n,t,i){if(t){if(!r.expanded||r.expandedKey!==n){var u=r.components[n];if(u)return r.focusedKey&&r.focusedKey!==n&&r.focusComponent(r.components[n]),r.expandedReason=i,r.expandedKey=n,r.expanded=!0,r.forceUpdate(),!0}}else if(r.expandedKey===n&&r.expanded)return r.expandedReason=undefined,r.expandedKey=undefined,r.expanded=undefined,r.forceUpdate(),!0;return!1},r.onBlur=function(n){r.componentElement&&r.componentElement.contains(n.srcElement)&&r.setTimeout(function(){r.processFocusChange=!0;r.forceUpdate()})},r.onFocus=function(n){if(r.focusElement===document.activeElement){var t=r.componentElement.querySelector("[tabIndex='-2']");t&&t.focus()}else r.componentElement&&r.componentElement.contains(n.target)&&(r.processFocusChange=!0,r.forceUpdate())},r.onKeyDown=function(n){if(!n.defaultPrevented&&r.focusedKey)for(var i=void 0,t=parseInt(r.focusedKey),f=t,u=!1,e=r.props.orientation===1?38:37,o=r.props.orientation===1?40:39;;){if(n.which===e?(--t==-1&&(t=r.childCount-1),u=!0):n.which===o&&++t===r.childCount&&(t=0),t===f)break;if(i=r.components[t],i&&r.focusComponent(i,u)){n.preventDefault();break}}},r.onKeyDownBody=function(n){r.setTimeout(function(){r.onKeyDown(n)},0)},r.processItems(t),r}return __extends(t,n),t.prototype.render=function(){var r=this,o,t,v,s,y,p,h,b,d,l,k,n,a;if(this.componentDetails?this.childCount=this.componentDetails.length:this.props.children&&(this.childCount=e.Children.count(this.props.children)),o=[],this.componentDetails?this.componentDetails.forEach(function(n,t){o.push({groupKey:n.componentProperties&&n.componentProperties.groupKey,element:e.createElement(i.WrappedComponent,__assign({wrappedType:n.componentType},Object.assign(r.getItemProps(t.toString()),n.componentProperties,{key:t.toString()})))})},this):this.props.children&&e.Children.forEach(this.props.children,function(n,t){var i;n||(n=e.createElement("div",{className:"commandbar-item-placeholder"}),i={});i=typeof n.type=="string"?{ref:function(n){r.components[t.toString()]=n}}:r.getItemProps(t.toString());o.push({groupKey:n.props&&(n.props.groupKey||n.props["data-groupKey"]),element:e.cloneElement(n,Object.assign(i,n.props),n.props.children)})}),this.props.groups){for(v={},s=0,y=this.props.groups;s<y.length;s++)p=y[s],v[p.key]=p;var w=[],f=undefined,tt=function(n){var t=undefined,i;n.groupKey&&(t=v[n.groupKey]);f&&t===f.group?f.items.push(n.element):(i=undefined,t&&(i=w.filter(function(n){return n.group===t})[0]),i?f=i:(f={group:t,items:[]},w.push(f)),f.items.push(n.element))};for(h=0,b=o;h<b.length;h++)d=b[h],tt(d);t=[];var c=!1,g=!1,nt=0;for(l=0,k=w;l<k.length;l++)n=k[l],n.group?(c&&n.group.useSeparators&&t.push(e.createElement(u,{key:"group-separator-"+(++nt).toString()})),t.push(e.createElement("div",{key:"group-"+n.group.key,className:n.group.className,ref:n.group.ref},n.items)),n.group.useSeparators?(g=!0,c=!1):c=!0):(g&&t.push(e.createElement(u,{key:"group-separator-"+(++nt).toString()})),t.push.apply(t,n.items),c=!0)}else t=o.map(function(n){return n.element});return a=e.createElement("div",{"aria-label":this.props["aria-label"],className:i.css("commandbar",this.props.className,this.props.componentRegion?"region-"+this.props.componentRegion:"",this.props.orientation===1?"flex-column":"flex-row",this.focusedKey?"focus":""),"data-renderedregion":this.props.componentRegion?this.props.componentRegion:null,ref:function(n){r.componentElement=n},role:"menubar",onFocus:this.onFocus,onKeyDown:function(n){r.onKeyDown(n.nativeEvent)}},e.createElement("div",{key:"focus.element",ref:function(n){r.focusElement=n},onFocus:this.onFocus,tabIndex:this.focusedKey?-1:0}),t),this.responsiveProps&&(a=e.createElement(rt.ResponsiveLayout,__assign({ref:function(n){r.responsiveLayout=n},orientation:this.props.orientation===1?1:0},this.responsiveProps),a)),a},t.prototype.componentDidUpdate=function(t,i){var u,r,f,e;if(n.prototype.componentDidUpdate.call(this,t,i),this.processFocusChange){u=!1;for(r in this.components)if(f=this.components[r],f&&(e=o.findDOMNode(f),e&&l.contains(e,document.activeElement))){this.focusedKey!==r?document.activeElement.getAttribute("tabIndex")==="-2"&&(this.addEventListener(document.body,"blur",this.onBlur,!0),navigator.userAgent.toLowerCase().indexOf("trident")===-1&&this.addEventListener(document.body,"keydown",this.onKeyDownBody),this.expanded&&this.expand(r,!0,"focus"),u=!0,this.focusedKey=r,this.forceUpdate()):u=!0;break}u||(this.expandedKey&&this.expand(this.expandedKey,!1,"blur"),this.focusedKey&&(this.focusedKey=undefined,this.removeEventListener(document.body,"blur",this.onBlur,!0),this.removeEventListener(document.body,"keydown",this.onKeyDownBody),this.forceUpdate()));delete this.processFocusChange}},t.prototype.componentWillReceiveProps=function(t){var r,u,f,o;if(n.prototype.componentWillReceiveProps.call(this,t),this.processItems(t),this.focusedKey&&(t.children||this.componentDetails)&&(r=this.components[this.focusedKey],r)){if(u=!1,t.children)e.Children.map(this.props.children,function(n){n.key===r.props.key&&(u=!0)});else if(this.componentDetails)for(f=0;f<this.componentDetails.length;f++)if(o=this.componentDetails[f],o.componentProperties&&o.componentProperties.key===r.props.key){u=!0;break}if(!u)for(var s=void 0,i=parseInt(this.focusedKey),h=i;;){if(s=this.components[i],s&&this.focusComponent(s))break;if(--i==-1&&(i=this.childCount-1),i===h)break}}this.components={};this.stateComponents={}},t.prototype.focus=function(n){this.focusComponent(this.components[n.toString()])},t.prototype.resetLayout=function(){this.responsiveLayout&&this.responsiveLayout.resetLayout()},t.prototype.processItems=function(n){var i,r,t;if(n.componentRegion?(r=this.context.pageContext.getService("IVssLayoutManager"),this.componentDetails=r.getComponentsForRegion(n.componentRegion)):this.componentDetails=n.items?n.items:undefined,n.responsiveProps){for(this.responsiveProps={adjustments:[],ignoredChildren:n.responsiveProps.ignoredChildren.slice(0,n.responsiveProps.ignoredChildren.length),onLayoutChange:n.responsiveProps.onLayoutChange},t=0;t<n.responsiveProps.adjustments.length;t++)this.responsiveProps.adjustments[t]=Object.assign({},n.responsiveProps.adjustments[t]),this.responsiveProps.adjustments[t].index++;(i=this.responsiveProps.ignoredChildren).splice.apply(i,[0,0].concat([!0]))}},t.prototype.focusComponent=function(n,t){var r=o.findDOMNode(n),i,u;return r&&(i=void 0,r.getAttribute("tabIndex")==="-2"?i=r:t?(u=r.querySelectorAll("[tabIndex='-2']"),i=u.item(u.length-1)):i=r.querySelector("[tabIndex='-2']"),i)?(i.focus(),!0):!1},t.prototype.getItemProps=function(n){var t=this;return{itemKey:n,expand:this.expand,expandOnHover:!0,expanded:this.expandedKey===n,expandedReason:this.expandedReason,mouseHoverDelayMs:this.expanded?0:200,ref:function(i){t.components[n]=t.stateComponents[n]||i},selected:this.focusedKey===n,shouldFocusOnMount:!!this.focusedKey}},t.componentType="commandBar",t}(i.VssComponent);t[n].CommandBarComponent=f;i.VssComponent.register(f.componentType,f);i.VssComponent.register("commandbar",f);u=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.render=function(){return e.createElement("div",{className:"flex separator",role:"separator"},e.createElement("div",{className:i.css("flex-cell","separator-item",this.props.className)}))},t.componentType="commandBarSeperator",t}(e.Component);t[n].CommandBarSeperatorComponent=u;i.VssComponent.register("commandBarSeparator",u);i.VssComponent.register(u.componentType,u);s=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.onSearchExpanded=function(){r.setState({searchExpanded:!0})},r.onSearchCollapsed=function(){r.setState({searchExpanded:!1})},window.addEventListener("searchExpanded",r.onSearchExpanded),window.addEventListener("searchCollapsed",r.onSearchCollapsed),r.state={searchExpanded:!1},r}return __extends(t,n),t.prototype.componentWillUnmount=function(){window.removeEventListener("searchExpanded",this.onSearchExpanded);window.removeEventListener("searchCollapsed",this.onSearchCollapsed)},t.prototype.render=function(){return this.state.searchExpanded?null:e.createElement(u,__assign({},this.props))},t.componentType="verticalHeaderCommandBarSeperator",t}(e.Component);t[n].VerticalHeaderCommandBarSeparatorComponent=s;i.VssComponent.register("verticalHeaderCommandBarSeperator",s);i.VssComponent.register(s.componentType,s);w=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.render=function(){return e.createElement("div",{"aria-label":this.props["aria-label"],className:i.css("commandbar-item",this.props.className,this.props.selected||this.props.expanded?" selected":""),id:this.props.id,role:"menuitem",tabIndex:this.props.noTabIndex?undefined:this.props.selected?0:-2},this.props.children)},t}(i.VssComponent);t[n].CommandBarChildComponent=w;h=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.onDivClick=function(n){if(!n.isDefaultPrevented()){if(r.props.telemetrySource){var t=r.context.pageContext.getService("IVssTelemetryService");t.publishEvent("WebPlatform","Command",__assign({},r.props.telemetryProperties||{},{source:r.props.telemetrySource}))}if(r.props.onClick)r.props.onClick(n)}},r.onDivKeyDown=function(n){if(!n.isDefaultPrevented()&&(n.which===32||n.which===13))r.onDivClick(n)},r.computeHref(t),r}return __extends(t,n),t.prototype.render=function(){var u=!!this.href,t=i.css("commandbar-item commandbar-item-command",this.props.className),r={"aria-label":this.props["aria-label"],id:this.props.id,role:"menuitem",tabIndex:this.props.noTabIndex?undefined:this.props.selected?0:-2},n=[];return this.props.iconName&&n.push(e.createElement(a.Icon,{key:"icon",className:"commandbar-item-icon",iconName:this.props.iconName})),this.props.text&&n.push(e.createElement("span",{key:"text",className:"commandbar-item-text"},this.props.text)),n.splice(n.length,0,this.props.children),u?e.createElement(c.FPSLinkComponent,__assign({},r,{className:i.css("commandbar-item-link",t,this.props.selected||this.props.expanded?" selected":""),href:this.href,supportsFPS:this.props.supportsFPS===!0,title:this.props.title,onClick:this.props.onClick,onMouseDown:function(n){n.preventDefault()},telemetrySource:this.props.telemetrySource||"commandBarCommand",telemetryProperties:this.props.telemetryProperties,navigationId:this.props.navigationId}),n):e.createElement("div",__assign({},r,{className:i.css("commandbar-item-button cursor-pointer",t,this.props.selected?"selected":""),role:"button",title:this.props.title,onClick:this.onDivClick,onKeyDown:this.onDivKeyDown,onMouseDown:function(n){n.preventDefault()}}),n)},t.prototype.componentWillReceiveProps=function(t){n.prototype.componentWillReceiveProps.call(this,t);this.computeHref(t)},t.prototype.computeHref=function(n){this.href=n.href?n.href:n.routeId?r.routeUrl(this.context.pageContext,n.routeId,n.routeValues||{}):undefined},t.componentType="commandBarCommand",t}(i.VssComponent);t[n].CommandBarCommandComponent=h;i.VssComponent.register("commandBarLink",h);i.VssComponent.register(h.componentType,h);v=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.onKeyDown=function(n){if(t.element&&t.element.contains(n.target)&&!n.defaultPrevented){var i=t.props.expandKey||40;(n.which===13||n.which===i||n.shiftKey&&n.which===121)&&(t.props.expand&&t.props.itemKey&&t.props.expand(t.props.itemKey,!0,n.type),n.preventDefault())}},t.onMouseEnter=function(n){if(t.props.expandOnHover&&t.props.expand){var i=n.type;t.hoverTimeout&&t.clearTimeout(t.hoverTimeout);t.hoverTimeout=t.setTimeout(function(){t.props.expand&&t.props.itemKey&&t.props.expand(t.props.itemKey,!0,i)},t.props.mouseHoverDelayMs)}},t.onMouseLeave=function(){t.hoverTimeout&&(t.clearTimeout(t.hoverTimeout),delete t.hoverTimeout)},t.onClick=function(n){t.element&&t.element.contains(n.target)&&t.props.expand&&t.props.itemKey&&!n.defaultPrevented&&t.props.expand(t.props.itemKey,!t.props.expanded,n.type)},t.touchEnd=function(n){t.props.expand&&t.props.itemKey&&!t.props.expanded&&(t.props.expand(t.props.itemKey,!0,n.type),n.preventDefault())},t}return __extends(t,n),t.prototype.render=function(){var n=this;return e.createElement("div",{"aria-controls":this.props.expanded?this.props.calloutId:undefined,"aria-expanded":this.props.expanded,"aria-haspopup":!0,"aria-label":this.props["aria-label"],"aria-owns":this.props.expanded?this.props.calloutId:undefined,className:i.css("commandbar-item cursor-pointer",this.props.className,this.props.selected||this.props.expanded?"selected":"",this.props.expanded?"expanded":""),id:this.props.id,ref:function(t){return n.element=t},role:"menuitem",tabIndex:this.props.noTabIndex?undefined:this.props.selected?0:-2,onClick:this.onClick,onMouseDown:function(t){n.element&&n.element.contains(t.target)&&t.preventDefault()},onKeyDown:this.onKeyDown,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onTouchEnd:this.touchEnd},this.props.iconName&&e.createElement(i.WrappedComponent,{wrappedType:"vssIcon",iconName:this.props.iconName}),this.props.children)},t}(i.VssComponent);t[n].CommandBarExpandableComponent=v;y=function(n){function t(t){var i=n.call(this,t)||this;return t.menuProps&&(i.menuId=t.menuProps.id),i.menuId=i.menuId||"menu"+i.componentId,i}return __extends(t,n),t.prototype.render=function(){var n=this,t=this.props.expanded?this.getMenuProps():null;return e.createElement(v,__assign({},this.props,{calloutId:this.props.expanded?this.menuId:undefined,className:i.css("commandbar-item-menu",this.props.className),id:"cmec"+this.componentId}),this.props.children,this.props.expanded?e.createElement(i.WrappedComponent,{wrappedType:"contextualMenu",wrappedRef:function(t){n.menuComponent=t},wrappedProps:t}):null)},t.prototype.componentDidMount=function(){n.prototype.componentDidMount.call(this);this.props.expanded&&this.forceUpdate()},t.prototype.getMenuProps=function(){var n=this,t=[];return this.props.menuId&&t.push(new tt.ContributedMenuItemProvider(this.context.pageContext,this.props.menuId)),this.props.menuProps&&this.props.menuProps.providers&&t.push.apply(t,this.props.menuProps.providers),Object.assign({gapSpace:0,id:this.menuId,items:this.props.items||[],providers:t,bounds:{left:0,top:0,right:window.innerWidth,bottom:window.innerHeight,width:window.innerWidth,height:window.innerHeight}},this.props.menuProps,{mouseLeaveDelayMs:this.props.expandedReason&&this.props.expandedReason==="mouseenter"?this.props.mouseLeaveDelayMs:0,onDismiss:function(t){n.props.expand&&n.props.itemKey&&n.props.expand(n.props.itemKey,!1,t&&t.type)},shouldFocusOnMount:this.props.shouldFocusOnMount,target:"#cmec"+this.componentId})},t.defaultProps=Object.assign({mouseLeaveDelayMs:500,mouseHoverDelayMs:200},i.VssComponent.defaultProps),t}(i.VssComponent);t[n].CommandBarMenuComponent=y;i.VssComponent.register("commandBarMenu",y);p=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.onDismiss=function(){t.props.expand&&t.props.itemKey&&t.props.expand(t.props.itemKey,!1)},t}return __extends(t,n),t.prototype.render=function(){return e.createElement(v,__assign({},this.props,{expandOnHover:!1,calloutId:this.props.expanded?"flyout"+this.componentId:undefined,className:i.css("commandbar-item-flyout",this.props.className),id:"cpec"+this.componentId}),this.props.children,this.props.expanded?e.createElement(ut.CommandBarFlyout,__assign({},this.props.commandBarFlyoutProps,{id:"flyout"+this.componentId,onDismiss:this.onDismiss,openingElement:"#cpec"+this.componentId}),e.createElement(i.WrappedComponent,__assign({},this.props.wrappedComponent,{expandedReason:this.props.expandedReason}))):null)},t}(i.VssComponent);t[n].CommandBarFlyoutComponent=p;i.VssComponent.register("commandBarFlyoutComponent",p)}("CommandBarCommandBar"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}lt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(ft)}("CommandBar"),function(n){at=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(n,t,i){this._pageContext=n;this._breadcrumbId=t;this._data=i}return n.prototype.loadItems=function(n,t){var u=[],p={},f=this._pageContext.getService("IVssContributionService"),d=f.getSharedData("_breadcrumbItems"),c,w,l,o,b,r,a,i,v,s,g,h,nt,y,k,e;if(d&&(u=d[this._breadcrumbId],u&&u.length>0&&n(u)),c=f.getContributionChildren(this._breadcrumbId,"ms.vss-web.breadcrumb-item"),c)for(i=0;i<c.length;i++)e=c[i],w=f.getContribution(e),w&&(u.push(this.createBreadcrumbItem(w,e)),p[e]=e);if(l=f.getContributionsByType("ms.vss-web.breadcrumb-item"),l)for(o in l)p[o]||(b=l[o],b.breadcrumbId===this._breadcrumbId&&(u.push(this.createBreadcrumbItem(b,o)),p[o]=o));for(u.length>0&&n(u),r=f.getContributionChildren(this._breadcrumbId,"ms.vss-web.breadcrumb-provider")||[],a={},i=0;i<r.length;i++)a[r[i]]=r[i];if(v=f.getContributionsByType("ms.vss-web.breadcrumb-provider"),v)for(s in v)a[s]||(g=v[s],g.breadcrumbId===this._breadcrumbId&&(r.push(s),a[s]=s));if(r&&r.length>0)for(h=r.slice(0),nt=function(i){f.getService(i).then(function(r){r&&r.loadItems(function(r,u){n(r,u);h.length===0&&t();var f=h.indexOf(i);f>-1&&(h.splice(f,1),h.length===0&&t())})})},y=0,k=r;y<k.length;y++)e=k[y],nt(e);else t()},n.prototype.createBreadcrumbItem=function(n,t){return{href:n.href,key:t,text:n.text,rank:n.rank}},n}();t[n].ContributedBreadcrumbItemProvider=i}("ContributedBreadcrumbItemProvider"),function(n){function r(n){var t=__assign({},n.componentProperties,n.contribution.componentProperties,{className:v.css(n.className,n.componentProperties&&n.componentProperties.className,n.contribution.componentProperties&&n.contribution.componentProperties.className)}),r=(n.dependencies||[]).concat(n.contribution.dependencies||[]);return n.contribution.uri?e.createElement(i.WrappedComponent,{dependencies:r.concat(["ms.vss-web.ext-content"]),wrappedType:"ExternalContent",wrappedProps:__assign({},t,{contributionId:n.contributionId})}):n.contribution.componentType?e.createElement(i.WrappedComponent,{dependencies:r,wrappedType:n.contribution.componentType,wrappedProps:t}):null}et=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});t[n].ContributedContentComponent=r}("ContributedContentComponent"),function(n){vt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(n){this._pageContext=n.context;this._targetId=n.targetId;this._contributionType=n.contributionType||"ms.vss-web.action";this._getContext=n.getContext}return n.prototype.loadItems=function(n){var t=this,i=this._pageContext.getService("IVssContributionService"),f=i.getContributionChildren(this._targetId,this._contributionType),e=[],o,s,r,u,h,c;if(f)for(o=function(n){var u=i.getContribution(n),r;u&&(r={key:n,name:u.text,iconProps:u.iconProps||d.contributionIconToIconProps(s._pageContext,n,u.icon),important:u.important,command:u.command,registeredObjectId:u.registeredObjectId,uri:u.uri,onClick:function(){var u,f;r&&(t._getContext&&(u=t._getContext(r)),r.command?i.executeCommandEx(n,r.command,u):(f={serviceName:r.registeredObjectId||r.key,uri:r.uri,configuration:u},i.getServiceEx(r.key,f,!0).then(function(n){n&&n.execute&&n.execute(u)})))}},e.push(r))},s=this,r=0,u=f;r<u.length;r++)h=u[r],o(h);n(e);c=i.getContributionChildren(this._targetId,"ms.vss-web.action-provider")||[];c.forEach(function(r){i.getService(r,!0).then(function(i){var f,e,u;i&&(f=t._getContext?t._getContext({key:r},!0):undefined,i.loadItems?i.loadItems(function(t,i){n(t,i)},f):i.getMenuItems&&(e=function(n){for(var u=[],f=function(i){var f=n[i],e={key:r+i.toString(),name:f.text,iconProps:f.icon,onClick:function(){if(f.action){var n=t._getContext?t._getContext({key:r},!0):undefined;f.action(n)}}};u.push(e)},i=0;i<n.length;i++)f(i);return u},u=i.getMenuItems(f||{}),u instanceof Promise?u.then(function(t){n(e(t),[])}):n(e(u),[])))})})},n}();t[n].ContributedPivotBarActionProvider=i}("ContributedPivotBarActionProvider"),function(n){function r(n,t,i){var r={id:t.id||t.itemKey||"",text:t.text||t.name||"",itemKey:t.itemKey,groupKey:t.groupKey,order:t.order,render:i,hidden:t.hidden},u;return t.routeId&&(u=n.getService("IVssLocationService"),r.url=u.routeUrl(t.routeId,t.routeValues)),t.fpsRequired&&(r.onBeforePivotChange=function(t,i,r){return r?(p.FastPageSwitch(n,r,!0),t&&t.preventDefault(),!1):!0}),r}yt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});t[n].createPivotBarItem=r;var u=function(){function n(n){this._pageContext=n.pageContext;n.tabGroupIds?this._tabGroupIds=n.tabGroupIds:n.contributions&&(this._contributions=n.contributions);this._tabType=n.tabType||"ms.vss-web.tab";this._getContext=n.getContext;this._additionalProps=n.props;this._dependencies=n.dependencies||[];this._loadingComponent=n.loadingComponent;this._getMutatedPivotBarItem=n.getMutatedPivotBarItem}return n.prototype.loadItems=function(n){for(var s,i,h=this,r=this._pageContext.getService("IVssContributionService"),l=this._getContributions(r),u=[],f=0,c=l;f<c.length;f++){var e=c[f],o=e.id,t=e.pivotContribution;t&&(this._getMutatedPivotBarItem&&(t=this._getMutatedPivotBarItem(e,t)),s=this._getRenderMethod(t,o),s?u.push(this._makeContributedPivotBarItem(t,o,s)):console.warn("Cannot render contributed pivot "+o+"."))}u.length>0&&n(u);i=[];(this._tabGroupIds||[]).forEach(function(n){i=i.concat(r.getContributionChildren(n,"ms.vss-web.tab-provider")||[])});i.forEach(function(t){r.getService(t).then(function(i){if(i){var r=h._getContext?h._getContext(t,!0):undefined;i.loadItems(function(t){n(t)},r)}})})},n.prototype._getContributions=function(n){return this._tabGroupIds?this._queryContributions(n):this._contributions?this._contributions:[]},n.prototype._queryContributions=function(n){for(var e,r,u,t=[],i=0,f=this._tabGroupIds;i<f.length;i++)e=f[i],r=n.getContributionChildren(e,this._tabType),r&&(u=r.map(function(t){return{id:t,pivotContribution:n.getContribution(t)}}).filter(function(n){return!!n.pivotContribution}),u.length>0&&t.push.apply(t,u));return t},n.prototype._makeContributedPivotBarItem=function(n,t,i){var u=r(this._pageContext,n,i);return u.id=t,u.sourceContribution=__assign({id:t},n),u},n.prototype._getRenderMethod=function(n,t){var i=this,r=n.moduleContent,u;return r?n.fpsRequired?function(n){return i._renderExternalHub(r,n)}:function(t){return i._renderByContributionId(r,t,n.dependencies)}:n.uri&&y.isFeatureEnabled(this._pageContext,"ms.vss-web.ext-nav-new-platform-feature",!1)?function(r){return i._renderExternalContent(n.id||t,r,n.dependencies,n.componentProperties)}:n.id||n.uri||n.content?function(r){return i._renderByContributionId(n.id||t,r,n.dependencies)}:n.componentType?(u=n.componentType,function(r){return i._renderComponent(n,t,u,r)}):null},n.prototype._renderComponent=function(n,t,r,u){var f=n.componentProperties?__assign({},n.componentProperties):{};return f=__assign({},f,this._additionalProps,this._getContext?__assign({},this._getContext(t)):{},{className:v.css(f.className,u)}),e.createElement(i.WrappedComponent,{dependencies:this._dependencies.concat(n.dependencies||[]),wrappedProps:f,wrappedType:r})},n.prototype._renderExternalContent=function(n,t,r,u){return e.createElement(i.WrappedComponent,{dependencies:this._dependencies.concat(r||[]).concat(["ms.vss-web.ext-content"]),wrappedType:"ExternalContent",wrappedProps:__assign({contributionId:n},u,this._additionalProps,this._getContext?__assign({},this._getContext(n)):{},{className:t})})},n.prototype._renderExternalHub=function(n,t){return e.createElement(i.WrappedComponent,{key:n,dependencies:["ms.vss-web.legacy-content","ms.vss-web.legacy-vss-ui-content"],wrappedType:"legacy",wrappedProps:{className:t,componentType:"legacyHubShimComponent",modules:["VSSPreview/Flux/Components/ExternalHubShim"],contributionId:n}})},n.prototype._renderByContributionId=function(n,t,r){var u=undefined;return this._getContext&&(u=this._getContext(n)),e.createElement(i.WrappedComponent,{key:n,dependencies:["ms.vss-web.legacy-content","ms.vss-web.legacy-vss-ui-content"],wrappedType:"legacy",wrappedProps:{componentType:"vssLegacyContributionContentHost",modules:["VSSPreview/Providers/ContentHost"],dependentContributionIds:this._dependencies.concat(r||[]),wrappedProps:{className:t,context:u,contribution:n,loadingComponent:this._loadingComponent},loadingComponent:this._loadingComponent}})},n}();t[n].ContributedPivotBarItemProvider=u}("ContributedPivotBarItemProvider"),function(n){pt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(n){this.pageContext=n.pageContext;this.tabGroupIds=n.tabGroupIds||[];this.defaultRouteId=n.defaultRouteId;this.updateUrlOnPivotChange=n.updateUrlOnPivotChange;this.additionalProps=n.props||{}}return n.prototype.getItems=function(){var n=this,r,u;if(this.tabs)return this.tabs;var t=this.pageContext.getService("IVssContributionService"),f=this.tabGroupIds,i=[];return(f||[]).forEach(function(n){i=i.concat(t.getContributionChildren(n,"ms.vss-web.tab-provider")||[])}),r=t.getContributionChildren(f[0],"ms.vss-web.tab"),u=r.map(function(n){var i=t.getContribution(n);return i.id?i:__assign({},i,{id:n})}),u.forEach(function(t,i){if(t){var u=r[i];t.render=function(){return e.createElement(et.ContributedContentComponent,{key:u,className:"flex-grow",contributionId:u,contribution:t,dependencies:t.dependencies,componentProperties:n.additionalProps})};n.addAdditionalProperties(t,u)}}),this.tabs=new w.ObservableArray(u),i.forEach(function(i){t.getService(i).then(function(t){if(t){var r=undefined;t.loadItems(function(t){var r;t.forEach(function(t){n.addAdditionalProperties(t,i)});(r=n.tabs).push.apply(r,t)},r)}})}),this.tabs},n.prototype.addAdditionalProperties=function(n,t){var r=this,i;n.routeId?(i=this.pageContext.getService("IVssLocationService"),n.url=i.routeUrl(n.routeId,n.routeValues)):this.defaultRouteId&&(i=this.pageContext.getService("IVssLocationService"),n.url=i.routeUrl(this.defaultRouteId,{contributionId:t}));n.fpsRequired?n.onBeforeTabChange=function(n,t,i){return i?(p.FastPageSwitch(r.pageContext,i,!0),n&&n.preventDefault(),!1):!0}:n.url&&this.updateUrlOnPivotChange&&(n.onBeforeTabChange=function(){var t=r.pageContext.getService("IVssHistoryService");return t.pushState(undefined,n.url),!0})},n}();t[n].ContributedTabProvider=i}("ContributedTabProvider"),function(n){ot=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var r=function(n){function t(t,i,r,u,f){var e=n.call(this)||this;return e.appendText=t,e.queryText=i,e.replaceText=r,e.setHelpVisibility=u,e.setHelpSearchProviderId=f,e}return __extends(t,n),t.prototype.textChanged=function(n){this.notify(n,"change")},t.prototype.keyDown=function(n){this.notify(n,"keyDown")},t}(w.Observable),u=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.availableProviders={},r.onBlur_Component=function(n){var t=n.relatedTarget||document.activeElement;r.setState({hasFocus:r.searchElement&&r.searchElement.contains(t)||r.helpElement&&r.helpElement.contains(t)||!!r.state.providerMenuItems,hideHelp:!(r.inputElement&&r.inputElement.contains(t)||r.helpElement&&r.helpElement.contains(t))})},r.onChange=function(){if(r.inputElement!==null){var n=r.inputElement.value.length>0;r.setState({hideHelp:!1,contentAvailable:n,hasFocus:!0,helpSearchProviderId:undefined,helpSearchProvider:undefined});r.searchInput.textChanged(r.inputElement.value)}},r.onFocus_Component=function(){r.state.hasFocus||r.setState({hasFocus:!0})},r.onFocus_Input=function(){r.state.hasFocus||(r.setState({hasFocus:!0,hideHelp:!1}),r.props.onInputFocus&&r.props.onInputFocus())},r.onProvidersDismiss=function(){r.setState({hasFocus:!!r.searchElement&&r.searchElement.contains(document.activeElement),hideHelp:!1,providerMenuItems:undefined})},r.onKeyDown_Help=function(n){n.which===27&&r.focus()},r.onKeyDown_Input=function(n){if(n.which===13)r.executeSearch(n.ctrlKey);else if(n.which===27)r.state.hideHelp||(r.setState({hideHelp:!0}),n.preventDefault());else if(n.which===40){if(r.sendKeysToHelp())r.searchInput.keyDown(n.key);else if(r.helpElement){var t=r.helpElement.querySelector("[tabIndex='-1']");t&&t.focus()}}else n.which===38&&r.sendKeysToHelp()&&(r.searchInput.keyDown(n.key),n.preventDefault())},r.sendKeysToHelp=function(){return r.props.sendKeysToHelp===!0},r.onKeyDown_Provider=function(n){(n.which===13||n.which===32||n.which===40)&&r.showProviderMenu()},r.onKeyDown_Search=function(n){(n.which===13||n.which===32)&&r.executeSearch(n.ctrlKey)},r.onProviderChanged=function(n){r.setState({customProviderSelected:!0,selectedProviderId:n})},r.onSearchClicked=function(n){r.executeSearch(n.ctrlKey)},r.onFpsCompleted=function(){r.state.customProviderSelected||r.setState(r.processProviders(r.props))},r.showProviderMenu=function(){for(var u,t=[],f=function(n){n!=r.state.selectedProviderId&&t.push({onClick:function(){r.setState({customProviderSelected:!0,selectedProviderId:n});r.focus()},key:n,name:r.availableProviders[n].providerName})},n=0,i=Object.keys(r.availableProviders);n<i.length;n++)u=i[n],f(u);r.setState({hideHelp:!0,providerMenuItems:t})},r.replaceOrAppendText=function(n,t,i){if(t===void 0&&(t=!0),i===void 0&&(i=!0),r.inputElement!==null){var u=t?r.inputElement.value+(r.inputElement.value.length>0?" ":"")+n:n;r.inputElement.value=u;r.inputElement.selectionStart=r.inputElement.selectionEnd=r.inputElement.value.length;r.setState({contentAvailable:!0});i&&r.searchInput.textChanged(r.inputElement.value);r.focus()}},r.state={},r.state=r.processProviders(t),r}return __extends(t,n),t.prototype.render=function(){var n=this,u,f=this.props.placeholderText||this.state.selectedProviderId&&this.availableProviders[this.state.selectedProviderId]&&this.availableProviders[this.state.selectedProviderId].placeholder||k.SearchPlaceholder,t,r;return this.state.providerMenuItems&&(u={calloutProps:{className:"search-provider-menu search-callout"},directionalHint:6,gapSpace:this.props.dropdownGapSize,items:this.state.providerMenuItems,onDismiss:this.onProvidersDismiss,shouldFocusOnMount:!0,target:this.searchElement!==null?this.searchElement:undefined,id:"search-providers-menu"}),t=null,!this.state.hideHelp&&this.state.hasFocus&&this.state.shownProvider&&this.state.shownProvider.help&&(r=this.state.shownProvider.help(this.searchInput),r&&(t=e.createElement(i.WrappedComponent,__assign({dependencies:["ms.vss-features.ui-content"],wrappedType:"callout"},{className:"search-help-callout search-callout",beakWidth:0,directionalHintFixed:!0,gapSpace:this.props.dropdownGapSize,setInitialFocus:!1,target:this.searchElement}),e.createElement("div",{id:this.props.helpId,className:this.props.helpClassName,ref:function(t){n.helpElement=t},onBlur:this.onBlur_Component,onKeyDown:this.onKeyDown_Help},r)))),this.state.selectedProviderId?e.createElement("div",{ref:function(t){n.searchElement=t},className:i.css("flex-cell","search",this.state.hasFocus?" focus":""),onBlur:this.onBlur_Component,onFocus:this.onFocus_Component,"aria-label":this.props.ariaLabel,role:"search"},e.createElement("input",{ref:function(t){n.inputElement=t},className:"search-input",onChange:this.onChange,onFocus:this.onFocus_Input,onKeyDown:this.onKeyDown_Input,placeholder:f,spellCheck:this.props.spellCheck,"aria-label":this.props.inputAriaLabel||f,type:"text"}),this.props.showSearchIcon?e.createElement("div",{className:"search-icon",onClick:this.onSearchClicked,onKeyDown:this.onKeyDown_Search,role:"button",tabIndex:this.state.contentAvailable?0:undefined,title:k.ExecuteSearch},e.createElement(b.VssIcon,{iconType:0,iconName:"search"})):null,this.props.showSearchProviders&&Object.keys(this.availableProviders).length>1?e.createElement("div",{className:"search-icon",onClick:this.showProviderMenu,onKeyDown:this.onKeyDown_Provider,role:"button",tabIndex:0,title:k.SearchChangeType},e.createElement("span",{className:"ms-Icon ms-Icon--ChevronDown ms-SearchBox-icon","aria-owns":"search-providers-menu"})):null,t,this.state.providerMenuItems?e.createElement(i.WrappedComponent,{dependencies:["ms.vss-features.ui-content"],wrappedType:"contextualMenu",wrappedProps:u}):null):null},t.prototype.componentDidMount=function(){var t=this,i;n.prototype.componentDidMount.call(this);this.addEventListener(document.body,"fpsCompleted",this.onFpsCompleted);i=this.context.pageContext.getService("IVssSearchService");i.subscribe(this.onProviderChanged,"providerSelected");this.props.initialQueryText&&this.setQueryText(this.props.initialQueryText);this.searchInput=new r(function(n,i){t.replaceOrAppendText(n,!0,i)},function(){return t.inputElement!==null?t.inputElement.value:""},function(n,i){t.replaceOrAppendText(n,!1,i)},function(n){t.setState({hideHelp:n})},function(n){if(n){var i=t.context.pageContext.getService("IVssContributionService");i.getService(n).then(function(i){i&&t.setState({helpSearchProviderId:n,helpSearchProvider:i})})}});this.props.componentRef&&this.props.componentRef(this)},t.prototype.componentWillUnmount=function(){var t=this.context.pageContext.getService("IVssSearchService");t.unsubscribe(this.onProviderChanged,"providerSelected");n.prototype.componentWillUnmount.call(this)},t.prototype.componentWillReceiveProps=function(n){n.selectedProviderId&&n.selectedProviderId!==this.state.selectedProviderId&&this.setState(this.processProviders(n))},t.prototype.hasFocus=function(){return this.state.hasFocus},t.prototype.focus=function(){this.inputElement&&this.inputElement.focus()},t.prototype.blur=function(){this.inputElement&&this.inputElement.blur()},t.prototype.setQueryText=function(n){this.inputElement&&this.inputElement.value!==n&&(this.inputElement.value=n)},t.prototype.getQueryText=function(){return this.inputElement?this.inputElement.value:""},t.prototype.setState=function(t){var i=this;n.prototype.setState.call(this,t,function(){if(i.state.selectedProviderId&&i.state.selectedProviderId!=i.state.shownProviderId){var t=i.context.pageContext.getService("IVssContributionService"),n=i.state.selectedProviderId;t.getService(n).then(function(t){t&&i.setState({shownProvider:t,shownProviderId:n})})}})},t.prototype.executeSearch=function(n){var f=this,e,t;if(this.inputElement!==null){var r=this.inputElement.value,u=this.state.shownProviderId,i=this.state.shownProvider;this.state.helpSearchProvider&&this.state.helpSearchProviderId&&(i=this.state.helpSearchProvider,u=this.state.helpSearchProviderId);r.length>0&&r.trim()!==""&&u&&i&&(e=r,t={queryText:e,providerId:u,openInNewWindow:n},i.getQuery&&(t=i.getQuery(t)),i.performAction?i.performAction(t).then(function(n){n||f.props.executeSearch(t)},function(){return f.props.executeSearch(t)}):this.props.executeSearch(t),this.setState({hideHelp:!0}))}},t.prototype.processProviders=function(n){var f=this.context.pageContext.getService("IVssSearchService"),e=f.getProviders(),r,t,i,u;this.availableProviders={};for(i in e)n.availableProviderIds&&n.availableProviderIds.indexOf(i)==-1||(this.availableProviders[i]=e[i]);return n.selectedProviderId&&this.availableProviders[n.selectedProviderId]&&(t=n.selectedProviderId,r=!0),r&&t||(u=f.getSelectedProvider(),u&&(t=u)),{customProviderSelected:r,selectedProviderId:t}},t}(i.VssComponent);t[n].SearchInputComponent=u}("SearchInputSearchInput"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}st=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(ot)}("SearchInput"),function(n){ht=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var r=function(n){function t(t,i){var r=n.call(this,t,i)||this,u;return r.onExecuteSearch=function(n){var t=r.context.pageContext.getService("IVssSearchService");t.execute(n)},u=i.pageContext.getService("IVssSearchService"),r.providersAvailable=Object.keys(u.getProviders()).length>0,r}return __extends(t,n),t.prototype.render=function(){return this.providersAvailable?e.createElement("div",{className:"flex search-header"},e.createElement(st.SearchInputComponent,{executeSearch:this.onExecuteSearch,dropdownGapSize:0,helpClassName:"header-search-help",showSearchProviders:!0,showSearchIcon:!0,spellCheck:!1})):e.createElement("div",{className:"search-placeholder"})},t.prototype.componentWillReceiveProps=function(){var n=this.context.pageContext.getService("IVssSearchService");this.providersAvailable=Object.keys(n.getProviders()).length>0},t}(i.VssComponent);t[n].SearchHeaderInput=r;i.VssComponent.register("searchInput",r)}("SearchHeaderSearchHeader"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}wt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(ht)}("SearchHeader")},["Resources","AssetResolver/AssetResolver","AssetResolver/index","AssetResolver","ContributedIconUtil","ContributedMenuItemProvider","ResponsiveLayout/ResponsiveLayout","ResponsiveLayout","CommandBar/CommandBarFlyout","CommandBar/CommandBar","CommandBar","ContributedBreadcrumbItemProvider","ContributedContentComponent","ContributedPivotBarActionProvider","ContributedPivotBarItemProvider","ContributedTabProvider","SearchInput/SearchInput","SearchInput","SearchHeader/SearchHeader","SearchHeader"]);document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.frame-content"}}));