"use strict";define("VSSUI",["require","exports","react","OfficeFabric/DetailsList","OfficeFabric/Utilities","OfficeFabric/FocusZone","OfficeFabric/Link","OfficeFabric/Icon","OfficeFabric/Selection","OfficeFabric/Spinner"],function(n,t,i,r,u,f,e,o,s,h){var l,a,v,y,p,w,c,b,k,d,g;(function(n){l=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var i;(function(n){n[n.oneLine=0]="oneLine";n[n.twoLine=1]="twoLine"})(i=t[n].VssDetailsListRowStyle||(t[n].VssDetailsListRowStyle={}))})("ComponentsVssDetailsListVssDetailsListProps"),function(n){a=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var f=function(n){function f(i){var u=n.call(this,i)||this;return u.standardPresentationStyle=127,u._onItemContextMenu=function(n,i,r){var f=r,e,o,h,s;if(f&&(e=f.target,e&&(e.nodeName==="A"||t.UtilitiesInternal.closest(e,"A")))||u.props.shouldDisplayActions&&!u.props.shouldDisplayActions(n))return!0;if(!f)return u.setState({activatedItem:n,target:undefined});o=null;f.button!==0&&f.clientX>0&&f.clientY>0||(h=f.target,s=t.UtilitiesInternal.closest(h,'[role="row"]'),o=s?s.querySelector("."+t.ComponentsContextualMenuButtonContextualMenuButton.ContextualMenuButton.ButtonContainerClassName):null);u.setState({activatedItem:n,target:o||f})},u._onDismiss=function(){u.setState({activatedItem:undefined,target:undefined})},u._onEllipsisClick=function(n){var i=Number(n.currentTarget.dataset.index),e=u.props.selectionMode===r.SelectionMode.multiple,t=u.state.selection,f,o,s;t.setChangeEvents(!1);f=n.ctrlKey||n.metaKey;e&&n.shiftKey?(o=!f,t.selectToIndex(i,o)):e?(s=!t.isIndexSelected(i),s&&!f&&t.setAllSelected(!1),t.setIndexSelected(i,!0,!0)):(t.setAllSelected(!1),t.setIndexSelected(i,!0,!0));t.setChangeEvents(!0)},u.state={},u}return __extends(f,n),f.prototype.componentWillMount=function(){var n=this._buildClassNames(this.props),t=this._buildColumns(this.props),i=this._buildSelection(this.props);this.overrideSelectedIndex=!1;this.setState({classNames:n,columns:t,selection:i})},f.prototype.componentDidMount=function(){this.overrideSelectedIndex=!0},f.prototype.componentWillReceiveProps=function(n){var t={};(this.props.className!==n.className||this.props.presentationStyles!==n.presentationStyles||this.props.usePresentationStyles!==n.usePresentationStyles||this.props.rowStyle!==n.rowStyle)&&(t.classNames=this._buildClassNames(n));(this.props.columns!==n.columns||this.props.actionsColumnKey!==n.actionsColumnKey)&&(t.columns=this._buildColumns(n));this.props.selection!==n.selection&&(t.selection=this._buildSelection(n));this.setState(t)},f.prototype.render=function(){var u=this.props.checkboxVisibility,o=u===void 0?r.CheckboxVisibility.hidden:u,f=this.state,s=f.classNames,h=f.columns,n=__assign({},this.props),e=this._hasActions(this.props),t;return(n.className=s,n.checkboxVisibility=o,n.checkboxCellClassName="vss-DetailsList--cellCheck",n.columns=h,e&&(n.onItemContextMenu=this._onItemContextMenu),t=i.createElement(r.DetailsList,__assign({},n,{initialFocusedIndex:this.overrideSelectedIndex?undefined:n.initialFocusedIndex,selection:this.state.selection,componentRef:this._resolveRef("detailsList")})),e)?i.createElement("div",{className:"vss-DetailsList--contextmenu-wrapper"},t,this._getContextMenu()):t},f.prototype._createActionsColumn=function(n){var r=this,u=__assign({},n);return u.onRender=function(u,f,e){var o=null,s;return n.onRender?o=n.onRender(u,f,e):r.props.onRenderItemColumn&&(o=r.props.onRenderItemColumn(u,f,e)),s=!0,r.props.shouldDisplayActions&&(s=r.props.shouldDisplayActions(u)),s?i.createElement("div",{className:"actions-column-wrapper"},i.createElement("div",{className:"original-content"},o),i.createElement(t.ContextualMenuButton.MoreActionsButton,{allocateSpaceWhileHidden:r.props.allocateSpaceForActionsButtonWhileHidden,className:"vss-DetailsList--contextual-menu-button",getItems:r.props.getMenuItems&&function(){return r.props.getMenuItems(u)},getItemProviders:r.props.getMenuItemProviders&&function(){return r.props.getMenuItemProviders(u)},onDismiss:r._onDismiss,dataIndex:f,onClick:r._onEllipsisClick})):o},u},f.prototype._hasActions=function(n){return!!(n.actionsColumnKey&&(n.getMenuItems||n.getMenuItemProviders))},f.prototype._buildSelection=function(n){return n.selection||new r.Selection({getKey:n.getKey})},f.prototype._buildColumns=function(n){var e=n.actionsColumnKey,r=n.columns,u,i,f,t;if(this._hasActions(n)&&r){for(u=[],i=0,f=r;i<f.length;i++)t=f[i],t.key===e&&(t=this._createActionsColumn(t)),u.push(t);return u}return r},f.prototype._buildClassNames=function(n){var e=n.usePresentationStyles,r=n.className,o=n.rowStyle,s=n.hideGroupExpansion,t=n.presentationStyles,f="",i;return e||t?(t===undefined&&(t=this.standardPresentationStyle),i=["vss-DetailsList--layout"],r&&i.push(r),t&1&&i.push("hideActionsButton"),t&2&&i.push("singleLine"),t&4&&i.push("flexCellLayout"),t&8&&i.push("paddingInCells"),t&16&&i.push("colors"),t&32&&i.push("linkStyles"),t&64&&i.push("headerRowStyles"),f=i.join(" ")):f=u.css("vss-DetailsList",r,{"vss-DetailsList--twoLine":o===1}),u.css(f,{noGroupExpand:s})},f.prototype._getContextMenu=function(){var r=this.state,n=r.activatedItem,h=r.target;if(!n)return undefined;var u=this.props,f=u.getMenuItems,e=u.getMenuItemProviders,o=f?f(n):undefined,s=e?e(n):undefined;return!o&&!s?undefined:i.createElement(t.VssContextualMenu.VssContextualMenu,{items:o,providers:s,onDismiss:this._onDismiss,shouldFocusOnMount:!0,target:h,gapSpace:0})},f}(u.BaseComponent);t[n].VssDetailsList=f}("ComponentsVssDetailsListVssDetailsList"),function(n){v=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var r=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.render=function(){var n=this.props,r=n.text,e=n.textCssClassName,t=n.onRenderContent;return i.createElement("div",{className:"vss-DetailsList--groupHeader","data-is-focusable":"true"},i.createElement(f.FocusZone,{direction:f.FocusZoneDirection.horizontal},t?t():i.createElement("div",{className:u.css("vss-DetailsList--groupHeaderText",e)},r)))},t}(u.BaseComponent);t[n].VssDetailsListGroupHeader=r}("ComponentsVssDetailsListVssDetailsListGroupHeader"),function(n){y=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var r=function(n){function r(){return n!==null&&n.apply(this,arguments)||this}return __extends(r,n),r.prototype.render=function(){var n=this.props,r=n.secondaryText,f=n.onRenderSecondaryText,t=n.ariaLabel,e=n.iconProps;return r||f?i.createElement("div",{className:u.css("vss-DetailsList--titleCellTwoLine",!e&&"noIcon"),"aria-label":t},this._renderIcon(),i.createElement("div",{className:"vss-DetailsList--titleCellTwoLineText"},this._renderPrimaryText(),this._renderSecondaryText()),this._renderIndicators()):i.createElement("div",{className:"vss-DetailsList--titleCellOneLine","aria-label":t},this._renderIcon(),this._renderPrimaryText(),this._renderIndicators())},r.prototype._renderPrimaryText=function(){var n=this.props,r=n.primaryText,t=n.primaryAction,h=n.primaryTarget,f=n.disabled,o=n.onRenderPrimaryText,s=this.props.primaryActionRole,c=o?o():t?typeof t=="function"?i.createElement(e.Link,{className:u.css("vss-DetailsList--titleCellText",{disabled:f}),role:s||"button",href:"#",onClick:t},r):i.createElement(e.Link,{className:u.css("vss-DetailsList--titleCellText",{disabled:f}),role:s||"link",href:t,target:h},r):i.createElement("span",{className:u.css("vss-DetailsList--titleCellText",{disabled:f})},r);return i.createElement("div",{className:"vss-DetailsList--titleCellPrimary"},c)},r.prototype._renderSecondaryText=function(){var n=this.props,r=n.secondaryText,o=n.disabled,f=n.onRenderSecondaryText,e=f?f():i.createElement(t.Tooltip.TooltipHost,{content:r,overflowMode:t.Tooltip.TooltipOverflowMode.Parent},i.createElement("span",{className:u.css("vss-DetailsList--titleCellText",{disabled:o})},r));return e?i.createElement("div",{className:"vss-DetailsList--titleCellSecondary"},e):null},r.prototype._renderIcon=function(){var r=this.props,n=r.iconProps,f=r.disabled;return n?i.createElement(t.VssIcon.VssIcon,__assign({},n,{className:u.css("vss-DetailsList--titleCellIcon",n.className,{disabled:f,"vss-DetailsList--titleCellIcon--image":n.iconType===3})})):null},r.prototype._renderIndicators=function(){var n=this.props.indicators?this.props.indicators.map(function(n){return n.getItemIndicator()}):[];return n&&n.length>0?i.createElement(t.ItemIndicator.ItemIndicatorSet,{indicators:n}):null},r}(u.BaseComponent);t[n].VssDetailsListTitleCell=r}("ComponentsVssDetailsListVssDetailsListTitleCell"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}p=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(a);i(l);i(v);i(y)}("ComponentsVssDetailsListindex"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}w=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(p)}("VssDetailsList"),function(n){var f,e,l;c=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});f=function(n){function t(t){var r=n.call(this,t)||this;return r.newlySelectedItem=undefined,r.onRenderRow=function(n,t){var u=n.item;return u.isExpandable?i.createElement(l,{expanded:u.isExpanded,treeListItem:u,rowProps:n,collapse:r.onCollapse,expand:r.onExpand,onKeyDown:r.props.onRowKeyDown}):t(n)},r.onCollapse=function(n){if(n.isExpanded){r.props.onItemToggled(n);return!0}return!1},r.onExpand=function(n){if(!n.isExpanded){r.props.onItemToggled(n);return!0}return!1},r.onSelectionChanged=function(){var t=r.selection.getSelection(),f=[],n,i,e,u;if(t&&t.length>0){for(n=0,i=t;n<i.length;n++)e=i[n],u=e,f.push(u.treeItem.item),r.newlySelectedItem=u;r.itemsToSelect=undefined}if(r.props.onSelectedItemsChanged)r.props.onSelectedItemsChanged(f)},r.onItemToggled=function(n,t){if(n.isExpanded)if(t)r.props.onItemToggled(n);else if(r.canCollapse(n))r.props.onItemToggled(n);else r.newlySelectedItem=undefined;else r.props.onItemToggled(n)},r.canCollapse=function(n){return r.selection.mode===s.SelectionMode.none?!0:r.newlySelectedItem!==n},r.selection=new s.Selection({onSelectionChanged:r.onSelectionChanged,selectionMode:t.selectionMode,getKey:function(n){return n.treeItem.id}}),r}return __extends(t,n),t.prototype.setSelectedItemsById=function(n){this.selection.setAllSelected(!1);this.itemsToSelect=n;this.setSelection()},t.prototype.render=function(){var c=this,n=this.props,l=n.className,a=n.treeListItems,o=n.primaryTreeColumnKey,v=n.actionsColumnKey,y=n.onPrimaryCellClick,p=n.getMenuItemProviders,b=n.getMenuItems,k=n.allocateSpaceForActionsButtonWhileHidden,d=n.isHeaderVisible,g=n.initialFocusedIndex,nt=n.onRowDidMount,tt=n.checkboxVisibility,t=this.props.columns.slice(),f=0,r,s,h;if(o!==undefined)for(r=0;r<t.length;r++)if(t[r].key===o){f=r;break}return s=t[f].onRender,h=function(n,t,r){return i.createElement(e,{onItemToggled:c.onItemToggled,treeListItem:n,index:t,column:r,onColumnRender:s,indentPaddingInPixels:20,onClick:y})},t[f]=__assign({},t[f],{onRender:h}),i.createElement("div",{role:"treegrid"},i.createElement(w.VssDetailsList,{className:u.css("tree-list",l),isHeaderVisible:d,items:a,initialFocusedIndex:g,columns:t,actionsColumnKey:v,getMenuItems:b,allocateSpaceForActionsButtonWhileHidden:k,getMenuItemProviders:p,onRenderRow:this.onRenderRow,usePresentationStyles:!0,setKey:"0",selection:this.selection,selectionPreservedOnEmptyClick:!0,onRowDidMount:nt,checkboxVisibility:tt}))},t.prototype.componentDidUpdate=function(){this.setSelection()},t.prototype.setSelection=function(){var n,t,r,i;if(this.itemsToSelect){for(n=[],t=0,r=this.itemsToSelect;t<r.length;t++)i=r[t],this.selection.setKeySelected(i,!0,!1),this.selection.isKeySelected(i)||n.push(i);n.length===0&&(n=undefined);this.itemsToSelect=n}},t}(u.BaseComponent);t[n].TreeList=f;e=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.onExpandCollapseButtonClicked=function(n){n.stopPropagation();t.props.onItemToggled(t.props.treeListItem,!0)},t.onCellClicked=function(n){if(t.props.onClick)t.props.onClick(n,t.props.treeListItem.treeItem.item);else t.props.onItemToggled(t.props.treeListItem,!1)},t}return __extends(t,n),t.prototype.render=function(){var n=this.props.treeListItem,t=this.props.indentPaddingInPixels*n.indentLevel,r=n.isLoading&&i.createElement(h.Spinner,{size:h.SpinnerSize.xSmall,className:"tree-list-spinner"}),f=i.createElement(o.Icon,{className:u.css("tree-chevron",{invisible:!n.isExpandable}),iconName:n.isExpanded?"ChevronDownSmall":"ChevronRightSmall",onClick:this.onExpandCollapseButtonClicked});return i.createElement("div",{className:"tree-column-wrapper",onClick:this.onCellClicked,style:{paddingLeft:t+"px"}},r||f,this.props.onColumnRender(this.props.treeListItem,this.props.index,this.props.column))},t}(i.Component);l=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.onKeyDown=function(n){if(n.which===39)t.props.expand(t.props.treeListItem)&&(n.preventDefault(),n.stopPropagation());else if(n.which===37)t.rowComponent!==null&&t.detailsElement!==null&&document.activeElement!=t.detailsElement?t.rowComponent.focus():t.props.collapse(t.props.treeListItem)&&(n.preventDefault(),n.stopPropagation());else if(t.props.onKeyDown)t.props.onKeyDown(n,t.props.rowProps.item.treeItem.item)},t}return __extends(t,n),t.prototype.render=function(){var n=this;return i.createElement("div",{onKeyDown:this.onKeyDown,ref:function(t){n.rowElement=t}},i.createElement(r.DetailsRow,__assign({},this.props.rowProps,{"aria-expanded":this.props.expanded,ref:function(t){n.rowComponent=t}})))},t.prototype.componentDidMount=function(){this.detailsElement=null;this.rowElement!==null&&(this.detailsElement=this.rowElement.querySelector("[tabIndex='0']")||this.rowElement.children[0])},t}(i.Component)}("ComponentsTreeTreeList"),function(n){b=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var r=function(n){function t(t){var i=n.call(this,t)||this,r,u;return i.onItemToggled=function(n){var o,u,e,t;if(n.isExpandable)if(n.isExpanded=!n.isExpanded,o=i.props.treeItemProvider,n.isExpanded)i.buildTree(o,n.treeItem.item),i.forceUpdate();else{var s=i.state.treeListItems,f=[],r=undefined;for(u=0,e=s;u<e.length;u++)t=e[u],t===n?(r=n.indentLevel,f.push(t)):(r===undefined||r>=t.indentLevel)&&(f.push(t),r=undefined);n.isLoading=!1;i.setState({treeListItems:f})}},i.childrenMap={},r=i.props.columns.slice(),u=i.buildColumns(r),i.state={treeListItems:[],treeListItemColumns:u},i.buildTree(t.treeItemProvider,undefined),i}return __extends(t,n),t.prototype.setSelectedItemsById=function(n){this.treeList&&this.treeList.setSelectedItemsById(n)},t.prototype.componentWillReceiveProps=function(n){if(this.props.columns!==n.columns){var t=n.columns.slice(),i=this.buildColumns(t);this.setState({treeListItemColumns:i})}this.props.treeItemProvider!==n.treeItemProvider&&(this.childrenMap={},this.buildTree(n.treeItemProvider,undefined))},t.prototype.render=function(){var t=this,n=this.state,r=n.treeListItems,u=n.treeListItemColumns;return i.createElement(c.TreeList,__assign({},this.props,{componentRef:function(n){return t.treeList=n},treeListItems:r,columns:u,onItemToggled:this.onItemToggled}))},t.prototype.buildColumns=function(n){return n.map(function(n){return __assign({},n,{onRender:function(t){return n.onRender(t.treeItem)}})})},t.prototype.buildTree=function(n,t){var r=this,u=Promise.resolve(n.getChildren(t)),i=t!==undefined&&n.getTreeListItem(t);i&&(i.isLoading=!0);u.then(function(u){for(var s,e=[],h=t!==undefined?i.indentLevel+1:0,f=0,o=u;f<o.length;f++)s=o[f],e.push(r.addTreeItems(n,s,h));Promise.all(e).then(function(n){var s=[].concat.apply([],n),u=[],h,f,e,o;if(t===undefined)u=s;else for(h=r.state.treeListItems,f=0,e=h;f<e.length;f++)o=e[f],u.push(o),t===o.treeItem.item&&(u=u.concat(s));(!i||i&&i.isExpanded&&i.isLoading)&&(i&&(i.isLoading=!1),r.setState({treeListItems:u}))})})},t.prototype.addTreeItems=function(n,t,i){var e=this,u=[],r=this.getOrCreateTreeListItem(n,t,i),f;return u.push(r),r.isExpanded?(f=this.childrenMap[r.treeItem.id],f!==undefined)?(r.isLoading=!1,Promise.resolve(f)):Promise.resolve(n.getChildren(t)).then(function(t){for(var h,o=[],f=0,s=t;f<s.length;f++)h=s[f],o.push(e.addTreeItems(n,h,i+1));return Promise.all(o).then(function(n){var t=[].concat.apply(u,n);return e.childrenMap[r.treeItem.id]=t,t})}):Promise.resolve(u)},t.prototype.getOrCreateTreeListItem=function(n,t,i){var r=n.getTreeListItem(t),u;return r||(u=n.getTreeItem(t),r={treeItem:u,indentLevel:i,isExpandable:u.isExpandable,isExpanded:!!u.defaultIsExpanded,isLoading:!1},n.setTreeListItem(t,r)),r},t}(u.BaseComponent);t[n].Tree=r}("ComponentsTreeTree"),function(n){k=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(){this.treeListItemMap=new Map}return n.prototype.setTreeListItem=function(n,t){this.treeListItemMap.set(n,t)},n.prototype.getTreeListItem=function(n){return this.treeListItemMap.get(n)},n}();t[n].TreeItemProvider=i}("ComponentsTreeTreeItemProvider"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}d=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(b);i(k);i(c)}("ComponentsTreeindex"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}g=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(d)}("Tree")},["Components/VssDetailsList/VssDetailsList.Props","Components/VssDetailsList/VssDetailsList","Components/VssDetailsList/VssDetailsListGroupHeader","Components/VssDetailsList/VssDetailsListTitleCell","Components/VssDetailsList/index","VssDetailsList","Components/Tree/TreeList","Components/Tree/Tree","Components/Tree/TreeItemProvider","Components/Tree/index","Tree"]);document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-detailslist-content"}}));