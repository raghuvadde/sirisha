"use strict";define("Favorites/Common",["require","exports","VSS/Platform/Context","VSS/Platform/RestClientBase","VSS/Core/Observable","react","OfficeFabric/Utilities","VSSUI/PickList","VSSUI/ItemIndicator","VSS/Platform/FPS"],function(n,t,i,r,u,f,e,o,s,h){var c,l,a,v,y,p;(function(n){c=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});t[n].FavoriteItemPickerBrowseAllText="Browse all items";t[n].FavoriteItemPickerLoadingMessage="Loading favorites...";t[n].FavoriteStarFavoritedTitle="Remove from favorites";t[n].FavoriteStarUnfavoritedTitle="Add to favorites";t[n].FavoriteItemPickerAriaDescription="Use right arrow to toggle favorite status."})("Resources"),function(n){var i,r;l=t[n]={};Object.defineProperty(t,"__esModule",{value:!0}),function(n){n.Collection="Collection";n.Project="Project";n.Organization="Organization"}(i=t[n].FavoriteStorageScopes||(t[n].FavoriteStorageScopes={})),function(n){n.Team="Team";n.User="User"}(r=t[n].OwnerScopeTypes||(t[n].OwnerScopeTypes={}))}("Constants"),function(n){a=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var u=function(n){function t(t){return n.call(this,t)||this}return __extends(t,n),t.prototype.getFavoriteProviders=function(n){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(){return t={faultInMissingHost:n},[2,this.beginRequest({apiVersion:"4.1-preview.1",routeTemplate:"_apis/Favorite/FavoriteProviders",queryParams:t})]})})},t.prototype.createFavorite=function(n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,this.beginRequest({apiVersion:"4.1-preview.1",method:"POST",routeTemplate:"_apis/Favorite/Favorites/{favoriteId}",body:n})]})})},t.prototype.createFavoriteOfOwner=function(n,t,i){return __awaiter(this,void 0,void 0,function(){var r;return __generator(this,function(){return r={ownerScopeType:t,ownerScopeId:i},[2,this.beginRequest({apiVersion:"4.1-preview.1",method:"POST",routeTemplate:"_apis/Favorite/Favorites/{favoriteId}",queryParams:r,body:n})]})})},t.prototype.deleteFavoriteById=function(n,t,i,r){return __awaiter(this,void 0,void 0,function(){var u;return __generator(this,function(){return u={artifactType:t,artifactScopeType:i,artifactScopeId:r},[2,this.beginRequest({apiVersion:"4.1-preview.1",method:"DELETE",routeTemplate:"_apis/Favorite/Favorites/{favoriteId}",routeValues:{favoriteId:n},queryParams:u})]})})},t.prototype.deleteFavoriteOfOwnerById=function(n,t,i,r,u,f){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(){return e={ownerScopeType:t,ownerScopeId:i,artifactType:r,artifactScopeType:u,artifactScopeId:f},[2,this.beginRequest({apiVersion:"4.1-preview.1",method:"DELETE",routeTemplate:"_apis/Favorite/Favorites/{favoriteId}",routeValues:{favoriteId:n},queryParams:e})]})})},t.prototype.getFavoriteByArtifact=function(n,t,i,r,u){return __awaiter(this,void 0,void 0,function(){var f;return __generator(this,function(){return f={artifactType:n,artifactId:t,artifactScopeType:i,artifactScopeId:r,includeExtendedDetails:u},[2,this.beginRequest({apiVersion:"4.1-preview.1",routeTemplate:"_apis/Favorite/Favorites/{favoriteId}",queryParams:f})]})})},t.prototype.getFavoriteById=function(n,t,i,r,u){return __awaiter(this,void 0,void 0,function(){var f;return __generator(this,function(){return f={artifactScopeType:t,artifactType:i,artifactScopeId:r,includeExtendedDetails:u},[2,this.beginRequest({apiVersion:"4.1-preview.1",routeTemplate:"_apis/Favorite/Favorites/{favoriteId}",routeValues:{favoriteId:n},queryParams:f})]})})},t.prototype.getFavoriteOfOwnerById=function(n,t,i,r,u,f,e){return __awaiter(this,void 0,void 0,function(){var o;return __generator(this,function(){return o={ownerScopeType:t,ownerScopeId:i,artifactScopeType:r,artifactType:u,artifactScopeId:f,includeExtendedDetails:e},[2,this.beginRequest({apiVersion:"4.1-preview.1",routeTemplate:"_apis/Favorite/Favorites/{favoriteId}",routeValues:{favoriteId:n},queryParams:o})]})})},t.prototype.getFavorites=function(n,t,i,r){return __awaiter(this,void 0,void 0,function(){var u;return __generator(this,function(){return u={artifactType:n,artifactScopeType:t,artifactScopeId:i,includeExtendedDetails:r},[2,this.beginRequest({apiVersion:"4.1-preview.1",routeTemplate:"_apis/Favorite/Favorites/{favoriteId}",queryParams:u})]})})},t.prototype.getFavoritesOfOwner=function(n,t,i,r,u,f){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(){return e={ownerScopeType:n,ownerScopeId:t,artifactType:i,artifactScopeType:r,artifactScopeId:u,includeExtendedDetails:f},[2,this.beginRequest({apiVersion:"4.1-preview.1",routeTemplate:"_apis/Favorite/Favorites/{favoriteId}",queryParams:e})]})})},t}(r.RestClientBase);i.RestClients.add("IFavoriteRestClient",{factory:u})}("RestClientFavorite"),function(n){v=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var r=function(n){function t(t,i,r,u,f){var e=n.call(this,i)||this,o;return e.pageContext=t,e.artifactType=r,e.artifactScopeType=u,e.artifactScopeId=f,e.onFavoriteAdded=function(n){e.isAssociatedFavorite(n)&&e.push(n)},e.onFavoriteRemoved=function(n){e.isAssociatedFavorite(n)&&e.removeAll(function(t){return t.id===n.id})},o=e.pageContext.getService("IFavoritesService"),o.subscribe(e.onFavoriteAdded,"favoriteAdded"),o.subscribe(e.onFavoriteRemoved,"favoriteRemoved"),e}return __extends(t,n),t.prototype.isAssociatedFavorite=function(n){return(!this.artifactType||n.artifactType===this.artifactType)&&(!this.artifactScopeId||n.artifactScope.type===this.artifactScopeType&&n.artifactScope.id===this.artifactScopeId)},t.prototype.dispose=function(){var n=this.pageContext.getService("IFavoritesService");n.unsubscribe(this.onFavoriteAdded,"favoriteAdded");n.unsubscribe(this.onFavoriteRemoved,"favoriteRemoved")},t}(u.ObservableArray),f=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.favoriteCollections={},t}return __extends(t,n),t.prototype.canUseFavorites=function(){var t=this.pageContext.getService("IVssSecurityService"),n=this.pageContext.getService("IVssSecurityService");return n.hasPermission("fa557b48-b5bf-458a-bb2b-1b680426fe8b","/Favorites",3)},t.prototype.canFetchExtendedDetails=function(){return!0},t.prototype.getFavorites=function(n,t,i,u){var s=this,h,f,e,o;return this.canUseFavorites()?(f=n+":"+t+":"+i+":"+u,e=this.favoriteCollections[f],e)?e:(o=this.getProvider(n).then(function(f){var e=s.pageContext.getRestClient("IFavoriteRestClient",{serviceInstanceType:f.serviceIdentifier});return e.getFavorites(n,t,i,u).then(function(u){return new r(s.pageContext,u,n,t,i)})}),this.favoriteCollections[f]=o,o):(h=new r(this.pageContext,[],n,t,i),Promise.resolve(h))},t.prototype.getTeamFavorites=function(n,t,i,u,f){var h=this,c,e,o,s;return this.canUseFavorites()?(e=t+":"+i+":"+u+":"+f+":"+n,o=this.favoriteCollections[e],o)?o:(s=this.getProvider(t).then(function(e){var o=h.pageContext.getRestClient("IFavoriteRestClient",{serviceInstanceType:e.serviceIdentifier,rootPath:e.serviceUri});return o.getFavoritesOfOwner("Team",n,t,i,u,f).then(function(n){return new r(h.pageContext,n,t,i,u)})}),this.favoriteCollections[e]=s,s):(c=new r(this.pageContext,[],t,i,u),Promise.resolve(c))},t.prototype.getFavoritesForScope=function(n,t,i){var u=this,s,f,e,o;return this.canUseFavorites()?(f=n+":"+t+":"+i,e=this.favoriteCollections[f],e)?e:(o=this.getProviders().then(function(f){var e={},h,o,c,l,s,a;for(h in f)o=f[h],e[o.serviceUri]||(c=u.pageContext.getRestClient("IFavoriteRestClient",{serviceInstanceType:o.serviceIdentifier}),l=c.getFavorites(undefined,n,t,i),e[o.serviceUri]=l);return s=[],a=Object.keys(e).map(function(n){return e[n]}),a.forEach(function(n){s.push(n.then(function(n){return n},function(n){var t=u.pageContext.getService("IVssTelemetryService");return t.publishEvent("Favorites","FavoritesService",n),[]}))}),Promise.all(s).then(function(i){return new r(u.pageContext,[].concat.apply([],i),undefined,n,t)})}),this.favoriteCollections[f]=o,o):(s=new r(this.pageContext,[],undefined,n,t),Promise.resolve(s))},t.prototype.addFavorite=function(n){var t=this;return this.canUseFavorites()?this.getProvider(n.artifactType).then(function(i){var r=t.pageContext.getRestClient("IFavoriteRestClient",{serviceInstanceType:i.serviceIdentifier});return r.createFavorite(n).then(function(n){return t._notify(n,"favoriteAdded"),n})}):(this.logNoEditPermissionError(),Promise.resolve(n))},t.prototype.addTeamFavorite=function(n,t){var i=this;return this.canUseFavorites()?this.getProvider(t.artifactType).then(function(r){var u=i.pageContext.getRestClient("IFavoriteRestClient",{serviceInstanceType:r.serviceIdentifier});return u.createFavoriteOfOwner(t,"Team",n).then(function(n){return i._notify(n,"favoriteAdded"),n})}):(this.logNoEditPermissionError(),Promise.resolve(t))},t.prototype.removeFavorite=function(n){var t=this;return this.canUseFavorites()?this.getProvider(n.artifactType).then(function(i){var r=t.pageContext.getRestClient("IFavoriteRestClient",{serviceInstanceType:i.serviceIdentifier});return r.deleteFavoriteById(n.id,n.artifactType,n.artifactScope.type,n.artifactScope.id).then(function(){t._notify(n,"favoriteRemoved")})}):(this.logNoEditPermissionError(),Promise.resolve())},t.prototype.removeTeamFavorite=function(n,t){var i=this;return this.canUseFavorites()?this.getProvider(t.artifactType).then(function(r){var u=i.pageContext.getRestClient("IFavoriteRestClient",{serviceInstanceType:r.serviceIdentifier});return u.deleteFavoriteOfOwnerById(t.id,"Team",n,t.artifactType,t.artifactScope.type,t.artifactScope.id).then(function(){i._notify(t,"favoriteRemoved")})}):(this.logNoEditPermissionError(),Promise.resolve())},t.prototype.getProvider=function(n){var r,t,i;return this.canUseFavorites()?(r=this.pageContext.getService("IVssContributionService"),t=r.getSharedData("_favoriteProviders"),t&&(i=t[n],i))?Promise.resolve(i):this.getProviders().then(function(t){return t[n]}):(this.logNoEditPermissionError(),Promise.resolve(null))},t.prototype.getProviders=function(){if(!this.canUseFavorites())return this.logNoEditPermissionError(),Promise.resolve({});if(!this.providersPromise){var n=this.pageContext.getRestClient("IFavoriteRestClient");this.providersPromise=n.getFavoriteProviders().then(function(n){return n.reduce(function(n,t){return n[t.artifactType]=t,n},{})})}return this.providersPromise},t.prototype.logNoEditPermissionError=function(){console.error("Favorites client UI should not expose or allow write operations with Favorites, when the active user does not have neccessary permission.")},t}(i.VssObservableService);i.Services.add("IFavoritesService",{serviceFactory:f})}("FavoritesService"),function(n){function r(n){return typeof n.then=="function"}var i,u;y=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i=function(){function n(n){var t=this;this._artifactsById={};this._disposed=!1;this._favoritesByArtifactId={};this._favoriteGroupItems={};this._favoriteIndicatorItems={};this._extendedFavoritesLoaded=!1;this.getItems=function(){var a,u,s,v,i,h,y,f,c,p,w,d,l,b,n,k;if(t._artifactsPromise||(t._artifactsPromise=t._options.getArtifacts(),a=function(n){t._resolvedArtifacts=t.processResolvedArtifacts(n);t._defaultGroup.isLoading=!1;e.EventGroup.raise(t,o.PICKER_CHANGE_EVENT)},r(t._artifactsPromise)?t._artifactsPromise.then(a):a(t._artifactsPromise)),!t._options.favoritesContext)return t._resolvedArtifacts||[];if(t._loadFavoriteExtendedData(),!t._favoritesCollection)return[];if(u=t._favoritesCollection.value.filter(function(n){return!n.artifactIsDeleted}),t._favoritesByArtifactId={},t._favoriteGroupItems={},!u.length)return t._resolvedArtifacts||[];for(s=0,v=u;s<v.length;s++)n=v[s],t._favoritesByArtifactId[n.artifactId]=n,t._favoriteGroupItems[n.artifactId]=!0;if(i=[],t._resolvedArtifacts){for(h=0,y=u;h<y.length;h++)n=y[h],f=t._artifactsById[n.artifactId],!f&&t._options.getArtifactFromFavorite&&(f=t._options.getArtifactFromFavorite(n)),f&&i.push(f);for(c=0,p=t._resolvedArtifacts;c<p.length;c++)w=p[c],d=t._options.getArtifactId(w),t._favoritesByArtifactId[d]||i.push(w);t._options.artifactComparer&&(i=i.sort(t._options.artifactComparer))}else if(t._options.getArtifactFromFavorite){for(l=0,b=u;l<b.length;l++)n=b[l],k=t._options.getArtifactFromFavorite(n),k&&i.push(k);t._options.artifactComparer&&(i=i.sort(t._options.artifactComparer))}return i};this.forgetCachedArtifacts=function(){t._artifactsPromise=undefined;t._artifactsById={};t._resolvedArtifacts=undefined};this.onGroupLoadRequest=function(n){if(n==="favorites"||n==="default")return Promise.resolve([]);var i=t._options.getArtifacts(n),u=function(n){return t._resolvedArtifacts=t.processResolvedArtifacts(n),e.EventGroup.raise(t,o.PICKER_CHANGE_EVENT),t._resolvedArtifacts};return r(i)?i.then(u):Promise.resolve(u(i))};this.getListItem=function(n){var r=t._options,s=r.getArtifactName,u=r.getArtifactId,f=r.getArtifactListGroupId,e=r.getArtifactHref,o=r.getArtifactIcon,i={artifact:n,name:s(n),key:u(n)};return t._getFavoriteItem(u(n))?i.groupKey="favorites":f&&(i.groupKey=f(n)),i.groupKey||(i.groupKey="default"),o&&(i.iconProps=o(n)),e&&(i.href=e(n)),i};this.onSelectedItemChanged=function(n){t.setSelectedItem(n);var i=t._options,r=i.onArtifactClicked,u=i.getArtifactHref;if(r)return r(n);if(u)return h.onClickFPS(t._options.pageContext,u(n),!0,undefined,{telemetrySource:"FavoritePickerProvider"})};this.onHasMoreSearchResults=function(n){return n===t._lastSearchResults&&Boolean(t._lastSearchResultsContinuationToken)};this._favoritesErrorDelegate=function(n){if(t._options.onFavoriteLoadError)t._options.onFavoriteLoadError(n);return undefined};this._onFavoritesLoaded=function(n){if(t._disposed){n.dispose();return}if(t._favoritesCollection&&t._favoritesCollection!==t._options.favoritesContext.favorites&&t._favoritesCollection.dispose(),t._favoritesCollection=n,t._favoriteGroup.isLoading=!1,n.subscribe(t._onFavoriteItemChanged),t.selectedItem){var i=t._options.getArtifactId(t.selectedItem);t._updateIndicatorItem(i,!!t._getFavoriteItem(i),!1)}return e.EventGroup.raise(t,o.PICKER_CHANGE_EVENT),n};this._onFavoriteItemChanged=function(n){var r,f,u,e,i;if(n.addedItems)for(r=0,f=n.addedItems;r<f.length;r++)i=f[r],t._favoritesByArtifactId[i.artifactId]=i,t._updateIndicatorItem(i.artifactId,!0,!1);if(n.removedItems)for(u=0,e=n.removedItems;u<e.length;u++)i=e[u],delete t._favoritesByArtifactId[i.artifactId],t._updateIndicatorItem(i.artifactId,!1,!1)};n&&this.initialize(n)}return n.prototype.initialize=function(n){var t=this,i;this._options=n;this._defaultGroup={key:"default",name:n.defaultGroupHeader,isLoading:!0,loadingMessage:n.loadingText,pivotId:n.defaultGroupPivotId};n.getSearchResults&&(this.onSearch=function(i,u,f,e){var s=e&&e===t._lastSearchResults&&t._lastSearchResultsContinuationToken||undefined,o=n.getSearchResults(i,f,s),h=function(n){return t.getUniqueSearchResults(n,Boolean(s))};return r(o)?o.then(h):h(o)});i=n.favoritesContext;this._favoritesService=n.favoritesService||n.pageContext.getService("IFavoritesService");i&&this._favoritesService.canUseFavorites()&&(this.initializeFavoriteGroup(),i.favorites?this._onFavoritesLoaded(i.favorites):this._options.hideFavoriteSelectedItemIndicator||this._loadFavorites(),this._favoriteIndicator={getItemIndicator:function(i){var r=n.getArtifactId(i),u,f;return r?(u=t._getFavoriteItem(r),!u&&(!t._options.getFavoriteFromArtifact||!t._options.getFavoriteFromArtifact(i)))?null:(f=t._updateIndicatorItem(r,!!u,!0),{title:"",item:f,onClick:function(){var u=!1,n=t._getFavoriteItem(r);if(n)u=!0;else if(n=t._options.getFavoriteFromArtifact(i),!n)return;u?t._favoritesService.removeFavorite(n):t._favoritesService.addFavorite(n)}}):null}})},n.prototype.dispose=function(){this._favoritesCollection&&(this._options.favoritesContext.favorites===this._favoritesCollection&&this._favoritesCollection.dispose(),this._favoritesCollection=undefined);this._disposed=!0},n.prototype.getTitleTextForItem=function(n){return this._options.getRootItemText?this._options.getRootItemText(n):n&&this._options.getArtifactName(n)},n.prototype.processResolvedArtifacts=function(n){for(var r,t,f=this,i=0,u=n;i<u.length;i++)r=u[i],this._artifactsById[this._options.getArtifactId(r)]=r;return t=Object.keys(this._artifactsById).map(function(n){return f._artifactsById[n]}),this._options.artifactComparer&&(t=t.sort(this._options.artifactComparer)),t},Object.defineProperty(n.prototype,"selectedItem",{get:function(){return this._handledInitialSelection||(this._handledInitialSelection=!0,this._selectedItem=this._options.selectedArtifact),this._selectedItem},enumerable:!0,configurable:!0}),n.prototype.setSelectedItem=function(n){if(this._selectedItem=n,n){var t=this._options.getArtifactId(n);this._updateIndicatorItem(t,!!this._getFavoriteItem(t),!0)}},Object.defineProperty(n.prototype,"selectedItemIndicators",{get:function(){return this._favoriteIndicator&&!this._options.hideFavoriteSelectedItemIndicator?this._options.selectedItemIndicators?this._options.selectedItemIndicators.concat([this._favoriteIndicator]):[this._favoriteIndicator]:this._options.selectedItemIndicators||[]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"dropdownIndicators",{get:function(){return this._favoriteIndicator?this._options.dropdownIndicators?this._options.dropdownIndicators.concat([this._favoriteIndicator]):[this._favoriteIndicator]:this._options.dropdownIndicators||[]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"groups",{get:function(){return this._favoriteGroup&&!this._isFavoriteGroupProvided?this._options.groups?[this._favoriteGroup,this._defaultGroup].concat(this._options.groups):[this._favoriteGroup,this._defaultGroup]:this._options.groups?[this._defaultGroup].concat(this._options.groups):[this._defaultGroup]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pivots",{get:function(){return this._options.pivots||[]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"limitSearchToPivot",{get:function(){return this._options.limitSearchToPivot||!1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"onFilterItemByText",{get:function(){return this._options.onFilterItemByText},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"actions",{get:function(){var n=this._options,u=n.browseAllText,t=n.onBrowseAllClick,i=n.otherActions,r=i?i.slice():[];return t&&r.push({onClick:t,name:u||c.FavoriteItemPickerBrowseAllText,iconProps:{iconName:"Home"}}),r},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isSearchable",{get:function(){return this._options.isSearchable===undefined?!0:this._options.isSearchable},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"searchTextPlaceholder",{get:function(){return this._options.searchTextPlaceholder},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"searchResultsGroupName",{get:function(){return this._options.searchResultsGroupName},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"searchResultsLoadingText",{get:function(){return this._options.searchResultsLoadingText},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"searchNoResultsText",{get:function(){return this._options.searchNoResultsText},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"noItemsText",{get:function(){if(this._favoritesService&&!this._favoritesCollection)return f.createElement("span",{className:"vss-FavoriteItemPicker--noItemsMessage"},c.FavoriteItemPickerLoadingMessage);var n=undefined;return typeof this._options.getNoItemsMessage=="function"&&(n=this._options.getNoItemsMessage()),n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"itemAriaDescription",{get:function(){return c.FavoriteItemPickerAriaDescription},enumerable:!0,configurable:!0}),n.prototype.getUniqueSearchResults=function(n,t){for(var u,f,i=t?this._lastSearchResults:[],r=0,e=n||[];r<e.length;r++)u=e[r],f=this._options.getArtifactId(u),this._artifactsById[f]||this._favoritesByArtifactId[f]||i.push(u);return this._lastSearchResults=i,this._lastSearchResultsContinuationToken=n&&this._options.getSearchResultsContinuationToken&&this._options.getSearchResultsContinuationToken(n),i},n.prototype.initializeFavoriteGroup=function(){var n=this._options.groups,t=n&&n.filter(function(n){return n.key==="favorites"})[0];t?(this._isFavoriteGroupProvided=!0,this._favoriteGroup=t):this._favoriteGroup={key:"favorites",name:this._options.favoriteGroupHeader,isLoading:!0,loadingMessage:this._options.loadingText,pivotId:this._options.favoriteGroupPivotId}},n.prototype._getFavoriteItem=function(n){var t=this._favoritesByArtifactId[n];return!t&&this._favoritesCollection&&!this._artifactsPromise?this._favoritesCollection.value.filter(function(t){return t.artifactId===n})[0]:t},n.prototype._updateIndicatorItem=function(n,t,i){var r=this._favoriteIndicatorItems,u=this._getIndicatorState(t,!!this._favoriteGroupItems[n]);return n in r?r[n].setState(u,i):r[n]=new s.Item({initialState:u}),r[n]},n.prototype._getIndicatorState=function(n,t){return{title:"",iconProps:{iconName:n?"FavoriteStarFill":"FavoriteStar",className:"vss-FavoriteItemPicker--starIcon ms-font-l"+(t||n?"":" not-initial-favorite"),title:n?c.FavoriteStarFavoritedTitle:c.FavoriteStarUnfavoritedTitle}}},n.prototype._loadFavoriteExtendedData=function(){this._loadFavorites(!0)},n.prototype._loadFavorites=function(n){if(n===void 0&&(n=!1),this._extendedFavoritesLoaded)return Promise.resolve(undefined);var t=this._options.favoritesContext,i=this._favoritesService.getFavorites(t.artifactType,t.artifactScope.type,t.artifactScope.id,n).then(this._onFavoritesLoaded,this._favoritesErrorDelegate);return this._extendedFavoritesLoaded=n,i},n}();t[n].ArtifactPickerProviderBase=i;u=function(n){function t(t){return n.call(this,t)||this}return __extends(t,n),t}(i);t[n].ArtifactPickerProvider=u}("FavoritePickerProvider"),function(n){p=t[n]={};Object.defineProperty(t,"__esModule",{value:!0})}("ContractsService")},["Resources","Constants","RestClient/Favorite","FavoritesService","FavoritePickerProvider","Contracts/Service"]);document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-favorites.favorites-common"}}));