"use strict";define("VSS/Platform",["require","exports","VSS/Core/Observable","VSS/Core/Util/String","react","react-dom","prop-types","create-react-class","VSS/Core/Util/Theming"],function(n,t,i,r,u,f,e,o,s){var ht,a,h,ct,lt,nt,p,at,b,w,vt,tt,v,yt,it,pt,c,l,wt,bt,k,kt,rt,dt,ut,gt,ft,d,et,ni,ti,ot,ii,ri,st,y,ui,fi,ei,oi,si,g,hi,ci,li,ai,vi,yi,pi,wi,bi,ki;(function(n){function f(n,t){return n?t?n.toLocaleUpperCase():n:""}function e(n,t,i){return n===t?0:f(n,i).localeCompare(f(t,i))}function r(n,t){return e(n,t,!1)}function u(n,t){return e(n,t,!0)}function s(n,t,i){return i?u(n,t)===0:r(n,t)===0}function h(n,t,i){var f=i?u:r;return f(t,n.substr(0,t.length))===0}function c(n,t,i){var f=i?u:r;return f(t,n.substr(n.length-t.length,t.length))===0}function l(n,t){return n.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())!==-1}function a(n){for(var i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];return o(!1,n,i)}function v(n){for(var i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];return o(!0,n,i)}function o(n,t,i){for(var o,f,c,u,e="",r=0;;){if(o=t.indexOf("{",r),f=t.indexOf("}",r),o<0&&f<0){e+=t.slice(r);break}if(f>0&&(f<o||o<0)){if(t.charAt(f+1)!=="}")throw new Error("The format string contains an unmatched opening or closing brace.");e+=t.slice(r,f+1);r=f+2;continue}if(e+=t.slice(r,o),r=o+1,t.charAt(r)==="{"){e+="{";r++;continue}if(f<0)throw new Error("The format string contains an unmatched opening or closing brace.");var s=t.substring(r,f),h=s.indexOf(":"),l=parseInt(h<0?s:s.substring(0,h),10);if(isNaN(l))throw new Error("The format string is invalid.");c=h<0?"":s.substring(h+1);u=i[l];(typeof u=="undefined"||u===null)&&(u="");e+=u.toFormattedString?u.toFormattedString(c):u instanceof Date?y(u,n):u.format?u.format(c):u.toString();r=f+1}return e}function y(n,t){return t?n.toLocaleString():n.toString()}function p(n){return/^\{?([\dA-F]{8})-?([\dA-F]{4})-?([\dA-F]{4})-?([\dA-F]{4})-?([\dA-F]{12})\}?$/i.test(n)}function w(){var n=(128+Math.floor(Math.random()*64)).toString(16);return i(8)+"-"+i(4)+"-4"+i(3)+"-"+n+i(2)+"-"+i(12)}function i(n){for(var t="",i=0;i<n;i++)t+=Math.floor(Math.random()*16).toString(16);return t}ht=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});t[n].localeComparer=r;t[n].localeIgnoreCaseComparer=u;t[n].equals=s;t[n].startsWith=h;t[n].endsWith=c;t[n].caseInsensitiveContains=l;t[n].format=a;t[n].localeFormat=v;t[n].EmptyGuidString="00000000-0000-0000-0000-000000000000";t[n].isGuid=p;t[n].newGuid=w})("UtilString"),function(n){a=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});t[n].CdnFallbackErrorMessage="There was an error loading a required file. Would you like to reload the page to try to load again?";t[n].NetworkError="TF400893: Unable to contact the server. Please check your network connection and try again.";t[n].JustNow="Just now";t[n].AgoMinutes="{0}m ago";t[n].AgoHours="{0}h ago";t[n].Today="Today";t[n].Yesterday="Yesterday";t[n].DayAtTimeFormat="{0} at {1}";t[n].LessThanASecond="<1s";t[n].Seconds="{0}s";t[n].MinutesSeconds="{0}m {1}s";t[n].HoursMinutesSeconds="{0}h {1}m {2}s";t[n].DaysHoursMinutes="{0}d {1}h {2}m";t[n].Global="Global"}("Resources"),function(n){var r,u,f,e;h=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});r=function(){function n(){}return n.prototype._serviceStart=function(n){this.pageContext=n},n.prototype._serviceEnd=function(){},n.prototype._serviceRestart=function(n){this.pageContext=n},n}();t[n].VssService=r;u=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.observable=new i.Observable,t}return __extends(t,n),t.prototype.subscribe=function(n,t){this.observable.subscribe(n,t)},t.prototype.unsubscribe=function(n,t){this.observable.unsubscribe(n,t)},t.prototype._notify=function(n,t,i){this.observable.notify(n,t,i)},t}(r);t[n].VssObservableService=u;t[n].Services=new i.ObservableObject;t[n].RestClients=new i.ObservableObject;f=function(){function n(n,t){var i=this,r;this.initializatonInProgress={};this.delayedServices=[];this.serviceInstances={};this.uniqueNumber=0;this.services=n;this.restClients=t;r=function(n,t){t==="add"&&n&&n.value&&n.value.options&&(n.value.options&4)==4&&(i.contentLoaded?i.getService(n.key):i.delayedServices.push(n.key))};this.services.subscribe(r);document.addEventListener("DOMContentLoaded",function(){var n,t,r;for(i.contentLoaded=!0,n=0,t=i.delayedServices;n<t.length;n++)r=t[n],i.getService(r);document.body.addEventListener("fpsLoaded",function(){var f={},e,r,u,o,n,t;i.contextUnloadInProgress=!0;for(n in i.serviceInstances)if(t=i.services.get(n),t&&t.options&&(t.options&2)==2)f[n]=i.serviceInstances[n];else{if(e=i.serviceInstances[n],e._serviceEnd)try{e._serviceEnd(i)}catch(s){console.error(s)}delete i.serviceInstances[n]}i.contextUnloadInProgress=!1;for(n in f)r=f[n],r&&r._serviceRestart&&r._serviceRestart(i);for(u=0,o=i.services.keys();u<o.length;u++)n=o[u],t=i.services.get(n),t&&t.options&&(t.options&4)==4&&(i.serviceInstances[n]||i._loadService(n,t))})})}return n.prototype.getService=function(n,t,i){var u,r;if(this.contextUnloadInProgress)throw new Error("Services can't be requested while a shutdown is in progress");else{if(u=this.serviceInstances[n],!u){if(r=this.services.get(n),r&&(!r.options||(r.options&8)!=8))if(t&&r.options&&(r.options&1)!=1){if(!i)throw new Error("The "+n+" service is not marked as remotable.");}else u=this._loadService(n,r);if(!u&&!i)throw new Error('No service has been registered with the name "'+n+'".');}return u}},n.prototype.getRestClient=function(n,t){var i=this.restClients.get(n),r;if(!i)throw new Error('No REST client has been registered with the name "'+n+'".');return t=Object.assign({},i.options,t),r=this.getService("IRestClientOptionsProviderService"),r.populateRestClientOptions(t),new i.factory(t)},n.prototype.getUniqueNumber=function(){return++this.uniqueNumber},n.prototype._loadService=function(n,t){var i;if(this.initializatonInProgress[n])throw"Unable to initialize service due to cyclic dependency: "+n;try{this.initializatonInProgress[n]=!0;i=new t.serviceFactory;i._serviceStart&&i._serviceStart(this)}catch(r){delete this.initializatonInProgress[n];throw r;}return this.serviceInstances[n]=i,delete this.initializatonInProgress[n],i},n}();e=new f(t[n].Services,t[n].RestClients)}("Context"),function(n){function i(n){return"Bearer "+n}var u,f,e;ct=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});u=function(){function n(n,t,i,u,f){if(i===void 0&&(i=r.EmptyGuidString),f===void 0&&(f=0),this.pageContext=n,this.namedTokenId=t,this.tokenType=f,u){var e=u.indexOf(".");this.publisherName=u.substr(0,e);this.extensionName=u.substr(e+1)}else this.appId=i||r.EmptyGuidString}return n.prototype.getAuthorizationHeader=function(n){return this.getSessionToken(n).then(function(n){return i(n.token)})},n.prototype.getSessionToken=function(n){var r=this,t,i;return!n&&(this.tokenExpirationTime&&(new Date).getTime()>this.tokenExpirationTime.getTime()-6e4&&(delete this.tokenExpirationTime,delete this.tokenPromise),this.tokenPromise)?this.tokenPromise:(t={appId:this.appId,extensionName:this.extensionName,publisherName:this.publisherName,force:n,tokenType:this.tokenType,namedTokenId:this.namedTokenId},i=this.pageContext.getRestClient("IAuthenticationRestClient"),this.tokenPromise=i.createSessionToken(t).then(function(n){return r.tokenExpirationTime=n.validTo,n}),this.tokenPromise)},n}();f=function(){function n(n){this.header=i(n)}return n.prototype.getAuthorizationHeader=function(){return Promise.resolve(this.header)},n}();t[n].BearerTokenProvider=f;e=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.getDefaultTokenProvider=function(){return this._defaultProvider||(this._defaultProvider=new u(this.pageContext)),this._defaultProvider},t.prototype.getNamedTokenProvider=function(n){return this.getTokenProvider(n,undefined,0)},t.prototype.getExtensionTokenProvider=function(n,t){return this.getTokenProvider(undefined,n,t)},t.prototype.getTokenProvider=function(n,t,i){var f=n+"."+t+"."+i,r;return this._providers||(this._providers={}),r=this._providers[f],r||(r=new u(this.pageContext,n,undefined,t,i),this._providers[f]=r),r},t.prototype.getBearerTokenProvider=function(n){return{getAuthorizationHeader:function(){return Promise.resolve(i(n))}}},t}(h.VssService);h.Services.add("IAuthenticationService",{serviceFactory:e})}("Authentication"),function(n){lt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function n(){this.pendingContent={};this.loadedContent={};this.observable=new i.Observable;window.__contentLoaded=this.loadComplete.bind(this);window.__loadScript=this.loadScript.bind(this)}return n.prototype.loadScript=function(n){var r=this,t,i=this.getContentId(n),u;return this.loadedContent[i]?t=Promise.resolve(n):this.pendingContent[i]?t=this.pendingContent[i].loadPromise:(u=window.performance.now(),t=new Promise(function(t,i){var u;n.contentType==="text/javascript"?(u=document.createElement("script"),u.async=!1,u.src=n.url,n.integrity&&(u.integrity=n.integrity,u.crossOrigin="anonymous"),n.moduleNamespaces&&n.moduleNamespaces.length&&(window.__moduleNamespaces||(window.__moduleNamespaces=[]),window.__moduleNamespaces=window.__moduleNamespaces.concat(n.moduleNamespaces))):(u=document.createElement("link"),u.href=n.url,u.rel="stylesheet",u.crossOrigin="anonymous",n.integrity&&(u.integrity=n.integrity),u.setAttribute("crossorigin","anonymous"));u.setAttribute("data-contentlength",n.contentLength.toString());n.clientId&&u.setAttribute("data-clientid",n.clientId);n.contributionId&&u.setAttribute("data-sourcecontribution",n.contributionId);u.addEventListener("load",function(n){t(r.loadComplete(n.target,!0))});u.addEventListener("error",function(n){i(r.loadComplete(n.target,!1))});document.head.appendChild(u)}),this.pendingContent[i]={startTime:u,loadPromise:t}),t},n.prototype.getContentId=function(n){return n.clientId||n.url},n.prototype.loadComplete=function(n,t,i,r){var f={contentLength:parseInt(n.getAttribute("data-contentlength")),clientId:n.getAttribute("data-clientid"),contentType:n.tagName.toUpperCase()==="SCRIPT"?"text/javascript":"text/css",contributionId:n.getAttribute("data-sourcecontribution"),url:n instanceof HTMLScriptElement?n.src:n.href,integrity:n.getAttribute("integrity")},e=this.getContentId(f),o=this.pendingContent[e],u;return delete this.pendingContent[e],i=i||window.performance.now(),u={contentAttributes:f,contentElement:n,loadEnd:i},r&&(u.previousResourceLoadEnd=r),o&&(u.loadStart=o.startTime),t?(this.loadedContent[e]=u,this.observable.notify(u,"contentComplete",!0)):this.observable.notify(u,"contentLoadError",!0),f},n.prototype.subscribe=function(n){this.observable.subscribe(n)},n}(),r=new u,f=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.completedContributions={},t.scriptComplete=function(n,i){var r=n.contributionId,u=i[r];return u&&(i[r]=u-1,u===1&&(t.completedContributions[r]||(t._notify({contributionId:r},"contributionComplete",!0),t.completedContributions[r]=!0))),n},t}return __extends(t,n),t.prototype._serviceStart=function(t){var o=this,f,i,e,u;for(n.prototype._serviceStart.call(this,t),r.subscribe(function(n,t){o._notify(n,t,!0)}),f=document.querySelectorAll("[data-sourcecontribution]"),i=0;i<f.length;i++)e=f[i],u=e.getAttribute("data-sourcecontribution"),this.completedContributions[u]||(this._notify({contributionId:u},"contributionComplete",!0),this.completedContributions[u]=!0)},t.prototype.loadScript=function(n){return r.loadScript(n)},t.prototype.loadScripts=function(n){for(var u,i,f=this,e=[],t={},r=0,o=n;r<o.length;r++)u=o[r],i=u.contributionId,i&&(t[i]=t[i]?t[i]+1:1),e.push(this.loadScript(u).then(function(n){return f.scriptComplete(n,t)},function(n){return f.scriptComplete(n,t)}));return Promise.all(e)},t}(h.VssObservableService);h.Services.add("IVssContentService",{serviceFactory:f,options:6})}("Content"),function(n){function f(n){for(var i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];return u.apply(void 0,[{deepClone:!0,arrayOptions:0},n].concat(i))}function u(n,t){for(var e,o,u,s=[],f=2;f<arguments.length;f++)s[f-2]=arguments[f];var l=Array.isArray(t),h=n.arrayOptions===1,c=n.deepClone!==!1;for(e=0,o=s;e<o.length;e++)u=o[e],l&&Array.isArray(u)?(h||(t.length=0),t.push.apply(t,c?i(u):u)):r(t,u,c,h);return t}function i(n){for(var t,f=[],u=0,e=n.length;u<e;u++)t=n[u],f[u]=typeof t!="object"||t===null||t instanceof Date?t:Array.isArray(t)?i(t):r({},t,!0,!1);return f}function r(n,t,u,f){var o,e,s,h,c,l;for(o in t)e=t[o],s=n[o],typeof s!="object"||s===null||s instanceof Date?n[o]=!u||typeof e!="object"||e===null||e instanceof Date?e:Array.isArray(e)?i(e):r({},e,u,f):(h=Array.isArray(s),h&&Array.isArray(e)?f?(c=e,u&&(c=i(e)),n[o]=s.concat(e)):n[o]=u?i(e):e:typeof e!="object"||e===null||e instanceof Date?n[o]=e:(l=h?s.slice():__assign({},s),n[o]=r(l,e,u,f)));return n}nt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});t[n].deepMerge=f;t[n].deepMergeWithOptions=u}("UtilObject"),function(n){function i(n){function r(n,t,i){var u,f;if(t&&typeof n.__msjson_date__=="number"){t[i]=new Date(n.__msjson_date__);return}for(u in n)f=n[u],f!==null&&typeof f=="object"&&r(n[u],n,u)}var t=null,i;return n&&(i=n.replace(u,'$1{"__msjson_date__":$2 }'),t=JSON.parse(i),i!==n&&r(t,null,"")),t}function f(n,t,u){var f,e,o;return window.jsonIslandData&&window.jsonIslandData[n]?window.jsonIslandData[n]:(f=document.getElementById(n),e=null,f&&(o=f.textContent,o&&(e=i(o)),u&&f.parentElement&&f.parentElement.removeChild(f)),r(n,e,t),e)}function r(n,t,i){window.jsonIslandData||(window.jsonIslandData={});window.jsonIslandData[n]=t;i&&(window[n]=t)}p=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var u=new RegExp('(^|[^\\\\])\\"\\\\/Date\\((-?[0-9]+)(?:[a-zA-Z]|(?:\\+|-)[0-9]{4})?\\)\\\\/\\"',"g");t[n].deserializeVssJsonObject=i;t[n].readJsonScript=f;t[n].updateJsonScriptValue=r}("UtilSerialization"),function(n){var r,i;at=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});r=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.dataProviderExceptions={},t.clientProviders={},t.dataProviders={},t.sharedData={},t.pendingContributions={},t.loadedContentContributions={},t.onContributionLoaded=function(n){t.loadedContentContributions[n.contributionId]=!0},t}return __extends(t,n),t.prototype._serviceStart=function(t){n.prototype._serviceStart.call(this,t);this.contentService=this.pageContext.getService("IVssContentService");this.contentService.subscribe(this.onContributionLoaded,"contributionComplete");var i=p.readJsonScript("dataProviders",!0);i&&(this._applyData(i.data,i.sharedData,i.exceptions,i.clientProviders,undefined),this.dataProviderScope||(this.dataProviderScope={name:i.scopeName,value:i.scopeValue}));this.contributionPageData=this.getData("ms.vss-web.page-data")},t.prototype._serviceEnd=function(t){n.prototype._serviceEnd.call(this,t);this.contentService.unsubscribe(this.onContributionLoaded,"contributionComplete")},t.prototype.executeCommand=function(n){for(var i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];return __awaiter(this,void 0,void 0,function(){var r,t;return __generator(this,function(u){switch(u.label){case 0:return r=null,[4,this.getContributionAsync(n)];case 1:return(t=u.sent(),t)?[2,this.executeCommandEx(n,t,i)]:[2,Promise.resolve(null)]}})})},t.prototype.executeCommandEx=function(n,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return __awaiter(this,void 0,void 0,function(){var u,i,f;return __generator(this,function(e){switch(e.label){case 0:return(u=null,!t)?[3,2]:[4,this.getServiceEx(n,t)];case 1:i=e.sent();i&&(f=i[t.methodName],f&&(u=f.apply(i,t.methodArguments||r)));e.label=2;case 2:return[2,u]}})})},t.prototype.getContributionData=function(){return this.getSharedData("_contributions")},t.prototype.getContribution=function(n){var i=undefined,t=this.getContributionData();return t&&t.contributions&&(i=t.contributions[n]),i},t.prototype.getContributionAsync=function(n,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,this.getContributionsAsync([n],t).then(function(n){return n[0]})]})})},t.prototype.getContributionsAsync=function(n,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,this.getContributionsAsyncInternal(n,t)]})})},t.prototype.getContributionsAsyncInternal=function(n,t,i,r){return __awaiter(this,void 0,void 0,function(){var u,h,c,e,s,l,p,w,b,a,k,v,d,o,g,y,nt,f,tt;return __generator(this,function(it){switch(it.label){case 0:if(u=this.getContributionData(),h=u&&u.contributions||{},c=this._getParametersKey(t),!this.contributionPageData)return[3,3];for(e=[],s=[],l=0,p=n;l<p.length;l++)f=p[l],w=this.pendingContributions[f+"/"+c],w?s.push(w):!i&&(h.hasOwnProperty(f)||this.loadedContentContributions[f]||this.getData(f,t)!==undefined)||e.push(f);if(e.length>0)for(b=this.fetchContributionsAsync(e,t,r),s.push(b),a=0,k=e;a<k.length;a++)o=k[a],this.pendingContributions[o+"/"+c]=b;return s.length?[4,Promise.all(s)]:[3,2];case 1:it.sent();it.label=2;case 2:for(u=this.getContributionData(),h=u&&u.contributions||{},v=0,d=e;v<d.length;v++)o=d[v],delete this.pendingContributions[o+"/"+c],u&&!u.contributions.hasOwnProperty(o)&&(u.contributions[o]=undefined);it.label=3;case 3:for(g=[],y=0,nt=n;y<nt.length;y++)f=nt[y],tt=h[f],g.push(tt);return[2,g]}})})},t.prototype.fetchContributionsAsync=function(n,t,i){return __awaiter(this,void 0,void 0,function(){var u,f,r;return __generator(this,function(e){switch(e.label){case 0:return u=Object.assign({},t),this._notify({contributionIds:n,properties:u},"dpqStarting"),f=this.pageContext.getRestClient("IWebContributionsRestClient",{serviceInstanceType:i}),[4,f.queryContributedHierarchy({contributionIds:n,dataProviderContext:{properties:u}},this.dataProviderScope.name,this.dataProviderScope.value)];case 1:return(r=e.sent(),this._applyData(r.dataProviders,r.dataProviderSharedData,r.dataProviderExceptions,undefined,t),!r.content)?[3,3]:[4,this.contentService.loadScripts(r.content)];case 2:e.sent();e.label=3;case 3:return this._notify({dataProviders:r.dataProviders,dataProviderSharedData:r.dataProviderSharedData,dataProviderExceptions:r.dataProviderExceptions},"dpqCompleted"),[2]}})})},t.prototype.getContributionChildren=function(n,t){var e=[],r=this.getContributionData(),i,h,o,s,u,f,c;if(r&&r.relationships){i=[];r.relationships[n]&&(h=r.relationships[n],i=h.children||[]);for(o in r.relationships)s=r.relationships[o],s&&s.parents&&s.parents.indexOf(n)!==-1&&i.indexOf(o)===-1&&i.push(o);if(u=[],t){if(u=this.getContributionIdsByType(t),!u||u.length===0)return e;for(f=0;f<i.length;f++)c=u.indexOf(i[f]),c!==-1&&e.push(i[f])}else e=i}return e},t.prototype.getContributionIdsByType=function(n){var i=[],t=this.getContributionData();return t&&t.types&&t.types[n]&&(i=t.types[n]),i},t.prototype.getContributionsByType=function(n){var e=this.getContributionIdsByType(n),u={},f=this.getContributionData(),t,i,r;if(f)for(t=0,i=e;t<i.length;t++)r=i[t],u[r]=f.contributions[r];return u},t.prototype.getContributionProvider=function(n){var t,i=this.getContributionData(),r,u;return i&&i.providers&&(r=n.split("."),u=r[0]+"."+r[1],t=i.providers[u],t&&(t.id=u)),t},t.prototype.getData=function(n,t){var i=undefined,u=this._getParametersKey(t),r=this.dataProviders[n];return r&&(i=r[u]),i},t.prototype.getDataAsync=function(n,t,i,r){return __awaiter(this,void 0,void 0,function(){var u,f,e,o,s;return __generator(this,function(h){switch(h.label){case 0:if(u=i?undefined:this.getData(n,t),!!u)return[3,2];f=void 0;for(e in this.clientProviders)if(this.clientProviders[e].contributionIds.indexOf(n)!==-1){o=this.clientProviders[e];r=r||o.queryServiceInstanceType;f=o.context.properties;break}return s=__assign({},f,t),[4,this.getContributionsAsyncInternal([n],s,!0,r)];case 1:h.sent();u=this.getData(n,s);h.label=2;case 2:return[2,Promise.resolve(u)]}})})},t.prototype.getSharedData=function(n){return this.sharedData[n]},t.prototype.getService=function(n,t){var i=this;return this.getContributionAsync(n).then(function(r){return r?i.getServiceEx(n,r,t):Promise.reject(undefined)})},t.prototype.getServiceEx=function(n,t,i){var r=this,u;return u=t.dependencies&&t.dependencies.length?this.getContributionsAsync(t.dependencies):Promise.resolve(),u.then(function(){var u=r.pageContext.getService(t.serviceName,i,!0);return u?u:r.getContributionAsync("ms.vss-web.remote-service-providers").then(function(){return r.getChildServices("ms.vss-web.remote-service-providers","ms.vss-web.service").then(function(i){return i.length?i[0].service.getService(n,t):undefined})})})},t.prototype.getChildServices=function(n,t){var i=this.getChildServicesEx(n,t);return Promise.all(i.map(function(n){return n.service})).then(function(n){for(var r=[],t=0,u=i.length;t<u;t++)n[t]&&r.push({id:i[t].id,service:n[t]});return r})},t.prototype.getChildServicesEx=function(n,t){for(var r,u=[],e=this.getContributionChildren(n,t),i=0,f=e;i<f.length;i++)r=f[i],u.push({id:r,service:this.getService(r)});return u},t.prototype.getDataProviderExceptions=function(){return this.dataProviderExceptions},t.prototype._applyData=function(n,t,i,r,u){var a,o,s,h,c,l,f,e;if(n){a=this._getParametersKey(u);for(f in n)o=this.dataProviders[f],o||(this.dataProviders[f]=o={}),o[a]=n[f]}if(t)for(s in t)h=t[s],c=this.sharedData[s],c&&(h=nt.deepMergeWithOptions({deepClone:!1,arrayOptions:1},c,h)),this.sharedData[s]=h;if(r)for(l in r)this.clientProviders[l]=r[l];if(i)for(f in i)e=i[f],this.dataProviderExceptions[f]=e,console.warn("ContributionData unavailable for '"+f+"', ExceptionType: '"+e.exceptionType+"', Reason: "+e.message+", StackTrace: "+e.stackTrace)},t.prototype._getParametersKey=function(n){return n?JSON.stringify(n):"{}"},t}(h.VssObservableService);h.Services.add("IVssContributionService",{serviceFactory:r});i=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t._lastSubscriptions={},t.onContributionDataLoaded=function(){t._lastSubscriptions=t.loadContributedSubscriptions(t._lastSubscriptions)},t}return __extends(t,n),t.prototype._serviceStart=function(t){n.prototype._serviceStart.call(this,t);this._contributionService=this.pageContext.getService("IVssContributionService");this._contributionService.subscribe(this.onContributionDataLoaded,"dpqCompleted");this._lastSubscriptions=this.loadContributedSubscriptions({})},t.prototype._serviceEnd=function(t){n.prototype._serviceEnd.call(this,t);this._contributionService.unsubscribe(this.onContributionDataLoaded,"dpqCompleted")},t.prototype.fireEvent=function(n,t,i){var r={name:n,data:t};this._notify(r,n,i)},t.prototype.loadContributedSubscriptions=function(n){var i=this.pageContext.getService("IVssContributionService"),t=this._contributionService.getContributionsByType("ms.vss-web.event-subscription"),r=function(r){if(!n[r]){var f=t[r];u.subscribe(function(n){f.command?i.executeCommandEx(r,f.command,n):f.commandId&&i.executeCommand(f.commandId,n)})}},u=this;for(var f in t)r(f);return t},t}(h.VssObservableService);t[n].VssContributedEventService=i;h.Services.add("IVssContributionEventService",{serviceFactory:i})}("Contribution"),function(n){function r(n,t,i){return new Promise(function(r,u){var f=setTimeout(function(){u(i==null?"Timed out after "+t+" ms.":i)},t);n.then(function(n){r(n);clearTimeout(f)},function(n){u(n);clearTimeout(f)})})}function i(n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,new Promise(function(t){setTimeout(t,n)})]})})}function u(n,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(r){switch(r.label){case 0:return[4,Promise.all([n,i(t)])];case 1:return[2,r.sent()[0]]}})})}function f(n){var t=new Array(n.length);return new Promise(function(i){for(var u=0,f=function(r){var f=n[r];f.then(function(n){t[r]={state:"fulfilled",value:n}},function(n){t[r]={state:"rejected",reason:n}}).then(function(){++u===n.length&&i(t)})},r=0;r<n.length;++r)f(r)})}b=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});t[n].makeCancelable=function(n){var t=!1,i=new Promise(function(r,u){var f=function(){return t&&(i.catch(function(){}),u({isCanceled:!0})),t};n.then(function(n){return f()||r(n)});n.catch(function(n){return f()||u(n)})});return{promise:i,cancel:function(){t=!0}}};t[n].timeout=r;t[n].wait=i;t[n].delay=u;t[n].allSettled=f}("UtilPromise"),function(n){function e(n,t,i){return __awaiter(this,void 0,void 0,function(){var l,o,e,s,h,v,c,p,w,b,y,u,k;return __generator(this,function(d){switch(d.label){case 0:l=++f;o=undefined;d.label=1;case 1:if(d.trys.push([1,,12,13]),r.notify({requestId:l,requestUrl:n,options:t,vssRequestOptions:i},"beforeRequest"),t||(t={}),e=void 0,t.headers){if(t.headers instanceof Headers)e=t.headers;else if(e=new Headers,typeof t.headers.hasOwnProperty=="function")for(s in t.headers)t.headers.hasOwnProperty(s)&&e.append(s,t.headers[s])}else e=new Headers;t.headers=e;e.append("X-VSS-ReauthenticationAction","Suppress");i&&(h=i.sessionId,v=i.command,h&&(v?e.append("X-TFS-Session",h+","+v):e.append("X-TFS-Session",h)));t.credentials="same-origin";c=!1;d.label=2;case 2:return(i&&i.authTokenProvider)?(w=(p=e).append,b=["Authorization"],[4,i.authTokenProvider.getAuthorizationHeader(c)]):[3,4];case 3:w.apply(p,b.concat([d.sent()]));e.append("X-TFS-FedAuthRedirect","Suppress");d.label=4;case 4:return d.trys.push([4,6,,7]),[4,fetch(n,t)];case 5:return o=d.sent(),[3,7];case 6:y=d.sent();console.warn("Unhandled exception in fetch for "+n+": "+(y&&y.toString()));u=new Error(a.NetworkError);u.name="NetworkException";throw u;case 7:if(o.status===401&&!c&&i&&i.authTokenProvider)return c=!0,[3,8];d.label=8;case 8:if(0)return[3,2];d.label=9;case 9:return!o.ok?(u=new Error,u.name="TFS.WebApi.Exception",u.status=o.status,k=u,[4,o.text()]):[3,11];case 10:if(k.responseText=d.sent(),u.responseText&&u.responseText!=="")try{u.serverError=JSON.parse(u.responseText);u.serverError&&u.serverError.message&&(u.message=u.serverError.message)}catch(g){}u.message||(u.message=o.status+": "+o.statusText);throw u;case 11:return[3,13];case 12:return r.notify({requestId:l,requestUrl:n,response:o,vssRequestOptions:i},"afterRequest"),[7];case 13:return[2,o]}})})}var f,r,u;w=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});f=0;r=new i.Observable;t[n].requestListeners=r;t[n].issueRequest=e;u={};t[n].requestListeners.subscribe(function(n){if(!n.vssRequestOptions||n.vssRequestOptions.showProgressIndicator!==!1){var t="http "+n.requestId+" "+n.requestUrl;u[n.requestId]=t}},"beforeRequest");t[n].requestListeners.subscribe(function(n){n.requestId in u},"afterRequest")}("Fetch"),function(n){vt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var i=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.getData=function(){var n=this.pageContext.getService("IVssContributionService");return n.getData("ms.vss-web.page-data")},t}(h.VssService);h.Services.add("IVssPageService",{serviceFactory:i})}("Page"),function(n){function i(n,t){for(var i={},r=0,f=n;r<f.length;r++){var u=f[r],e=t(u)||"",o=i[e];o?o.push(u):i[e]=[u]}return i}function r(n,t){for(var r,e,u={},i=0,f=n;i<f.length;i++)r=f[i],e=t(r),u[e]=r;return u}function u(n,t){function r(n,t,i){var e=i-t,f;e<2||(f=t+Math.floor(e/2),r(n,t,f),r(n,f,i),u(n,t,f,i))}function u(n,r,u,f){for(var e=r,o=u,s=0;e<u&&o<f;)t(n[e],n[o])<=0?(i[s]=n[e],e++):(i[s]=n[o],o++),s++;while(e<u)i[s]=n[e],s++,e++;while(o<f)i[s]=n[o],s++,o++;for(e=0;e<f-r;e++)n[e+r]=i[e]}var i=new Array(n.length);return r(n,0,n.length),n}tt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});t[n].groupBy=i;t[n].buildMap=r;t[n].stableSort=u}("UtilArray"),function(n){function i(n,t){t===void 0&&(t=null);var i=null;try{i=localStorage.getItem(n)}catch(r){}return i===null?t:i}function u(n,t){var r=i(n);if(r)try{return JSON.parse(r)}catch(u){return t}else return t}function r(n,t){try{return t===null||t===undefined?localStorage.removeItem(n):localStorage.setItem(n,t),!0}catch(i){return!1}}function f(n,t){var i=t?JSON.stringify(t):undefined;return r(n,i)}v=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});t[n].tryGetLocalStorageValue=i;t[n].tryGetLocalStorageObject=u;t[n].trySetLocalStorageValue=r;t[n].trySetLocalStorageObject=f}("UtilStorage"),function(n){yt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var i=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.events=[],t._onWindowUnload=function(){t.unloading=!0;t.events.length&&(t._writeEventsToLocalStorage.apply(t,t.events),t.events=[])},t}return __extends(t,n),t.prototype._serviceStart=function(t){var r,i;n.prototype._serviceStart.call(this,t);this._initializeService();this.publishInterval=window.setInterval(this._sendEvents.bind(this),1e3);window.addEventListener("unload",this._onWindowUnload);i=this._readEventsFromLocalStorage();i&&(r=this.events).push.apply(r,i)},t.prototype._serviceRestart=function(t){n.prototype._serviceRestart.call(this,t);this._sendEvents();this._initializeService()},t.prototype._serviceEnd=function(t){this.publishInterval&&(window.clearInterval(this.publishInterval),this.publishInterval=0);window.removeEventListener("unload",this._onWindowUnload);n.prototype._serviceEnd.call(this,t)},t.prototype.publishEvent=function(n,t,i,r){var u=Object.assign({},i),f;this.sessionId&&(u.SessionId=this.sessionId);u.EventTimestamp=(new Date).getTime();n||(console.warn("Publishing telemetry event with unknown area. Feature: "+t+". Properties: "+JSON.stringify(u)),n="Unknown");t||(console.warn("Publishing telemetry event with unknown feature. Area: "+n+". Properties: "+JSON.stringify(u)),t="Unknown");f={area:n,feature:t,properties:u,serviceInstanceType:r};this._notify(f,"publish");this.unloading?this._writeEventsToLocalStorage(f):this.events.push(f)},t.prototype._initializeService=function(){var t=this.pageContext.getService("IVssPageService"),n=t.getData();n&&(this.sessionId=n.sessionId,this.hostId=n.hostId)},t.prototype._sendEvents=function(){var t=this,n=tt.groupBy(this.events,function(n){return n.serviceInstanceType});this.events=[];Object.keys(n).forEach(function(i){try{var r=t.pageContext.getRestClient("ICustomerIntelligenceRestClient",{showProgressIndicator:!1,serviceInstanceType:i||undefined});n[i].forEach(function(n){delete n.serviceInstanceType});r.publishEvents(n[i])}catch(u){console.error(u)}})},t.prototype._readEventsFromLocalStorage=function(){var n,t="ciEvents/"+this.hostId;return n=v.tryGetLocalStorageObject(t),n&&v.trySetLocalStorageObject(t,undefined),n},t.prototype._writeEventsToLocalStorage=function(){for(var t,i,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];t=r;i=this._readEventsFromLocalStorage();i&&(t=i.concat(t));v.trySetLocalStorageObject("ciEvents/"+this.hostId,t)},t}(h.VssObservableService);h.Services.add("IVssTelemetryService",{serviceFactory:i,options:2})}("Telemetry"),function(n){function r(n){var r,u,i,t;if(document.cookie&&document.cookie.length>0&&n)for(r=n+"=",u=document.cookie.split(";"),i=0;i<u.length;i++){for(t=u[i];t.charAt(0)==" ";)t=t.substring(1);if(t.indexOf(r)==0)return decodeURIComponent(t.substring(r.length))}return""}function i(n,t,i,r,u){i===void 0&&(i="/");var f=[n+"="+t,"path="+i];r&&f.push("expires="+r);u&&f.push("max-age="+u);window.location.protocol.indexOf("https")!==-1&&f.push("secure");document.cookie=f.join(";")}function u(n,t){t===void 0&&(t="/");i(n,"",t,"Thu, 01 Jan 1970 00:00:01 GMT")}it=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});t[n].getCookie=r;t[n].setCookie=i;t[n].deleteCookie=u}("UtilCookie"),function(n){function c(n){if(n){var t=s.exec(n);if(t)return t[1]}}function f(n,t){return n.scenarioName+"-"+(t===u.Start?"start":"end")}var e,i,u;pt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var o=Math.random()<.02,s=new RegExp("//(.*?)/");e=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.activeScenarios={},t.completedScenarios=[],t.pageNavigateScenario=!0,t.pageNavigateSplitTimings=[],t._afterRequest=function(n){if(t.performanceData.contentData.ajaxCount++,n.response&&n.response.ok){var i=n.response.headers.get("content-length");i&&(t.performanceData.contentData.ajaxSize+=parseInt(i))}},t._completedContentCache=[],t._contentComplete=function(n,i){n.contentAttributes.contentType==="text/css"?(t.performanceData.contentData.cssCount++,t.performanceData.contentData.cssSize+=n.contentAttributes.contentLength):n.contentAttributes.contentType==="text/javascript"&&(t.performanceData.contentData.scriptsCount++,t.performanceData.contentData.scriptSize+=n.contentAttributes.contentLength);i!=="contentComplete"||t.performanceData.timeToInteractive||t._completedContentCache.push(n)},t._legacyContentComplete=function(n){n&&n.detail&&n.detail.size&&(n.detail.isCss?(t.performanceData.contentData.cssCount++,t.performanceData.contentData.cssSize+=n.detail.size):(t.performanceData.contentData.scriptsCount++,t.performanceData.contentData.scriptSize+=n.detail.size))},t.fpsLoading=function(){t.pageNavigateScenario=!1;t.navigationStartTime=Date.now();window.lwpLastNavigationStartTime=t.navigationStartTime;t.pageNavigateSplitTimings=[]},t.scenarioStarted=function(n){var i=n.detail.descriptor;i&&t.startScenario(i.getName(),i.isPageInteractive(),i.getStartTime())},t.scenarioCompleted=function(n){var r=n.detail.scenarioDetail,i,u;r&&(i=r.scenario,u=r.telemetryData,i.isPageInteractive()?t.markTimeToInteractive(i.getFeatureArea(),i.getName(),i.getEndTime(),i.getData(),i.getSplitTimings(),u):t.endScenario(i.getFeatureArea(),i.getName(),!1,i.getEndTime(),i.getData(),i.getSplitTimings(),u))},t}return __extends(t,n),t.prototype._serviceStart=function(t){n.prototype._serviceStart.call(this,t);this.resetPerformanceData(!0);this.navigationStartTime=window.performance.timing.navigationStart;var i=this.pageContext.getService("IVssContentService");i.subscribe(this._contentComplete,"contentComplete");i.subscribe(this._contentComplete,"contentLoadError");w.requestListeners.subscribe(this._afterRequest,"afterRequest");document.addEventListener("scenarioStarted",this.scenarioStarted);document.addEventListener("scenarioCompleted",this.scenarioCompleted);document.addEventListener("legacyContentElementLoaded",this._legacyContentComplete);this.initializeService();document.body.addEventListener("fpsLoading",this.fpsLoading)},t.prototype._serviceRestart=function(t){n.prototype._serviceRestart.call(this,t);this.resetPerformanceData(!1);this.initializeService()},t.prototype.initializeService=function(){var u=this.pageContext.getService("IVssPageService"),t=u.getData(),i,r,n;if(t&&(this.isDebugMode=t.isDebugMode,this.sessionId=t.sessionId,this.pageId=t.sessionId,this.serviceVersion=t.serviceVersion),i=p.readJsonScript("serverStatistics",!0),this.serverStatistics=i?i.serverTimings:null,this.performanceInsights=i?i.insights:undefined,this.serverStatistics)for(r in this.serverStatistics){n=this.serverStatistics[r];switch(r){case"AAD":case"ServiceBus":this.performanceData.serverPerformanceData.totalRemote+=n.count;break;case"BlobStorage":case"TableStorage":this.performanceData.serverPerformanceData.storage+=n.count;this.performanceData.serverPerformanceData.totalRemote+=n.count;break;case"Redis":this.performanceData.serverPerformanceData.redis+=n.count;this.performanceData.serverPerformanceData.totalRemote+=n.count;break;case"SQL":this.performanceData.serverPerformanceData.sql+=n.count;this.performanceData.serverPerformanceData.totalRemote+=n.count;break;case"VssClient":this.performanceData.serverPerformanceData.rest+=n.count;this.performanceData.serverPerformanceData.totalRemote+=n.count}}},t.prototype.setNewSessionId=function(){this.sessionId=r.newGuid()},t.prototype.isFastPageSwitchScenario=function(){return!this.pageNavigateScenario},t.prototype.addSplitTiming=function(n,t){if(t){var i=this.activeScenarios[t];i&&(i.splitTimings||(i.splitTimings=[]),i.splitTimings.push({name:n,timestamp:Date.now()-i.startTime}))}else this.pageNavigateSplitTimings.push({name:n,timestamp:Date.now()-this.navigationStartTime})},t.prototype.getCompletedScenarios=function(){return this.completedScenarios},t.prototype.getServerStatistics=function(){return this.serverStatistics},t.prototype.getPerformanceInsights=function(){return this.performanceInsights},t.prototype.getEntriesByName=function(n){return i.getEntriesByName(n)},t.prototype.getTimingByName=function(n){return i.getTimingByName(n)},t.prototype.getPerformanceData=function(){return this.performanceData},t.prototype.endScenario=function(n,t,r,e,o,s,h){var c=this;return Promise.resolve().then(function(){var l=c.activeScenarios[t],w,a,y,b,v,p,k,d;return(!l||r)&&c.pageNavigateSplitTimings.length&&(s=c.pageNavigateSplitTimings.concat(s?s.slice():[])),l?(l.properties=Object.assign(l.properties,o),l.isPageInteractive=r,l.splitTimings||(l.splitTimings=[]),delete c.activeScenarios[t]):l={elaspsedTicks:-1,endTime:e||Date.now(),isPageInteractive:r,properties:Object.assign({},o),scenarioName:t,sessionId:c.pageId,splitTimings:[],startTime:c.navigationStartTime},s&&s.length&&(l.splitTimings=l.splitTimings.concat(s)),l.endTime=e||Date.now(),l.featureArea=n,l.elaspsedTicks=l.endTime-l.startTime,c.completedScenarios.push(l),r&&(c.performanceData.timeToInteractive=l.endTime-l.startTime,w=it.getCookie("TFS-BREAK-TTI"),w==="enabled",c.setNewSessionId()),a=h,a&&a.properties&&r?Object.assign(a.properties,c.performanceData.contentData):(a=c.getScenarioTelemetry(l),h&&(a.serviceInstanceType=h.serviceInstanceType,Object.assign(a.properties,h.properties))),a.properties.LWLS=!0,r&&(a.properties.isTTI=!0),y=c.pageContext.getService("IVssTelemetryService"),y.publishEvent(a.area,a.feature,a.properties,a.serviceInstanceType),r&&(b=c._shouldCollectResourceTimings(),v=c.getTimingTelemetry(b),v&&y.publishEvent(v.area,v.feature,v.properties,a.serviceInstanceType)),(e===undefined||r)&&(p=f(l,u.End),i.mark(p),k=r?"navigationStart":f(l,u.Start),i.measure(l.scenarioName,k,p)),c._notify(l,"scenarioComplete"),r&&(d=c.pageContext.getService("IVssContributionEventService"),d.fireEvent("page-interactive",l,!0)),l})},t.prototype.markTimeToInteractive=function(n,t,i,r,u,f){return this.endScenario(n,t,!0,i,r,u,f)},t.prototype.startScenario=function(n,t,r,e){var s=!1,o=this.activeScenarios[n];return r||(s=!0,r=Date.now()),o||(o=this.activeScenarios[n]={elaspsedTicks:-1,endTime:-1,featureArea:"",isPageInteractive:t,properties:Object.assign({},e),scenarioName:n,sessionId:this.sessionId,splitTimings:[],startTime:r}),s&&i.mark(f(o,u.Start)),o},t.prototype.getDefaultNavigationEvents=function(n){var f=[],h,r,e,t,u,c,o,s;try{for(h=[{name:"PLT",startEvent:"navigationStart",endEvent:"loadEventEnd",isAggregate:!0},{name:"Redirect",startEvent:"redirectStart",endEvent:"redirectEnd"},{name:"Unload",startEvent:"unloadEventStart",endEvent:"unloadEventEnd"},{name:"Fetch",startEvent:"fetchStart",endEvent:"domainLookupStart"},{name:"DNS",startEvent:"domainLookupStart",endEvent:"domainLookupEnd"},{name:"TCP",startEvent:"connectStart",endEvent:"connectEnd"},{name:"SSL",startEvent:"secureConnectionStart",endEvent:"connectEnd"},{name:"Request",startEvent:"connectEnd",endEvent:"responseStart"},{name:"Server Time",startEvent:"connectEnd",endEvent:"responseEnd",isAggregate:!0},{name:"Response",startEvent:"responseStart",endEvent:"responseEnd"},{name:"DOMInteractive",startEvent:"domInteractive",endEvent:"domComplete"},{name:"DOMProcessing",startEvent:"domLoading",endEvent:"domComplete"},{name:"onLoad",startEvent:"loadEventStart",endEvent:"loadEventEnd"},{name:"Network Time",startEvent:"domainLookupStart",endEvent:"connectEnd"},{name:"PreRequest",startEvent:"navigationStart",endEvent:"connectEnd",isAggregate:!0},{name:"RequestResponse",startEvent:"connectEnd",endEvent:"responseEnd",isAggregate:!0}],r=0,e=h;r<e.length;r++){if(t=e[r],u=i.getEntriesByName(t.name),u.length===0){if(i.getTimingByName(t.startEvent)==null&&i.getEntriesByName(t.startEvent).length===0||i.getTimingByName(t.endEvent)==null&&i.getEntriesByName(t.endEvent).length===0)continue;i.measure(t.name,t.startEvent,t.endEvent);u=i.getEntriesByName(t.name)}c=u.map(function(n){return{name:n.name,startTime:n.startTime,duration:n.duration}})[0];t.perfEntry=c;f.push(t)}}catch(l){}return n&&(o=0,n.endTime&&(o=n.startTime-n.endTime),s={name:"TTI",perfEntry:{name:"TTI",duration:o,startTime:0},startEvent:"navigationStart",endEvent:n.scenarioName,isAggregate:!0},s&&f.push(s)),f},t.prototype.getResourceTimingEntries=function(){return i.getEntriesByType("resource")||[]},t.prototype.getTimingTelemetry=function(n){var e=this._getContentTelemetryProperties(n),t,s,i,f,h;if(!e)return null;if(t={area:"Performance",feature:"ResourceTiming",properties:e},t.properties.individualTimings)for(var r=JSON.stringify(t,null,2),o=3e4;r.length>o;){var c=r.length-o,l=Math.ceil(c/450),u=Object.keys(t.properties.individualTimings);if(u.length<=10)return null;for(s=u.slice(Math.max(20,u.length-l)),i=0,f=s;i<f.length;i++)h=f[i],delete t.properties.individualTimings[h];r=JSON.stringify(t,null,2)}return t},t.prototype.getScenarioTelemetry=function(n){var r=this.navigationStartTime,t={activityId:n.sessionId,backgroundTab:document.hidden,debugMode:this.isDebugMode,elapsedTime:n.endTime-n.startTime,featureArea:n.featureArea||"",name:n.scenarioName,pageId:this.pageId,pageNavigateScenario:this.pageNavigateScenario,serviceVersion:this.serviceVersion,splitTimings:n.splitTimings,startTime:r,timeZoneOffset:(new Date).getTimezoneOffset()},i;if(t=Object.assign({},n.properties,t),n.isPageInteractive)try{i=this._getPageInteractiveTelemetryProperties(t.pageNavigateScenario);Object.assign(t,i)}catch(u){}return{area:"Performance",feature:"Scenario",elapsedTime:n.endTime-n.startTime,properties:t}},t.prototype._getPageInteractiveTelemetryProperties=function(n){var e={},r={resourceCount:this.performanceData.contentData.cssCount+this.performanceData.contentData.scriptsCount,scriptResourceCount:this.performanceData.contentData.scriptsCount,cssResourceCount:this.performanceData.contentData.cssCount,ajaxRequests:this.performanceData.contentData.ajaxCount,scriptSize:this.performanceData.contentData.scriptSize,cssSize:this.performanceData.contentData.cssSize},f,u,i,t;if(n){for(f=this.getDefaultNavigationEvents(),u=0;u<f.length;u++)i=f[u].perfEntry,i&&(e[i.name]={start:i.startTime,duration:i.duration});r.navigation=e}try{r.screen={h:window.screen.height,w:window.screen.width,winH:window.innerHeight,winW:window.innerWidth,winOH:window.outerHeight,winOW:window.outerWidth};t=window.navigator;t&&t.connection&&(r.connection={rtt:t.connection.rtt,type:t.connection.effectiveType,downlink:t.connection.downlink})}catch(o){}return r},t.prototype.resetPerformanceData=function(n){this.performanceData={timeToInteractive:0,contentData:{ajaxCount:0,ajaxSize:0,cssCount:0,cssSize:0,other:"",scriptsCount:0,scriptSize:0},serverPerformanceData:{redis:0,rest:0,sql:0,storage:0,totalRemote:0},initialPageLoad:n}},t.prototype._shouldCollectResourceTimings=function(){var i=this.pageContext.getService("IVssPageService"),n=i.getData(),r=window.location.href.indexOf("collectResourceTimings=true")>=0||document.cookie.indexOf("TFS-COLLECT-TIMING=true")>=0,u=this.performanceData.timeToInteractive>8e3,t;if(n){if(t=n.isBundlingEnabled&&!n.isDebugMode&&n.isCdnEnabled,t){if(o)return 1;if(u)return 2}if(r)return 3}return 0},t.prototype._getContentTelemetryProperties=function(n){var r={cdnResourceCount:0,diskcachedResourceCount:0,memcachedResourceCount:0,resourceCount:0,skippedResources:0,totalDuration:0,totalTransferSize:0},f={aggregate:r,reason:n},h,k,e,l,a,o,v,i,u;if(n!==0&&(f.individualTimings={}),this._completedContentCache.length===0)return null;try{for(h={},k=this.getResourceTimingEntries(),e=0,l=k;e<l.length;e++)a=l[e],h[a.name]=a;for(o=0,v=this._completedContentCache;o<v.length;o++)if(i=v[o],i.contentAttributes.clientId){var d=i.contentElement instanceof HTMLLinkElement?i.contentElement.href:i.contentElement.src,t=h[d],y=c(d),s=void 0,p=void 0,w=void 0;t&&(w=t.transferSize,p=Math.round(t.duration),s=this._extrapolateResourceLoadSource(t),y&&(r.resourceCount++,r.totalTransferSize+=w,r.cdnResourceCount+=y.indexOf("cdn")>=0?1:0,r.diskcachedResourceCount+=s===2?1:0,r.memcachedResourceCount+=s===1?1:0,r.totalDuration+=p));f.individualTimings&&(u={contentType:i.contentAttributes.contentType,contributionId:i.contentAttributes.contributionId,domain:y,loadStart:i.loadStart,loadEnd:i.loadEnd,previousResourceLoadEnd:i.previousResourceLoadEnd},t&&(Object.assign(u,{decodedBodySize:t.decodedBodySize,encodedBodySize:t.encodedBodySize,source:s,totalDuration:p,transferSize:w}),t.requestStart&&(u.requestStart=t.requestStart),t.responseStart&&(u.responseStart=t.responseStart),t.responseEnd&&(u.responseEnd=t.responseEnd)),f.individualTimings[i.contentAttributes.clientId]=u)}}catch(b){console.warn("Error while collecting telemetry data: "+b&&b.message||b.toString())}return f},t.prototype._extrapolateResourceLoadSource=function(n){var t=n.responseStart-n.requestStart,i=n.responseEnd-n.requestStart;return i<10?1:t<60?2:3},t}(h.VssObservableService);h.Services.add("IVssPerformanceService",{serviceFactory:e,options:6}),function(n){function u(n){window.performance&&window.performance.mark&&window.performance.mark(n);console&&console.timeStamp&&console.timeStamp(n)}function i(n){return e(n)||r(n).length>0}function f(n,t,r){if(window.performance&&window.performance.measure){if(!i(t)||!i(r))return;window.performance.measure(n,t,r)}}function e(n){var t=window.performance&&window.performance.timing&&window.performance.timing[n]||null;return typeof t!="undefined"&&t!==null}function t(n){return window.performance&&window.performance.getEntriesByType&&window.performance.getEntriesByType(n)||[]}function r(n){return window.performance&&window.performance.getEntriesByType&&window.performance.getEntriesByName(n)||[]}function o(){return t("measure")}function s(){return t("mark")}function h(n){return window.performance&&window.performance.timing&&window.performance.timing[n]||null}n.mark=u;n.measure=f;n.getEntriesByType=t;n.getEntriesByName=r;n.getMeasures=o;n.getMarks=s;n.getTimingByName=h}(i=t[n].Timing||(t[n].Timing={})),function(n){n[n.Start=0]="Start";n[n.End=1]="End"}(u||(u={}))}("Performance"),function(n){function p(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.filter(function(n){return n}).join(" ").trim()}var r,a,s,w,k,l,v,y;c=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});u.PropTypes=e;u.createClass=o;t[n].css=p;t[n].Components=new i.ObservableObject;r=function(i){function r(n,t){var u=i.call(this,n,t)||this;return t&&(u.context=t),u.componentId=++r.uniqueNumber,r.prototype.componentWillReceiveProps.__suppressDeprecationWarning=!0,u}return __extends(r,i),r.prototype.componentDidMount=function(){},r.prototype.componentDidUpdate=function(){this._manageObservables(this.props)},r.prototype.componentWillReceiveProps=function(){},r.prototype.componentWillUnmount=function(){var n,t,i;if(this._manageObservables(),this.events&&(this.events.removeAllListeners(),delete this.events),this.timers&&(this.timers.clearAllTimers(),delete this.timers),this.promises)for(n=0,t=this.promises;n<t.length;n++)i=t[n],i.cancel()},r.prototype.addEventListener=function(n,t,i,r){this.events||(this.events=new a);this.events.addEventListener(n,t,i,r)},r.prototype.removeEventListener=function(n,t,i,r){this.events&&this.events.removeEventListener(n,t,i,r)},r.prototype.clearInterval=function(n){this.timers&&this.timers.clearInterval(n)},r.prototype.clearTimeout=function(n){this.timers&&this.timers.clearTimeout(n)},r.prototype.setInterval=function(n,t){for(var r,u=[],i=2;i<arguments.length;i++)u[i-2]=arguments[i];return this.timers||(this.timers=new s),(r=this.timers).setInterval.apply(r,[n,t].concat(u))},r.prototype.setTimeout=function(n,t){for(var r,u=[],i=2;i<arguments.length;i++)u[i-2]=arguments[i];return this.timers||(this.timers=new s),(r=this.timers).setTimeout.apply(r,[n,t].concat(u))},r.prototype.trackPromise=function(n){var i=this,t;return this.promises||(this.promises=[]),t=b.makeCancelable(n),n.then(function(){i.promises=i.promises.filter(function(n){return n!==t})},function(){i.promises=i.promises.filter(function(n){return n!==t})}),this.promises.push(t),t},r.prototype.observe=function(n){var i,r,t;for(this.observers={},this.observables||(this.observables={}),i=0,r=n;i<r.length;i++)t=r[i],this.observers[t.propertyName]||(this.observers[t.propertyName]=[]),this.observers[t.propertyName].push(t);this._manageObservables(this.props)},r.prototype._manageObservables=function(n){var u,o,f,t,i,e,s,r;if(this.observables){for(t in this.observables){for(u=0,o=this.observables[t];u<o.length;u++)f=o[u],f.observable.unsubscribe(f.observer,f.action);delete this.observables[t]}if(n&&this.observers)for(t in this.observers)if(i=n[t],i&&i.subscribe&&i.unsubscribe)for(e=0,s=this.observers[t];e<s.length;e++)r=s[e],i.subscribe(r.observer,r.action),this.observables[t]||(this.observables[t]=[]),this.observables[t].push({observable:i,observer:r.observer,action:r.action})}},r.register=function(i,r){t[n].Components.add(i,r)},r.uniqueNumber=0,r.defaultProps={},r.contextTypes={pageContext:e.object},r}(u.Component);t[n].VssComponent=r;a=function(){function n(){this.listeners={}}return n.prototype.addEventListener=function(n,t,i,r){var u=t+(r?"-uc":""),e,o,f;for(this.listeners[u]||(this.listeners[u]=[]),e=this.listeners[u],o=!1,f=0;f<e.length;f++)if(e[f].listener===i){o=!0;break}o||this.listeners[u].push({listener:i,target:n,type:t,useCapture:r});n.addEventListener(t,i,r)},n.prototype.removeAllListeners=function(){var i,t,n;for(i in this.listeners)for(t=this.listeners[i],n=0;n<t.length;n++)t[n].target.removeEventListener(t[n].type,t[n].listener,t[n].useCapture)},n.prototype.removeEventListener=function(n,t,i,r){var e=t+(r?"-uc":""),f,u;if(n.removeEventListener(t,i,r),this.listeners[e])for(f=this.listeners[e],u=0;u<f.length;u++)if(f[u].target===n&&f[u].listener===i){f.splice(u,1);break}},n}();t[n].EventManagement=a;s=function(){function n(){this.intervals=[];this.timeouts=[]}return n.prototype.clearAllTimers=function(){for(var u,t,r,f,n=0,i=this.intervals;n<i.length;n++)u=i[n],window.clearInterval(u);for(t=0,r=this.timeouts;t<r.length;t++)f=r[t],window.clearTimeout(f);this.intervals.splice(0,this.intervals.length);this.timeouts.splice(0,this.timeouts.length)},n.prototype.clearInterval=function(n){window.clearInterval(n);this.removeInterval(n)},n.prototype.clearTimeout=function(n){window.clearTimeout(n);this.removeTimeout(n)},n.prototype.setInterval=function(n,t){for(var r,u=[],i=2;i<arguments.length;i++)u[i-2]=arguments[i];return r=window.setInterval.apply(window,[n,t].concat(u)),this.intervals.push(r),r},n.prototype.setTimeout=function(n,t){for(var i,f=this,u=[],r=2;r<arguments.length;r++)u[r-2]=arguments[r];return i=0,i=window.setTimeout.apply(window,[function(){f.removeTimeout(i);n.apply(void 0,u)},t].concat(u)),this.timeouts.push(i),i},n.prototype.removeInterval=function(n){var t=this.intervals.indexOf(n);t>=0&&this.intervals.splice(t,1)},n.prototype.removeTimeout=function(n){var t=this.timeouts.indexOf(n);t>=0&&this.timeouts.splice(t,1)},n}();t[n].TimerManagement=s;w=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.onDataProviderQueryEnd=function(n){var i,r,e,u,s,f,o,h;if(n.dataProviders&&(i=n.dataProviders["ms.vss-web.component-data"],i))for(r in i)if(e=i[r],u=t.regionMapping[r],u)for(s=function(n){u.some(function(t){return t.componentId===n.componentId})||u.push(n)},f=0,o=e;f<o.length;f++)h=o[f],s(h);else t.regionMapping[r]=e},t}return __extends(t,n),t.prototype._serviceStart=function(t){n.prototype._serviceStart.call(this,t);this.contributionService=this.pageContext.getService("IVssContributionService");this.contributionService.subscribe(this.onDataProviderQueryEnd,"dpqCompleted");this.regionMapping=this.contributionService.getData("ms.vss-web.component-data")||{}},t.prototype._serviceEnd=function(){this.contributionService.unsubscribe(this.onDataProviderQueryEnd,"dpqCompleted")},t.prototype.getComponentsForRegion=function(n){var t=this.regionMapping[n];return t&&(t=t.slice(),t.sort(function(n,t){return(n.componentProperties&&n.componentProperties.componentOrder||Number.MAX_VALUE)-(t.componentProperties&&t.componentProperties.componentOrder||Number.MAX_VALUE)})),t},t.prototype.renderCallout=function(n){var t=document.createElement("div"),i;document.body.appendChild(t);i=function(){f.unmountComponentAtNode(t);document.body.removeChild(t)};f.render(u.createElement(l,{pageContext:this.pageContext},n(i)),t)},t}(h.VssService);h.Services.add("IVssLayoutManager",{serviceFactory:w});k=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype._serviceStart=function(t){var i=this;n.prototype._serviceStart.call(this,t);document.body.addEventListener("fpsCompleted",function(n){n.detail.success&&i.renderPage()});this.pageRegions=document.querySelectorAll("[data-componentregion]");this.renderPage()},t.prototype.renderPage=function(){var i=this.pageContext.getService("IVssPerformanceService"),n,t;for(i.addSplitTiming("VssPageRenderingService.renderPage.start"),window.location.href.indexOf("fullScreen=true")!==-1?document.body.classList.add("full-screen-mode"):document.body.classList.remove("full-screen-mode"),n=0;n<this.pageRegions.length;n++)t=this.pageRegions[n].getAttribute("data-componentregion"),t&&f.render(u.createElement(l,{pageContext:this.pageContext},u.createElement(v,{componentRegion:t,className:"full-size"},null)),this.pageRegions[n]);i.addSplitTiming("VssPageRenderingService.renderPage.end")},t}(h.VssService);h.Services.add("VssPageRenderingService",{serviceFactory:k,options:6});l=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.getChildContext=function(){return{pageContext:this.props.pageContext}},t.prototype.render=function(){return this.props.children},t.childContextTypes=r.contextTypes,t}(r);t[n].ReactRootComponent=l;v=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.render=function(){var t=this,i=this.context.pageContext.getService("IVssLayoutManager"),n=i.getComponentsForRegion(this.props.componentRegion)||[];return n.length===0&&this.props.fallbackComponent?this.props.fallbackComponent():u.createElement("div",{className:p(this.props.className,"region-"+this.props.componentRegion),"data-renderedregion":this.props.componentRegion,role:this.props.role},n.map(function(n,i){return u.createElement(y,__assign({},t.props.childComponentProperties,n.componentProperties,{key:i,wrappedType:n.componentType}))}))},t}(r);t[n].RegionComponent=v;y=function(i){function r(r,u){var f=i.call(this,r,u)||this,e,o;return f._subscribed=!1,f._dependenciesResolved=!1,f.onComponentAdded=function(i){i.key===f.props.wrappedType&&(f._componentClass=t[n].Components.get(f.props.wrappedType),f._updateLoadingState(),t[n].Components.unsubscribe(f.onComponentAdded,"add"),f._subscribed=!1)},f._componentClass=t[n].Components.get(f.props.wrappedType),r.dependencies?(e=u.pageContext.getService("IVssContributionService"),o=f.trackPromise(e.getContributionsAsync(r.dependencies)).promise,o.then(function(){f._handleDependenciesResolved();f._updateLoadingState()},function(n){n&&!n.isCancelled&&console.warn(n)})):f._handleDependenciesResolved(),f.state={showLoadingComponent:!1},f}return __extends(r,i),r.prototype.render=function(){return this._componentClass&&this._dependenciesResolved?u.createElement(this._componentClass,Object.assign({ref:this.props.wrappedRef},this.props.wrappedProps||this.props),this.props.children):this.state.showLoadingComponent&&this.props.loadingComponent&&this.props.loadingComponent()||null},r.prototype.componentDidMount=function(){var n=this;i.prototype.componentDidMount.call(this);this._componentClass||this._resolveComponentClass(this.props.wrappedType);!this.props.loadingComponent||this._componentClass&&this._dependenciesResolved||(this._delayLoadingTimeout=this.setTimeout(function(){n._componentClass||n.setState({showLoadingComponent:!0})},100))},r.prototype.componentWillReceiveProps=function(n){i.prototype.componentWillReceiveProps.call(this,n);this.props.wrappedType!==n.wrappedType&&this._resolveComponentClass(n.wrappedType)},r.prototype.componentWillUnmount=function(){i.prototype.componentWillUnmount.call(this);this._subscribed&&t[n].Components.unsubscribe(this.onComponentAdded,"add")},r.prototype._handleDependenciesResolved=function(){var t=this,n=undefined;this.props.onDependenciesResolved&&(n=this.props.onDependenciesResolved());n?this.trackPromise(n).promise.then(function(){t._dependenciesResolved=!0;t._updateLoadingState()},function(){}):this._dependenciesResolved=!0},r.prototype._updateLoadingState=function(){this._componentClass&&this._dependenciesResolved&&(this._delayLoadingTimeout&&(this.clearTimeout(this._delayLoadingTimeout),this._delayLoadingTimeout=0),this.setState({showLoadingComponent:!1}))},r.prototype._resolveComponentClass=function(i){this._componentClass=t[n].Components.get(i);this._componentClass||this._subscribed||(t[n].Components.subscribe(this.onComponentAdded,"add"),this._subscribed=!0)},r}(r);t[n].WrappedComponent=y}("Layout"),function(n){function f(){for(var i,t,u,n,f=[],r=0;r<arguments.length;r++)f[r]=arguments[r];for(i=[],t=0,u=f.length-1;t<=u;t++)n=f[t],n&&(n==="/"&&(t===0||t===u)?i.push(""):(t>0&&n[0]==="/"&&(n=n.substr(1)),t<u&&n[n.length-1]==="/"&&(n=n.substr(0,n.length-1)),n&&i.push(n)));return i.length===1&&i[0]===""?"/":i.join("/")}function e(n){for(var o,s,l,r,a,c,h,u={segments:[]},f=-1,i=-1,e="",t=0,v=n.length;t<v;t++)o=n.charCodeAt(t),f>=0?o===125&&(s=n.substring(f,t),l=!1,s.charCodeAt(0)===42&&(s=s.substr(1),l=!0),u.segments.push({paramName:s,isWildCardParam:l}),f=-1):o===123&&n.charCodeAt(t+1)!==123?((e||i>=0)&&(r=e,i>=0&&(r+=n.substring(i,t)),r&&u.segments.push({text:r}),i=-1,e=""),f=t+1):((o===123&&n.charCodeAt(t+1)===123||o===125&&n.charCodeAt(t+1)===125)&&(e=e+n.substring(i>=0?i:t,t+1),i=-1,t++),i<0&&(i=t));for((i>=0||f>=0)&&(r=e+n.substring(i>=0?i:f),r&&u.segments.push({text:r})),a=!1,c=u.segments.length-1;c>=0;c--)h=u.segments[c],h.text&&h.text!=="/"?a=!0:a&&h.paramName&&(h.isRequiredParam=!0);return u}function s(n,t){var r=o(n,t),f,i;if(!r)return"";f=new u(r.url);for(i in t)r.matchedParameters[i]||f.addQueryParam(i,t[i]);return f.absoluteUri}function o(n,t){for(var o,u,r,s=Object.keys(t).length,f=0,e=n;f<e.length;f++)if(o=e[f],u=i(o,t,!1),u&&(!r||u.matchedParametersCount>r.matchedParametersCount)&&(r=u,u.matchedParametersCount===s))return r;return r}function i(n,t,i){for(var u,f,s,e,r=[],h={},c=0,o=0,l=n.segments.length;o<l;o++)if(u=n.segments[o],u.text)f=u.text,i&&o>0&&f.charAt(0)==="/"&&r.length===0&&(f=f.substr(1)),f&&r.push(f);else if(s=t[u.paramName],s)r.push(u.isWildCardParam?encodeURI(""+s):encodeURIComponent(""+s)),h[u.paramName]=!0,c++;else if(i)r.length&&(e=r[r.length-1],e[e.length-1]==="/"&&(r[r.length-1]=e.substr(0,e.length-1)));else{if(u.isRequiredParam)return undefined;break}return{url:r.join(""),matchedParameters:h,matchedParametersCount:c}}function h(n,t){var r=e(n);return i(r,t,!0).url}l=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function n(n,t){n&&this._setFromUriString(n,t)}return n.prototype._setFromUriString=function(n,t){var i=n,o=this._singleSplit(i,"#"),u,f,e,r;if(o?(i=o.part1,this.hashString=this._decodeUriComponent(o.part2)):this.hashString="",u=this._singleSplit(i,"?"),u?(i=u.part1,this.queryString=u.part2):this.queryParameters=[],this.scheme="",this.host="",this.port=0,this.path="",this.noSchemeSeparator=!1,f=this._singleSplit(i,":"),f?(this.scheme=f.part1,i=f.part2,i.substr(0,2)==="//"?(i=i.substr(2),e=this._singleSplit(i,"/"),e?(i=e.part1,this.path=e.part2):this.path="",r=this._singleSplit(i,":"),r?(this.host=r.part1,this.port=parseInt(r.part2),isNaN(this.port)&&(this.host+=":",this.path=r.part2+"/"+this.path)):this.host=i):(this.noSchemeSeparator=!0,this.path=i)):this.path=i,t&&t.absoluteUriRequired&&!this.scheme)throw new Error('The uri string "'+n+'" does not represent a valid absolute uri.');},n.prototype._singleSplit=function(n,t){var i=n.indexOf(t);return i>=0?{part1:n.substr(0,i),part2:n.substr(i+1)}:undefined},n.prototype._decodeUriComponent=function(n){return n&&(n=n.replace(/\+/g,"%20"),n=decodeURIComponent(n)),n},Object.defineProperty(n.prototype,"absoluteUri",{get:function(){var n="",t,r,i,u,e;return this.scheme&&(n=encodeURI(decodeURI(this.scheme))+":",this.noSchemeSeparator||(n+="//")),this.host&&(n+=encodeURI(decodeURI(this.host)),this.port&&(n+=":"+this.port),(!this.noSchemeSeparator||this.path)&&(n+="/")),this.path&&(t=void 0,this.noSchemeSeparator?t=encodeURI(decodeURI(this.path)):(r=this.path.split("/"),t=r.map(function(n){return encodeURIComponent(decodeURIComponent(n))}).join("/")),n=this.host?f(n,t):n+t),i=this.queryString,i&&(n+="?"+i),this.hashString&&(u=this._splitStringIntoParams(this.hashString),e=this._getParamsAsString(u),n+="#"+e),n},set:function(n){this._setFromUriString(n||"")},enumerable:!0,configurable:!0}),n.prototype.getEffectivePort=function(){return this.port?this.port:r.equals(this.scheme,"http",!0)?80:r.equals(this.scheme,"https",!0)?443:0},n.prototype._getParamsAsString=function(n){return n&&n.length?n.map(function(n){return n.value!==null?encodeURIComponent(n.name)+"="+encodeURIComponent(n.value):encodeURIComponent(n.name)}).join("&"):""},Object.defineProperty(n.prototype,"queryString",{get:function(){return this._getParamsAsString(this.queryParameters)},set:function(n){this.queryParameters=this._splitStringIntoParams(n)},enumerable:!0,configurable:!0}),n.prototype._splitStringIntoParams=function(n){var t=this,i=[];return n.split("&").forEach(function(n){if(n){var r=t._singleSplit(n,"=");r?i.push({name:t._decodeUriComponent(r.part1),value:t._decodeUriComponent(r.part2)}):i.push({name:t._decodeUriComponent(n),value:null})}}),i},n.prototype.getQueryParam=function(n){var i,t;return this.queryParameters&&(t=this.queryParameters.filter(function(t){return r.equals(t.name,n,!0)}),t.length>0&&(i=t[0].value)),i},n.prototype.addQueryParam=function(n,t,i){i&&this.removeQueryParam(n);this.queryParameters||(this.queryParameters=[]);this.queryParameters.push({name:n,value:t})},n.prototype.addQueryParams=function(n){var i=this,r=function(r){var u=n[r];u!==null&&u!==undefined&&(u instanceof Date?t.addQueryParam(r,u.toJSON()):Array.isArray(u)?u.forEach(function(n){return i.addQueryParam(r,""+n)}):t.addQueryParam(r,""+u))},t=this;for(var u in n)r(u)},n.prototype.removeQueryParam=function(n){this.queryParameters&&(this.queryParameters=this.queryParameters.filter(function(t){return!r.equals(t.name,n,!0)}))},n}();t[n].Uri=u;t[n].combineUrlPaths=f;t[n].parseRouteTemplate=e;t[n].routeUrl=s;t[n].getBestRouteMatch=o;t[n].replaceParsedRouteValues=i;t[n].replaceRouteValues=h}("UtilUrl"),function(n){function r(n){var t=n.getService("IVssNavigationService");return t.getCurrentRoute()}function u(n){var t=n.getService("IVssNavigationService");return t.getDisplayedNavigation()}function f(n,t){var i=n.getService("IVssNavigationService");return i.getNavigation(t)}function e(n){var t=n.getService("IVssNavigationService");return t.getRouteValues()}function o(n,t){var i=n.getService("IVssNavigationService");return i.isDisplayed(t)}wt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var i=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype._serviceStart=function(t){var o,i,s,f,h,r,c,u,e,a;if(n.prototype._serviceStart.call(this,t),o=t.getService("IVssContributionService"),this.navigationData=o.getData("ms.vss-web.navigation-data"),i=this.navigationData.resolvedUrl,i&&(window.location.hash&&(i+=window.location.hash),window.history.replaceState(history.state,document.title,i)),this.navigationData.navigation){if(this.navigationData.location)for(s in this.navigationData.navigation)f=this.navigationData.navigation[s],f.href=this.navigationData.location[f.id];if(this.navigationData.hierarchy){h=function(n){var i=r.navigationData.navigation[n],p=r.navigationData.hierarchy[n],u={},f=[],e,h,v,y,o,c,l,s,a,t;for(i.children=[],e=0,h=p;e<h.length;e++)v=h[e],t=r.navigationData.navigation[v],((t.flags||0)&2)!=2&&(t.order=(t.order||0)+1e5),t.flags!==undefined&&(t.flags&32)!=32?(t.parentId=i.id,i.children.push(t)):t.href&&f.push(t);for(i.children.sort(function(n,t){var i=n.order-t.order;return i===0&&(i=n.id.toUpperCase().localeCompare(t.id.toUpperCase())),i}),y=1,o=0,c=i.children;o<c.length;o++)t=c[o],l=t.navGroup||"",u[l]||(u[l]=y++);if(i.children.sort(function(n,t){var i=u[n.navGroup||""]-u[t.navGroup||""];return i===0&&(i=n.order-t.order,i===0&&(i=n.id.localeCompare(t.id))),i}),!i.href){for(s=0,a=i.children;s<a.length;s++)if(t=a[s],t.href){i.href=t.href;break}!i.href&&f.length>0&&(f.sort(function(n,t){return n.order-t.order}),i.href=f[0].href)}};r=this;for(c in this.navigationData.hierarchy)h(c);if(this.matchedRoute={routeId:this.navigationData.routeId,parsedRoutes:[],routeTemplates:this.navigationData.routeTemplates,routeValues:this.navigationData.routeValues},this.navigationData.routeTemplates)for(u=0,e=this.navigationData.routeTemplates;u<e.length;u++)a=e[u],this.matchedRoute.parsedRoutes.push(l.parseRouteTemplate(a))}}},t.prototype.getCurrentRoute=function(){return this.matchedRoute},t.prototype.getDisplayedNavigation=function(){return this.navigationData.displayed},t.prototype.getNavigation=function(n){return this.navigationData.navigation[n]},t.prototype.getRouteValues=function(){return this.navigationData.routeValues},t.prototype.isDisplayed=function(n){return this.navigationData.displayed.indexOf(n)!=-1},t.prototype.getPageTitle=function(){return this.navigationData.pageTitle},t}(h.VssService);h.Services.add("IVssNavigationService",{serviceFactory:i});t[n].getCurrentRoute=r;t[n].getDisplayedNavigation=u;t[n].getNavigation=f;t[n].getRouteValues=e;t[n].isDisplayed=o}("Navigation"),function(n){function r(n,t,i,r,u){var f=n.getService("IVssTraceService");f.traceError(t,i,r,u)}function u(n,t,i,r,u){var f=n.getService("IVssTraceService");f.traceException(t,i,r,u)}function f(n,t,i,r,u){var f=n.getService("IVssTraceService");f.traceWarning(t,i,r,u)}function e(n,t){var i=n.getService("IVssTraceService");i.trace(t)}bt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});t[n].traceError=r;t[n].traceException=u;t[n].traceWarning=f;t[n].trace=e;var i=5,o=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.events=[],t.globalErrorCount=0,t._onWindowError=function(n){if(n.filename&&t.globalErrorCount++<i){var r={filename:n.filename,lineNumber:n.lineno,columnNumber:n.colno,errorType:"UnhandledException"},u=t.pageContext.getService("IVssNavigationService"),f=u.getCurrentRoute().routeId;t.traceException("WebUnhandledExceptions",f,n.error,r)}},t._onUnhandledRejection=function(n){var r=n.reason;if(r&&!r.isCanceled&&(console.warn("Unhandled promise rejection: "+r),t.globalErrorCount++<i)){var u=t.pageContext.getService("IVssNavigationService"),f=u.getCurrentRoute().routeId;t.traceException("WebUnhandledExceptions",f,r,{errorType:"UnhandledRejection"})}},t}return __extends(t,n),t.prototype._serviceStart=function(t){n.prototype._serviceStart.call(this,t);this.publishInterval=window.setInterval(this._sendEvents.bind(this),1e3);window.addEventListener("error",this._onWindowError);window.addEventListener("unhandledrejection",this._onUnhandledRejection)},t.prototype._serviceRestart=function(t){n.prototype._serviceRestart.call(this,t);this.globalErrorCount=0;this._sendEvents()},t.prototype._serviceEnd=function(t){this.publishInterval&&(window.clearInterval(this.publishInterval),this.publishInterval=0);window.removeEventListener("error",this._onWindowError);window.removeEventListener("unhandledrejection",this._onUnhandledRejection);n.prototype._serviceEnd.call(this,t)},t.prototype._sendEvents=function(){if(this.events.length>0){var t=this.events,n=this.pageContext.getRestClient("IClientTraceRestClient",{showProgressIndicator:!1});n.publishEvents(this.events);this.events=[]}},t.prototype.traceError=function(n,t,i,r){var u={area:n,feature:t,message:i,properties:r,level:1};this.trace(u)},t.prototype.traceException=function(n,t,i,r){var u={area:n,feature:t,message:i?i.message:i||"unknown",exceptionType:"",properties:r,level:2};i&&(u.properties||(u.properties={}),u.properties.stackTrace=i.stack,u.exceptionType=i.name);this.trace(u)},t.prototype.traceWarning=function(n,t,i,r){var u={area:n,feature:t,message:i,properties:r,level:2};this.trace(u)},t.prototype.trace=function(n){this.events.push(n)},t}(h.VssService);h.Services.add("IVssTraceService",{serviceFactory:o,options:6})}("Trace"),function(n){k=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var i=function(n){function t(t){var i=n.call(this,t)||this;return i.state={},i}return __extends(t,n),t.prototype.componentDidCatch=function(n,t){var r;if(this.setState({error:n,errorInfo:t}),n){var u=this.context.pageContext.getService("IVssNavigationService"),f=u.getCurrentRoute().routeId,i={};t&&t.componentStack&&(i.componentStack=t.componentStack);r=this.context.pageContext.getService("IVssTraceService");r.traceException("WebUnhandledExceptions",f,n,i)}},t.prototype.render=function(){var i=this,n,t;return this.state.error?(n=this.props.handlerComponentProps||{},t=__assign({},n,{reloadComponent:function(){i.setState({error:undefined,errorInfo:undefined})},error:this.state.error,errorInfo:this.state.errorInfo}),u.createElement(c.WrappedComponent,{wrappedType:this.props.handlerComponentType,wrappedProps:t,key:"error-boundary-ui"},[])):this.props.children},t}(c.VssComponent);t[n].ErrorBoundary=i}("ComponentsErrorBoundaryErrorBoundary"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}kt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(k)}("ComponentsErrorBoundary"),function(n){rt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});t[n].FormatComponent=function(n){var r=undefined,h=n.format,a=n.elementType,c=n.children,v=__rest(n,["format","elementType","children"]),f,l,e,i,o,t,s;if(h)for(f=h.split(/(?:\{)([0-9]+)(?:\})/),l=u.Children.toArray(c),r=[],e={},i=0;i<f.length;++i)if(o=f[i],i&1)if(t=parseInt(o,10),e[t])throw new Error("Index in the format can only be used once, recurring index is "+t);else{if(s=l[t],!s)throw new Error("No element found for the specified index "+t);r.push(s);e[t]=!0}else r.push(o);return u.createElement(a||"span",v,r||c)}}("ComponentsFormatFormat"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}dt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(rt)}("ComponentsFormat"),function(n){var i,r,f,e;ut=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.render=function(){var n=this.context.pageContext.getService("IVssLayoutManager");return u.createElement(this.props.elementType||"div",{"aria-label":this.props["aria-label"],className:c.css("flex",this.props.orientation&&this.props.orientation==="column"?"flex-column":"flex-row",this.props.className)},this.props.components.map(function(n,t){var i;return n.componentType?i=u.createElement(c.WrappedComponent,Object.assign({key:t,hasBoundary:!!n.errorBoundaryProps},n.componentProperties,{wrappedType:n.componentType})):n.componentRegion&&(i=u.createElement(c.RegionComponent,Object.assign({key:t,hasBoundary:!!n.errorBoundaryProps},n.componentProperties,{componentRegion:n.componentRegion}))),n.errorBoundaryProps?u.createElement(k.ErrorBoundary,Object.assign({key:t},n.errorBoundaryProps),i):i}))},t.componentType="layout",t}(c.VssComponent);t[n].LayoutComponent=i;c.VssComponent.register(i.componentType,i);r=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.render=function(){return u.createElement("div",{className:c.css("flex-grow",this.props.className)})},t.componentType="layoutFiller",t}(c.VssComponent);t[n].LayoutFillerComponent=r;c.VssComponent.register(r.componentType,r);f=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.render=function(){return u.createElement(this.props.elementType||"div",{className:this.props.className},this.props.text)},t.componentType="htmlElement",t}(c.VssComponent);t[n].HtmlElementComponent=f;c.VssComponent.register(f.componentType,f);e=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.render=function(){return null},t.componentType="NoOp",t}(u.Component);t[n].NoOpComponent=e;c.VssComponent.register(e.componentType,e)}("ComponentsLayoutLayout"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}gt=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(ut)}("ComponentsLayout"),function(n){var i,r;ft=t[n]={};Object.defineProperty(t,"__esModule",{value:!0}),function(n){n.statePopped="statePopped"}(i=t[n].HistoryServiceEventNames||(t[n].HistoryServiceEventNames={}));r=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.onbeginDataProviderQuery=function(n){n.properties.sourcePage={url:window.location.href,routeId:t._currentRoute.routeId,routeValues:t.getCurrentRouteValues()}},t._onPopState=function(n){var r=n.state,u,f,e;r&&r.vssNavigationState&&(u=r.vssNavigationState);f=t._currentState;t._currentState=u;e={oldState:f,newState:u};t._notify(e,i.statePopped)},t}return __extends(t,n),t.prototype._serviceStart=function(t){n.prototype._serviceStart.call(this,t);this._initialize();window.addEventListener("popstate",this._onPopState);this.replaceState(undefined,undefined)},t.prototype._serviceRestart=function(t){n.prototype._serviceRestart.call(this,t);this._initialize()},t.prototype._initialize=function(){var i=this,r=this.pageContext.getService("IVssPageService"),t,n;this._pageData=r.getData();t=this.pageContext.getService("IVssNavigationService");this._currentRoute=t.getCurrentRoute();this._unsubscribeOnRestart&&this._unsubscribeOnRestart();n=this.pageContext.getService("IVssContributionService");n.subscribe(this.onbeginDataProviderQuery,"dpqStarting");this._unsubscribeOnRestart=function(){n.unsubscribe(i.onbeginDataProviderQuery,"dpqStarting")}},t.prototype.replaceState=function(n,t,i,r){this._setState(!0,n,t,i,r)},t.prototype.pushState=function(n,t,i,r){this._setState(!1,n,t,i,r)},t.prototype.getState=function(){return this._currentState&&this._currentState.state?__assign({},this._currentState.state):this._getStateFromUrl(window.location.href)},t.prototype._setState=function(n,t,i,r,u){var f,e,o,s;i&&!t?t=this._getStateFromUrl(i):t&&!i?i=this.generateUrl(t,0):i||t||(i=window.location.href,t=this._currentState&&this._currentState.state,t||(t=this._getStateFromUrl(i)));(r===null||r===undefined)&&(r=this._currentRoute.routeId);f=window.history.state;e={};n&&f&&f.vssNavigationState&&(e=f.vssNavigationState.data);u&&(e=__assign({},e,u));o={state:t,routeId:r,data:e,url:i};s=n?__assign({},f,{vssNavigationState:o}):{vssNavigationState:o};this._currentState=o;n||window.location.href===i?window.history.replaceState(s,undefined,i):window.history.pushState(s,undefined,i)},t.prototype.generateUrl=function(n,t){var s,i,r,e,o,u,f;t===void 0&&(t=2);s=this._currentRoute.routeValues;switch(t){case 2:i=__assign({},this.getState(),n);break;case 1:i=__assign({},this.getCurrentRouteValues(),n);break;default:i=n}if(r=l.getBestRouteMatch(this._currentRoute.parsedRoutes,i),e="",r&&(e=r.url),o=new l.Uri(l.combineUrlPaths(this._pageData.hostPath,e)),r)for(u in i)r.matchedParameters[u]||(f=i[u],f!==null&&f!==undefined&&s[u]!==f&&o.addQueryParam(u,f));return o.absoluteUri},t.prototype.getCurrentRouteValues=function(){var i=this._currentRoute.routeValues,n={},r=this.getState();for(var t in i)n[t]=r[t];return n},t.prototype._getStateFromUrl=function(n){var u=__assign({},this._currentRoute.routeValues),f,t,i,r;if(n)for(f=new l.Uri(n),t=0,i=f.queryParameters;t<i.length;t++)r=i[t],u[r.name]=r.value||"";return u},t}(h.VssObservableService);h.Services.add("IVssHistoryService",{serviceFactory:r,options:2})}("History"),function(n){function o(n,t,i){i===void 0&&(i={});var r=n.getService("IVssNavigationService"),u=n.getService("IVssPageService").getData(),f=r.getDisplayedNavigation();return __assign({},i,{source:t||"unknown",sourceNavigationId:f[f.length-1],sourceRouteId:r.getCurrentRoute().routeId,startNavigationOffset:Date.now()-window.performance.timing.navigationStart,serviceVersion:u?u.serviceVersion:undefined})}function r(n,t){t.endNavigationOffset=Date.now()-window.performance.timing.navigationStart;var i=n.getService("IVssTelemetryService");i.publishEvent("WebPlatform","FPS",t)}function c(n,t,i,u,e){if(e===void 0&&(e={}),u&&(u.ctrlKey||u.metaKey||u.shiftKey||u.button===1)){var s=o(n,e.telemetrySource,e.telemetryProperties);s.external=!0;s.ctrlKey=(u&&u.ctrlKey)===!0;s.metaKey=(u&&u.metaKey)===!0;s.shiftKey=(u&&u.shiftKey)===!0;s.middleClick=(u&&u.button)===1;r(n,s)}else return f(n,t,i,e),u&&u.preventDefault(),!0}function f(n,t,f,s){var d,c,h,y,nt,k,g,a,tt;return(s===void 0&&(s={}),d=++e,c={pageContext:n,href:t,recordHistoryEntry:f,data:s},i&&(i.cancel(),i=null),h=o(n,s.telemetrySource,s.telemetryProperties),y=new CustomEvent("fpsStarting",{cancelable:!0,detail:Object.assign({},c)}),document.body.dispatchEvent(y))?(nt={cache:"no-cache",method:"GET",mode:"same-origin"},k=new l.Uri(t),k.addQueryParam("__rt","fps"),g=n.getService("IVssPageService").getData(),g&&k.addQueryParam("__ver",""+g.webPlatformVersion),document.body.dispatchEvent(new CustomEvent("fpsLoading",{cancelable:!1,detail:Object.assign({},c)})),a=b.makeCancelable(w.issueRequest(k.absoluteUri,nt)),tt=a.promise.then(function(e){return i===a&&(i=null),e.text().then(function(i){var k=n.getService("IVssPerformanceService"),o,e,w,b,s,l,a;k.addSplitTiming("fpsResponseReceived");o=null;try{o=p.deserializeVssJsonObject(i)}catch(y){return console.log("Not a valid FPS response: "+(y.message||y)+". Performing full page navigation"),h.invalidFPSResponse=!0,v.trySetLocalStorageObject(u,h),window.location.href=t,!0}if(e=o&&o.fps,e&&(e.dataProviders&&p.updateJsonScriptValue("dataProviders",e.dataProviders,!0),e.performance&&p.updateJsonScriptValue("serverStatistics",e.performance),e.content)){if(w=n.getService("IFastPageSwitchService"),w.hasStaleContent(e.content))return h.staleContent=!0,r(n,h),window.location.href=t,!0;b=n.getService("IVssContentService");b.loadScripts(e.content)}return s=n.getService("IVssHistoryService"),f?s.pushState(undefined,t,undefined,{fpsNavigationId:d}):s.replaceState(undefined,t,undefined,{fpsNavigationId:d}),document.body.dispatchEvent(new CustomEvent("fpsLoaded",{cancelable:!1,detail:Object.assign({fpsResponse:o},c)})),s.replaceState(undefined,window.location.href),document.body.dispatchEvent(new CustomEvent("fpsCompleted",{cancelable:!1,detail:Object.assign({fpsResponse:o,success:!0},c)})),l=n.getService("IVssNavigationService"),a=l.getDisplayedNavigation(),h.targetNavigationId=a[a.length-1],h.targetRouteId=l.getCurrentRoute().routeId,h.success=!0,r(n,h),!0})}).catch(function(f){return i!==a||f.isCanceled?(h.cancelledByOtherFPS=!0,r(n,h)):(h.failed=!0,v.trySetLocalStorageObject(u,h),window.location.href=t),i===a&&(i=null),document.body.dispatchEvent(new CustomEvent("fpsCompleted",{cancelable:!1,detail:Object.assign({success:!1,reason:f},c)})),!1}),i=a,tt):(h.cancelledByUser=!0,y.detail.cancellationReason&&(h.cancellationReason=y.detail.cancellationReason),r(n,h),Promise.resolve(!1))}var u,i,e,s;d=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});u="navigation/fpsCIEvent";e=0;t[n].onClickFPS=c;t[n].FastPageSwitch=f;s=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.loadedContentIntegrity={},t._onNavigate=function(n){if(n.newState){var i=n.oldState&&n.oldState.data&&n.oldState.data.fpsNavigationId,r=n.newState.data&&n.newState.data.fpsNavigationId;i!==r&&f(t.pageContext,n.newState.url,!1,{})}},t._onContentLoaded=function(n){var i=n.contentAttributes;i&&i.clientId&&i.integrity&&(t.loadedContentIntegrity[i.clientId]=i.integrity)},t}return __extends(t,n),t.prototype._serviceStart=function(t){var i,f,e,s,o,h;n.prototype._serviceStart.call(this,t);try{i=v.tryGetLocalStorageObject(u);v.trySetLocalStorageObject(u,undefined);i&&(f=t.getService("IVssNavigationService"),e=f.getDisplayedNavigation(),i.targetNavigationId=e[e.length-1],i.targetRouteId=f.getCurrentRoute().routeId,r(t,i))}catch(c){}s=t.getService("IVssHistoryService");s.subscribe(this._onNavigate,ft.HistoryServiceEventNames.statePopped);o=t.getService("IVssPageService").getData();o&&o.isBundlingEnabled&&(this.bundlingEnabled=!0,h=t.getService("IVssContentService"),h.subscribe(this._onContentLoaded,"contentComplete"))},t.prototype.hasStaleContent=function(n){var f=!1,i,r,t,u;if(this.bundlingEnabled)for(i=0,r=n;i<r.length;i++)if(t=r[i],t.clientId&&t.integrity&&(u=this.loadedContentIntegrity[t.clientId],u&&u!==t.integrity)){f=!0;break}return f},t}(h.VssService);h.Services.add("IFastPageSwitchService",{serviceFactory:s,options:6})}("FPS"),function(n){et=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var i=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.render=function(){var n=this,t=__assign({},this.props,{onClick:function(t){if(!t.isDefaultPrevented())if(n.props.href&&n.props.supportsFPS!==!1)d.onClickFPS(n.context.pageContext,n.props.href,!0,t,{telemetrySource:n.props.telemetrySource,telemetryProperties:n.props.telemetryProperties,navigationId:n.props.navigationId});else if(n.props.telemetrySource){var i=n.context.pageContext.getService("IVssTelemetryService");i.publishEvent("WebPlatform","Link",__assign({},n.props.telemetryProperties||{},{source:n.props.telemetrySource}))}}});return delete t.navigationId,delete t.supportsFPS,delete t.telemetrySource,delete t.telemetryProperties,u.createElement("a",t,this.props.children)},t}(c.VssComponent);t[n].FPSLinkComponent=i}("ComponentsFPSLinkFPSLink"),function(n){function i(i){for(var r in i)t[n].hasOwnProperty(r)||(t[n][r]=i[r])}ni=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});i(et)}("ComponentsFPSLink"),function(n){ti=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var i="cdn.fallback.service",r=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.secureFlag="",t.contentLoadError=function(n){document.cookie="TFS-CDN=disabled;max-age=28800;path=/"+t.secureFlag;document.cookie="TFS-CDNTRACE=report-true;path=/"+t.secureFlag;d.onClickFPS(t.pageContext,document.location.href,!1,undefined,{telemetrySource:i,telemetryProperties:{failingContent:n},customUnloadMessage:a.CdnFallbackErrorMessage})},t}return __extends(t,n),t.prototype._serviceStart=function(t){var r,i,u;n.prototype._serviceStart.call(this,t);r=this.pageContext.getService("IVssPageService");i=r.getData();i&&i.isCdnEnabled&&(i.isSslOnly&&(this.secureFlag=";secure"),u=this.pageContext.getService("IVssContentService"),u.subscribe(this.contentLoadError,"contentLoadError"))},t}(h.VssService);h.Services.add("IVssFallbacksService",{serviceFactory:r,options:6})}("Fallback"),function(n){function r(n,t,i){var r=n.getService("IVssFeatureService");return r.isFeatureEnabled(t,i)}function u(n,t,i){var r=n.getService("IVssFeatureService");return r.isFeatureFlagEnabled(t,i)}ot=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var i=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.isFeatureEnabled=function(n,t){var i=this.getSharedDataState("_features",n,t);if(i===undefined)throw new Error("Could not find feature state for feature '"+n+"'. Ensure that the feature is added using IClientFeatureProviderService.AddFeatureState.");return i},t.prototype.isFeatureFlagEnabled=function(n,t){var i=this.getSharedDataState("_featureFlags",n,t);if(i===undefined)throw new Error("Could not find feature flag state for '"+n+"'. Ensure that the feature flag is added using IClientFeatureProviderService.AddFeatureFlagState.");return i},t.prototype.getSharedDataState=function(n,t,i){var f=this.pageContext.getService("IVssContributionService"),u=f.getSharedData(n),r;return u&&(r=u[t],r!==undefined)?r:i},t}(h.VssService);h.Services.add("IVssFeatureService",{serviceFactory:i});t[n].isFeatureEnabled=r;t[n].isFeatureFlagEnabled=u}("Feature"),function(n){function u(n,t,i){var r=n.getService("IVssIdentityService");return r.getIdentityImageUrl(t,i)}ii=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var i="_identityDetails",r=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.cachedIdentityDetails={},t}return __extends(t,n),t.prototype.getSharedIdentityDetails=function(n){var r=this.pageContext.getService("IVssContributionService"),t=r.getSharedData(i);return t?t[n]:undefined},t.prototype.getIdentityDetails=function(n){var t=this.cachedIdentityDetails[n],i;if(t||(i=this.getSharedIdentityDetails(n),i&&(t={id:n,displayName:i.displayName,imageId:i.identityImageId,imageUrl:this.getIdentityImageUrl(n)},this.cachedIdentityDetails[n]=t)),!t)throw new Error("Missing shared identity details for identity with id "+n+".");return t},t.prototype.getIdentityImageUrl=function(n,t){return t===void 0&&(t=0),typeof n=="string"?this._getIdentityImageUrlFromIdentityId(n,t):this._getIdentityImageUrlFromIdentityRef(n,t)},t.prototype._getIdentityImageUrlFromIdentityId=function(n,t){var u,f=this.getSharedIdentityDetails(n),i,r;return f&&(u=f.identityImageId||"0"),i="_api/_common/identityImage?id="+n+"&size="+t,u&&(i+="&t="+u),r=this.pageContext.getService("IVssPageService").getData(),r&&r.hostPath&&(i=l.combineUrlPaths(encodeURI(r.hostPath),i)),i},t.prototype._getIdentityImageUrlFromIdentityRef=function(n,t){var r=!ot.isFeatureFlagEnabled(this.pageContext,"VisualStudio.Services.WebPlatform.DisableNewAvatarImage"),u=n._links&&n._links.avatar&&n._links.avatar.href,i;return u&&r?(i=new l.Uri(n._links.avatar.href),i.addQueryParam("size",""+t,!0),i.absoluteUri):n.descriptor&&r?this._getIdentityAvatarUrl(n.descriptor):n.imageUrl||this._getIdentityImageUrlFromIdentityId(n.id,t)},t.prototype._getIdentityAvatarUrl=function(n){var t="_apis/GraphProfile/MemberAvatars/"+n,i=this.pageContext.getService("IVssPageService").getData();return i&&i.hostPath&&(t=l.combineUrlPaths(encodeURI(i.hostPath),t)),t},t}(h.VssService);h.Services.add("IVssIdentityService",{serviceFactory:r});t[n].getIdentityImageUrl=u}("Identity"),function(n){ri=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var i=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t._originalStopCallback=window.Mousetrap.prototype.stopCallback,t}return __extends(t,n),t.prototype._serviceStart=function(t){n.prototype._serviceStart.call(this,t);var i=this;window.Mousetrap.prototype.stopCallback=function(n,t,r,u){return i._globalCombos[r]||i._globalCombos[u]?!1:t.getAttribute("data-onlyglobalshortcuts")==="true"?!0:i._originalStopCallback.call(this,n,t,r)};this.initializeService()},t.prototype._serviceRestart=function(t){n.prototype._serviceRestart.call(this,t);this.initializeService()},t.prototype.initializeService=function(){var i;this.reset();var n=this.pageContext.getService("IVssContributionService"),t=n.getContributionsByType("ms.vss-web.shortcut"),r=function(i){var r=t[i];u.registerShortcut(r.group,{combos:r.combos,description:r.description,isPageNavigationShortcut:r.isPageNavigationShortcut,action:function(){r.command?n.executeCommandEx(i,r.command):r.commandId&&n.executeCommand(r.commandId)}})},u=this;for(i in t)r(i)},t.prototype.reset=function(){window.Mousetrap.reset();this._globalCombos={};this._registeredCombos={};this._shortcutsGroups={}},t.prototype.getShortcutGroups=function(){var n=this;return Object.keys(this._shortcutsGroups).map(function(t){return n._shortcutsGroups[t]})},t.prototype.getGlobalCombos=function(){return Object.keys(this._globalCombos)},t.prototype.registerShortcut=function(n,t){var l=this,a,f,e,v,i,o,s,h,r,c,u,y;for(this._shortcutsGroups[n]||(this._shortcutsGroups[n]={name:n,shortcuts:[]}),a=function(t){var i=l.pageContext.getService("IVssTelemetryService");i.publishEvent("KeyboardShortcuts","ShortcutInvoked",{group:n,shortcut:t})},e=function(n,i){return a(i),t.isPageNavigationShortcut&&l.reset(),t.action(n,i),t.allowPropagation||!1},t.element?(f=window.Mousetrap(t.element),f.bind(t.combos,e)):window.Mousetrap.bind(t.combos,e),v=t.globalCombos||[],i=0,o=t.combos;i<o.length;i++)s=o[i],v.indexOf(s)>=0&&(this._globalCombos[s]=!0);for(h=[],r=0,c=t.combos;r<c.length;r++)u=c[r],this._registeredCombos[u]||(h.push(u),this._registeredCombos[u]=!0);y=__assign({},t,{combos:t.combos,combosToDisplay:t.hideFromHelpDialog?[]:h,mousetrapInstance:f});this._shortcutsGroups[n].shortcuts.push(y)},t.prototype.unRegisterShortcut=function(n,t){var i;if(this._registeredCombos[t]&&delete this._registeredCombos[t],this._shortcutsGroups[n]){for(var r=this._shortcutsGroups[n].shortcuts,u=0,f=!1;u<r.length;u++)if(i=r[u],i.combos.indexOf(t)>=0){i.mousetrapInstance?i.mousetrapInstance.unbind(t):window.Mousetrap.unbind(t);i.combos.length===1&&(f=!0);delete this._globalCombos[t];break}f&&(r.splice(u,1),r.length===0&&this.removeShortcutGroup(n))}},t.prototype.removeShortcutGroup=function(n){var t=this,i;this._shortcutsGroups[n]&&(i=this._shortcutsGroups[n].shortcuts,delete this._shortcutsGroups[n],i.forEach(function(n){var i,r,u;for(n.mousetrapInstance?n.mousetrapInstance.unbind(n.combos):window.Mousetrap.unbind(n.combos),i=0,r=n.combos;i<r.length;i++)u=r[i],delete t._registeredCombos[u],delete t._globalCombos[u]}))},t}(h.VssService);h.Services.add("IVssKeyboardShortcutService",{serviceFactory:i,options:6})}("KeyboardShortcuts"),function(n){function r(n,t){var i=n.getService("IVssLocationService");return i.getAssetLocation(t)}function u(n,t,i){var r=n.getService("IVssLocationService");return r.getServiceLocation(t,i)}function f(n,t,i,r){var u=n.getService("IVssLocationService");return u.routeUrl(t,i,r)}st=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var i=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t._parsedRoutes={},t}return __extends(t,n),t.prototype.getAssetLocation=function(n){var i=this.pageContext.getService("IVssContributionService"),t=i.getSharedData("_assets");if(t)return t[n];throw new Error("Could not find asset for service "+n+". Ensure that the asset is added through a shared data value.");},t.prototype.getServiceLocation=function(n,t){var i=this.pageContext.getService("IVssPageService").getData(),e,r,u,f;if(t||(t=i.hostType),n&&i.isHosted||(n=i.serviceInstanceType),e=this.pageContext.getService("IVssContributionService"),r=e.getSharedData("_locations"),r&&(u=r[n],u&&(f=u[t],f)))return f;throw new Error("Could not find location for service "+n+" and hostType "+t+". Ensure that the requested service location is added using IClientLocationProviderService.AddLocation.");},t.prototype.routeUrl=function(n,t,i){var r=this._parsedRoutes[n],o,f,e,s,u,h;if(r||(o=this.pageContext.getService("IVssContributionService"),f=o.getSharedData("_routes"),f&&(e=f[n],e&&(r=[],e.forEach(function(n){r.push(l.parseRouteTemplate(n))}),this._parsedRoutes[n]=r))),r&&(s=l.routeUrl(r,t||{}),i||(u=this.pageContext.getService("IVssPageService").getData(),u&&u.hostPath&&(i=u.hostPath)),i))return h=encodeURI(i),l.combineUrlPaths(h,s);throw new Error("Could not find route for route id "+n+". Ensure that the requested route is added to routes shared data.");},t}(h.VssService);h.Services.add("IVssLocationService",{serviceFactory:i});t[n].getAssetLocation=r;t[n].getServiceLocation=u;t[n].routeUrl=f}("Location"),function(n){y=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(n){this._options=n||{};this._rootPath=typeof this._options.rootPath=="string"?Promise.resolve(this._options.rootPath):this._options.rootPath||Promise.resolve("/")}return n.prototype.getRootPath=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,this._rootPath]})})},n.prototype.beginRequest=function(n){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(){return[2,this._rootPath.then(function(i){var r=i+l.replaceRouteValues(n.routeTemplate,n.routeValues||{}),u;return n.queryParams&&(u=new l.Uri(r),u.addQueryParams(n.queryParams),r=u.absoluteUri),t._issueRequest(r,n.apiVersion,n)})]})})},n.prototype._issueRequest=function(n,t,i){var r={},u,f,e,o;return r.method=i.method||"GET",r.mode="cors",r.body=!i.isRawData&&i.body&&r.method.toUpperCase()!=="GET"?JSON.stringify(i.body):i.body,u=i.httpResponseType||"application/json",f=u+";api-version="+t+";excludeUrls=true;enumsAsNumbers=true;msDateFormat=true;noArrayWrap=true",r.headers=Object.assign({Accept:f,"Content-Type":i.body&&"application/json"},i.customHeaders),e={authTokenProvider:this._options.authTokenProvider,showProgressIndicator:this._options.showProgressIndicator,sessionId:this._options.sessionId,command:i.command||this._options.command},o=w.issueRequest(n,r,e),o.then(function(n){return i.returnRawResponse?n:u.toLowerCase().indexOf("json")>=0?n.text().then(p.deserializeVssJsonObject):u.toLowerCase()==="text/plain"?n.text():n.arrayBuffer()})},n}();t[n].RestClientBase=i}("RestClientBase"),function(n){ui=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var i=function(n){function t(t){return n.call(this,t)||this}return __extends(t,n),t.prototype.createSessionToken=function(n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,this.beginRequest({apiVersion:"3.2-preview.1",method:"POST",routeTemplate:"_apis/WebPlatformAuth/SessionToken",body:n})]})})},t}(y.RestClientBase);h.RestClients.add("IAuthenticationRestClient",{factory:i})}("RestClientAuthenticationImpl"),function(n){fi=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var i=function(n){function t(t){return n.call(this,t)||this}return __extends(t,n),t.prototype.publishEvents=function(n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,this.beginRequest({apiVersion:"4.1-preview.1",method:"POST",routeTemplate:"_apis/ClientTrace/Events",body:n})]})})},t}(y.RestClientBase);h.RestClients.add("IClientTraceRestClient",{factory:i})}("RestClientClientTraceImpl"),function(n){ei=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var i=function(n){function t(t){return n.call(this,t)||this}return __extends(t,n),t.prototype.queryContributionNodes=function(n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,this.beginRequest({apiVersion:"3.2-preview.1",method:"POST",routeTemplate:"_apis/Contribution/nodes/query",body:n})]})})},t.prototype.queryDataProviders=function(n,t,i){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,this.beginRequest({apiVersion:"3.2-preview.1",method:"POST",routeTemplate:"_apis/Contribution/dataProviders/query/{scopeName}/{scopeValue}",routeValues:{scopeName:t,scopeValue:i},body:n})]})})},t}(y.RestClientBase);h.RestClients.add("IContributionsRestClient",{factory:i})}("RestClientContributionsImpl"),function(n){oi=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var i=function(n){function t(t){return n.call(this,t)||this}return __extends(t,n),t.prototype.publishEvents=function(n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,this.beginRequest({apiVersion:"3.2-preview.1",method:"POST",routeTemplate:"_apis/customerintelligence/Events",body:n})]})})},t}(y.RestClientBase);h.RestClients.add("ICustomerIntelligenceRestClient",{factory:i})}("RestClientCustomerIntelligenceImpl"),function(n){si=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var i=function(n){function t(t){return n.call(this,t)||this}return __extends(t,n),t.prototype.getConnectionData=function(n,t,i){return __awaiter(this,void 0,void 0,function(){var r;return __generator(this,function(){return r={connectOptions:n,lastChangeId:t,lastChangeId64:i},[2,this.beginRequest({apiVersion:"4.0-preview.1",routeTemplate:"_apis/ConnectionData",queryParams:r})]})})},t.prototype.getResourceArea=function(n,t,i){return __awaiter(this,void 0,void 0,function(){var r;return __generator(this,function(){return r={enterpriseName:t,organizationName:i},[2,this.beginRequest({apiVersion:"4.0-preview.1",routeTemplate:"_apis/ResourceAreas/{areaId}",routeValues:{areaId:n},queryParams:r})]})})},t.prototype.getResourceAreaByHost=function(n,t){return __awaiter(this,void 0,void 0,function(){var i;return __generator(this,function(){return i={hostId:t},[2,this.beginRequest({apiVersion:"4.0-preview.1",routeTemplate:"_apis/ResourceAreas/{areaId}",routeValues:{areaId:n},queryParams:i})]})})},t.prototype.getResourceAreas=function(n,t){return __awaiter(this,void 0,void 0,function(){var i;return __generator(this,function(){return i={enterpriseName:n,organizationName:t},[2,this.beginRequest({apiVersion:"4.0-preview.1",routeTemplate:"_apis/ResourceAreas/{areaId}",queryParams:i})]})})},t.prototype.getResourceAreasByHost=function(n){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(){return t={hostId:n},[2,this.beginRequest({apiVersion:"4.0-preview.1",routeTemplate:"_apis/ResourceAreas/{areaId}",queryParams:t})]})})},t.prototype.deleteServiceDefinition=function(n,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,this.beginRequest({apiVersion:"4.0-preview.1",method:"DELETE",routeTemplate:"_apis/ServiceDefinitions/{serviceType}/{identifier}",routeValues:{serviceType:n,identifier:t}})]})})},t.prototype.getServiceDefinition=function(n,t,i,r){return __awaiter(this,void 0,void 0,function(){var u;return __generator(this,function(){return u={allowFaultIn:i,previewFaultIn:r},[2,this.beginRequest({apiVersion:"4.0-preview.1",routeTemplate:"_apis/ServiceDefinitions/{serviceType}/{identifier}",routeValues:{serviceType:n,identifier:t},queryParams:u})]})})},t.prototype.getServiceDefinitions=function(n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,this.beginRequest({apiVersion:"4.0-preview.1",routeTemplate:"_apis/ServiceDefinitions/{serviceType}/{identifier}",routeValues:{serviceType:n}})]})})},t.prototype.updateServiceDefinitions=function(n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,this.beginRequest({apiVersion:"4.0-preview.1",method:"PATCH",routeTemplate:"_apis/ServiceDefinitions/{serviceType}/{identifier}",body:n})]})})},t}(y.RestClientBase);h.RestClients.add("ILocationsRestClient",{factory:i})}("RestClientLocationsImpl"),function(n){function r(n,t){var i=n.getService("IVssUserClaimsService");return i.hasClaim(t)}g=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var i=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.hasClaim=function(n){if(!this.claims){var t=this.pageContext.getService("IVssContributionService");this.claims=t.getData("ms.vss-web.user-claims-data")||this.getDefaultClaims()}return n=(n||"").toLowerCase(),this.claims[n]===!0},t.prototype.getDefaultClaims=function(){var n={};return n.member=!0,n},t}(h.VssService);h.Services.add("IVssUserClaimsService",{serviceFactory:i});t[n].userHasClaim=r}("UserClaims"),function(n){hi=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var i=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.populateRestClientOptions=function(n){var t=this.pageContext.getService("IVssPageService").getData(),i,r,u;t&&(n.sessionId||(n.sessionId=t.sessionId),n.rootPath||(i=n.serviceInstanceType,r=n.hostType,t.isHosted&&i&&i!==t.serviceInstanceType||r&&r!==t.hostType?(t.isHosted&&g.userHasClaim(this.pageContext,"member")&&!n.authTokenProvider&&(u=this.pageContext.getService("IAuthenticationService"),n.authTokenProvider=u.getDefaultTokenProvider()),n.rootPath=st.getServiceLocation(this.pageContext,i,n.hostType)):n.rootPath=t.hostPath||"/"))},t}(h.VssService);h.Services.add("IRestClientOptionsProviderService",{serviceFactory:i})}("RestClientOptionsProvider"),function(n){ci=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var i=function(n){function t(t){return n.call(this,t)||this}return __extends(t,n),t.prototype.getEntries=function(n,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,this.beginRequest({apiVersion:"4.1-preview.1",routeTemplate:"_apis/Settings/Entries/{userScope}/{*key}",routeValues:{userScope:n,key:t}})]})})},t.prototype.removeEntries=function(n,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,this.beginRequest({apiVersion:"4.1-preview.1",method:"DELETE",routeTemplate:"_apis/Settings/Entries/{userScope}/{*key}",routeValues:{userScope:n,key:t}})]})})},t.prototype.setEntries=function(n,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,this.beginRequest({apiVersion:"4.1-preview.1",method:"PATCH",routeTemplate:"_apis/Settings/Entries/{userScope}/{*key}",routeValues:{userScope:t},body:n})]})})},t.prototype.getEntriesForScope=function(n,t,i,r){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,this.beginRequest({apiVersion:"4.1-preview.1",routeTemplate:"_apis/Settings/{scopeName}/{scopeValue}/Entries/{userScope}/{*key}",routeValues:{userScope:n,scopeName:t,scopeValue:i,key:r}})]})})},t.prototype.removeEntriesForScope=function(n,t,i,r){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,this.beginRequest({apiVersion:"4.1-preview.1",method:"DELETE",routeTemplate:"_apis/Settings/{scopeName}/{scopeValue}/Entries/{userScope}/{*key}",routeValues:{userScope:n,scopeName:t,scopeValue:i,key:r}})]})})},t.prototype.setEntriesForScope=function(n,t,i,r){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,this.beginRequest({apiVersion:"4.1-preview.1",method:"PATCH",routeTemplate:"_apis/Settings/{scopeName}/{scopeValue}/Entries/{userScope}/{*key}",routeValues:{userScope:t,scopeName:i,scopeValue:r},body:n})]})})},t}(y.RestClientBase);h.RestClients.add("ISettingsRestClient",{factory:i})}("RestClientSettingsImpl"),function(n){li=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var i=function(n){function t(t){return n.call(this,t)||this}return __extends(t,n),t.prototype.getContributedHierarchy=function(n,t,i){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/Contribution/Hierarchy/{contributionId}/{scopeName}/{scopeValue}",routeValues:{contributionId:n,scopeName:t,scopeValue:i}})]})})},t.prototype.queryContributedHierarchy=function(n,t,i){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/Contribution/HierarchyQuery/{scopeName}/{scopeValue}",routeValues:{scopeName:t,scopeValue:i},body:n})]})})},t}(y.RestClientBase);h.RestClients.add("IWebContributionsRestClient",{factory:i})}("RestClientWebContributionsImpl"),function(n){ai=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var i="ms.vss-web.search-coordinator",r="ms.vss-web.search-provider",u=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.execute=function(n){var o=this,f=this.pageContext.getService("IVssContributionService"),r=f.getContributionsByType(i),t=undefined,u=undefined;for(var e in r)(!u||r[e].priority>u.priority)&&(t=e,u=r[t]);return t?f.getService(t).then(function(t){if(t)return t.execute(n).then(function(n){return o._notify(n,"searchStarted"),n});throw new Error("Failed to create the configured search coordinator");}):Promise.reject("No search coordinator is available to perform the search operation.")},t.prototype.getProviders=function(){var n=this.pageContext.getService("IVssContributionService");return n.getContributionsByType(r)},t.prototype.getSelectedProvider=function(){var n=this.selectedProviderId||this.defaultProviderId,t,o,u,f,e,c,v,i,r,l;if(!n&&(t=this.getProviders(),o=Object.keys(t),o.length>0)){var a=this.pageContext.getService("IVssNavigationService"),s=a.getDisplayedNavigation(),h=[];for(u=s.length-1;u>=0;u--)f=a.getNavigation(s[u]),f&&f.displayedDocTypes&&h.splice.apply(h,[s.length,0].concat(f.displayedDocTypes));n:for(e=0,c=h;e<c.length;e++){v=c[e];for(i in t)if(r=t[i],r.supportedDocTypes&&r.supportedDocTypes.indexOf(v)!==-1){n=i;break n}}if(!n){n=o[0];for(i in t)r=t[i],l=t[n],typeof r.priority!="undefined"&&(typeof l.priority=="undefined"||r.priority>l.priority)&&(n=i)}this.defaultProviderId=n}return n},t.prototype.setSelectedProvider=function(n){var t=this.getProviders();t[n]&&(this.selectedProviderId=n,this._notify(this.selectedProviderId,"providerSelected"))},t}(h.VssObservableService);h.Services.add("IVssSearchService",{serviceFactory:u})}("Search"),function(n){vi=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var i="_permissions",r=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.hasPermission=function(n,t,r){var o=this.pageContext.getService("IVssContributionService"),e=o.getSharedData(i),u,f;return e?(u=e[n.toLowerCase()],!u)?this.handleMissingState("Security namespace with id '"+n+"' not found"):(f=u[t],f===undefined)?this.handleMissingState("No permissions found for security namespace '"+n+"' and token '"+t+"'"):(r&f)>0:this.handleMissingState("No shared permissions found")},t.prototype.checkPermission=function(n,t,i){if(!this.hasPermission(n,t,i))throw new Error("Access denied: Permission "+i+" is needed for the resource "+t+".");},t.prototype.handleMissingState=function(n){return console.error(n+". Ensure that the effective permissions are added using IClientSecurityProviderService.AddPermissions."),!1},t}(h.VssService);h.Services.add("IVssSecurityService",{serviceFactory:r})}("Security"),function(n){yi=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var r=Promise.resolve({value:{},count:0}),i=Promise.resolve(),u=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.getEntry=function(n,t,i,r){var a,s,h,c,u,f,v,y,l,e,o;if(!this.canCallSettingsEndpoint)return undefined;if(a=this.pageContext.getService("IVssContributionService"),s=a.getSharedData("_settings"),s&&(h=this.userScopeToString(t),i&&(h+=";"+i+";"+(r||"")),c=s[h],c))for(u=n.split("/"),f=0,v=u.length;f<v;f++)if(y=u.slice(0,f+1).join("/"),l=c[y],l){for(e=l,o=f+1;o<u.length&&e;o++)e=e[u[o]];return e}return undefined},t.prototype.getEntriesAsync=function(n,t,i,u){return this.canCallSettingsEndpoint?i?this.httpClient.getEntriesForScope(this.userScopeToString(t),i,u,n):this.httpClient.getEntries(this.userScopeToString(t),n):r},t.prototype.setEntries=function(n,t,r,u){return this.canCallSettingsEndpoint?r?this.httpClient.setEntriesForScope(n,this.userScopeToString(t),r,u):this.httpClient.setEntries(n,this.userScopeToString(t)):i},t.prototype.removeEntries=function(n,t,r,u){return this.canCallSettingsEndpoint?r?this.httpClient.removeEntriesForScope(this.userScopeToString(t),r,u,n):this.httpClient.removeEntries(this.userScopeToString(t),n):i},t.prototype.userScopeToString=function(n){return n===1?"host":"me"},Object.defineProperty(t.prototype,"httpClient",{get:function(){return this._httpClient||(this._httpClient=this.pageContext.getRestClient("ISettingsRestClient")),this._httpClient},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canCallSettingsEndpoint",{get:function(){return this._canCallSettingsEndpoint===undefined&&(this._canCallSettingsEndpoint=g.userHasClaim(this.pageContext,"member")),this._canCallSettingsEndpoint},enumerable:!0,configurable:!0}),t}(h.VssService);h.Services.add("ISettingsService",{serviceFactory:u})}("Settings"),function(n){pi=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var i="user-custom-theme",r=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype._serviceStart=function(t){n.prototype._serviceStart.call(this,t);this._initializeTheme()},t.prototype._serviceRestart=function(t){n.prototype._serviceRestart.call(this,t);this._initializeTheme()},t.prototype._serviceEnd=function(t){n.prototype._serviceEnd.call(this,t)},t.prototype.getCSSVariablesContent=function(){var i=[],n=this.currentTheme.data,t;if(n)for(t in n)i.push("--"+t+": "+n[t]);return i.join("; ")},t.prototype.getThemeValue=function(n){return s.expandThemeableProperties("var(--"+n+")",this.currentTheme.data)},t.prototype.getCurrentTheme=function(){return this.currentTheme},t.prototype._initializeTheme=function(){var n=undefined,t;n=v.tryGetLocalStorageObject(i);n||(t=this.pageContext.getService("IVssContributionService"),n=t.getData("ms.vss-web.theme-data"));this.currentTheme=n||{id:"empty-theme",name:"",data:{}};this.applyTheme(this.currentTheme)},t.prototype.applyTheme=function(n){this.currentTheme=n;this._notify(n,"themeChanged");this.contentElement||(this.contentElement=document.createElement("style"),this.contentElement.type="text/css",document.head.appendChild(this.contentElement));this.contentElement.innerText=":root { "+this.getCSSVariablesContent()+" }"},t.prototype.saveCustomUserTheme=function(n){v.trySetLocalStorageObject(i,n)},t}(h.VssObservableService);h.Services.add("IVssThemeService",{serviceFactory:r,options:6})}("Theming"),function(n){function i(n,t){var u,f,i,e;if(n.contains(t)||(u=n.getAttribute("aria-owns"),u&&r(u,t)))return!0;for(f=n.querySelectorAll("[aria-owns]"),i=0;i<f.length;i++)if(e=f[i],r(e.getAttribute("aria-owns"),t))return!0;return!1}function r(n,t){var r=document.querySelector("[id='"+n+"']");return r&&i(r,t)?!0:!1}wi=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});t[n].contains=i}("UtilDOM"),function(n){function f(n){return i+[encodeURIComponent(n.tool),encodeURIComponent(n.type),encodeURIComponent(n.id)].join(u)}function e(n){var f,t;if(n.length>i.length&&(f=n.substr(0,i.length).toLowerCase(),f===i&&(t=n.substr(i.length).split(u),t.length>=3))){var e=t[0],o=t[1],s=t.slice(2).join("/");return{uri:n,tool:r(e),type:r(o),id:r(s)}}throw new Error("Invalid artifact uri: "+n);}function r(n){var t;return t=n.replace(/\+/g," "),decodeURIComponent(t)}bi=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var i="vstfs:///",u="/";t[n].encodeUri=f;t[n].decodeUri=e}("UtilLinking"),function(n){function s(n,t,o,s){var l,h,v,y,c,p;return o||(o=new Date),t||(t=u.Compact),l=(o.getTime()-n.getTime())/1e3,h="",l<2*i?h=a.JustNow:t===u.Compact?l<59*i?h=r.format(a.AgoMinutes,Math.round(l/i)):o.toDateString()===n.toDateString()?h=r.format(a.AgoHours,Math.round(l/f)):l<e&&o.getDay()!==n.getDay()?(y=new Date,y.setDate(o.getDate()-1),n.getDate()===y.getDate()?h=a.Yesterday:(c={weekday:"long"},h=n.toLocaleString(s,c))):o.getFullYear()===n.getFullYear()?(c={month:"short",day:"numeric"},h=n.toLocaleDateString(s,c)):(c={month:"short",year:"numeric",day:"numeric"},h=n.toLocaleDateString(s,c)):t===u.Extended&&(v="",o.toDateString()===n.toDateString()?v=a.Today:l<e&&o.getDay()!==n.getDay()?(y=new Date,y.setDate(o.getDate()-1),n.getDate()===y.getDate()?v=a.Yesterday:(c={weekday:"short"},v=n.toLocaleString(s,c))):o.getFullYear()===n.getFullYear()?(c={month:"short",day:"numeric"},v=n.toLocaleDateString(s,c)):(c={month:"short",year:"numeric",day:"numeric"},v=n.toLocaleDateString(s,c)),p=n.toLocaleString(s,{hour:"numeric",minute:"numeric"}),h=r.format(a.DayAtTimeFormat,v,p)),h||(h=n.toString()),h}ki=t[n]={};Object.defineProperty(t,"__esModule",{value:!0});var i=60,f=i*60,o=f*24,e=o*7,u;(function(n){n[n.Compact=0]="Compact";n[n.Extended=1]="Extended"})(u=t[n].AgoFormat||(t[n].AgoFormat={}));t[n].ago=s}("UtilDate")},["Util/String","Resources","Context","Authentication","Content","Util/Object","Util/Serialization","Contribution","Util/Promise","Fetch","Page","Util/Array","Util/Storage","Telemetry","Util/Cookie","Performance","Layout","Util/Url","Navigation","Trace","Components/ErrorBoundary/ErrorBoundary","Components/ErrorBoundary","Components/Format/Format","Components/Format","Components/Layout/Layout","Components/Layout","History","FPS","Components/FPSLink/FPSLink","Components/FPSLink","Fallback","Feature","Identity","KeyboardShortcuts","Location","RestClientBase","RestClient/AuthenticationImpl","RestClient/ClientTraceImpl","RestClient/ContributionsImpl","RestClient/CustomerIntelligenceImpl","RestClient/LocationsImpl","UserClaims","RestClient/OptionsProvider","RestClient/SettingsImpl","RestClient/WebContributionsImpl","Search","Security","Settings","Theming","Util/DOM","Util/Linking","Util/Date"]),function(n,t,i){function e(n,t,i){n.addEventListener?n.addEventListener(t,i,!1):n.attachEvent("on"+t,i)}function s(n){if("keypress"==n.type){var t=String.fromCharCode(n.which);return n.shiftKey||(t=t.toLowerCase()),t}return u[n.which]?u[n.which]:l[n.which]?l[n.which]:String.fromCharCode(n.which).toLowerCase()}function y(n){var t=[];return n.shiftKey&&t.push("shift"),n.altKey&&t.push("alt"),n.ctrlKey&&t.push("ctrl"),n.metaKey&&t.push("meta"),t}function o(n){return"shift"==n||"ctrl"==n||"alt"==n||"meta"==n}function h(n,t){var r,h=[],e=n,i,s;for("+"===e?e=["+"]:(e=e.replace(/\+{2}/g,"+plus"),e=e.split("+")),r=0;r<e.length;++r)i=e[r],v[i]&&(i=v[i]),t&&"keypress"!=t&&a[i]&&(i=a[i],h.push("shift")),o(i)&&h.push(i);if(e=i,r=t,!r){if(!f){f={};for(s in u)95<s&&112>s||u.hasOwnProperty(s)&&(f[u[s]]=s)}r=f[e]?"keydown":"keypress"}return"keypress"==r&&h.length&&(r="keydown"),{key:i,modifiers:h,action:r}}function c(n,i){return null===n||n===t?!1:n===i?!0:c(n.parentNode,i)}function r(n){function f(n){n=n||{};var t=!1;for(var i in u)n[i]?t=!0:u[i]=0;t||(v=!1)}function p(n,t,r,f,e,s){var l,v=[],a=r.type,h,c;if(!i._callbacks[n])return[];for("keyup"==a&&o(n)&&(t=[n]),l=0;l<i._callbacks[n].length;++l)h=i._callbacks[n][l],(f||!h.seq||u[h.seq]==h.level)&&a==h.action&&((c="keypress"==a&&!r.metaKey&&!r.ctrlKey)||(c=h.modifiers,c=t.sort().join(",")===c.sort().join(",")),c&&(c=f&&h.seq==f&&h.level==s,(!f&&h.combo==e||c)&&i._callbacks[n].splice(l,1),v.push(h)));return v}function c(n,t,r,u){i.stopCallback(t,t.target||t.srcElement,r,u)||!1!==n(t,r)||(t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation?t.stopPropagation():t.cancelBubble=!0)}function l(n){"number"!=typeof n.which&&(n.which=n.keyCode);var t=s(n);t&&("keyup"==n.type&&a===t?a=!1:i.handleKey(t,y(n),n))}function d(n,t,i,r){function l(t){return function(){v=t;++u[n];clearTimeout(b);b=setTimeout(f,1e3)}}function y(t){c(i,t,n);"keyup"!==r&&(a=s(t));setTimeout(f,10)}for(var o,e=u[n]=0;e<t.length;++e)o=e+1===t.length?y:l(r||h(t[e+1]).action),w(t[e],o,r,n,e)}function w(n,t,r,u,f){i._directMap[n+":"+r]=t;n=n.replace(/\s+/g," ");var e=n.split(" ");1<e.length?d(n,e,t,r):(r=h(n,r),i._callbacks[r.key]=i._callbacks[r.key]||[],p(r.key,r.modifiers,{type:r.action},u,n,f),i._callbacks[r.key][u?"unshift":"push"]({callback:t,modifiers:r.modifiers,action:r.action,seq:u,level:f,combo:n}))}var i=this;if(n=n||t,!(i instanceof r))return new r(n);i.target=n;i._callbacks={};i._directMap={};var u={},b,a=!1,k=!1,v=!1;i._handleKey=function(n,t,i){var u=p(n,t,i),r,e,s;for(t={},e=0,s=!1,r=0;r<u.length;++r)u[r].seq&&(e=Math.max(e,u[r].level));for(r=0;r<u.length;++r)u[r].seq?u[r].level==e&&(s=!0,t[u[r].seq]=1,c(u[r].callback,i,u[r].combo,u[r].seq)):s||c(u[r].callback,i,u[r].combo);u="keypress"==i.type&&k;i.type!=v||o(n)||u||f(t);k=s&&"keydown"==i.type};i._bindMultiple=function(n,t,i){for(var r=0;r<n.length;++r)w(n[r],t,i)};e(n,"keypress",l);e(n,"keydown",l);e(n,"keyup",l)}if(n){var u={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},l={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},a={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},v={option:"alt",command:"meta","return":"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},f;for(i=1;20>i;++i)u[111+i]="f"+i;for(i=0;9>=i;++i)u[i+96]=i.toString();r.prototype.bind=function(n,t,i){return n=n instanceof Array?n:[n],this._bindMultiple.call(this,n,t,i),this};r.prototype.unbind=function(n,t){return this.bind.call(this,n,function(){},t)};r.prototype.trigger=function(n,t){return this._directMap[n+":"+t]&&this._directMap[n+":"+t]({},n),this};r.prototype.reset=function(){return this._callbacks={},this._directMap={},this};r.prototype.stopCallback=function(n,t){return-1<(" "+t.className+" ").indexOf(" mousetrap ")||c(t,this.target)?!1:"INPUT"==t.tagName||"SELECT"==t.tagName||"TEXTAREA"==t.tagName||t.isContentEditable};r.prototype.handleKey=function(){return this._handleKey.apply(this,arguments)};r.addKeycodes=function(n){for(var t in n)n.hasOwnProperty(t)&&(u[t]=n[t]);f=null};r.init=function(){var n=r(t);for(var i in n)"_"!==i.charAt(0)&&(r[i]=function(t){return function(){return n[t].apply(n,arguments)}}(i))};r.init();n.Mousetrap=r;"undefined"!=typeof module&&module.exports&&(module.exports=r);"function"==typeof define&&define.amd&&define("mousetrap",function(){return r})}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null),function(n){function f(n){if(typeof n!="string"&&(n=String(n)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(n))throw new TypeError("Invalid character in header field name");return n.toLowerCase()}function s(n){return typeof n!="string"&&(n=String(n)),n}function e(n){var t={next:function(){var t=n.shift();return{done:t===undefined,value:t}}};return i.iterable&&(t[Symbol.iterator]=function(){return t}),t}function t(n){this.map={};n instanceof t?n.forEach(function(n,t){this.append(t,n)},this):Array.isArray(n)?n.forEach(function(n){this.append(n[0],n[1])},this):n&&Object.getOwnPropertyNames(n).forEach(function(t){this.append(t,n[t])},this)}function o(n){if(n.bodyUsed)return Promise.reject(new TypeError("Already read"));n.bodyUsed=!0}function h(n){return new Promise(function(t,i){n.onload=function(){t(n.result)};n.onerror=function(){i(n.error)}})}function b(n){var t=new FileReader,i=h(t);return t.readAsArrayBuffer(n),i}function k(n){var t=new FileReader,i=h(t);return t.readAsText(n),i}function d(n){for(var i=new Uint8Array(n),r=new Array(i.length),t=0;t<i.length;t++)r[t]=String.fromCharCode(i[t]);return r.join("")}function c(n){if(n.slice)return n.slice(0);var t=new Uint8Array(n.byteLength);return t.set(new Uint8Array(n)),t.buffer}function l(){return this.bodyUsed=!1,this._initBody=function(n){if(this._bodyInit=n,n)if(typeof n=="string")this._bodyText=n;else if(i.blob&&Blob.prototype.isPrototypeOf(n))this._bodyBlob=n;else if(i.formData&&FormData.prototype.isPrototypeOf(n))this._bodyFormData=n;else if(i.searchParams&&URLSearchParams.prototype.isPrototypeOf(n))this._bodyText=n.toString();else if(i.arrayBuffer&&i.blob&&p(n))this._bodyArrayBuffer=c(n.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else if(i.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(n)||w(n)))this._bodyArrayBuffer=c(n);else throw new Error("unsupported BodyInit type");else this._bodyText="";this.headers.get("content-type")||(typeof n=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):i.searchParams&&URLSearchParams.prototype.isPrototypeOf(n)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i.blob&&(this.blob=function(){var n=o(this);if(n)return n;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");else return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?o(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(b)}),this.text=function(){var n=o(this);if(n)return n;if(this._bodyBlob)return k(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(d(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");else return Promise.resolve(this._bodyText)},i.formData&&(this.formData=function(){return this.text().then(nt)}),this.json=function(){return this.text().then(JSON.parse)},this}function g(n){var t=n.toUpperCase();return a.indexOf(t)>-1?t:n}function u(n,i){i=i||{};var r=i.body;if(n instanceof u){if(n.bodyUsed)throw new TypeError("Already read");this.url=n.url;this.credentials=n.credentials;i.headers||(this.headers=new t(n.headers));this.method=n.method;this.mode=n.mode;r||n._bodyInit==null||(r=n._bodyInit,n.bodyUsed=!0)}else this.url=String(n);if(this.credentials=i.credentials||this.credentials||"omit",(i.headers||!this.headers)&&(this.headers=new t(i.headers)),this.method=g(i.method||this.method||"GET"),this.mode=i.mode||this.mode||null,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function nt(n){var t=new FormData;return n.trim().split("&").forEach(function(n){if(n){var i=n.split("="),r=i.shift().replace(/\+/g," "),u=i.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(u))}}),t}function tt(n){var i=new t;return n.split(/\r?\n/).forEach(function(n){var t=n.split(":"),r=t.shift().trim(),u;r&&(u=t.join(":").trim(),i.append(r,u))}),i}function r(n,i){i||(i={});this.type="default";this.status="status"in i?i.status:200;this.ok=this.status>=200&&this.status<300;this.statusText="statusText"in i?i.statusText:"OK";this.headers=new t(i.headers);this.url=i.url||"";this._initBody(n)}var i,a,v;if(!n.fetch){if(i={searchParams:"URLSearchParams"in n,iterable:"Symbol"in n&&"iterator"in Symbol,blob:"FileReader"in n&&"Blob"in n&&function(){try{return new Blob,!0}catch(n){return!1}}(),formData:"FormData"in n,arrayBuffer:"ArrayBuffer"in n},i.arrayBuffer)var y=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],p=function(n){return n&&DataView.prototype.isPrototypeOf(n)},w=ArrayBuffer.isView||function(n){return n&&y.indexOf(Object.prototype.toString.call(n))>-1};t.prototype.append=function(n,t){n=f(n);t=s(t);var i=this.map[n];this.map[n]=i?i+","+t:t};t.prototype["delete"]=function(n){delete this.map[f(n)]};t.prototype.get=function(n){return n=f(n),this.has(n)?this.map[n]:null};t.prototype.has=function(n){return this.map.hasOwnProperty(f(n))};t.prototype.set=function(n,t){this.map[f(n)]=s(t)};t.prototype.forEach=function(n,t){for(var i in this.map)this.map.hasOwnProperty(i)&&n.call(t,this.map[i],i,this)};t.prototype.keys=function(){var n=[];return this.forEach(function(t,i){n.push(i)}),e(n)};t.prototype.values=function(){var n=[];return this.forEach(function(t){n.push(t)}),e(n)};t.prototype.entries=function(){var n=[];return this.forEach(function(t,i){n.push([i,t])}),e(n)};i.iterable&&(t.prototype[Symbol.iterator]=t.prototype.entries);a=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];u.prototype.clone=function(){return new u(this,{body:this._bodyInit})};l.call(u.prototype);l.call(r.prototype);r.prototype.clone=function(){return new r(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new t(this.headers),url:this.url})};r.error=function(){var n=new r(null,{status:0,statusText:""});return n.type="error",n};v=[301,302,303,307,308];r.redirect=function(n,t){if(v.indexOf(t)===-1)throw new RangeError("Invalid status code");return new r(null,{status:t,headers:{location:n}})};n.Headers=t;n.Request=u;n.Response=r;n.fetch=function(n,t){return new Promise(function(f,e){var s=new u(n,t),o=new XMLHttpRequest;o.onload=function(){var n={status:o.status,statusText:o.statusText,headers:tt(o.getAllResponseHeaders()||"")},t;n.url="responseURL"in o?o.responseURL:n.headers.get("X-Request-URL");t="response"in o?o.response:o.responseText;f(new r(t,n))};o.onerror=function(){e(new TypeError("Network request failed"))};o.ontimeout=function(){e(new TypeError("Network request failed"))};o.open(s.method,s.url,!0);s.credentials==="include"&&(o.withCredentials=!0);"responseType"in o&&i.blob&&(o.responseType="blob");s.headers.forEach(function(n,t){o.setRequestHeader(t,n)});o.send(typeof s._bodyInit=="undefined"?null:s._bodyInit)})};n.fetch.polyfill=!0}}(typeof self!="undefined"?self:this);document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-web.platform-content"}}));